/*
 Navicat Premium Data Transfer

 Source Server         : test
 Source Server Type    : MySQL
 Source Server Version : 80030
 Source Host           : localhost:3306
 Source Schema         : tomcat

 Target Server Type    : MySQL
 Target Server Version : 80030
 File Encoding         : 65001

 Date: 26/09/2023 22:52:41
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for tomcatbeforefixcomments
-- ----------------------------
DROP TABLE IF EXISTS `tomcatbeforefixcomments`;
CREATE TABLE `tomcatbeforefixcomments`  (
  `id` int(0) NOT NULL AUTO_INCREMENT,
  `bug_id` char(6) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `comment_id` varchar(3) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `comment` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  `author` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `date` varchar(30) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `attachment` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 2880 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of tomcatbeforefixcomments
-- ----------------------------
INSERT INTO `tomcatbeforefixcomments` VALUES (1, '56029', '1', 'Happens with all named operators\n\n<span class=\'${foo == \'bar\' and 1==1 ? \'bar-span\' : \'other-span\'}\'>span</span>	\n\n\nwill break as well.\n\nIf used in jspx it only works now as \n\n<span class=\'${foo == \'bar\' &amp;&amp; 1==1 ? \'bar-span\' : \'other-span\'}\'>span</span>	\n\nwhich is not a really acceptable solution.', 'Michael Simons', '2014-01-18 13:09:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2, '56029', '2', 'Ack. Reproducible with your sample file from  Comment 0  minus the \'xmlns:c\' and \'xmlns:fmt\' attributes.\n\n\n> javax.el.ELException: Failed to parse the expression [${currentControllereq\'News\'?\'selectedItem\':\'\'}]\n\nNotes:\n\n1. \'currentControllereq\' is printed without spaces in the above message. Also the rest of whitespaces are also missing in the message.\n\n2. A workaround is to add braces around the variable name.\nThe following does work:\n\n... class=\'${(currentController) eq \'News\' ? \'selectedItem\' : \'\'}\' ...\n\n\n3. This issue happens when EL in the value of a tag attribute.\n\nThis issue does not happen when EL is in the plain text (body of a tag).\nThe following does work successfully:\n\n<jsp:root version=\'2.0\' xmlns:jsp=\' http://java.sun.com/JSP/Page \'\n><jsp:directive.page contentType=\'text/plain\'/>\n${currentController eq \'News\' ? \'selectedItem\' : \'\'}</jsp:root>', 'Konstantin Kolinko', '2014-01-18 15:34:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (3, '56029', '3', '(In reply to Konstantin Kolinko from  comment #2 )\n> Ack. Reproducible with your sample file from  Comment 0  minus the \'xmlns:c\'\n> and \'xmlns:fmt\' attributes.\n> \n\nReproducible in 8.0-RC10 and 6.0.38 (release candidate) as well.', 'Konstantin Kolinko', '2014-01-18 15:44:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (4, '56029', '4', 'I suspected when I read this report that it was a regression caused by the fix for  Bug 55198  and given the versions of Tomcat affected it looks to be very much the case (although I haven\'t confirmed it yet).', 'Mark Thomas', '2014-01-18 17:23:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (5, '56029', '5', 'Fixed in 8.0.x for 8.0.0 onwards and in 7.0.x for 7.0.51 onwards.\n\nProposed for 6.0.x.', 'Mark Thomas', '2014-01-18 19:46:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (6, '56029', '6', '***  Bug 56031  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2014-01-18 21:04:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (7, '56029', '7', 'Konstantin: Your addendum is fully correct, i can confirm this.\n\nThanks for your kind reply and the quick solution, highly appreciated. Also thanks for the workaround, but i guess i\'ll wait to 7.0.51.', 'Michael Simons', '2014-01-18 21:11:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (8, '56029', '8', 'Created  attachment 31231   [details] \ntest.jspx - Failure to trim leading space from fn prefix\n\nRe:  r1559555 \n\nNot yet.\n\nTesting current 7.0.x (at  r1559663 ) I see the following error\n1. Place attached test.jspx into webapps/examples\n2. Access  http://localhost:8080/examples/test.jspx \n3. Expected: \'[1]\'. Actual:\n\norg.apache.jasper.JasperException: /test.jspx (line: 7, column: 63) The attribute prefix  fn does not correspond to any imported tag library\n org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:42)\n org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:443)\n org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:149)\n org.apache.jasper.compiler.Validator$ValidateVisitor$1FVVisitor.visit(Validator.java:1563)\n ...\n org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2375)\n org.apache.jasper.compiler.Validator.validateExDirectives(Validator.java:1817)\n org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:217)\n ...\n\nIn the message the prefix is printed as \' fn\' with leading whitespace.\nThe expression on the page is ${1 + fn:length(list)}', 'Konstantin Kolinko', '2014-01-20 12:10:03 UTC', 'tomcat_attachment/attachment 31231.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (9, '56029', '9', 'If fixed the white space issue in 8.0.x and 7.0.x and added it to the proposal for 6.0.x', 'Mark Thomas', '2014-01-20 14:32:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (10, '55943', '1', 'If this change were to be implemented then it should be implemented the same way as the delegate flag since that controls a similar behaviour. I\'d lean towards to boolean flag that simply disabled the code block (0.2) that checked the system class loader.\n\nNote that the system class loader is checked first to enforce the specification requirement that web applications must not be allowed to override Java SE platform classes. I\'d hesitate before adding an option to disable this check because of the specification requirement.\n\nI wonder if there isn\'t a better solution to this issue. The system class loader might not be the best class loader to use here. It is really the bootstrap class loader that is required but you can\'t get a reference to that in some JREs - including Oracle\'s. The class loader hierarchy for an Oracle JVM is system->ext->bootstrap so using the ext class loader would work in that case.\n\nI\'m thinking that rather than using the system class loader in this case the parent of the system class loader should be used (if it has one). That should both fix this issue and still enforce the specification requirement for not allowing the overriding of Java SE platformclasses.', 'Mark Thomas', '2014-01-01 11:24:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (11, '55943', '2', 'Switching to use a different classloader does sound a lot easier. Should I use the parent of the system classloader? It sounds like we really want the  bootstrap loader. Couldn\'t I recursively get the parent loaders, until I run out, to get the bootstrap loader?', 'chris.dow8', '2014-01-03 16:28:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (12, '55943', '3', 'Doing that won\'t get you the bootstrap class loader in an Oracle JRE - you\'ll get the ext loader (which is good enough for this use case).\n\nFor the sake of clarity, my suggestion is start at the system class loader, recursively get the parent and use the last non-null value you find.', 'Mark Thomas', '2014-01-09 14:20:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (13, '55943', '4', '\n\n*** This bug has been marked as a duplicate of  bug 55945  ***', 'Mark Thomas', '2014-01-14 12:11:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (14, '55943', '5', 'Sorry - wrong bug.', 'Mark Thomas', '2014-01-14 12:12:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (15, '55943', '6', 'I\'ve fixed this in 8.0.x for 8.0.0 and in 7.0.x for 7.0.51 onwards.\n\nAs I was cleaning up the use of the system class loader I also refactored the handling of parent==null which fell back to the system class loader to make it a little (probably not noticeably) faster.', 'Mark Thomas', '2014-01-17 15:37:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (16, '55943', '7', 'You beat me to it.  Thanks for all of your help.', 'chris.dow8', '2014-01-17 16:42:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (17, '55943', '8', 'Hi\n\nthis totaally breaks tomcat and tomee usage in embeded mode (+ has a lot of side effect in normal mode).\n\n1) the j2seClassLoader is not overridable in children classloader which is a pain since system was\n2) system is no more used\n3) it breaks compatibility\n\ncan you revert it and make it active just with a flag is asked?\n\nSide note: for a minor this is an important change which should have been showed a bit more (7.1 maybe)', 'romain.manni-bucau', '2014-02-18 09:56:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (18, '55943', '9', 'This change breaks previous behaviour. We have an app that sets some static variable values and then launches embedded tomcat. Embeded tomcat has a war file that inspects values of these static variables. This no longer seems to work.\n\nWe want to use a newer version of tomcat in order to close any security issues. Is there is any way to add a flag to be able to revert to the old behaviour?', 'hifisoftware', '2014-04-08 22:57:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (19, '55943', '10', 'This configurable. See this thread for details:\n http://markmail.org/thread/mid36pgk7nckp2rr ', 'Mark Thomas', '2014-04-09 00:27:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (20, '55943', '11', 'Thank Mark for the link. I have trouble understanding how to configure to follow the old behaviour.\n\nAre you suggesting to override the WebappClassLoader class?', 'hifisoftware', '2014-04-10 00:34:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (21, '55943', '12', 'I was able to figure out the fix. When I added the following line to context.xml file, class loader behaviour was restored:\n<Loader delegate=\'true\'/>\n\nThanks', 'hifisoftware', '2014-04-10 16:19:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (22, '55943', '13', '(In reply to Mark Thomas from  comment #6 )\n\nThe essential bit of  r1559153  /  r1559134  is the following change:\n\n@@ -1186,9 +1200,9 @@ public class WebappClassLoader extends U\n         // (0.2) Try loading the class with the system class loader, to prevent\n         //       the webapp from overriding J2SE classes\n         String resourceName = binaryNameToPath(name, false);\n-        if (system.getResource(resourceName) != null) {\n+        if (j2seClassLoader.getResource(resourceName) != null) {\n             try {\n-                clazz = system.loadClass(name);\n+                clazz = j2seClassLoader.loadClass(name);\n\nThe old code used \'System\' classloader - the JVM CLASSPATH.\nThe new code uses \'Bootstrap\' classloader - the topmost non-null parent of System class loader - the one that provides Java SE core classes.\n\nAs such, class-loader-howto,html has to be corrected.\nThe classes lookup order in 7.0.50 and earlier is:\n\n *  Bootstrap classes of your JVM\n *  System class loader classes (described above)\n *  /WEB-INF/classes of your web application\n *  /WEB-INF/lib/*.jar of your web application\n *  Common class loader classes (described above)\n\nFor 8.0.0 and 7.0.52 and later it now is\n\n *  Bootstrap classes of your JVM\n *  /WEB-INF/classes of your web application\n *  /WEB-INF/lib/*.jar of your web application\n *  System class loader classes (described above)\n *  Common class loader classes (described above)\n\nI am REOPENING this issue to apply this documentation fix. It is worth noting this in migration guide.\n\nIt may be worth to add that if one configures <Loader delegate=\'true\'/>,\nthe above order becomes\n\n *  Bootstrap classes of your JVM\n *  System class loader classes (described above)\n *  Common class loader classes (described above)\n *  /WEB-INF/classes of your web application\n *  /WEB-INF/lib/*.jar of your web application\n\n\nOne use case when jar is added by Java to the system classloader is using -javaagent option.\nDocumentation:\n http://docs.oracle.com/javase/7/docs/api/java/lang/instrument/package-summary.html#package_description \n\nA thread:\n http://tomcat.markmail.org/thread/trd7yj46qajqra2v \nOf course, such jar files should not be in WEB-INF/lib directory.', 'Konstantin Kolinko', '2014-04-30 00:06:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (23, '55995', '1', 'I can\'t reproduce this with the latest 8.0.x source. Neither do I see anything in the change history since RC10 that looks like it would have fixed this.\n\nWithout the JSP source it is hard to see what might be triggering this. Please provide the simplest possible JSP that demonstrates this issue along with any additional files (tags etc) that may be required to reproduce it.', 'Mark Thomas', '2014-01-13 17:48:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (24, '55995', '2', 'Drop severity to a realistic level. It isn\'t functionality used by most users and in at least some cases JspC still works.', 'Mark Thomas', '2014-01-13 17:50:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (25, '55995', '3', 'Created  attachment 31203   [details] \njspc_55995_test.bat\n\nI can reproduce this NPE with 8.0-RC10 and with trunk.\n\nSee the attached Windows batch file. Essentially, it uses Tomcat\'s bin/cpappend.bat to reproduce classpath from  Comment 0 . That is\n\n1. ant.jar\n2. all jars from %CATALINA_HOME% bin and %CATALINA_HOME% lib\n3. libs from the examples webapp (the JSTL jars)\n\nThen it tries to compile examples jsp tagplugin choose.jsp.\nThis results in the same NullPointerException, as reported by OP.\n\nException in thread \'main\' java.lang.NullPointerException\n        at org.apache.jasper.servlet.JspCServletContext.getResource(JspCServletContext.java:344)\n        at org.apache.jasper.compiler.TldCache.getLastModified(TldCache.java:124)\n        at org.apache.jasper.compiler.TldCache.<init>(TldCache.java:70)\n        at org.apache.jasper.JspC.initServletContext(JspC.java:1468)\n        at org.apache.jasper.JspC.execute(JspC.java:1321)\n        at org.apache.jasper.JspC.main(JspC.java:269)\n\n4. If I comment-out the line that adds JSTL jars to the classpath,\nJspC completes successfully and generates Java source text for the page.\nNote, that the JSTL tag library in the WEB-INF/lib directory of the web application is successfully recognized and processed by JspC.', 'Konstantin Kolinko', '2014-01-13 22:39:03 UTC', 'tomcat_attachment/attachment 31203.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (26, '55976', '1', 'Java client is used for smoke testing Tomcat 7.0.50. Java client fails with following exception:\n\n====\nException in thread \'main\' java.lang.RuntimeException: java.io.IOException: Invalid Http response\n	at webcrawler.WebCrawler.getpage(WebCrawler.java:117)\n	at webcrawler.WebCrawler.repeat(WebCrawler.java:191)\n	at webcrawler.WebCrawler.main(WebCrawler.java:30)\nCaused by: java.io.IOException: Invalid Http response\n	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1342)\n	at java.net.URL.openStream(URL.java:1037)\n	at webcrawler.WebCrawler.getpage(WebCrawler.java:94)\n	... 2 more\n----\n\n\nRelevant lines from sun.net.www.protocol.http.HttURLConnection.getInputStream:\n\n====\nrespCode = getResponseCode();\nif (respCode == -1) {\n    disconnectInternal();\n    throw new IOException (\'Invalid Http response\');\n}\n----\n\n\nSo, getResponseCode returns -1. Relevant part from sun.net.www.protocol.http.HttURLConnection.getResponseCode():\n\n====\n        /*\n         * Examine the status-line - should be formatted as per\n         * section 6.1 of RFC 2616 :-\n         *\n         * Status-Line = HTTP-Version SP Status-Code SP Reason-Phrase\n         *\n         * If status line can\'t be parsed return -1.\n         */\n        if (statusLine.startsWith(\'HTTP/1.\')) {\n            int codePos = statusLine.indexOf(\' \');\n            if (codePos > 0) {\n\n                int phrasePos = statusLine.indexOf(\' \', codePos+1);\n                if (phrasePos > 0 && phrasePos < statusLine.length()) {\n                    responseMessage = statusLine.substring(phrasePos+1);\n                }\n\n                // deviation from RFC 2616 - don\'t reject status line\n                // if SP Reason-Phrase is not included.\n                if (phrasePos < 0)\n                    phrasePos = statusLine.length();\n\n                try {\n                    responseCode = Integer.parseInt\n                            (statusLine.substring(codePos+1, phrasePos));\n                    return responseCode;\n                } catch (NumberFormatException e) { }\n            }\n        }\n        return -1;\n----\n\nSo it seems that response from Tomcat doesn\'t contain string \'HTTP/1.\' in the first line.', 'Ognjen Blagojevic', '2014-01-08 10:20:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (27, '55976', '2', 'Created  attachment 31182   [details] \nCorrect request and correct response', 'Ognjen Blagojevic', '2014-01-08 10:22:11 UTC', 'tomcat_attachment/attachment 31182.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (28, '55976', '3', 'Created  attachment 31183   [details] \nCorrect request and broken response', 'Ognjen Blagojevic', '2014-01-08 10:23:00 UTC', 'tomcat_attachment/attachment 31183.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (29, '55976', '4', 'I took localhost dump using RawCap. The dump contains traffic from the smoke testing. I then opened it with wireshark. \n\nIn the dump, there is a number of requests for file prelude.jspf.html:\n\n  \'GET /examples/jsp/jsp2/misc/prelude.jspf.html HTTP/1.1\'\n\nTomcat generally responds correctly, as seen in  attachment 31182   [details] .\n\nBut, in one request, instead of responding with content from \'prelude.jspf.html\' Tomcat responds with partial content from a different file -- \'/docs/architecture/startup/serverStartup.txt\'.\n\nAs one can see in  attachment 31183   [details] , the response also doesn\'t contain any header. That is the reason why Java client fails.', 'Ognjen Blagojevic', '2014-01-08 10:33:07 UTC', 'tomcat_attachment/attachment 31182.txt\ntomcat_attachment/attachment 31183.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (30, '55976', '5', 'Can you provide the source code of the test client you are using so the committers can try and reproduce this?', 'Mark Thomas', '2014-01-08 10:44:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (31, '55976', '6', 'Created  attachment 31184   [details] \nJava test class\n\nHere is Java class used for testing.\n\nYou should call it with one argument - starting URL (e.g. \' http://localhost:8080/ \')\n\nAt the first phase, it crawls all pages starting from the root. During the crawl, Java stack traces for 401s and 404s will be printed on the console, and may be ignored.\n\nAt the second phase, it will repeatedly read all collected URLs, 500 times in a row. In total, it reads around 140k pages. \n\nIf there is an error during the test, exception will be thrown, e.g:\n\n====\nRound: 154 / 500\nRound: 155 / 500\nRound: 156 / 500\nException in thread \'main\' java.lang.RuntimeException: java.io.IOException: Invalid Http response\n	at webcrawler.WebCrawler.getpage(WebCrawler.java:117)\n	at webcrawler.WebCrawler.repeat(WebCrawler.java:191)\n	at webcrawler.WebCrawler.main(WebCrawler.java:30)\nCaused by: java.io.IOException: Invalid Http response\n	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1342)\n	at java.net.URL.openStream(URL.java:1037)\n	at webcrawler.WebCrawler.getpage(WebCrawler.java:94)\n	... 2 more\n----\n\nSometimes exception is thrown after 5k requests, sometimes only after running this test several times.\n\n-Ognjen', 'Ognjen Blagojevic', '2014-01-08 11:15:30 UTC', 'tomcat_attachment/attachment 31184.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (32, '55976', '7', 'Created  attachment 31185   [details] \nTCP data log\n\n(In reply to Ognjen Blagojevic from  comment #6 )\n> Created  attachment 31184   [details] \n> Java test class\n\nHi,\n\nI can reproduce the problem with your test class with Tomcat 7.0.50, Tomcat 7.0.47 and Tomcat 8.0.0-RC10 on Windows 8.1 x64 with Java 1.7.0_45.\n\n\nTo provide an additional example of a broken HTTP response, I used a self-written tool to intercept the TCP connections from the Java client to Tomcat and log all data of each TCP connection channel to a file and I attached a Zip file containing the logs of the last few TCP connections.\n\nThe logs of connections 262-267 look normal (each HTTP request is replied to with an HTTP response), but if you look at 268 (where a single HTTP request was sent), Tomcat did not start the reply with an HTTP response, but with some random data chunks that seem to belong to different responses, and later sent the actual HTTP response for the request.', 'Konstantin Preißer', '2014-01-08 16:22:29 UTC', 'tomcat_attachment/attachment 31184.txt\ntomcat_attachment/attachment 31185.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (33, '55976', '8', '(In reply to Konstantin Preißer from  comment #7 )\n> I can reproduce the problem with your test class with Tomcat 7.0.50, Tomcat\n> 7.0.47 and Tomcat 8.0.0-RC10 on Windows 8.1 x64 with Java 1.7.0_45.\n\nSo that\'s critical information -- this isn\'t a regression since 7.0.47, i.e. in the 7.0.50 release.  It might be a regression in 7.0.47, but that was already released as stable.', 'Jess Holle', '2014-01-08 16:36:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (34, '55976', '9', 'Can someone who has been able to repeat this please test with tomcat/trunk from svn and see if they can still repeat it. I have been trying to repeat this for several hours with no success. I am wondering if the root cause is a bug that has been fixed since the last release.', 'Mark Thomas', '2014-01-09 16:32:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (35, '55976', '10', 'Created  attachment 31190   [details] \nmulti-threaded WebCrawler\n\nSlightly enhanced version of the provided WebCrawler class:\n\n- Params URL ITERATIONS THREADS\n  (crawl recursively starting at URL, retrieve found list of pages ITERATIONS times distributed on THREADS threads)\n- Log timestamp if an error occurs\n- don\'t convert bytes to strings when in replay mode\n\nExample: \n\n/path/to/bin/java webcrawler.WebCrawler  http://myserver:8080/docs/  1000 10\n\nCode tunables:\n\n    public static final int BUFSZ = 1000; // Buffer size for reading responses\n    public static final int CONNECT_TIMEOUT = 5000; // Connect timeout\n    public static final int READ_TIMEOUT = 30000; // Connect timeout', 'Rainer Jung', '2014-01-09 17:02:47 UTC', 'tomcat_attachment/attachment 31190.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (36, '55976', '11', 'Created  attachment 31191   [details] \nAlternative Testcase - WAR', 'Konstantin Preißer', '2014-01-09 17:07:28 UTC', 'tomcat_attachment/attachment 31191');
INSERT INTO `tomcatbeforefixcomments` VALUES (37, '55976', '12', 'Created  attachment 31192   [details] \nAlternative Test Case - Java class\n\nHi Mark,\n\n(In reply to Mark Thomas from  comment #9 )\n> Can someone who has been able to repeat this please test with tomcat/trunk\n> from svn and see if they can still repeat it. I have been trying to repeat\n> this for several hours with no success. I am wondering if the root cause is\n> a bug that has been fixed since the last release.\n\nI could reproduce the issues with Tomcat 8 trunk, SVN  r1556836  on Windows 8.1 x64, Java 1.7.0_45 x64.\n\nI uploaded an alternative Testcase which maybe makes reproducing easier - a WAR that contains 100 text files, and a Java class that starts 100 Threads that concurrently download 100 URLs.\n\nNormally, the only things that should be displayed in the console are \'Starting...\' and \'Finished.\'. This happens when running with the BIO connector.\n\nHowever, with Tomcat NIO connector, I mostly get exceptions like this:\n\njava.io.IOException: Invalid Http response\n	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)\n	at test.TomcatNioTest.readUrl(TomcatNioTest.java:23)\n	at test.TomcatNioTest.access$0(TomcatNioTest.java:19)\n	at test.TomcatNioTest$1.run(TomcatNioTest.java:48)\n	at java.lang.Thread.run(Unknown Source)\nException in thread \'Thread-93\' java.lang.RuntimeException: Size mismatch for URL  http://localhost:8080/testnio/files/TextFile81.txt  - Expected: 58003, Got: 65536\n	at test.TomcatNioTest.readUrl(TomcatNioTest.java:31)\n	at test.TomcatNioTest.access$0(TomcatNioTest.java:19)\n	at test.TomcatNioTest$1.run(TomcatNioTest.java:48)\n	at java.lang.Thread.run(Unknown Source)\n\nAlso, most of the time the program never finishes - it seems Tomcat does not serve some requests.\n\n\nSometimes I also get these Exceptions in Tomcat:\n\n09-Jan-2014 17:40:48.143 SEVERE [http-nio-8080-exec-76] org.apache.coyote.http11.AbstractHttp11Processor.process Error processing request\n java.lang.NullPointerException\n	at org.apache.coyote.http11.Http11NioProcessor.actionInternal(Http11NioProcessor.java:321)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:843)\n	at org.apache.coyote.Request.action(Request.java:381)\n	at org.apache.catalina.connector.Request.getRemoteAddr(Request.java:1240)\n	at org.apache.catalina.connector.Request.getRemoteHost(Request.java:1255)\n	at org.apache.catalina.valves.AccessLogValve$HostElement.addElement(AccessLogValve.java:1366)\n	at org.apache.catalina.valves.AccessLogValve.log(AccessLogValve.java:963)\n	at org.apache.catalina.core.AccessLogAdapter.log(AccessLogAdapter.java:51)\n	at org.apache.catalina.core.ContainerBase.logAccess(ContainerBase.java:1044)\n	at org.apache.catalina.core.ContainerBase.logAccess(ContainerBase.java:1051)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:573)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1015)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:646)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1576)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:744)\n\n09-Jan-2014 17:40:48.518 WARNING [http-nio-8080-exec-76] org.apache.catalina.connector.CoyoteAdapter.log Exception while attempting to add an entry to the access log\n java.lang.NullPointerException\n	at org.apache.coyote.http11.Http11NioProcessor.actionInternal(Http11NioProcessor.java:321)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:843)\n	at org.apache.coyote.Request.action(Request.java:381)\n	at org.apache.catalina.connector.Request.getRemoteAddr(Request.java:1240)\n	at org.apache.catalina.connector.Request.getRemoteHost(Request.java:1255)\n	at org.apache.catalina.valves.AccessLogValve$HostElement.addElement(AccessLogValve.java:1366)\n	at org.apache.catalina.valves.AccessLogValve.log(AccessLogValve.java:963)\n	at org.apache.catalina.core.AccessLogAdapter.log(AccessLogAdapter.java:51)\n	at org.apache.catalina.core.StandardEngine.logAccess(StandardEngine.java:344)\n	at org.apache.catalina.connector.CoyoteAdapter.log(CoyoteAdapter.java:644)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1044)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:646)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1576)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:744)\n\n09-Jan-2014 17:47:37.091 SEVERE [http-nio-8080-ClientPoller-1] org.apache.tomcat.util.net.NioEndpoint.processSocket Error allocating socket processor\n java.lang.NullPointerException\n	at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:622)\n	at org.apache.tomcat.util.net.NioEndpoint$Poller.processKey(NioEndpoint.java:1144)\n	at org.apache.tomcat.util.net.NioEndpoint$Poller.run(NioEndpoint.java:1101)\n	at java.lang.Thread.run(Thread.java:744)', 'Konstantin Preißer', '2014-01-09 17:07:32 UTC', 'tomcat_attachment/attachment 31192.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (38, '55976', '13', 'I can reproduce errors even for trunk but there currently only read timeouts. I\'m using a relatively slow server and remote access from a more powerful machine using 10 threads in the improved version of the WebCrawler. Crawling the docs/ webapp suffices to produce those read timeouts (30 seconds). The CPU on the server is not fully saturated and other parametrization shows that those requests would hang indefinitely if no timeout were applied.\n\nFor TC 7.0.50 I could also produce other types of errors, but didn\'t play long enough with trunk.\n\nNot directly related to the read timeout occurences I see on the server side sometimes messages:\n\n09-Jan-2014 17:56:33.691 SEVERE [http-nio-8080-ClientPoller-1] org.apache.tomcat.util.net.NioEndpoint$PollerEvent.run\n java.nio.channels.ClosedChannelException\n        at java.nio.channels.spi.AbstractSelectableChannel.register(AbstractSelectableChannel.java:194)\n        at org.apache.tomcat.util.net.NioEndpoint$PollerEvent.run(NioEndpoint.java:797)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.events(NioEndpoint.java:925)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.run(NioEndpoint.java:1085)\n        at java.lang.Thread.run(Thread.java:744)\n\nRegards,\n\nRainer', 'Rainer Jung', '2014-01-09 17:15:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (39, '55976', '14', 'When crawling not only /docs but also /examples, I get more types of errors.\n\nIn the access log (non-200, non-302)\n\n195.227.30.185 - - 18:11:12.441 \'GET /docs/cgi-howto.html HTTP/1.1\' 400 -\n- - - 00:59:59.00-1 \'-\' 500 -\n195.227.30.185 - - 18:11:12.895 \'GET /examples/jsp/jsp2/simpletag/book.jsp HTTP/1.1\' 400 951\n195.227.30.185 - - 18:11:13.050 \'GET /examples/jsp/jsp2/simpletag/book.jsp HTTP/1.1\' 400 951\n195.227.30.185 - - 18:11:33.967 \'GET /examples/servlets/nonblocking/numberwriter HTTP/1.1\' 500 49200\n195.227.30.185 - - 18:11:35.036 \'GET /examples/servlets/nonblocking/numberwriter HTTP/1.1\' 500 155800\n- - - 00:59:59.00-1 \'-\' 500 -\n- - - 00:59:59.00-1 \'-\' 400 -\n195.227.30.185 - - 18:11:35.486 \'GET /docs/jspapi/index.html HTTP/1.1\' 400 -\n195.227.30.185 - - 18:11:35.674 \'GET /examples/jsp/jsp2/jspattribute/jspattribute.html HTTP/1.1\' 500 2221\n- - - 00:59:59.00-1 \'-\' 500 -\n195.227.30.185 - - 18:11:35.888 \'GET /docs/config/cluster-valve.html HTTP/1.1\' 400 10669\n195.227.30.185 - - 18:11:35.887 \'GET /docs/config/cluster-valve.html HTTP/1.1\' 400 -\n\netc.\n\nIn the tomcat logs\n\n09-Jan-2014 18:10:40.405 SEVERE [http-nio-8080-ClientPoller-1] org.apache.tomcat.util.net.NioEndpoint$PollerEvent.run\n java.nio.channels.ClosedChannelException\n        at java.nio.channels.spi.AbstractSelectableChannel.register(AbstractSelectableChannel.java:194)\n        at org.apache.tomcat.util.net.NioEndpoint$PollerEvent.run(NioEndpoint.java:797)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.events(NioEndpoint.java:925)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.run(NioEndpoint.java:1085)\n        at java.lang.Thread.run(Thread.java:744)\n\n09-Jan-2014 18:11:11.341 SEVERE [http-nio-8080-exec-9] org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process Error reading request, ignored\n java.lang.NullPointerException\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.release(Http11NioProtocol.java:243)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:698)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1576)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\n\n09-Jan-2014 18:11:12.450 INFO [http-nio-8080-exec-26] org.apache.coyote.http11.AbstractHttp11Processor.process Error parsing HTTP request header\n Note: further occurrences of HTTP header parsing errors will be logged at DEBUG level.\n09-Jan-2014 18:11:12.745 SEVERE [http-nio-8080-exec-29] org.apache.coyote.http11.AbstractHttp11Processor.process Error processing request\n java.lang.NullPointerException\n        at org.apache.catalina.connector.Request.notifyAttributeAssigned(Request.java:1512)\n        at org.apache.catalina.connector.Request.setAttribute(Request.java:1503)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:76)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:934)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:90)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:522)\n        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1015)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:646)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1576)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\n\n09-Jan-2014 18:11:12.752 SEVERE [http-nio-8080-exec-29] org.apache.coyote.http11.AbstractHttp11Processor.endRequest Error finishing response\n java.lang.NullPointerException\n        at org.apache.coyote.http11.InternalNioOutputBuffer.flushBuffer(InternalNioOutputBuffer.java:235)\n        at org.apache.coyote.http11.InternalNioOutputBuffer.addToBB(InternalNioOutputBuffer.java:190)\n        at org.apache.coyote.http11.InternalNioOutputBuffer.access$000(InternalNioOutputBuffer.java:42)\n        at org.apache.coyote.http11.InternalNioOutputBuffer$SocketOutputBuffer.doWrite(InternalNioOutputBuffer.java:321)\n        at org.apache.coyote.http11.filters.ChunkedOutputFilter.end(ChunkedOutputFilter.java:166)\n        at org.apache.coyote.http11.AbstractOutputBuffer.endRequest(AbstractOutputBuffer.java:379)\n        at org.apache.coyote.http11.AbstractHttp11Processor.endRequest(AbstractHttp11Processor.java:1704)\n        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1071)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:646)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1576)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\n\n...\n\n09-Jan-2014 18:11:33.966 SEVERE [http-nio-8080-exec-9] org.apache.catalina.connector.CoyoteAdapter.asyncDispatch Exception while processing an asynchronous request\n java.lang.IllegalStateException: Calling [asyncTimeout()] is not valid for a request with Async state [READ_WRITE_OP]\n        at org.apache.coyote.AsyncStateMachine.asyncTimeout(AsyncStateMachine.java:265)\n        at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:802)\n        at org.apache.coyote.Request.action(Request.java:381)\n        at org.apache.catalina.core.AsyncContextImpl.timeout(AsyncContextImpl.java:139)\n        at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:306)\n        at org.apache.coyote.http11.AbstractHttp11Processor.asyncDispatch(AbstractHttp11Processor.java:1618)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:640)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1576)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\n\n09-Jan-2014 18:11:34.685 SEVERE [http-nio-8080-exec-21] org.apache.catalina.connector.CoyoteAdapter.asyncDispatch Exception while processing an asynchronous request\n java.lang.IllegalStateException: In non-blocking mode you may not write to the ServletOutputStream until the previous write has completed and isReady() returns true\n        at org.apache.catalina.connector.CoyoteOutputStream.checkNonBlockingWrite(CoyoteOutputStream.java:128)\n        at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:96)\n        at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:90)\n        at nonblocking.NumberWriter$NumberWriterListener.onWritePossible(NumberWriter.java:132)\n        at nonblocking.NumberWriter$NumberWriterListener.onAllDataRead(NumberWriter.java:120)\n        at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:391)\n        at org.apache.coyote.http11.AbstractHttp11Processor.asyncDispatch(AbstractHttp11Processor.java:1618)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:631)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1576)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\n\n09-Jan-2014 18:11:34.967 SEVERE [http-nio-8080-exec-20] org.apache.catalina.connector.CoyoteAdapter.asyncDispatch Exception while processing an asynchronous request\n java.lang.IllegalStateException: The request associated with the AsyncContext has already completed processing.\n        at org.apache.catalina.core.AsyncContextImpl.check(AsyncContextImpl.java:532)\n        at org.apache.catalina.core.AsyncContextImpl.complete(AsyncContextImpl.java:91)\n        at nonblocking.NumberWriter$NumberWriterListener.onError(NumberWriter.java:145)\n        at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:395)\n        at org.apache.coyote.http11.AbstractHttp11Processor.asyncDispatch(AbstractHttp11Processor.java:1618)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:631)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1576)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\n\n\n\n...\n\n09-Jan-2014 18:11:36.787 SEVERE [http-nio-8080-exec-4] org.apache.coyote.http11.AbstractHttp11Processor.process Error processing request\n java.lang.NullPointerException\n        at org.apache.tomcat.util.buf.MessageBytes.toChars(MessageBytes.java:228)\n        at org.apache.catalina.mapper.Mapper.map(Mapper.java:665)\n        at org.apache.catalina.connector.CoyoteAdapter.postParseRequest(CoyoteAdapter.java:794)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:517)\n        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1015)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:646)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1576)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\n\n\n\nSome of which are possibly because the client calls URLs that it shouldn\'t.', 'Rainer Jung', '2014-01-09 17:19:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (40, '55976', '15', '(In reply to Konstantin Preißer from  comment #11 )\n> Created  attachment 31191   [details] \n> Alternative Testcase - WAR\n\nThanks. I can repeat the problem with that variation of the test case. My testing shows the issue is related to sendFile. If I set useSendFile=\'false\' on the NIO connector everything works as expected. I\'m looking at the sendFile code now to see if I can figure out where I (assuming it was me but it is a pretty good bet that it was) broke it.', 'Mark Thomas', '2014-01-09 19:16:41 UTC', 'tomcat_attachment/attachment 31191');
INSERT INTO `tomcatbeforefixcomments` VALUES (41, '55976', '16', 'Just in case others want to check as well, it is useSendfile=\'false\' (lower case \'file\').\n\nRunning test with my multi-threaded version of the crawler against alls tc webaps right now. Looks better than before, no errors yet, will let it run for another hour or so.', 'Rainer Jung', '2014-01-09 20:37:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (42, '55976', '17', 'I believe I have fixed this in 8.0.x trunk. I\'d be grateful if one or more of you who were able to repeat this issue are able to validate (or not) my fix.', 'Mark Thomas', '2014-01-09 21:33:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (43, '55976', '18', 'So far so good. Tomcat 8 trunk ( r1556957 ) works for me. No exception on client side, or in server logs, no HTTP 500 errors.', 'Ognjen Blagojevic', '2014-01-10 00:07:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (44, '55976', '19', 'Looks promising. I did not get any errors with sendfile turned off and 50000 iterations distributed on 20 threads. I now run the recent trunk with your fix again with 20 threads and the first 2000 iterations are good. I\'ll let it run until 50000 and will check tomorrow whether 7.0.50 runs without problems when switching off sendfile.!gre', 'Rainer Jung', '2014-01-10 00:20:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (45, '55958', '1', 'Stack trace? It looks like ContextConfig:627 in trunk might allow a directory to be treated as if it were a file.', 'Christopher Schultz', '2014-01-06 22:25:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (46, '55958', '2', 'This is the relevant output in catalina.out including the stacktrace\n\nINFO: Deploying web application directory /home/rhatlapa/projects/redhat_projects/eap/eap63-development/apache-tomcat-7.0.47/webapps/byteslounge.war\nJan 06, 2014 10:08:48 AM org.apache.catalina.startup.ContextConfig init\nSEVERE: Exception fixing docBase for context [/byteslounge]\njava.io.FileNotFoundException: /home/rhatlapa/projects/redhat_projects/eap/eap63-development/apache-tomcat-7.0.47/webapps/byteslounge.war (Is a directory)\n  at java.util.zip.ZipFile.open(Native Method)\n  at java.util.zip.ZipFile.<init>(ZipFile.java:215)\n  at java.util.zip.ZipFile.<init>(ZipFile.java:145)\n  at java.util.jar.JarFile.<init>(JarFile.java:153)\n  at java.util.jar.JarFile.<init>(JarFile.java:90)\n  at sun.net.www.protocol.jar.URLJarFile.<init>(URLJarFile.java:93)\n  at sun.net.www.protocol.jar.URLJarFile.getJarFile(URLJarFile.java:69)\n  at sun.net.www.protocol.jar.JarFileFactory.get(JarFileFactory.java:99)\n  at sun.net.www.protocol.jar.JarURLConnection.connect(JarURLConnection.java:122)\n  at sun.net.www.protocol.jar.JarURLConnection.getJarFile(JarURLConnection.java:89)\n  at org.apache.catalina.startup.ExpandWar.expand(ExpandWar.java:113)\n  at org.apache.catalina.startup.ContextConfig.fixDocBase(ContextConfig.java:741)\n  at org.apache.catalina.startup.ContextConfig.init(ContextConfig.java:843)\n  at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:387)\n  at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n  at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n  at org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:402)\n  at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:110)\n  at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:139)\n  at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n  at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n  at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n  at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1120)\n  at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1678)\n  at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n  at java.util.concurrent.FutureTask.run(FutureTask.java:262)\n  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n  at java.lang.Thread.run(Thread.java:744)\n\nJan 06, 2014 10:08:48 AM org.apache.catalina.core.StandardContext resourcesStart\nSEVERE: Error starting static Resources\njava.lang.IllegalArgumentException: Document base /home/rhatlapa/projects/redhat_projects/eap/eap63-development/apache-tomcat-7.0.47/webapps/byteslounge does not exist or is not a readable directory\n  at org.apache.naming.resources.FileDirContext.setDocBase(FileDirContext.java:138)\n  at org.apache.catalina.core.StandardContext.resourcesStart(StandardContext.java:5055)\n  at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5235)\n  at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n  at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n  at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n  at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n  at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1120)\n  at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1678)\n  at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n  at java.util.concurrent.FutureTask.run(FutureTask.java:262)\n  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n  at java.lang.Thread.run(Thread.java:744)', 'Radim Hatlapatka', '2014-01-07 08:20:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (47, '55958', '3', 'So you have a directory named \'/home/rhatlapa/projects/redhat_projects/eap/eap63-development/apache-tomcat-7.0.47/webapps/byteslounge.war\'? What else is in your \'/home/rhatlapa/projects/redhat_projects/eap/eap63-development/apache-tomcat-7.0.47/webapps/\' directory before you try to start Tomcat?', 'Christopher Schultz', '2014-01-07 18:18:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (48, '55958', '4', 'Yes, that is right, I have the directory named byteslounge.war, if I remove .war from the name => by renaming it to byteslounge it works just fine.\n\nThe rest of webapps in the webapps directory are only the default ones which are in clean tomact installation.\n\nThe only issue is that if you decide to name the webapp with suffix .war it is automatically treated as zip file instead of being treated as directory.', 'Radim Hatlapatka', '2014-01-07 18:35:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (49, '55937', '1', '\n> When I do exactly the same thing as #1 (tomcat auto deploy)\n> but just change the \'path\' variable from /360Store to /ROOT\n\n\'ROOT\' is base file name for the default webapp. Its context path is \'\' (an empty string), it is not \'/ROOT\', see [1].\n\nWhat if you specify path=\'\' or path=\'/\' ?\n\n[1]  http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Naming \n[2]  http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html#Deploy_A_New_Application_Remotely ', 'Konstantin Kolinko', '2013-12-28 11:14:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (50, '55937', '2', 'Thank you Konstantin, this did fix the problem!\n\nOne request - could the error reporting be improved? Maybe in the log file it could have a line stating something like \'ROOT is not a valid contact path\'?\n\nUsing the name /ROOT did work in Tomcat 6 - which is what I was migrating from. I expect that others who are moving from Tomcat 6 to a later version might make the same mistake.', 'Jesse Barnum', '2013-12-28 14:05:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (51, '55937', '3', 'This has been fixed in 8.0.x for 8.0.0 onwards.\n\nNote that in Tomcat 8, attempting to deploy to /ROOT deploys the WAR as the ROOT web application but reports that the deployment has failed. After this fix the deployment is still to the ROOT web application but the deployer now reports a successful deployment to \'/\'.\n\nAlso note that the automatic deployment improvements back-ported to 7.0.x for 7.0.50 may have changed the behaviour for 7.0.x.', 'Mark Thomas', '2014-01-09 11:41:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (52, '55884', '1', 'Well that was pointless, because apparently there\'s a tiny size limit on attachments. Suggestions on how to attach this WAR file?', 'Nick Williams', '2013-12-14 17:05:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (53, '55884', '2', '(In reply to Nick Williams from  comment #1 )\n\n1. Simplify.\n\nYour issue is that a single JSP page does not compile. Remove everything that is not related to the problem. There is no need to bundle all of Spring etc.\n\n2. Are you sure that you have a JAR that contains org.apache.taglibs.standard.tag.rt.core.UrlTag\non the classpath?\n\nIt seems that you are trying to use Oracle JSTL implementation (that abuses Apache package names).\n\n3. What version of Tomcat 8 are you using?\nSeveral tag-file related bugs were fixed in the last few days (those were noted during 8.0.0-RC7 voting).\n\n4. What versions of Java 8 and of Apache Ant are you using?', 'Konstantin Kolinko', '2013-12-14 20:05:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (54, '55884', '3', 'The mixed use of URL encoding on the classpath looks suspicious:\n  /C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/javax.servlet.jsp.jstl-1.2.2.jar\nvs.\n  /C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/servlet-api.jar\n\nThe difference seems to be paths to libraries sourced from the webapp, which would include the jar containing the classes needed for JSTL.\n\nCan you reproduce this with the stock distribution (the SVG example  http://localhost:8080/examples/jsp/jsp2/jspx/svgexample.html  uses JSTL) when it is installed in a directory with spaces and uses the Ant compiler?', 'Jeremy Boynes', '2013-12-14 20:09:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (55, '55884', '4', 'Created  attachment 31117   [details] \nApplication Replicating Problem\n\nOkay. I\'ve attached the simplest possible application that replicates the problem. Just go to  http://localhost:8080/test-jstl/  after deploying it.\n\nTo respond to your questions (and in anticipation of future questions):\n\n1) I\'m using Tomcat 8.0.0-trunk-1550920 (compiled this morning).\n2)  http://localhost:8080/examples/jsp/jsp2/jspx/svgexample.html  works fine.\n3) Yes, I have the necessary JARs in my application (see attached WAR file).\n4) Java 8-ea-120 (this week)\n5) Ant 1.9.0 compiled on March 5 2013\n6) The app only fails to compile the JSP in Tomcat 8 using the Ant+Java 8 compiler configuration.\n7) The app works fine in Tomcat 8.0.0-trunk-1550920 using the built-in Eclipse compiler.\n8) The app works fine in Tomcat 7.0.47 using the built-in Eclipse compiler.\n9) The app works fine in Tomcat 7.0.47 using the same Ant+Java 8 compiler configuration.\n\nHere\'s the error for the new test-jstl.war app:\n\n14-Dec-2013 20:16:10.819 SEVERE [http-nio-8080-exec-2] org.apache.jasper.compiler.AntCompiler.generateClass Javac exception\n Compile failed; see the compiler error output for details.\n	at org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:1174)\n	at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:930)\n	at org.apache.jasper.compiler.AntCompiler.generateClass(AntCompiler.java:234)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:380)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:355)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:342)\n	at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:357)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:403)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:347)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\n	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:107)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:76)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:934)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:90)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:522)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1015)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:646)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1597)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1555)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n	at java.lang.Thread.run(Thread.java:744)\n\n14-Dec-2013 20:16:10.834 SEVERE [http-nio-8080-exec-2] org.apache.jasper.compiler.AntCompiler.generateClass Environment:Compile: javaFileName=C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost test-jstl org apache jsp index_jsp.java\n    classpath=/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/test-jstl/WEB-INF/lib/javax.servlet.jsp.jstl-1.2.2.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/test-jstl/WEB-INF/lib/javax.servlet.jsp.jstl-api-1.2.1.jar;C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost test-jstl;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/annotations-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina-ant.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina-ha.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina-storeconfig.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina-tribes.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/ecj-4.3.1.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/el-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/jasper-el.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/jasper.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/jsp-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/servlet-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-coyote.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-dbcp.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-i18n-es.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-i18n-fr.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-i18n-ja.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-jdbc.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-jni.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-spdy.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-util-scan.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-util.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-websocket.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/websocket-api.jar;/C:/Program Files/Java/jdk8/lib/tools.jar;/C:/Program Files/Apache Software Foundation/Ant/lib/ant.jar;/C:/Program Files/Apache Software Foundation/Ant/lib/ant-launcher.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/bin/bootstrap.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/bin/tomcat-juli.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/access-bridge-64.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/cldrdata.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/dnsns.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/jaccess.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/jfxrt.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/localedata.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/nashorn.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/sunec.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/sunjce_provider.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/sunmscapi.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/sunpkcs11.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/zipfs.jar\n    cp=C: Program Files Java jdk8 lib tools.jar;C: Program Files Apache Software Foundation Ant lib ant.jar;C: Program Files Apache Software Foundation Ant lib ant-launcher.jar;C: Program Files Apache Software Foundation Tomcat 8.0 bin bootstrap.jar;C: Program Files Apache Software Foundation Tomcat 8.0 bin tomcat-juli.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps test-jstl WEB-INF lib javax.servlet.jsp.jstl-1.2.2.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps test-jstl WEB-INF lib javax.servlet.jsp.jstl-api-1.2.1.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost test-jstl\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib annotations-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina-ant.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina-ha.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina-storeconfig.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina-tribes.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib ecj-4.3.1.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib el-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib jasper-el.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib jasper.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib jsp-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib servlet-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-coyote.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-dbcp.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-i18n-es.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-i18n-fr.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-i18n-ja.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-jdbc.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-jni.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-spdy.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-util-scan.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-util.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-websocket.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib websocket-api.jar\n    cp=C: Program Files Java jdk8 lib tools.jar\n    cp=C: Program Files Apache Software Foundation Ant lib ant.jar\n    cp=C: Program Files Apache Software Foundation Ant lib ant-launcher.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 bin bootstrap.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 bin tomcat-juli.jar\n    cp=C: Program Files Java jdk8 jre lib ext access-bridge-64.jar\n    cp=C: Program Files Java jdk8 jre lib ext cldrdata.jar\n    cp=C: Program Files Java jdk8 jre lib ext dnsns.jar\n    cp=C: Program Files Java jdk8 jre lib ext jaccess.jar\n    cp=C: Program Files Java jdk8 jre lib ext jfxrt.jar\n    cp=C: Program Files Java jdk8 jre lib ext localedata.jar\n    cp=C: Program Files Java jdk8 jre lib ext nashorn.jar\n    cp=C: Program Files Java jdk8 jre lib ext sunec.jar\n    cp=C: Program Files Java jdk8 jre lib ext sunjce_provider.jar\n    cp=C: Program Files Java jdk8 jre lib ext sunmscapi.jar\n    cp=C: Program Files Java jdk8 jre lib ext sunpkcs11.jar\n    cp=C: Program Files Java jdk8 jre lib ext zipfs.jar\n    work dir=C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost test-jstl\n    extension dir=C: Program Files Java jdk8 jre lib ext;C: Windows Sun Java lib ext\n    srcDir=C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost test-jstl\n    compiler=modern\n   compilerTargetVM=1.8\n   compilerSourceVM=1.8\n    include=org/apache/jsp/index_jsp.java\n\n14-Dec-2013 20:16:10.834 SEVERE [http-nio-8080-exec-2] org.apache.jasper.compiler.AntCompiler.generateClass Error compiling file: C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost test-jstl org apache jsp index_jsp.java     [javac] warning: \'includeantruntime\' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds\n    [javac] Compiling 1 source file\n\nC: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost test-jstl org apache jsp index_jsp.java:109: error: package org.apache.taglibs.standard.tag.rt.core does not exist\n    org.apache.taglibs.standard.tag.rt.core.UrlTag _jspx_th_c_005furl_005f0 = (org.apache.taglibs.standard.tag.rt.core.UrlTag) _005fjspx_005ftagPool_005fc_005furl_0026_005fvalue_005fnobody.get(org.apache.taglibs.standard.tag.rt.core.UrlTag.class);\n                                           ^\nC: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost test-jstl org apache jsp index_jsp.java:109: error: package org.apache.taglibs.standard.tag.rt.core does not exist\n    org.apache.taglibs.standard.tag.rt.core.UrlTag _jspx_th_c_005furl_005f0 = (org.apache.taglibs.standard.tag.rt.core.UrlTag) _005fjspx_005ftagPool_005fc_005furl_0026_005fvalue_005fnobody.get(org.apache.taglibs.standard.tag.rt.core.UrlTag.class);\n                                                                                                                      ^\nC: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost test-jstl org apache jsp index_jsp.java:109: error: package org.apache.taglibs.standard.tag.rt.core does not exist\n    org.apache.taglibs.standard.tag.rt.core.UrlTag _jspx_th_c_005furl_005f0 = (org.apache.taglibs.standard.tag.rt.core.UrlTag) _005fjspx_005ftagPool_005fc_005furl_0026_005fvalue_005fnobody.get(org.apache.taglibs.standard.tag.rt.core.UrlTag.class);\n                                                                                                                                                                                                                                        ^\n3 errors', 'Nick Williams', '2013-12-15 02:35:35 UTC', 'tomcat_attachment/attachment 31117');
INSERT INTO `tomcatbeforefixcomments` VALUES (56, '55884', '5', 'I can reproduce this on OSX using Java 1.7 and the stock distribution.\n\nIf I copy output/build to \'/tmp/good-path\' and make the config changes described (setenv.sh and JspServlet) then the SVG demo and Nick\'s app work. If I then move the install to \'/tmp/bad path\' then I get the same compilation error occurs with both.\n\nI assume it\'s in the resource handling which is replacing the \' \' with \'%20\' in the classpath entry.', 'Jeremy Boynes', '2013-12-15 03:45:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (57, '55801', '1', 'Hello,\nWhat is the chance to have this patch integrated into trunk? I want to avoid keeping my fork of tomcat that is only for client code.\n\nThis patch would be useful also for those who cope with self-signed certificates for test purposes.\nThanks,\n\nMarek', 'Marek Jagielski', '2013-11-21 14:39:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (58, '55801', '2', '(In reply to Marek Jagielski from  comment #1 )\n> This patch would be useful also for those who cope with self-signed\n> certificates for test purposes.\n\nI\'m just curious how this would help with self-signed certificates. What can you not accomplish with existing APIs/configuration?', 'Christopher Schultz', '2013-11-21 23:07:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (59, '55801', '3', '(In reply to Christopher Schultz from  comment #2 )\n> (In reply to Marek Jagielski from  comment #1 )\n> > This patch would be useful also for those who cope with self-signed\n> > certificates for test purposes.\n> \n> I\'m just curious how this would help with self-signed certificates. What can\n> you not accomplish with existing APIs/configuration?\n\nIf certificate is known beforehand there is no problem - it can be simply added to the trust store.\n\nMy problem is that clients do not know anything about the server they are connecting to. I work in cloud environment and servers are instantiated and terminated as they are needed. Every time new server instance is created it gets new self-signed certificate. The only thing client knows about server is its IP address. Ability to temporarily ignore certificates would solve this problem for me.\n\nAdditionally, even if trust store solves problem for most cases, some people prefer to ignore certificates. I think it\'s fairly common practice in HTTPS clients. I remember doing so myself in Jersey Client API.', 'Maciej Lypik', '2013-11-22 08:53:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (60, '55801', '4', 'I\'m wondering if I could get any feedback on this patch. I\'d like for it to be integrated, as it is the only feasible solution to my problem.\n\nI hate to push this myself, but with time it\'s becoming a blocking issue for me.', 'Maciej Lypik', '2013-11-26 12:41:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (61, '55801', '5', 'It is OK for me, but here are two minor glitches\n\n1. Wasted work.\n\n> SSLContext sslContext = SSLContext.getInstance(\'TLS\');\n\nSuch getInstance() calls are usually slow. It\'d be better to skip it if you are ignoring its result.\n\n2. You have Javadoc (good), but these properties are also mentioned at the bottom of\n webapps docs web-socket-howto.xml\n\nIt would be good to mention somewhere that the value of a SSL_TRUSTSTORE_PROPERTY is ignored when using SSL_CONTEXT_PROPERTY.', 'Konstantin Kolinko', '2013-11-26 22:48:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (62, '55801', '6', 'I haven\'t looked at the Websocket client code, but if it\'s using HttpsURLConnection (which is a big IF) to negotiate the initial connection, it\'s trivial to re-configure it using the standard API.', 'Christopher Schultz', '2013-11-26 23:35:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (63, '55801', '7', 'Created  attachment 31080   [details] \nCorrected patch', 'Maciej Lypik', '2013-11-27 09:17:28 UTC', 'tomcat_attachment/attachment 31080.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (64, '55801', '8', 'Sorry for commenting so late. I\'ve fixed the logic and added description to websocket-howto so it should be OK now.\n\nI was also looking for a better solution to this problem.  I checked Tyrus and it also uses custom properties to configure SSLEngine. So I guess there is no perfect answer until client-side SSL configuration is defined in WebSocket spec.', 'Maciej Lypik', '2013-12-02 16:53:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (65, '55801', '9', 'Hi,\nCan you give any feedback on this issue? I need to take a decision to move my project forward. I want to know if I will stay with tomcat implementation of websocket client or look for something else. I have already removed jwebsocket proprietary implementation to replace it with jsr356 one. \nI would like to use Tomcat implementation as I have a huge confidence to your project. However discussed ability will be crucial for me in the future. \nThanks\n\nMarek', 'Marek Jagielski', '2013-12-04 15:04:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (66, '55842', '1', '1. Usually the buffer size of a JSP page is configured via @page directive.\n\nI suspect that response.setBufferSize() is a wrong API here and configures something else.\n\n\n2. What is the size of the first chunk of that chunked response?', 'Konstantin Kolinko', '2013-12-04 21:02:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (67, '55842', '2', '1. It is reproducable with a simple Servlet as well. In fact, I found this bug using a JSF application where the response was chunked, even though I set the context-param \'javax.faces.FACELETS_BUFFER_SIZE\' to a high value (over 1MB). Myfaces calls response.setBufferSize with the correct value.\n\n2. All chunks are 2,000 bytes (looks like this is some kind of default)\n\nI have created and attached a simple project that you can use to see the problem. Just deploy the Servlet to Tomcat and run the test case. The test case shows the chunks in System.err.', 'Martin Maier-Moessner', '2013-12-05 15:05:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (68, '55842', '3', 'Created  attachment 31095   [details] \nEclipse/Maven project to reproduce this bug\n\n- Deploy the project on a Tomcat\n- Run ChunkTest.testChunk() as Junit Test\n- Look at System.err output', 'Martin Maier-Moessner', '2013-12-05 15:16:34 UTC', 'tomcat_attachment/attachment 31095');
INSERT INTO `tomcatbeforefixcomments` VALUES (69, '55837', '1', '(In reply to oschina.net from  comment #0 )\n> if no file or folder named \'/test\' exist in webroot \n> then path return null\n\nThe container is under no obligation to return anything other than null for getRealPath().  Read the doc for the API:\n\n\'This method returns null if the servlet container cannot translate the virtual path to a real path for any reason (such as when the content is being made available from a .war archive).\'', 'Chuck Caldarale', '2013-12-03 12:45:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (70, '55837', '2', '(In reply to Chuck Caldarale from  comment #1 )\n> (In reply to oschina.net from  comment #0 )\n> > if no file or folder named \'/test\' exist in webroot \n> > then path return null\n> \n> The container is under no obligation to return anything other than null for\n> getRealPath().  Read the doc for the API:\n> \n> \'This method returns null if the servlet container cannot translate the\n> virtual path to a real path for any reason (such as when the content is\n> being made available from a .war archive).\'\n\nbut in same condition，tomcat 7 & 8 return different value (not .war archive)', 'oschina.net', '2013-12-03 14:51:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (71, '55837', '3', 'The short version is that this should return a file (that doesn\'t exist) in this case.\n\nThe long version is that this is just about defined in the Servlet specification but only tenuously.\n\nThe use of virtual path and real path in the Javadoc ServletContext.getRealPath() and HttpServletRequest.getPathTranslated() suggests strongly that they have the same meanings in both cases.\n\nHttpServletRequest.getPathTranslated() states it has the \'Same as the\nvalue of the CGI variable PATH_TRANSLATED\'. A little googling lead me to\nRFC 3875. While that is not a formal standard, it does define \'current\npractice\' which is as good as you are ever going to get for CGI.\n\nSection 4.1.6 of RFC 3875 addresses PATH_TRANSLATED. At the top of page\n15 about half way through section 4.1.6 there is the following text:\n\'The value is derived in this way irrespective of whether it maps to a\n valid repository location.\'\n\nTherefore a real path doesn\'t have to exist.\n\nTherefore getRealPath() doesn\'t can return a file that doesn\'t exist.\n\nFinally, there is nothing I could see in the spec that prevents getRealPath() returning a valid file even if that file does not exist.\n\nGiven I had to dig into this for the Servlet EG I\'m surprised that Tomcat 8 is doing the wrong thing. Probably an oversight on my part. I\'ll take a look.', 'Mark Thomas', '2013-12-04 12:22:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (72, '55804', '1', 'Would it be sufficient for your use case if request.getUserPrincipal() returned null if the GSSCredential had expired?', 'Mark Thomas', '2013-11-21 00:03:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (73, '55804', '2', 'If request.getUserPrinicpal() returns null, then we go on reauthenticate and repopulates a new GSSCrential. However, when we reauthenticate the session also changes. I believe the session changes because changeSessionIdOnAuthentication is true by default, so the we have to reinitialize session(populate some objects just as in case of fresh login onto session) in our application.  Can we have request.getUserPrinicipal null and then when a session already exists not create a new session.', 'Sachin Kumar', '2013-11-23 13:00:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (74, '55804', '3', 'When the session ID is changed on authentication that is exactly what happens. The session object remains the same, just the ID changes. There should be no need to populate the session as it remains populated.\n\nIf you need to update some of your session attributes because the ID has changed, you can use an HttpSessionIdListener.\n\nOn this basis, it looks like having request.getUserPrincipal() return null if the GSSCredential has expired will be sufficient.', 'Mark Thomas', '2013-11-27 17:21:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (75, '55804', '4', 'Sure thanks Mark. Can we have this fix soon?', 'Sachin Kumar', '2013-11-29 04:00:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (76, '55798', '1', 'Using Ubuntu 12.04 and Sun Java (so installed Java and Tomcat by hand) - this was required because another app requires the Sun Java.  Did NOT do this with the default Ubuntu installer. \n\nTomcat is installed in /usr/local/apache-tomcat-7.0.47  Java is the latest from Oracle-Sun.  \n\nThe following is the problem.  \n\n1.  In server.xml the \n\n<Resource name=\'UserDatabase\' auth=\'Container\'\n              type=\'org.apache.catalina.UserDatabase\'\n              description=\'User database that can be updated and saved\'\n              factory=\'org.apache.catalina.users.MemoryUserDatabaseFactory\'\n              pathname=\'conf/tomcat-users.xml\' />\n\n- had to be changed to - \n\n<Resource name=\'UserDatabase\' auth=\'Container\'\n              type=\'org.apache.catalina.UserDatabase\'\n              description=\'User database that can be updated and saved\'\n              factory=\'org.apache.catalina.users.MemoryUserDatabaseFactory\'\n              pathname=\'/usr/local/apache-tomcat-7.0.47/conf/tomcat-users.xml\' />\n\nWhere a softlink was used ( CATALINA_HOME=/usr/local/tomcat ) and tomcat is the softlink to /usr/local/apache-tomcat-7.0.47 - giving this line  \n\n       pathname=\'/usr/local/apache-tomcat-7.0.47/conf/tomcat-users.xml\'\n\n  it also failed. \n\nThe failure is simply a repetition of the request for authentication.  Nothing actually wrong with that part of the process.  I am curious what sort of debugging might enable a check of the login processing itself as enabling debug  down to \'fine\' still left me with no information that the file was not being found. \n\nThis was discovered by trial and educated guesswork. There is no indication in the doc that it should be looked at. \n\nA wide range of useless information is out there on the web now, as a lot of people have this problem in some form.  My tomcat-users.xml  (when it finally worked) looks like this:  \n\n<role rolename=\'manager\'/>\n<role rolename=\'manager-gui\'/>\n<role rolename=\'admin-gui\'/>\n<role rolename=\'admin-script\'/>\n<role rolename=\'manager-script\'/>\n<role rolename=\'manager-xml\'/>\n<role rolename=\'manager-status\'/>\n\n  <role rolename=\'tomcat\'/>\n  <role rolename=\'role1\'/>\n  <user username=\'tomcat\' password=\'tomcat\' roles=\'tomcat\'/>\n  <user username=\'both\' password=\'tomcat\' roles=\'tomcat,role1\'/>\n  <user username=\'role1\' password=\'tomcat\' roles=\'role1\'/>\n  <user username=\'admin\' password=\'tomcat\' roles=\'tomcat,manager,manager-gui,manager-status,manager-xml,manager-script,admin-gui,admin-script\'/>\n\n\nI have no doubt that a lot of that can be pruned away. \n\nThe process in the manual, no matter how carefully followed, does not result in a working login for the manager.  \n\nThere may be something more to this.  I currently have started tomcat as \'root\' which troubles me... but I haven\'t gotten to the security doc yet and there is no discussion I\'ve seen that says that manager won\'t work if you start as \'root\' either. \n\nrespectfully \nBJ', 'BJ Chippindale', '2013-11-19 23:33:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (77, '55798', '2', 'As I expected, using the documented roles only does work properly. \n\n<role rolename=\'manager-gui\'/>\n<role rolename=\'manager-script\'/>\n<role rolename=\'manager-xml\'/>\n<role rolename=\'manager-status\'/>\n\n\n  <role rolename=\'tomcat\'/>\n  <role rolename=\'role1\'/>\n  <user username=\'tomcat\' password=\'tomcat\' roles=\'tomcat\'/>\n  <user username=\'both\' password=\'tomcat\' roles=\'tomcat,role1\'/>\n  <user username=\'role1\' password=\'tomcat\' roles=\'role1\'/>\n  <user username=\'admin\' password=\'tomcat\' roles=\'manager-gui,manager-status\'/>\n\n\n The issue is solely with the ability to access the file in the first instance, with the pathname in server.xml not being correct in some way.  This is almost sure to be linux version, Java version,  user or shell dependent, as it would not have been \'incorrect\' as written.  The fact that it did not follow links surprises and suggests that it has to do with the identity starting tomcat.  If root it may not behave... but as an ordinary user it did not start.  \n\nSome sort of discussion of this (if it is the case) would be a useful hint to someone looking at the document but not able to reach the manager page.  \n\nrespectfully \nBJ', 'BJ Chippindale', '2013-11-19 23:56:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (78, '55798', '3', '(In reply to BJ Chippindale from  comment #1 )\n> \n> 1.  In server.xml the \n> \n> <Resource name=\'UserDatabase\' auth=\'Container\'\n>               type=\'org.apache.catalina.UserDatabase\'\n>               description=\'User database that can be updated and saved\'\n>               factory=\'org.apache.catalina.users.MemoryUserDatabaseFactory\'\n>               pathname=\'conf/tomcat-users.xml\' />\n> \n> - had to be changed to - \n> \n> <Resource name=\'UserDatabase\' auth=\'Container\'\n>               type=\'org.apache.catalina.UserDatabase\'\n>               description=\'User database that can be updated and saved\'\n>               factory=\'org.apache.catalina.users.MemoryUserDatabaseFactory\'\n>              \n> pathname=\'/usr/local/apache-tomcat-7.0.47/conf/tomcat-users.xml\' />\n> \n\nThere is no need for such a change. When the value of the pathname attribute is a relative path, it is interpreted as relative to ${catalina.base}.\n\nThe code is in org.apache.catalina.users.MemoryUserDatabase#open().\n\nI am keeping this issue open, as I think the open() method may be improved to log a message when the file is missing.  It may be a warning if(this.readonly==true) and an info message otherwise.\n\nCurrently it just returns silently.\n\n>\n> A wide range of useless information is out there on the web now,\n\n http://tomcat.apache.org/findhelp.html \n http://tomcat.apache.org/lists.html#tomcat-users \n\n>  If root it may not behave... but as an ordinary user it did not start. \n>\n\nA tip in advance: Do not forget to apply \'chown\' to all log and temporary files that were created when you started Tomcat as root. Those are in $CATALINA_BASE/logs and $CATALINA_BASE/work.\n\nIf those are not accessible, things will go wrong. And if log files are not writable, you will get no logging.\n\nIf you have further questions, ask on the mailing list.', 'Konstantin Kolinko', '2013-11-20 07:19:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (79, '55776', '1', 'Do you know which API call ultimately gets made? E.g. ServletContext.getResource(), etc.?', 'Christopher Schultz', '2013-11-14 18:34:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (80, '55776', '2', '(In reply to Christopher Schultz from  comment #1 )\n> Do you know which API call ultimately gets made? E.g.\n> ServletContext.getResource(), etc.?\n\nI browse the source,  this problem occors at \n\'org.apache.catalina.webresources.AbstractFileResourceSet.file(String name, boolean mustExist)\'', 'LabnizDirac', '2013-11-15 04:44:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (81, '55776', '3', 'Again, which API is being calling and with what parameters? Without that information this bug is likely to be resolved as INVALID.', 'Mark Thomas', '2013-11-15 09:59:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (82, '55776', '4', 'WebClassLoader.getResource cause this problem,This is my example in jsp:\n<% java.net.URL url = this.getClass().getClassLoader().getResource(\'/../classes/app.xml\'); System.out.println(\'url=\'+url);%>\n\nprint: url=null', 'LabnizDirac', '2013-11-15 10:49:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (83, '55776', '5', 'That isn\'t valid since the first /../ sequence is trying to step outside the root of the class loader resources. However /foo/../app.xml also fails and that is valid so I am currently working on a fix.', 'Mark Thomas', '2013-11-15 14:18:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (84, '55776', '6', 'Thanks for the report. I\'ve fixed the /foo/../app.xml case in trunk and it will be included in 8.0.0-RC6 onwards.', 'Mark Thomas', '2013-11-15 15:10:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (85, '55776', '7', '-0\n\nTesting behaviour of classloader of Java 1.7.0_45, such a getResource() call works when resource is in a file system, but returns null if it is in a Jar file. \n\nI think that a name containing \'/../\' or \'/./\' is not a valid resource name and you should not expect it to work. I think it is not class loader\'s job to normalize resource names.\n\n\n http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html#getResource%28java.lang.String%29 ', 'Konstantin Kolinko', '2013-11-15 19:26:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (86, '55776', '8', 'Created  attachment 31047   [details] \nTest.java. Demo for ClassLoader.getResource().', 'Konstantin Kolinko', '2013-11-15 19:38:06 UTC', 'tomcat_attachment/attachment 31047.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (87, '55776', '9', 'Point taken with respect to the standard class loader implementation but you also have to look at how 7.0.x behaved. 7.0.x allowed /../ and /./ sequences. It also allowed stepping outside of /WEB-INF/classes (note it only allowed stepping as far as the context root and this was because it added /WEB-INF/classes to the resource path before doing a standard resources lookup).\n\nI would argue that this fix in 8.0.x is currently a step in the right direction.', 'Mark Thomas', '2013-11-16 07:45:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (88, '55760', '1', 'Hi I am adding an attached fix for complete removal of dependency.', 'Arunav Sanyal', '2013-11-09 10:11:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (89, '55760', '2', 'Created  attachment 31028   [details] \nNew source code', 'Arunav Sanyal', '2013-11-09 12:01:01 UTC', 'tomcat_attachment/attachment 31028.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (90, '55760', '3', 'Proposed patches should be in diff -u format.', 'Mark Thomas', '2013-11-10 20:29:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (91, '55760', '4', 'Hi\n\nI am giving the fix in the diff -u format', 'Arunav Sanyal', '2013-11-11 06:42:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (92, '55760', '5', 'Created  attachment 31030   [details] \nProper format of fix\n\ncommand run:- diff -u SpnegoAuthenticator.java SpnegoAuthenticatorModified.java', 'Arunav Sanyal', '2013-11-11 06:43:11 UTC', 'tomcat_attachment/attachment 31030.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (93, '55735', '1', 'Um... it seems JSP spec doesn\'t clarify the behavior at all...\n\nBut XSLT does. If we \'borrow\' rules from XSLT, then some correct examples could be (text=\'2 &gt; 1\'):\n\ntagx/jspx:  <div title=\'&quot;${text}&quot;\'>ABCD</div>\noutput:     <div title=\'&quot;2 &amp;gt; 1&quot;\'>ABCD</div>\n\ntagx/jspx:  <div>&quot;<c:out value=\'&amp;nbsp;${text}&quot;\' escapeXml=\'false\'></div>\noutput:     <div>&quot;&nbsp;2 &gt; 1\'</div>\n\nBut XSLT doesn\'t allow expressions in template text, thus, what can be the correct result generated by the following example?\n\ntagx/jspx:  <div>&quot;${text}&quot;</div>\n\nShould it be\noutput:     <div>&quot;2 &amp;gt; 1&quot;</div>\nor\noutput:     <div>\'2 &gt; 1\'</div>\nor\noutput:     <div>&quot;2 &gt; 1&quot;</div>\nor\noutput:     <div>\'2 &amp;gt; 1\'</div>\n\n????????', 'azuo.lee', '2013-11-02 10:28:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (94, '55735', '2', 'Conclusion:\n\n1. If you use jspx or tagx, then never use any EL expressions within attribute values, and always use JSTL <out> tag to output expression values within template content -- unless you know the expression value must not contain any\nXML reserved characters;\n\n2. Do not use jspx or tagx at all, use jsp and tag files instead -- whose behaviors are relatively determined.', 'azuo.lee', '2013-11-02 11:05:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (95, '55735', '3', 'Thanks for the report. This was a regression in the fix for  bug55198 .\n\nThis has been fixed in trunk for 8.0.0-RC6 onwards.\n\nThis has been fixed in 7.0.x for 7.0.48 onwards.', 'Mark Thomas', '2013-11-05 22:57:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (96, '55684', '1', 'Stack trace?', 'Christopher Schultz', '2013-10-22 00:38:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (97, '55684', '2', 'Tomcat is designed to work out of the box under a security manager. Calls to this particular code either originate from container code that has the necessary permissions or come via a appropriate PrivilegedAction code block.\n\nIf you change Tomcat\'s default security permissions then that is likely to break something.\n\nWithout a stack trace, this is going to get resolved as invalid.', 'Mark Thomas', '2013-10-28 20:37:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (98, '55684', '3', 'Hello,\n\nI run tomcat and other applications under the same JVM.\nEach application has a thread group and cannot access to thread group of other application.\nThis is enforce by a modified SecurityManager.\n\nI know I can authorize Tomcat to access all thread group (I do it in fact) however I would like to remove this permission.\n\nStacktrace just show my SecurityManager throwing a SecurityException to ThreadGroup.getParent().\nJavadoc of ThreadGroup.getParent() indicates that a SecurityException can be thrown.', 'Gael Lalire', '2013-10-28 23:33:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (99, '55684', '4', 'A clean solution could be to have the possibility to set the root thread group in  WebappClassLoader.\nSo WebappClassLoader.getThread() can avoid to loop inside parent thread group while not null.', 'Gael Lalire', '2013-10-28 23:45:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (100, '55691', '1', 'Please re-try with a Tomcat 6 version that has been released in the last 4 years. 6.0.20 was released in summer 2009. Try again with Tomcat 6.0.37, which has had a bunch of fixes in the meantime. If you can reproduce with 6.0.latest, we can probably fix it.\n\nWhile you\'re at it, please test against Tomcat 7.0.42. There are lots of differences between Tomcat 6 and 7, but much less between Tomcat 7 and 8 (where a fix is more likely to happen faster).', 'Christopher Schultz', '2013-10-23 15:42:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (101, '55691', '2', '(In reply to Christopher Schultz from  comment #1 )\n> Please re-try with a Tomcat 6 version that has been released in the last 4\n> years. 6.0.20 was released in summer 2009. Try again with Tomcat 6.0.37,\n> which has had a bunch of fixes in the meantime. If you can reproduce with\n> 6.0.latest, we can probably fix it.\n> \n> While you\'re at it, please test against Tomcat 7.0.42. There are lots of\n> differences between Tomcat 6 and 7, but much less between Tomcat 7 and 8\n> (where a fix is more likely to happen faster).\n\nSorry should have been more clear.\nIt was tested against 6.0.37\nThe stacktrace is from 6.0.37 not 6.0.20\n6.0.20 was when it was still working\n\nDid a quick test against 7.0.27 and getting same error no primitives support', 'taly', '2013-10-23 20:09:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (102, '55691', '3', 'Did a little more digging apparently this snippet of code was add to javax.el.ArrayELResolver.setValue()\n\nif (value != null &&\n        !base.getClass().getComponentType().isAssignableFrom(\n                value.getClass())) {\n    throw new ClassCastException(message(context,\n            \'objectNotAssignable\',\n            new Object[] {value.getClass().getName(),\n            base.getClass().getComponentType().getName()}));\n}\n\nisAssignableFrom() does not take into account autoboxing so therefore this change is breaking setValue()', 'taly', '2013-10-23 20:34:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (103, '55691', '4', 'Created  attachment 30970   [details] \nProposed patch\n\nCan you run this through your tests?', 'Christopher Schultz', '2013-10-25 14:17:16 UTC', 'tomcat_attachment/attachment 30970.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (104, '55691', '5', 'This patch is against Tomcat 8 (trunk), but will likely apply cleanly to earlier versions.', 'Christopher Schultz', '2013-10-25 14:17:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (105, '55691', '6', 'This has been fixed in 8.0.x and 7.0.x and will be included in 7.0.48 onwards and 8.0.0-RC6 onwards. It has also been proposed for 6.0.x.\n\nNote that the suggested patch was not used. The Util class already contained the necessary version of isAssignableFrom(). This was used instead. I also added a test case to confirm the fix.', 'Mark Thomas', '2013-10-28 21:32:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (106, '55691', '7', 'Reduce severity to something sensible.', 'Mark Thomas', '2013-10-28 21:33:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (107, '55691', '8', '(In reply to Mark Thomas from  comment #6 )\n> Note that the suggested patch was not used. The Util class already contained\n> the necessary version of isAssignableFrom(). This was used instead. I also\n> added a test case to confirm the fix.\n\nAw, I worked really hard on that ;)', 'Christopher Schultz', '2013-10-29 03:59:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (108, '55317', '1', 'I have no objections in principle but obviously I\'d want to see the proposed patch first.\n\nI will say that someone from the Spring project will need to confirm that any proposed patch is a) correct and b) helpful.', 'Mark Thomas', '2013-07-28 07:52:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (109, '55317', '2', 'Why would one need to extend the webapp class loader? A quick look to java.lang.instrument indicates that one should be able to do it with a normal instrumentation agent. Can you clarify?\n\nThe registered ClassFileTransformers will get the classloader passed in in their transform() call so can decide whether it is a webapp classloader and it wants to act on the class.\n\nProbably it would be nice if there were an easy way to associate the webapp with the WebappClassLoader, or at least the WebappLoader could be retrieved from the WebappClassLoader. From there one can get the necessary info about the webapp via the container.', 'Rainer Jung', '2013-07-28 08:15:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (110, '55317', '3', 'Sorry, me again: if we want to support it in an agent free way, it seems it woul suffice to add a addTransformer() (or probably better registerTransformer() and unregisterTranformer()) call to the WebappClassLoader that maintains a list of added tranformers and calls them in findResourceInternal() similar to the original spring code. The original spring code calls all of them in turn until the first one succeeds. Don\'t know whether it would be better to proceed calling in registration order to allow mutliple transformations to occur.\n\nThere\'s no real need to support the proprietry getThrowawayClassLoader() method, which makes most of the lines unnecessary and we\'ll also not need the WeavingTransformer because we can call the registered Transformers directly.\n\nAs far as I can see spring can support the getThrowawayClassLoader() on top of that without subclassing our class loader.\n\nWDYT?', 'Rainer Jung', '2013-07-28 09:25:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (111, '55317', '4', 'First, here\'s the companion Spring Framework enhancement request:  https://jira.springsource.org/browse/SPR-10788 \n\n/I/ don\'t need to extend WebappClassLoader. I plan on simply adding to the existing WebappClassLoader. Spring Framework extends it because that\'s the only way to make it work without changing Tomcat directly. The reason any changes are needed at all is because a standard ClassLoader does not just support instrumentation out-of-the-box. You must instrument a class file /as it is being loaded/, before it is initialized/instantiated.\n\nI like the idea of creating registerTransformer() and unregisterTranformer() instead of addTransformer(), but that is a deviation from the unofficial convention that other containers abide by. If Mark is also okay with registerTransformer() and unregisterTranformer(), I\'ll take that approach.\n\nI\'m not exactly sure what getThrowawayClassLoader() is for, either. I have asked some Spring folks to clarify. It exists consistently across containers and Spring container-support classes, so I assume it must be important. We\'ll see.', 'Nick Williams', '2013-07-28 15:15:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (112, '55317', '5', 'I have reservations around the security consequences of providing anything that has access to the webapp classloader the ability to modify any code defined by that classloader. \n\nCurrently, that has to be specifically enabled by adding an agent to the JVM or by adding special classloader to the container installation and enabling it in a web application\'s Context. This change would automatically enable this for all applications. Further, if an application was enabled for cross-context dispatch it would also be able to register a transformer to modify the code of other applications.\n\nSome sort of check seems needed here - for example, that transformers can only transform classes for their own web application where permission has been explicitly granted (perhaps based on ProtectionDomain). I\'d think the ProtectionDomain should also be passed to any ClassFileTransformer called.', 'Jeremy Boynes', '2013-07-28 17:37:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (113, '55317', '6', 'How does this interact with annotation scanning and ServletContainerInitializers?\n\nFor example, a transformer could add or remove annotations or class dependencies (e.g. adding new interfaces) that related to component scans or types handled by SCIs. Tomcat reads the bytecode directly for this, which would be different to bytecode returned from a transformed class and could result in ambiguous or inconsistent application behaviour.', 'Jeremy Boynes', '2013-07-28 17:47:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (114, '55317', '7', 'Updated summary to indicate this is more about application driven bytecode weaving rather than Instrumentation (in the way the JRE defines instrumentation).', 'Jeremy Boynes', '2013-07-28 17:57:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (115, '55317', '8', 'To address Jeremy\'s concerns/questions:\n\n1) I don\'t see a security issue. JBoss, GlassFish, WebLogic, and WebSphere, for example, all \'automatically enable this for all applications.\' You say, \'Currently, that has to be specifically enabled by adding an agent to the JVM or by adding special classloader to the container installation and enabling it in a web application\'s Context,\' and I say that\'s a bad thing. It makes weaving difficult to configure, and sometimes impossible in hosted environments where the consumer doesn\'t have the ability to jump through these hoops.\n\n2) I took some time to peruse the code on GlassFish, particularly  org.glassfish.web.loader.WebappClassLoader. It performs no special security checks. If someone calls addTransformer, it just lets them add the transformer. That\'s all. It doesn\'t use a ProtectionDomain, and it passes null to the transformer\'s transform method. JBoss also performs no security checks in its code, though it does pass the existing ProtectionDomain to the transformer. It\'s up to the transformer to use or not use the ProtectionDomain, but apparently it\'s allowed to be null.\n\n3) If a user enables cross-context dispatch (off by default), they don\'t do so accidentally (they may do so ignorantly, but that\'s not our concern). Enabling cross-context dispatch already has its own whole set of security concerns, and I consider the possibilities with this minor compared to those other security concerns.\n\n4) I don\'t have any particular objection to some sort of Tomcat setting (maybe in catalina.properties?) that disables/disallows transformation, though I strongly believe it should be enabled by default.\n\n5) \'How does this interact with annotation scanning and ServletContainerInitializers?\' All of this scanning happens /before/ any application code is allowed to execute. As such, it happens before any code is capable of adding transformers. Thus, this won\'t affect such scanning at all. Transformers are only going to want to instrument classes that they use--that won\'t be SCIs. As far as adding/removing annotations, the creator of a transformer to be used in a web application knows better than to attempt to add or remove annotations that might be scanned for by the container. None of the other containers do anything to anticipate/detect/prevent this bad programming practice, which wouldn\'t work but also wouldn\'t hurt anything.\n\nNow, to address what Rainer was saying about getThrowawayClassLoader(). After reading some GlassFish and JBoss source code, I\'ve figured out what it\'s for. Code that adds transformers to a ClassLoader may need to initially load a class to determine whether it requires transformation (for example, Spring looks for classes annotated @Configurable and only adds a transformer for them if it finds a class annotated @Configurable). GlassFish implements this with a copy() method that simply returns a new UrlClassLoader with the same URL and parent class loader as the WebappClassLoader.', 'Nick Williams', '2013-07-28 18:52:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (116, '55317', '9', 'I\'ve received some guidance from the folks over at SpringSource ( https://jira.springsource.org/browse/SPR-10788 ) and I\'d like to get started on a patch for this now. However, I\'ve yet to hear from Mark whether he has a preference for adding a single addTransformer() method as I had originally suggested or adding registerTransformer() and unregisterTranformer() methods as Rainer suggested (or, a third alternative, addTransformer() and removeTransformer()).\n\nMark, what do you think? If you don\'t have a preference, I\'ll probably go Rainer\'s route but with addTransformer() and removeTransformer() as it\'s more flexible but also uses a convention (addTransformer()) that other containers use.\n\nThoughts?', 'Nick Williams', '2013-08-03 16:35:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (117, '55317', '10', '(In reply to Nick Williams from  comment #9 )\n\n> Mark, what do you think?\n\nMy primary concern has already been articulated in  comment #1 .\n\n> If you don\'t have a preference, I\'ll probably go\n> Rainer\'s route but with addTransformer() and removeTransformer() as it\'s\n> more flexible but also uses a convention (addTransformer()) that other\n> containers use.\n\nI have a very small preference for addTransformer() and removeTransformer() but I\'m happy to defer to the preferences of the Spring folks.\n\nMark', 'Mark Thomas', '2013-08-05 14:27:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (118, '55317', '11', 'Okeydokey. addTransformer() and removeTransformer() is my preference and also what\'s easiest on the Spring folks (it will require no code change on their part to work), so that\'s the direction we\'ll go.', 'Nick Williams', '2013-08-05 17:42:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (119, '55317', '12', 'I noticed WebappClassLoader\'s toString() method includes a lot of information about the ClassLoader, such as the parent ClassLoader, context name, delegation setting, and repository. Should I also change toString() to append information about any attached transformers?', 'Nick Williams', '2013-08-05 18:08:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (120, '55317', '13', 'Created  attachment 30678   [details] \nProposal for transformer registration API\n\n(In reply to Nick Williams from  comment #11 )\n> Okeydokey. addTransformer() and removeTransformer() is my preference and\n> also what\'s easiest on the Spring folks (it will require no code change on\n> their part to work), so that\'s the direction we\'ll go.\n\nI\'d suggest adding these in a separate interface for just this functionality so that applications don\'t need to depend on the actual implementation. The Tomcat API package (org.apache.tomcat) might be a good location.', 'Jeremy Boynes', '2013-08-06 06:08:19 UTC', 'tomcat_attachment/attachment 30678.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (121, '55317', '14', 'Created  attachment 30748   [details] \nProposed implementation of this feature\n\nI have attached a patch with the implementation complete. In addition to 10 thorough unit tests, my functional testing with Spring Framework indicates that it works great.\n\nThe only remaining question I have, which may require a slight tweak, is regarding memory leaks. I can\'t figure out whether transformers added to the WebappClassLoader (which will come from application classes) constitute a potential memory leak. It seems to me that the WebappClassLoader instance is cleaned up when the application is shut down, so it shouldn\'t be a problem. But I wanted to get someone\'s opinion on whether the WebappClassLoader should clear out the contents of the \'transformers\' LinkedList when it shuts down. I\'m not convinced it\'s necessary, so I left it out for now.', 'Nick Williams', '2013-08-21 23:15:45 UTC', 'tomcat_attachment/attachment 30748.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (122, '55317', '15', 'Created  attachment 30749   [details] \nProposed implementation of this feature\n\nThere was an error in my previous patch. Please disregard and accept this one instead.', 'Nick Williams', '2013-08-21 23:21:04 UTC', 'tomcat_attachment/attachment 30749.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (123, '55317', '16', '(In reply to Nick Williams from  comment #15 )\n> Created  attachment 30749   [details] \n> Proposed implementation of this feature\n\n1. Why loop over list rather than using contains() in addTransformer() ?\n\n2. Should addTransformer() be looking for multiple instances of the same Transformer or multiple instances of the same class of Transformer?\n\n3. Why not use List.remove(Object) in removeTransformer() ?\n\n4. I\'m concerned that synchronizing on the list of transformers while classes are transformed will become a bottleneck when lots of classes are being loaded and the transformer is relatively slow. A separate ReadWriteLock for the transformer list is probably the way to go but really some testing is required to determine if there is an issue here or not.\n\n5. I\'m not a fan of the org.apache.tomcat.unittest package unless the classes concerned are going to be used by multiple tests across multiple packages.', 'Mark Thomas', '2013-08-29 09:28:17 UTC', 'tomcat_attachment/attachment 30749.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (124, '55317', '17', 'Created  attachment 30825   [details] \nProposed implementation of this feature\n\n(In reply to Mark Thomas from  comment #16 )\n> 1. Why loop over list rather than using contains() in addTransformer() ?\n>  \n> 3. Why not use List.remove(Object) in removeTransformer() ?\n\nThat was my own mistake. I didn\'t read the Javadoc properly. I have corrected this in the attached revised patch.\n\n> 4. I\'m concerned that synchronizing on the list of transformers while classes are transformed will become a bottleneck when lots of classes are being loaded and the transformer is relatively slow. A separate ReadWriteLock for the transformer list is probably the way to go but really some testing is required to determine if there is an issue here or not.\n\nAnother mistake of mine. This could DEFINITELY be a problem if multiple threads are loading classes at the same time. A ReadWriteLock is definitely preferable over synchronization here. I have corrected this in the attached revised patch.\n\n> 5. I\'m not a fan of the org.apache.tomcat.unittest package unless the classes concerned are going to be used by multiple tests across multiple packages.\n\nUnderstood. I have relocated/renamed these two classes in accordance with the discussion on the mailing list. The changes are in the attached revised patch.\n\n> 2. Should addTransformer() be looking for multiple instances of the same Transformer or multiple instances of the same class of Transformer?\n\nNo, this was correct. It could be valid to have multiple instances of the same transformer class, but not multiple copies of the same instance.\n\nAn example use case is an application using JPA with Spring Framework. JPA abstracts away from the java.lang.instrument.ClassFileTransformer by specifying a javax.persistence.spi.ClassTransformer. JPA providers add ClassTransformers to the persistence unit instead of ClassFileTransformers. Applying this directly would require the ClassLoader to support javax.persistence.spi.ClassTransformer, which won\'t work in many cases (such as Tomcat). To get around this, Spring Framework uses a org.springframework.orm.jpa.persistenceunit.ClassFileTransformerAdapter to wrap a ClassTransformer with a ClassFileTransformer. If a provider adds multiple ClassTransformer implementations to the persistence unit, Spring will in turn add multiple ClassFileTransformerAdapter instances to the ClassLoader. All of these instances will do something different, but they will be of the same class as far as WebappClassLoader can tell.', 'Nick Williams', '2013-09-12 19:30:44 UTC', 'tomcat_attachment/attachment 30825.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (125, '55317', '18', '1) CopyOnWriteArrayList would simplify managing added transformers and is intended for this use-case.\n\n2) I would not try to de-dupe the list at all. There\'s no contract around equals() for transformers and this will be different from how JRE\'s Instrumentation manages them.\n\n3) You\'re applying the transformers in findResourceInternal() which, I think, means getResource() will return transformed data. The transform should be moved into findClass() so only defined classes are transformed.\n\n4) In the messages, we typically wrap [] around the substituted values i.e. [{0}]', 'Jeremy Boynes', '2013-09-13 15:11:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (126, '55317', '19', '(In reply to Jeremy Boynes from  comment #18 )\n> 1) CopyOnWriteArrayList would simplify managing added transformers and is\n> intended for this use-case.\n\nHow have I never heard of this class before? Certainly, mutation operations will definitely vastly outnumber traversal operations. Perhaps CopyOnWriteArrayList is the way to go here, instead of any locking. Mark? Thoughts?\n \n> 2) I would not try to de-dupe the list at all. There\'s no contract around\n> equals() for transformers and this will be different from how JRE\'s\n> Instrumentation manages them.\n\nYou\'re correct, there\'s no contract for equals in ClassFileTransformer. By default a \'duplicate\' will be if the transformers are the exact same instance (==). Only if the person who implemented the transformer overrides Object#equals will a different behavior occur. Arguably, if the person overrides Object#equals, they likely did so to specify a different definition of \'duplicate.\' I disagree that we shouldn\'t try to keep duplicates out of the list. I /would/ be open to saying that we should specifically look for duplicate instances (==) and not rely on Object#equals, in which case we need to go back to iterating over the list instead of using List#contains.\n\n> 3) You\'re applying the transformers in findResourceInternal() which, I\n> think, means getResource() will return transformed data. The transform\n> should be moved into findClass() so only defined classes are transformed.\n\n#findResourceInternal definitely feels like the right place for this. Re: \'so only defined classes are transformed,\' how I\'ve written it means only classes are transformed because the transformers are only applied if isClassResource is true. I don\'t see a problem here, but maybe I don\'t understand what you\'re saying.\n\n> 4) In the messages, we typically wrap [] around the substituted values i.e.\n> [{0}]\n\nI would challenge \'typically\'. Looks like about 50% of the time to me. If I\'m being told that only [{0}] is right, I\'ll change it. But there is /plenty/ of code that isn\'t \'correct\' if this is the case. How are contributors to know which to use? They can\'t.', 'Nick Williams', '2013-09-13 15:27:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (127, '55317', '20', '(In reply to Nick Williams from  comment #19 )\n> (In reply to Jeremy Boynes from  comment #18 )\n> > 1) CopyOnWriteArrayList would simplify managing added transformers and is\n> > intended for this use-case.\n> \n> How have I never heard of this class before? Certainly, mutation operations\n> will definitely vastly outnumber traversal operations. Perhaps\n> CopyOnWriteArrayList is the way to go here, instead of any locking. Mark?\n> Thoughts?\n\nAs long as the solution is reasonable and meets the requirements there won\'t be any objection from me. I can\'t speak for any other committer.\n\n> > 4) In the messages, we typically wrap [] around the substituted values i.e.\n> > [{0}]\n> \n> I would challenge \'typically\'. Looks like about 50% of the time to me. If\n> I\'m being told that only [{0}] is right, I\'ll change it. But there is\n> /plenty/ of code that isn\'t \'correct\' if this is the case. How are\n> contributors to know which to use? They can\'t.\n\nAll new code uses [{0}] for clarity on what exactly the value is (makes it easier to spot empty values and unexpected white space). We are fixing older values slowly over time.\n\nMark', 'Mark Thomas', '2013-09-13 17:20:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (128, '55317', '21', 'Created  attachment 30838   [details] \nProposed implementation of this feature\n\nRevised patch again. Switched to using CopyOnWriteArrayList, which should be much faster than synchronization or a ReadWriteLock to protect from concurrency issues. Wrapped [] around substitution values. Fixed mergability issues due to changes to WebappClassLoader in last couple of days.\n\nI think this is very close. Juergen has been at SpringOne all week, but he should be home in the next day or two. Hopefully he can look at this soon now that things are less stressful over there. I\'d like to get all the issues settled on the Tomcat side so that, once Juergen gives it the thumbs up, it can be committed ASAP. I\'d really love to get this in 8.0.RC2 and 7.0.44, if at all possible.', 'Nick Williams', '2013-09-14 02:30:12 UTC', 'tomcat_attachment/attachment 30838.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (129, '55317', '22', 'The patch looks fine to me. Would be great to merge it into Tomcat proper as soon as possible.\n\nFortunately, since we\'re reflectively discovering those methods, we don\'t need to wait for Tomcat binaries to get Spring\'s part done: Based on the conventions in the patch, we\'ll adapt our discovery mechanism for Spring Framework 4.0 RC1, due on Oct 15th. Of course, it would be great if a corresponding Tomcat 8 release wasn\'t far beyond that...\n\nJuergen', 'Juergen Hoeller', '2013-09-26 19:05:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (130, '55317', '23', 'The patch has been applied with a few minor tweaks to fix the various warnings Eclipse threw up. It will be included in 8.0.0-RC4 onwards. I anticipate the next 8.0.0-RCx release around (maybe even before) the Spring 4 RC1 release.', 'Mark Thomas', '2013-09-26 22:57:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (131, '55317', '24', 'Excellent. Thanks! Two things:\n\n1) InstrumentableClassLoader, as committed, says \'@since 8.0, 7.0.44.\' At the time I submitted my most recent patch, 7.0.44 was \'next.\' As you know, due to several recent vote cancellations, 7.0.44 was actually never released. At the very least, it should say \'@since 8.0, 7.0.44.\' Which brings me to point 2...\n\n2) CAN this be included in 7.0.46? I\'d like it to be. It will be some time before 8.0 obtains widespread adoption, and I don\'t see this as a breaking change, so I believe it would be beneficial to include it in 7.0.46. If it can\'t be in 7.0, then InstrumentableClassLoader just needs to be changed to say \'@since 8.0.\'', 'Nick Williams', '2013-09-26 23:15:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (132, '55317', '25', '*** At the very least, it should say \'@since 8.0, 7.0.46.\'', 'Nick Williams', '2013-09-26 23:16:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (133, '55317', '26', 'The feature is backported to 7.0.x for 7.0.64 onwards.', 'Violeta Georgieva', '2015-07-17 08:02:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (134, '55576', '1', 'The Servlet specification does defer to W3C for all HTML matters.\n\nThe text quoted above regarding ordering only applies when application/x-www-form-urlencoded is being used. Strictly, it applies only to the order that the client provides the data. It could be argued that if the client is required to provide the parameters in order in this case then the getParamererXXX() methods should respect that order. Further, if the order needs to be maintained for this one case, it is easier to maintain it for all.\n\nHowever, there is nothing that I can see in either the Servlet or HTML specifications that strcitly requires the Servlet API to present the parameters in the same order as they were received.\n\nThere is no major performance difference (I am aware of) between HashMap and LinkedHahsMap so I am not against making this change but neither (at this point) do I really see the need for it. One concern I do have is that given that there is not a requirement for this, other containers may not implement it and that could cause portability issues.\n\nI am curious as to the use case that supports it. Can you elaborate on why it might be important for the parameters to be returned in the same order as they appear on the form.', 'Mark Thomas', '2013-09-23 13:48:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (135, '55576', '2', '(In reply to Mark Thomas from  comment #1 )\n> I am curious as to the use case that supports it. Can you elaborate on why\n> it might be important for the parameters to be returned in the same order as\n> they appear on the form.\n\nSomewhat related:\n\n http://host/resource?op=add&op=update&op=delete \n\nIf the application expects left-to-right ordering when fetching \'op\' (which IMO is reasonable) then the ordering of the values is quite important.\n\nIt seems like extending the above use case to parameters with different names would be reasonable, though I can\'t really envision a use case where the order of unknown request parameter names would be important.', 'Christopher Schultz', '2013-09-23 15:08:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (136, '55576', '3', 'Thomas, thank you for your rapid evaluation and response on this matter.\n\nThe general use case is the servicing of a request in which the order of parameter evaluation is significant.\n\n http://host/resource?country=CA&postalcode=N7T5R4 \n\nLet\'s assume this is in context of a general infrastructure that evaluates each parameter in the order received (field validation being just one example of potential triggers). postalcode validation is dependent on the value of country.\n\nThe specific scenario I am currently dealing with is porting a web service implementation from ASP/IIS to Java/Tomcat. The Microsoft IRequestDictionary.QueryString implementation respects order of insertion, while Tomcat scrambles the order as a result of the backing HashMap collection. \n\nI respect your position that there is no explicit specification of the server-side evaluation of HTML parameters.  However, I also see no significance to the client-side specification of parameter order beyond the implication that the ordering is also significant to the processing server that consumes it. What other purpose could such an ordering possibly serve?\n\nAssuming equivalent performance, what portability issues could arise from a MORE determinate collection implementation? If anyone is currently relying on the iteration order of the existing HashMap implementation,\na) they are in for a surprise anyhow, and\nb) the ServletRequest interface, unfortunately, provides no guarantees, relying on the generic Map and Enumeration interfaces, both of which defer to the implementation for behaviour in this regard.\n\nThis decision could only be interpreted as an improvement in compliance (with the HTML specification).', 'corythearchitect', '2013-09-23 16:10:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (137, '55576', '4', '(In reply to corythearchitect from  comment #3 )\n> The general use case is the servicing of a request in which the order of\n> parameter evaluation is significant.\n> \n>  http://host/resource?country=CA&postalcode=N7T5R4 \n> \n> Let\'s assume this is in context of a general infrastructure that evaluates\n> each parameter in the order received (field validation being just one\n> example of potential triggers). postalcode validation is dependent on the\n> value of country.\n\nIsn\'t \'postalcode validation is dependens on the value of country\' part of your business logic? If so, you should always be fetching the country first, then the postalcode. Or are you building a system where the order of the parameters in the request dictates the way validation is performed?\n\nIn any case, I am +1 for changing HashMap->LinkedHashMap to preserve parameter ordering.', 'Christopher Schultz', '2013-09-23 16:30:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (138, '55576', '5', '\'Or are you building a system where the order of the parameters in the request dictates the way validation is performed?\'\n\nEssentially, yes.', 'corythearchitect', '2013-09-23 18:18:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (139, '55576', '6', 'In my opinion this requirement and the use case are weak.\n\nIn the best case I\'d try to avoid depending on any ordering in the application.\n\nBut if ordering is really required then I would encode the parameter values and parse them myself and not rely on some container specific feature.\nE.g.: ?ops=op1|op2|op3&something=else, or any other encoding that will work for my use case. With URL encoded value the syntax could be quite rich.\n\nOn the other hand replacing HashMap with LinkedHashMap will not cause performance degradation so I don\'t mind such change.', 'mgrigorov', '2013-09-23 20:17:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (140, '54693', '1', 'Created  attachment 30045   [details] \nFirst attempt at a patch.\n\nAttaching my first attempt at a patch.  This adds a \'validationQueryTimeout\' property, which calls \'setQueryTimeout\' on the validation query\'s statement.  Includes unittest and documentation update.', 'Daniel Mikusa', '2013-03-13 20:11:10 UTC', 'tomcat_attachment/attachment 30045.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (141, '54693', '2', 'Only one comment: since a value of \'0\' disabled query timeout (it will wait forever), why not make the default 0 instead of -1?\n\nAlso, you mention that QueryTimeoutInterceptor will modify the query timeouts of all queries... how does it interact with this patch? Will QueryTimeoutInterceptor set the query timeout and then your code re-sets the query timeout (presumably to a different value)? If that\'s the case, what happens when validationQueryTimeout=0 and you are using the QueryTimeoutInterceptor? A reasonable user might expect that the validation query would /never/ time out, but the QueryTimeoutInterceptor would affect it.', 'Christopher Schultz', '2013-03-15 18:59:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (142, '54693', '3', 'Comments inline below...\n\n>Only one comment: since a value of \'0\' disabled query timeout (it will wait forever), why not make the default 0 instead of -1?\n\nI implemented it the same way as DBCP to try and make it as compatible as possible.  \n\nIn my implementation (same as DBCP), the value must be greater than 0 or the connection pool code won\'t call \'setQueryTimeout\', which means that by default the connection pool won\'t call \'setQueryTimeout\'.  \n\nI like this approach because it won\'t change anything by default.  In other words, the query timeout value would default to what is specified by the JDBC driver or perhaps by a driver specific setting.\n\nI\'m open to other suggestions though.\n\n\n>Also, you mention that QueryTimeoutInterceptor will modify the query timeouts of all queries... how does it interact with this patch?\n\nSorry, I was under the impression based on some comments I read on a previous bug that the QueryTimeoutInterceptor would set the query timeout for a validation query.  I tested this a bit and it turns out to not be true.  In my tests, I saw that the validation query is executed against the underlying Connection, not the ProxyConnection.  Because it runs against the underlying Connection, this means that the interceptors are not executed against it.\n\n\n>Will QueryTimeoutInterceptor set the query timeout and then your code re-sets the query timeout (presumably to a different value)? If that\'s the case, what happens when validationQueryTimeout=0 and you are using the QueryTimeoutInterceptor? A reasonable user might expect that the validation query would /never/ time out, but the QueryTimeoutInterceptor would affect it.\n\nAs I mentioned above, the QueryTimeoutInterceptor and validationQueryTimeout should not affect each other.  Just to be sure, I added a test case to check this.  Attaching new patch with that test case added.\n\nDan', 'Daniel Mikusa', '2013-03-20 19:33:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (143, '54693', '4', 'Created  attachment 30086   [details] \nSecond patch\n\nAdded patch with additional testcase.', 'Daniel Mikusa', '2013-03-20 19:40:42 UTC', 'tomcat_attachment/attachment 30086.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (144, '54693', '5', 'Sorry, found an issue with my second patch.  Getting an NPE with testOnConnect set to true.  Need to revisit and see what is happening.', 'Daniel Mikusa', '2013-03-20 20:55:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (145, '54693', '6', 'Created  attachment 30094   [details] \nThird patch\n\nOk, so there was an issue with my second patch.  When \'testOnConnect\' was enabled, the validation query specified times out and a connection was requested, an NPE would be thrown from \'setupConnection\', where \'con.getHandler()\' is called.\n\n    protected Connection setupConnection(PooledConnection con) throws SQLException {\n        //fetch previously cached interceptor proxy - one per connection\n        JdbcInterceptor handler = con.getHandler();\n        if (handler==null) {\n\nThis was because \'borrowConnection\', at the point below, returns null.\n\n    public Connection getConnection() throws SQLException {\n        //check out a connection\n        PooledConnection con = borrowConnection(-1,null,null);\n        return setupConnection(con);\n    }\n\nIt returned null because of the following conditions...\n\n  - there are no available connections\n  - \'borrowConnection(..)\' tries to create one by calling \'createConnection(..)\'\n  - because \'testOnConnect\' is true, \'createConnection(..)\' will call \'con.validate(..)\' and the validation query will run\n  - because we use a slow query and set a low validation query timeout, the validation query is interrupted\n  - \'con.validate(..)\' returns false\n  - this causes \'createConnection(..)\' to clean up and return null\n  - \'borrowConnection(..)\' returns what was returned by \'createConnection(..)\', which is null\n  - the null then slips through to \'setupConnection(con)\' and causes the NPE.\n\nI fixed this by throwing an SQLException in \'createConnection(..)\' when \'con.validate(..)\' returns false.  This causes \'createConnection(..)\' to clean up and then re-throw the SQLException.  This exception bubbles up to the user\'s code alerting them that the pool cannot create any new connections because the validation query fails.\n\nA very similar situation happens if the validation query is invalid, such as \'SELECT\'.  This fixes both conditions.  Unit tests included in the latest patch.', 'Daniel Mikusa', '2013-03-22 02:02:03 UTC', 'tomcat_attachment/attachment 30094.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (146, '54693', '7', 'Any idea when this will be released ?\n\nThanks\nRob', 'Rob Dunn', '2013-06-25 05:26:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (147, '54693', '8', 'Any idea when this will be released ?\n\nThanks\nRob', 'Rob Dunn', '2013-06-25 06:23:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (148, '54693', '9', '(In reply to Rob Dunn from  comment #8 )\n> Any idea when this will be released ?\n\nNot likely until it\'s fixed.', 'Christopher Schultz', '2013-06-25 12:12:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (149, '55494', '1', 'Here is our configuration (some values are censored):\n\n  <Realm className=\'org.apache.catalina.realm.JNDIRealm\'\n        connectionName=\'cn=xxx\'\n        connectionPassword=\'xxx\'\n	adCompat=\'true\'\n	allRolesMode =\'authOnly\'\n	connectionTimeout=\'3000\'\n        connectionURL=\'ldap://srv1:389\'\n	alternateURL=\'ldap://srv2:389\'\n        userBase=\'ou=xxx\'\n        userSearch=\'(sAMAccountName={0})\'\n	userSubtree=\'true\'\n	roleSubtree=\'true\'\n        roleBase=\'ou=xxx\'\n        roleName=\'cn\'\n        roleSearch=\'(member={0})\'\n     />', 'Thomas Hoffmann', '2013-08-28 12:56:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (150, '55494', '2', 'This bug report only contains statements of fact. It does not identify what the problem is. Arguably, a valid warning is being logged. There is no clear issue that needs addressing.\n\nA bug report needs to include at least one of:\n- what happened that you did not expect to happen\n- what didn\'t happen that you expected to happen', 'Mark Thomas', '2013-08-28 13:05:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (151, '55494', '3', 'Thanks for your comment!\nI assumed that some users failed to logon because of this error.\n\nAccording to the code in JNDIRealm.java, Tomcat will try once more\nafter encoutering the above error.\n\nMaybe it would be an improvement to change the wording, e.g.\n\'failed to authenticate... trying again...\' or something like that.\n\nThank you for your quick reply!', 'Thomas Hoffmann', '2013-08-28 13:29:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (152, '55454', '1', 'I\'m unable to reproduce this with a unit test on Tomcat 7.0.x or 8.0.x nor with a JSP with 7.0.x. I have tried with the example provided and with various combinations of whitespace around the \';\'.\n\nIf you are sure this issue affects that latest stable Tomcat 7 release please re-open this issue and attach the simplest possible JSP that demonstrates the issue on a clean Tomcat 7 install of the latest stable release.', 'Mark Thomas', '2013-08-20 11:22:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (153, '55454', '2', '(In reply to Mark Thomas from  comment #1 )\n> I\'m unable to reproduce this with a unit test on Tomcat 7.0.x or 8.0.x nor\n> with a JSP with 7.0.x. I have tried with the example provided and with\n> various combinations of whitespace around the \';\'.\n> \n> If you are sure this issue affects that latest stable Tomcat 7 release\n> please re-open this issue and attach the simplest possible JSP that\n> demonstrates the issue on a clean Tomcat 7 install of the latest stable\n> release.\n\nMark\nI took the <tomcat7.0.x-trunk>/webapps/examples/jsp/jsp2/jspx/basic.jspx and change it like this <jsp:directive.page contentType=\'text/html;\' />\n\nThen I can reproduce the NPE.\n\norg.apache.tomcat.util.http.parser.HttpParser.parseMediaType(StringReader) \n\nrow -> 211 String attribute = readToken(input);\n\nthe attribute is null and the input is \'text/html;;charset=UTF-8\'', 'Violeta Georgieva', '2013-08-20 13:26:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (154, '55454', '3', 'What about if we do a change like this?\n\n--- org/apache/tomcat/util/http/parser/HttpParser.java	( revision 1515761 )\n+++ org/apache/tomcat/util/http/parser/HttpParser.java	(working copy)\n@@ -210,11 +210,13 @@\n         while (lookForSemiColon == SkipConstantResult.FOUND) {\n             String attribute = readToken(input);\n \n+            String value = \'\';\n             if (skipConstant(input, \'=\') == SkipConstantResult.FOUND) {\n-                String value = readTokenOrQuotedString(input, true);\n+                value = readTokenOrQuotedString(input, true);\n+            }\n+\n+            if (attribute != null) {\n                 parameters.put(attribute.toLowerCase(Locale.ENGLISH), value);\n-            } else {\n-                parameters.put(attribute.toLowerCase(Locale.ENGLISH), \'\');\n             }\n \n             lookForSemiColon = skipConstant(input, \';\');', 'Violeta Georgieva', '2013-08-20 13:54:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (155, '55454', '4', 'Works for me.', 'Mark Thomas', '2013-08-20 14:00:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (156, '55404', '1', 'Same applies for Tomcat 7 and 8.', 'Michael Osipov', '2013-08-12 13:10:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (157, '55404', '2', 'Using a security role that is not defined in the web.xml is indicative of an error (e.g. a typo in a role name) and therefore the warnings are appropriate.', 'Mark Thomas', '2013-08-12 13:36:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (158, '55404', '3', '(In reply to Mark Thomas from  comment #2 )\n> Using a security role that is not defined in the web.xml is indicative of an\n> error (e.g. a typo in a role name) and therefore the warnings are\n> appropriate.\n\nBut not with INFO log level. That\'s the point.', 'Michael Osipov', '2013-08-12 14:03:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (159, '55404', '4', 'Sorry, juggling too many things and read the report too fast.\n\nYes, I agree with the proposed change.', 'Mark Thomas', '2013-08-12 14:18:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (160, '55404', '5', 'This has been fixed in trunk for 8.0.0-RC2 and 7.0.x for 7.0.43.\n\nIt has been proposed for 6.0.x.', 'Mark Thomas', '2013-08-12 14:34:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (161, '55312', '1', 'I played around with the Tomcat embedded server a bit more and found that it actually is relatively easy (if obscure) to switch on SCI:\n\n		ContextConfig contextConfig = new ContextConfig();\n		context.addLifecycleListener(contextConfig);\n\nThe biggest problem is that the classpath scanner only scans certain well-known locations (/WEB-INF/lib/*.jar, /WEB-INF/classes I am guessing) so it doesn\'t pick up anything else by default that happens to be on the classpath but in a different location (e.g. if you launch with java -jar, or from inside an IDE). I think that\'s a bigger problem than the obscure API for setting it up. There are some mentions in comments about /WEB-INF/classes being bound to multiple locations to help Eclipse tooling, so there is some precedence for the required generalization, but again no obvious API for adding bindings.', 'Dave Syer', '2013-07-28 16:18:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (162, '55312', '2', 'I\'m working on a fix for 55287 and as part of that I have separated the SCI discovery from ContextConfig. That would allow an embedder to perform their own scan for SCIs based on just the ServletContext obtained from the Context they are initializing.', 'Jeremy Boynes', '2013-07-28 17:52:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (163, '55312', '3', 'I committed the change to decouple SCI loading in  http://svn.apache.org/r1507870 \n\nThis should allow you to perform SCI detection separately from full ContextConfig. Does that help for your application?', 'Jeremy Boynes', '2013-07-29 00:12:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (164, '55312', '4', 'It helps a bit. But it\'s actually the scan for HandlesTypes references that I need  to modify (populating the initializerClassMap in ContextConfig) - the SCIs are all discovered correctly, but their handlers are not unless they are in /WEB-INF/classes or /WEB-INF/lib/*.jar.', 'Dave Syer', '2013-07-29 08:50:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (165, '55312', '5', '(In reply to Dave Syer from  comment #1 )\n> I played around with the Tomcat embedded server a bit more and found that it\n> actually is relatively easy (if obscure) to switch on SCI:\n> \n> 		ContextConfig contextConfig = new ContextConfig();\n> 		context.addLifecycleListener(contextConfig);\n\nAside:\n\nThis is as expected if you are using addContext() vs addWebapp(). I have updated the Javadocs for the Tomcat class to try an make that clearer. I\'m sure there is scope for further improvement to the docs. Patches welcome.', 'Mark Thomas', '2013-07-29 17:49:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (166, '55312', '6', 'Changing back to a bug as all classes should be scanned unless excluded via JARs to skip.\n\nWe should also check that classes deployed to CATALIBA_[BASE/|HOME]lib are scanned for matches to @HandlesTypes', 'Mark Thomas', '2013-07-30 10:04:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (167, '55267', '1', 'There is no thread dump attached to this issue. The bug will get resolved as INVALID without one.', 'Mark Thomas', '2013-07-15 12:08:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (168, '55267', '2', 'Created  attachment 30595   [details] \ndump', 'Pavel', '2013-07-15 12:51:34 UTC', 'tomcat_attachment/attachment 30595.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (169, '55267', '3', 'Thanks for the thread dump. I\'m going to assume that other information provided elsewhere is unchanged. i.e. the thread is not stuck but configured to use an excessively long timeout of 30 minutes.\n\nI have not been able to recreate this issue - even with a debugger - but I think I have got close enough to figure out what is going on and I believe I have a solution.\n\nI believe the following is happening:\n- Atmosphere is setting a 30 minute timeout for Comet connections\n- That timeout is used to set the socket read/write timeout\n- When the client disconnects Atmosphere closes the comet event\n- That triggers a write to the socket and at this point the timeout is still 30 mins\n- Something about the exact timing and state means that an exception is not thrown\n\nOne could argue several root causes:\n 1 Tomcat should only apply the Comet timeout to reads, not writes\n 2 Atomsphere should reset the timeout once an error occurs\n 3 Tomcat should reset the timeout once an error occurs\n 4 Tomcat should reset the timeout as soon as close is called on the comet event\n\nWe might be able to do something about 1 but 3 and/or 4 look like simpler solutions. Looking at implementing a solution is next on my TODO list.', 'Mark Thomas', '2013-07-22 17:24:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (170, '55267', '4', 'Great - waiting for the fix (I\'m trying to figure out this issue for months, but it\'s indeed very hard to replicate locally.)', 'Pavel', '2013-07-23 08:02:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (171, '55259', '1', 'Created  attachment 30588   [details] \npatch to move instantiation outside the loop', 'Jeremy Boynes', '2013-07-13 04:35:35 UTC', 'tomcat_attachment/attachment 30588.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (172, '55259', '2', 'Jeremy,\n\nAlthough you were originally granted commit karma due to your taglibs work, you have the necessary karma to commit to any part of the Tomcat tree. You clearly know what you are doing so feel free to use it :)\n\nA couple of things to note although I suspect you know all this already anyway:\n- commits should normally be made to trunk and then backported (trunk -> 7.0.x -> 6.0.x) as appropriate\n- trunk and 7.0.x are CTR but 6.0.x is RTC so proposals need to be added to the status file for 6.0.x\n- the trunk changelog entries are currently limited to those changes that won\'t be back-ported\n- the changelogs have a comment at the top that explain the order of entries\n\nHave fun!', 'Mark Thomas', '2013-07-13 09:43:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (173, '55259', '3', 'Fixed in trunk:  http://svn.apache.org/r1502897 ', 'Jeremy Boynes', '2013-07-17 01:45:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (174, '55245', '1', 'Pre-compiling test/webapp with JspC fails because some tests (e.g. for 47331) use invalid JSP syntax which causes JspC to fail.\n\nSuggest a new webapp-jspc for use in testing.', 'Jeremy Boynes', '2013-07-12 03:43:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (175, '55245', '2', 'Created  attachment 30586   [details] \nPatch with basic test case\n\nSimple initial test case that runs JspC against webapp-*', 'Jeremy Boynes', '2013-07-12 04:18:07 UTC', 'tomcat_attachment/attachment 30586.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (176, '55245', '3', 'It is worth noting that this new test case fails and that this is expected as it highlights at least one bug ( bug 55250 ) in the refactored JspC code.\n\nI\'ve added this locally but will refrain from committing it until the tests pass.\n\nAs an aside, what is wrong with the JSPO syntax in the test for 47331?', 'Mark Thomas', '2013-07-12 08:46:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (177, '55238', '1', 'Under load the clearHandler method can be invoked twice, where the first time the handler is cleared leading to NPE on second call.', 'Niki Dokovski', '2013-07-11 08:15:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (178, '55238', '2', 'Created  attachment 30577   [details] \nNPE exception\n\nstacktrace', 'Niki Dokovski', '2013-07-11 08:16:45 UTC', 'tomcat_attachment/attachment 30577.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (179, '55238', '3', 'Created  attachment 30578   [details] \nWsRemoteEndpointImplServer patch', 'Niki Dokovski', '2013-07-11 08:25:51 UTC', 'tomcat_attachment/attachment 30578.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (180, '55228', '1', 'I opened this bug against Tomcat6 since that is what we\'re using, but this bug exists on all Tomcat7, as well, and most likely Tomcat8.  I\'m not sure how to deal with that.\n\n\n\nLooking at tomcat-embed-core-7.0.42.jar:\nAbstractHttp11Processor.prepareResponse\nline: 1458\n\n// Add date header\nheaders.setValue(\'Date\').setString(FastHttpDateFormat.getCurrentDate());\n\n\nYou see that it sets the Date header, not checking if it had been already set by that application.  Should be able to easily wrap it with:\n\nif ( headers.getValue(\'Date\') == null ) {\n  ...\n}', 'fern&#64;alum.mit.edu', '2013-07-10 00:41:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (181, '55228', '2', 'If a bug affects multiple versions open an issue (as you have done) against the earliest supported version you want to see the fix in. Fixes are applied to trunk and then back-ported through each supported version until the bug the issue was reported against is reached. So this will be fixed (assuming the bug is valid and it looks like it is at first glance) in trunk, 7.0.x and 6.0.x.', 'Mark Thomas', '2013-07-10 11:56:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (182, '55228', '3', 'I\'m currently leaning to resolving this as invalid. As an origin server, Tomcat is required by RFc2616 to set the date header (using the current time) on every request.\n\nI\'d be prepared to implement this change given a valid use case but I currently don\'t see a valid, RFC 2616 compliant reason for an application to set the date header.', 'Mark Thomas', '2013-07-10 12:54:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (183, '55228', '4', 'The valid usecase is that we have implemented a Caching Filter (and many people have to).  And per that spec, we\'re supposed to return the Date header of when the original response was cached/generated.  It\'s required so that clients can properly calculate the age of the returned resource.  But Tomcat keeps overwriting the Date header, thus messing up the age calculation.\n\n http://www.w3.org/Protocols/HTTP/Issues/add-age.html ', 'fern&#64;alum.mit.edu', '2013-07-10 22:06:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (184, '55228', '5', 'Fair enough.\n\nThis has been fixed for trunk and 7.0.x and will be included in 7.0.43 onwards.\n\nThe fix has been proposed for 6.0.x.', 'Mark Thomas', '2013-07-11 16:05:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (185, '55231', '1', 'Created  attachment 30574   [details] \nPatch extracted from 53737 that fixes these\n\nExtracted changes to JspConfig from 53737 proposal that fixes these issues.\n\nThe large patch also cleaned up JspConfig to simplify initialization (it does not need to be lazy for JspC), to use Collection instead of Vector to match the spec, to avoid unnecessary copying of the common JspProperty, and to use Java5 foreach.', 'Jeremy Boynes', '2013-07-10 04:36:06 UTC', 'tomcat_attachment/attachment 30574.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (186, '55231', '2', 'Large patches that address multiple issues are hard to review and won\'t get applied. One patch should address one issue.', 'Mark Thomas', '2013-07-10 13:27:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (187, '55231', '3', 'I\'d already spotted one NPE and have fixed another case highlighted by the patch.\n\nI\'ll look at version detection next.', 'Mark Thomas', '2013-07-10 13:32:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (188, '55166', '1', 'Created  attachment 30508   [details] \nPatch including XSDs downloaded from Sun/JCP website, modified to include CDDL election by ASF\n\nModification only adds the text:\n\n  <xsd:annotation>\n    <xsd:documentation>\n      The Apache Software Foundation elects to include this software under the\n      CDDL license.\n    </xsd:documentation>\n  </xsd:annotation>\n\nquoted from web-app_3_1.xsd and added per instructions in original files.', 'Jeremy Boynes', '2013-06-30 20:09:30 UTC', 'tomcat_attachment/attachment 30508.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (189, '55166', '2', 'What is your issue?\n\nThose DTDs do not belong to the Servlet spec, they belong to the JSP one.\nYou\'ll find them in jsp-api.jar\n\nClosing as INVALID', 'Konstantin Kolinko', '2013-06-30 23:27:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (190, '55166', '3', '(In reply to Konstantin Kolinko from  comment #2 )\n\n> You\'ll find them in jsp-api.jar\nI missed that they were there, sorry for that. \n\n> What is your issue?\n \nI ran into a problem trying to use xjc because web-common_3_1.xsd contains\n\n  <xsd:include schemaLocation=\'jsp_2_3.xsd\'/>\n\nand which did not resolve. The same applies to jsp_2_3.xsd when it is in the jsp jar because it in turn contains\n\n  <xsd:include schemaLocation=\'javaee_7.xsd\'/>\n\nwhich is back in the servlet jar.\n\nI updated the issue summary to reflect this.', 'Jeremy Boynes', '2013-07-01 03:47:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (191, '55166', '4', 'Do you still see the issue if both the servlet-api.jar and jsp-api.jar are available on the class path?\n\nI\'d expect the answer to be no since the TCK tests run with validation enabled for the XML parser and there are no issues resolving the various schemas.', 'Mark Thomas', '2013-07-02 09:52:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (192, '55166', '5', 'Created  attachment 30526   [details] \nfull output from test run\n\nI was seeing the problem with xjc running against the resources directory. That may not be a typical manifestation.\n\nHowever, I put together this testcase for validation\n\n    @Test\n    public void testValidation() throws Exception {\n        System.out.println(\'ServletContext = \' + getClass().getResource(\'/javax/servlet/ServletContext.class\'));\n        System.out.println(\'JspFactory = \' + getClass().getResource(\'/javax/servlet/jsp/JspFactory.class\'));\n        SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\n        schemaFactory.setErrorHandler(new ErrorHandler() {\n            @Override\n            public void warning(SAXParseException exception) throws SAXException {\n                exception.printStackTrace();\n            }\n\n            @Override\n            public void error(SAXParseException exception) throws SAXException {\n                exception.printStackTrace();\n            }\n\n            @Override\n            public void fatalError(SAXParseException exception) throws SAXException {\n                exception.printStackTrace();\n            }\n        });\n        URL url = ServletContext.class.getResource(\'/javax/servlet/resources/web-app_3_0.xsd\');\n        System.out.println(\'url = \' + url);\n        Schema schema = schemaFactory.newSchema(url);\n    }\n\nwhich fails with \n\norg.xml.sax.SAXParseException; systemId: jar:file:/Users/jeremy/apache/apache-tomcat-7.0.41/lib/servlet-api.jar!/javax/servlet/resources/web-common_3_0.xsd; lineNumber: 119; columnNumber: 46; schema_reference.4: Failed to read schema document \'jsp_2_2.xsd\', because 1) could not find the document; 2) the document could not be read; 3) the root element of the document is not <xsd:schema>.\n\nCaused by: java.io.FileNotFoundException: JAR entry javax/servlet/resources/jsp_2_2.xsd not found in /Users/jeremy/apache/apache-tomcat-7.0.41/lib/servlet-api.jar\n\nThe full output is attached. As you can see, it is looking for jsp_2_2.xsd in same location as the web-common_3_0.xsd resource that is including it. I ran against the lib directory from a download of 7.0.41.\n\nI don\'t know how the TCK is validating. It may have a custom resolver for its own copies of the XSDs.', 'Jeremy Boynes', '2013-07-03 03:29:45 UTC', 'tomcat_attachment/attachment 30526.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (193, '55166', '6', 'Created  attachment 30527   [details] \nPatch to add testcase to trunk\n\nPatch to add the prior testcase to trunk. It passes if I svn copy the jsp xsds to javax/servlet/resources but I didn\'t do that in the patch in order to keep file history.\n\nIt fails to validate on test/webapp/WEB-INF/web.xml so I also includes changes to make that file conform to the XSD (basically reordering a couple of elements).', 'Jeremy Boynes', '2013-07-03 03:34:27 UTC', 'tomcat_attachment/attachment 30527.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (194, '55166', '7', 'Created  attachment 30528   [details] \nSame as 30527 but with ASF header and link to this issue', 'Jeremy Boynes', '2013-07-03 03:46:49 UTC', 'tomcat_attachment/attachment 30528.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (195, '55166', '8', 'You are doing it wrong.\na) You have to configure a resolver to be able to locate schemas.\n\nTomcat uses org.apache.catalina.util.SchemaResolver as configured by org.apache.catalina.startup.DigesterFactory.\nSee DigesterFactory#registerLocalSchema().\n\nb) You can use SchemaFactory.newSchema(Source[]). I do not know whether it helps in your case (maybe it does not help with includes), but it is a way to pass several schema files to a SchemaFactory.\n\nc) You can bundle and redistribute schema files on your own, without relying on ones used internally by Tomcat.', 'Konstantin Kolinko', '2013-07-05 11:50:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (196, '55166', '9', '(In reply to Konstantin Kolinko from  comment #8 )\n> a) You have to configure a resolver to be able to locate schemas.\n> \n\nI should not need to use a resolver for this case. The base location of the schema file is known in the call to newSchema(url) and all the references from that file (its includes) are relative URIs. You can see that if you provide a LSResourceResolver to the schemaFactory where it gets called with\n  type =  http://www.w3.org/2001/XMLSchema \n  namespaceURI =  http://java.sun.com/xml/ns/javaee \n  publicId = null\n  systemId = jsp_2_2.xsd\n  baseURI = jar:file:/Users/jeremy/apache/apache-tomcat-7.0.41/lib/servlet-api.jar!/javax/servlet/resources/web-common_3_0.xsd\n\nResolving the relative URI of the systemId against the base gives an absolute local URI for the resource being included. This works fine for all the XSDs used by the Servlet specification (for example, the include from web-app to web-common) but fails for the JSPs XSD as it is not in the same relative location as the spec assumes. \n\n> Tomcat uses org.apache.catalina.util.SchemaResolver as configured by\n> org.apache.catalina.startup.DigesterFactory.\n> See DigesterFactory#registerLocalSchema().\n\nIn the Digester code registerLocalSchema(), the local resources are being registered with the filename as the publicId. I don\'t believe that is correct for the XmlSchema resources - the publicIds are there DTD-based resources with a <!DOCTYPE>. For XSD-based documents, xsi:schemaLocation is used to provide the *systemId* for the schema i.e. \' http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd \' and the resolver should be using that to map to the local cached copy. It works because SchemaResolver uses a single lookup table for both publicId and systemId and because (on line 112) it strips the systemId down to just the basename. This stripping down is not actually needed if you see what systemId the EntityResolver is being called with:\n   http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd  \n    (returns jar:file:/Users/jeremy/apache/tomcat/trunk/output/build/lib/servlet-api.jar!/javax/servlet/resources/web-app_3_1.xsd)\n  jar:file:/Users/jeremy/apache/tomcat/trunk/output/build/lib/servlet-api.jar!/javax/servlet/resources/web-common_3_1.xsd\n  jar:file:/Users/jeremy/apache/tomcat/trunk/output/build/lib/servlet-api.jar!/javax/servlet/resources/javaee_7.xsd\n   http://www.w3.org/2001/xml.xsd \n...\n  jar:file:/Users/jeremy/apache/tomcat/trunk/output/build/lib/servlet-api.jar!/javax/servlet/resources/jsp_2_3.xsd\n\nAs you can see, the parser is resolving the <include schemaLocation> as a URI relative to the containing document resulting in a systemId for the \'jsp_2_3.xsd\' relative URI that is in the same place as the containing \'.../web-common_3_1.xsd\' document. SchemaResolver\'s implementation works by stripping that down to \'jsp_2_3.xsd\' and mapping that to the JSP jar. This works but would not be needed if the XSDs were in the same location relative to each other as they are at  http://xmlns.jcp.org/xml/ns/javaee/ \n\nThis could simplify the Digester as its SchemaResolver would only need to be configured with the systemIds that are documented by the specifications (e.g.  http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd ) for use in deployment descriptors, or with other external schemas (e.g.  http://www.w3.org/2001/xml.xsd ). It would not need to be configured with the internal references that are not defined by the specifications (e.g. web-common_3_1.xsd, jsp_2_3.xsd and so on).\n\nI\'ll put together a patch to see how much of a difference it makes.\n\n> \n> b) You can use SchemaFactory.newSchema(Source[]). I do not know whether it\n> helps in your case (maybe it does not help with includes), but it is a way\n> to pass several schema files to a SchemaFactory.\n\nIt does not help with the includes as they are using the relative URI references between schema documents.', 'Jeremy Boynes', '2013-07-05 20:21:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (197, '55166', '10', 'Created  attachment 30556   [details] \nStart to refactor SchemaResolver not to key only on basename\n\nI started on the patch I mentioned above. This changes SchemaResolver to use the full systemId when resolving rather than just matching on the file name. This led to discovery of 55204 which previously worked because an incorrect path was being ignored.\n\nAs part of this I also made SchemaResolver a SAX2 EntityResolver2 so that is it potentially more useful.\n\nThe previous implementation also had a dependency on a Digester in order to set the publicId. This is not normally an EntityResolver\'s responsibility. I removed this call and updated Digester to use the publicId reported by a LexicalHandler, and did the same for the Digester\'s internal EntityResolver implementation. This also allows SchemaResolver to be a singleton.\n\nVerified with test-bio (I\'m assuming these changes are independent of connector).\n\nI\'m attaching this checkpoint as there are a few more changes I would like to make which would be broader reaching. I noticed that the entries in Constants do not reflect the distinction between public and system ids. For example, WebDtdPublicId_23 is a public id for the 2.3 DTD but WebSchemaPublicId_24 is a truncated version of the 2.4 system id. In the spirit of my previous comment I\'m going to propose a patch to clean up that naming, make the constant values the fully qualified URIs (I\'m going to assume for this that the values in o.a.c.startup.Constants are for internal use only and can be changed), and assume that the relative URIs can be made to work by moving the XSDs from jsp to servlet. This will also allow a bit of cleanup in WebXml as setPublicId() would only need to handle DOCTYPE-based versions and setVersion() only the XSD-based versions. Finally, as Digester is already SAX2 aware, I will update it to extend DefaultHandler2 and the corresponding EntityResolver2 and LexicalHandler methods.', 'Jeremy Boynes', '2013-07-07 00:22:07 UTC', 'tomcat_attachment/attachment 30556.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (198, '55166', '11', 'Created  attachment 30567   [details] \nUpdated patch\n\nThis version assumes that the JSP XSDs can be moved to the same location as the Servlet XSDs they have relative references too.\n\nUpdated the resolver to only require the systemIds specified in the spec docs. These are used to resolve the initial schema and from there all relative references are resolved as relative URIs.\n\nMoved the XML identifiers from o.a.c.startup to o.a.tomcat to be part of the API allowing them to be used from Jasper (which already depends on tomcat-api). Moved the resolver to o.a.t.u.res so that it too could be shared (there may be a better package for this but it seemed resource related).\n\nUpdated Digester to extend DefaultHandler2 with its built in implementations of EntityResolver2 and Lexical handler. On WebXml, setPublicId() is now used only for files with a <DOCTYPE> (2.2 and 2.3) whereas setVersion() is used for all files using XmlSchema (2.4 and later) which means it can be simplified a little.\n\nAdded test/webapp-2.2 to confirm 2.2 version was still correctly detected and added it to the other test cases using webapp-*.\n\nThis change is now starting to collide with my patch for 53737 and I\'ll ping the dev list about how that could be combined.', 'Jeremy Boynes', '2013-07-08 01:07:00 UTC', 'tomcat_attachment/attachment 30567.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (199, '55166', '12', 'I\'ve been looking at the first issues raised - namely where the Servlet and JSP schemas are located.\n\nCurrently, the schemas are split between [1] and [2].\n\nThis split creates the a problem that can easily been seen when viewing the schemas in Eclipse. A number of these schemas include entries along the lines of:\n<xsd:include schemaLocation=\'xxx.xsd\'/>\n\nI\'ve had a look at the W3C specs and there is a requirement that these locations are relative so that means the included files all need to be in the same location. With the files split between [1] and [2] there are numerous references that can\'t be resolved.\n\nI see two approaches to solving this:\n\na) Move files from [2] to [1]\nb) Duplicate files between [1] and [2]\n\nOption a)\nPros: Only a single copy of the files will exist\nCons: The taglib files are not required by the Servlet API (the JSP\n      ones are)\n\nOption b)\nPros: servlet-api JAR won\'t contain unnecessary tablib files\nCons: Duplication of a most of the files between the JARs\n\n\nOn balance I think I prefer option a). I\'d rather have 4 files in the servlet-api JAR that are only required when processing JSPs than duplicate nearly all of the files in the jsp-api JAR especially given that the jsp-api.jar depends on the servlet-api.jar anyway.\n\n\nIn Tomcat 7 folks might be using these JARs from there current locations so I intend to fix this using option a) for Tomcat 8 only.\n\nThe issue with the schema resolver belong in a new Bugzilla issue (or possibly issues - I haven\'t looked too hard at whether there is a single issue there or multiple issues).\n\n[1]  http://svn.apache.org/viewvc/tomcat/trunk/java/javax/servlet/resources/ \n[2]  http://svn.apache.org/viewvc/tomcat/trunk/java/javax/servlet/jsp/resources/ ', 'Mark Thomas', '2013-07-08 08:35:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (200, '53777', '1', 'method parseClassNames in JAASRealm sometimes (not always) uses as ContextClassLoader this one\n\nWebappClassLoader\n  context: /manager\n  delegate: false\n  repositories:\n----------> Parent Classloader:\norg.apache.catalina.loader.StandardClassLoader@9fa0f19\n\nIn my case this causes JASSRealm not to find custom Principal classes (userClassNames and roleClassNames)', 'eolivelli', '2012-08-24 14:55:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (201, '53777', '2', 'Created  attachment 29274   [details] \nThis is a subclass of JASSRealm that implements the feature', 'eolivelli', '2012-08-24 15:05:45 UTC', 'tomcat_attachment/attachment 29274.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (202, '53777', '3', 'Created  attachment 29275   [details] \nPatch on JAASRealm (tomcat 7 trunk)\n\nI tried to write a patch against JAASREalm.java (don\'t know if it is the correct format)\n\nPatch is for Tomcat 7 trunk\n\nthis is what is does:\n- adds \'configfile\' property (will be resolved as ClassLoader.getResource().toURI) to require the use of a custom JAAS Configuration file\n- instantiates a \'sun\' ConfigFile (using Reflection) to have a Configuration\n- uses the 4-args constructor of LoginContext (in order to use the custom configuration)\n- sets a work-around for a bug in Realm setup (parseClassNames) because sometimes that method is not called with a good contextclassloader', 'eolivelli', '2012-08-24 15:29:46 UTC', 'tomcat_attachment/attachment 29275.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (203, '53777', '4', '(In reply to  comment #1 )\n> method parseClassNames in JAASRealm sometimes (not always) uses as\n> ContextClassLoader this one\n> \n> WebappClassLoader\n>   context: /manager\n>   delegate: false\n>   repositories:\n> ----------> Parent Classloader:\n> org.apache.catalina.loader.StandardClassLoader@9fa0f19\n> \n> In my case this causes JASSRealm not to find custom Principal classes\n> (userClassNames and roleClassNames)\n\nIf your <Realm> is in conf/context.xml this behaviour is as expected,\nbecause the conf/context.xml file is shared by all web applications, including the Manager one.\n\nIf you observe it is different circumstances, please file a separate bug report and include the stacktrace from the thread that calls parseClassNames.\n(If TCCL is set incorrectly by the calling thread that would be a bug).', 'Konstantin Kolinko', '2012-08-25 14:18:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (204, '53777', '5', 'Sorry,\nI was using TomEE (Tomcat + OpenEJB).\nWith a raw Tomcat the problem does not happen, I reported this problem on OpenEJB list', 'eolivelli', '2012-08-26 06:49:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (205, '53777', '6', 'Created  attachment 29280   [details] \nPatch on JAASRealm (tomcat 7 trunk)\n\nUpdating the patch, without the workaround for TomEE cl bug (that has been resolved too, in openejb trunk)', 'eolivelli', '2012-08-26 15:51:00 UTC', 'tomcat_attachment/attachment 29280.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (206, '55160', '1', 'Thanks for the report.\n\nThis has been fixed in trunk and 7.0.x and will be included in 7.0.42 onwards.', 'Mark Thomas', '2013-07-01 14:29:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (207, '55160', '2', 'This bug has resurfaced.\n\nThe fix  https://github.com/apache/tomcat/commit/dc08904d6f515d90e49f24bf635c955156ce4cb0  was reverted 4 years later by  https://github.com/apache/tomcat/commit/c8ea5646a66d7b31974f9594787961a44019c045 \n\n\nThe read timeout is once again the connectionTimeout and not the connectionUploadTimeout.', 'Garrison Kubis', '2020-10-09 23:10:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (208, '55160', '3', 'Confirmed (with a unit test) that this is currently broken for NIO on 7.0.x. Later versions are not affected.', 'Mark Thomas', '2020-10-15 15:59:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (209, '55017', '1', 'I think the code starting at line 217 should probably be an \'else\' of this if clause:\n\n            if (rmiSSL) {\n                csf = new SslRMIClientSocketFactory();\n                ssf = new SslRMIServerSocketFactory(ciphers, protocols,\n                            clientAuth);\n            }\n\nOtherwise, if rmiSSL and rmiBindAddress are both set, rmiBindAddress will take precedence and a) we\'ll create and discard objects for no reason and b) potentially open a security vulnerability because the user might think they can have both SSL and a specific address.\n\nWe might even want to detect the current incompatibility (I also don\'t see a way to specify an interface when creating an SslRMIServerSocketFactory) and throw an error.\n\nCan you adjust your patch?', 'Christopher Schultz', '2013-05-24 19:28:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (210, '55017', '2', 'Created  attachment 30320   [details] \nPatch to provider bind rmi bind address setup ability (updated)\n\nJust adjusted patch: added else clause + warning if both options are set', 'Alexey Noskov', '2013-05-24 19:48:39 UTC', 'tomcat_attachment/attachment 30320.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (211, '55017', '3', 'I think conflicting settings should actually fail to configure the connector, rather than playing favorites.', 'Christopher Schultz', '2013-05-24 20:19:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (212, '55017', '4', 'Well. But then which exception should be thrown here? Or there is other preferred way to fail configuring the connector?', 'Alexey Noskov', '2013-05-24 20:24:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (213, '55017', '5', 'Hmm... I thought sure that LifecycleListeners could throw checked exceptions, but it seems they can\'t. I\'m still not happy with this not failing-fast.\n\nWhat happens if you throw an IllegalStateException... will Tomcat fail to start? If it doesn\'t, we might have to re-think things.', 'Christopher Schultz', '2013-05-24 21:13:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (214, '55017', '6', 'Created  attachment 30321   [details] \nPatch to provider bind rmi bind address setup ability (updated, 2)\n\nYes, with IllegalStateException Tomcat fails to start.\nUpdated patch with it.', 'Alexey Noskov', '2013-05-24 21:38:32 UTC', 'tomcat_attachment/attachment 30321.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (215, '55017', '7', 'The patch needs to include the associated documentation changes. It would also be nice if it used StringManager for i18n.', 'Mark Thomas', '2013-06-03 19:57:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (216, '55017', '8', '(In reply to Mark Thomas from  comment #7 )\n> The patch needs to include the associated documentation changes. It would\n> also be nice if it used StringManager for i18n.\n\nAlexey, if you\'d care to make those documentation patches and include them, it would be great. If not, someone else will do them but the patch will take longer to accept. Let us know if you need any instructions for how to do that: it\'s not hard, but just in case you needed some encouragement.\n\nLook at other classes in the same package for uses of StringManager: it\'s fairly simple. Basically, anything that is going to end up in a log file, shown to the user, etc. should be localized. Providing an English translation is usually sufficient, though it would be nice to provide Spanish and Japanese if you happen to be multilingual.', 'Christopher Schultz', '2013-06-04 19:46:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (217, '55017', '9', 'Yes, I already found how it\'s used.\n\nI\'ll make documentation and i18n changes in nearest days.', 'Alexey Noskov', '2013-06-04 19:55:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (218, '55017', '10', 'Created  attachment 30398   [details] \nPatch to provider bind rmi bind address setup ability (updated, 3)\n\nJust added i18n and documentation changes.', 'Alexey Noskov', '2013-06-05 15:45:11 UTC', 'tomcat_attachment/attachment 30398.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (219, '55017', '11', 'Are there other areas in which this patch should be improved?', 'Alexey Noskov', '2013-06-16 19:54:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (220, '55017', '12', 'Overall patch looks OK.\n\nOne questions: Why are SSL and rmiBindAddress mutually exclusive?', 'Mark Thomas', '2013-06-20 15:54:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (221, '55017', '13', 'It\'s because I found no way to specify bind address when using SslRMIServerSocketFactory.', 'Alexey Noskov', '2013-06-20 15:59:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (222, '55017', '14', 'I see what you mean. Fair enough.', 'Mark Thomas', '2013-06-20 19:48:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (223, '55102', '1', 'Related post on users list:\n http://markmail.org/thread/vq3n2igy7q5fttc4 ', 'Jeremy Boynes', '2013-06-15 17:10:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (224, '55102', '2', 'Generally the patch looks good to me.\n\nIt is missing documentation. Other than that I see no reason not to add it to trunk and 7.0.x.', 'Mark Thomas', '2013-06-20 21:42:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (225, '55102', '3', 'Created  attachment 30473   [details] \nDocumentation for %F AccessLogValve parameter\n\nAdd documentation in the docs webapp', 'Jeremy Boynes', '2013-06-22 15:54:54 UTC', 'tomcat_attachment/attachment 30473.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (226, '55102', '4', 'Created  attachment 30474   [details] \nDocumentation for %F AccessLogValve parameter\n\nMinor change to add username to bug line from previous patch', 'Jeremy Boynes', '2013-06-22 16:01:53 UTC', 'tomcat_attachment/attachment 30474.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (227, '55102', '5', 'Created  attachment 30475   [details] \nBackport to 7.0.x branch', 'Jeremy Boynes', '2013-06-22 16:05:29 UTC', 'tomcat_attachment/attachment 30475.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (228, '55046', '1', 'Created  attachment 30364   [details] \nCORS Filter\'s request processing flowchart.\n\nPlease include this flowchart image into webapps/docs/images/ folder. I have linked this from CORS documentation section in filter.xml.', 'Mohit Soni', '2013-06-02 00:53:15 UTC', 'tomcat_attachment/attachment 30364.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (229, '55046', '2', 'Comment on  attachment 30363   [details] \nA patch file containing CORS filter source code, units tests, and changes to tomcat documentation\'s filter.xml.\n\nMarked attachment as a patch.', 'Mohit Soni', '2013-06-02 00:54:00 UTC', 'tomcat_attachment/attachment 30363.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (230, '55046', '3', 'I\'ve started to merge the patch into Tomcat trunk (with the assumption it will be back-ported to 7.0.x). So far I have the following comments:\n- ALv2 license headers are missing\n- No i18n (use of StringManager)\n- Trailing whitespace\n- No use of <> (Tomcat 8 is Java 7 minimum)\n- Javadoc warnings\n- Generics warnings\n- Autoboxing warnings\n- In Tomcat unit tests mock objects are named TesterXxx\n- There is already a mock HttpServletRequest that could have been re-used\n- Missing @Override\n\nThe issues are all minor but this is a large patch so there are a fair few of them.\n\nIn addition to expecting a clean build (with Checkstyle enabled) we also provide IDE settings for Eclipse that can help with aligning patches with the coding standards (such as there are) for Tomcat.\n\nI\'ll continue working on this tomorrow.', 'Mark Thomas', '2013-06-03 22:26:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (231, '55046', '4', 'Created  attachment 30384   [details] \nRevised patch to address several comments.\n\nThanks Mark, it\'s great to know that a back-port for 7.0.x is being considered.\n\nI have provided a new patch with:\n+ ALv2 license headers\n+ Removed trailing whitespace (ran ant -Dexecute.validate=true validate, to verify)\n+ Updated test code to use Generics.\n+ Removed Generics warnings\n+ Renamed mock object to follow TesterXxx pattern.\n+ Added missing @Override for interface implementations.\n+ Fixed Autoboxing warnings\n+ Fixed Javadoc warnings\n\nStill pending:\n- No i18n (use of StringManager)\n  Saw couple of examples from other tomcat classes. Should CORSFilter extends from FilterBase to use the StringManager ? \n- There is already a mock HttpServletRequest that could have been re-used.\n  Not sure, which one you are referring to. Found couple of implementations. But, agree that a duplicate shouldn\'t be there. Can you recommend one that can be used ?', 'Mohit Soni', '2013-06-04 05:41:12 UTC', 'tomcat_attachment/attachment 30384.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (232, '55046', '5', 'Thanks for the updated patch but as I has already started work on the previous patch I have continued with that. The feedback was intended for future patches rather than a list of changes required for this patch.\nAdditional notes from this morning\'s work:\n- Use of ServletContext.log() has been removed\n- Visibility, particularly of methods, has been reduced\n- line length in docs\n- s/Ex/Eg/\n\nThe patch has been applied to trunk.\n\nI\'ll wait on back-porting it to 7.0.x to give you a chance to review the applied patch. I\'d like to include this in 7.0.41 which will be tagged in the next day or so the sooner you can review the applied patch the better.', 'Mark Thomas', '2013-06-04 10:53:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (233, '55046', '6', 'Created  attachment 30395   [details] \nUpdated documentation filter.xml.\n\nI have reviewed the last patch, it looks fine to me functionality wise. \n\nI have updated the filter.xml to reflect change in class name from CORSFilter to CorsFilter, and have made other minor changes to documentation.\n\nReally excited to know that it\'s getting included in 7.0.41 as well.', 'Mohit Soni', '2013-06-05 01:54:06 UTC', 'tomcat_attachment/attachment 30395.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (234, '54971', '1', ' http://docs.oracle.com/javaee/6/api/javax/servlet/http/Part.html#write%28java.lang.String%29 ', 'Daniel Koh', '2013-05-15 02:24:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (235, '54971', '2', 'For the problem 2, the default location of MultipartConfig is avax.servlet.context.tempdir as defined by 8.1.5\n@MultipartConfig.', 'Eugene Chung (TmaxSoft)', '2013-05-15 05:19:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (236, '54971', '3', '(In reply to  comment #0 )\n> 1. fileName parameter / relative vs absolute\n\nTomcat is implementing a container specific extension that allows absolute paths to be specified. I thought that there had been some discussion of this previously but I can\'t find anything in the archives.\n\nAny specification compliant input (i.e. a relative path) will work so nothing is broken w.r.t. to the spec here.', 'Mark Thomas', '2013-05-15 11:02:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (237, '54971', '4', '(In reply to  comment #2 )\n> For the problem 2, the default location of MultipartConfig is\n> avax.servlet.context.tempdir as defined by 8.1.5\n> @MultipartConfig.\n\nAgreed. Tomcat applies that default elsewhere but it is missing in this case. Tomcat also handles relative locations by making them relative to javax.servlet.context.tempdir\n\nI\'ll see about getting this fixed.', 'Mark Thomas', '2013-05-15 11:09:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (238, '54947', '1', 'Created  attachment 30272   [details] \nPatch for trunk\n\nHi,\n\nI can reproduce the issue with current trunk and Tomcat 7.0.40.\n\nAttached is a patch against trunk that fixes the issue for me by resolving a logic error in InternalNioInputBuffer (\'end = 0\' was set twice: when starting to read the HTTP version up to  r, and after the  n has been received; which meant \'end\' was set to the position of \' n\' instead of \' r\', causing the version string to be \'HTTP/1.1 r\' instead of \'HTTP/1.1\').', 'Konstantin Preißer', '2013-05-12 21:48:47 UTC', 'tomcat_attachment/attachment 30272.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (239, '54947', '2', 'Restore originally reported version.\n\nBy default, bugs get fixed in trunk and back-ported until the reported version is reached so this needs to be left as the original value else 6.0.x might not get fixed.', 'Mark Thomas', '2013-05-13 16:13:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (240, '54947', '3', 'Ok, sorry for changing the version.', 'Konstantin Preißer', '2013-05-13 16:58:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (241, '54947', '4', 'Thanks for the report, test case and fix.\n\nI added a test to Tomcat\'s unit tests based on the provided test case that confirmed that problem. I also confirmed the proposed patch fixes the issue.\n\nThe patch has been applied to trunk and 7.0.x and will be included in 7.0.41 onwards.\n\nThe patch has been proposed for 6.0.x', 'Mark Thomas', '2013-05-28 11:34:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (242, '54984', '1', 'Can you post a simple test-case as a WAR (including source) to reproduce this?', 'Christopher Schultz', '2013-05-21 20:15:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (243, '54984', '2', 'Created  attachment 30311   [details] \nMultipart demo war', 'Per Holmberg', '2013-05-22 11:36:44 UTC', 'tomcat_attachment/attachment 30311');
INSERT INTO `tomcatbeforefixcomments` VALUES (244, '54984', '3', 'Created  attachment 30312   [details] \nMultipart demo source', 'Per Holmberg', '2013-05-22 11:42:32 UTC', 'tomcat_attachment/attachment 30312.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (245, '54928', '1', 'This is a question for the users list if you want to discuss this further (and possibly the Servlet EG as I don\'t see a clear definition of how an app is expected to handle this in the spec).\n\nI\'m assuming that the I/O operation that triggers the error does not occur on a container thread. If it occurs in a container thread let Tomcat handle it.\n\nLooking at the Tomcat source code, a dispatch to a simple error page should trigger an error when it tries to write to the response which in turn should trigger the onError method of any registered AsyncListener allowing you to do the clean-up.', 'Mark Thomas', '2013-05-04 17:43:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (246, '54928', '2', 'Okay, I see. It looks like one has to dispatch before calling asyncContext.complete(). I opened this ticket because of the exception but I didn\'t realize it was illegal ot call complete() from a non-container thread. Maybe that can be detected and rejected with a message to that extent.', 'Rossen Stoyanchev', '2013-05-04 19:18:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (247, '54928', '3', '(In reply to  comment #2 )\n> Okay, I see. It looks like one has to dispatch before calling\n> asyncContext.complete().\n\nIn this case you need the dispatch to get the request back onto a container thread where the error handling can deal with the error. It is this bit I am not 100% is what is intended by the spec but I can\'t find any clear definitions.\n\n> I opened this ticket because of the exception but I\n> didn\'t realize it was illegal ot call complete() from a non-container\n> thread. Maybe that can be detected and rejected with a message to that\n> extent.\n\nIt is perfectly valid to call complete() from a non-container thread.\n\nAgain, the users list is the place to discuss this.', 'Mark Thomas', '2013-05-04 19:39:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (248, '54928', '4', 'I\'ve been pondering this and having thought about the question you asked on the Servlet spec users list, I have reached the conclusion that allowing complete() makes the most sense here.\n\nI\'m re-opening this to make this change for 7.0.41\n\nThe EG may ultimately come to a different conclusion. We\'ll deal with that if it happens.', 'Mark Thomas', '2013-05-17 10:05:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (249, '54928', '5', 'OK, thanks. For what it\'s worth, from brief experimentation calling complete() in this scenario on Jetty and Glassfish doesn\'t cause any exceptions. Not sure that means it works but if it doesn\'t it could be considered a bug since it completes silently.', 'Rossen Stoyanchev', '2013-05-17 13:41:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (250, '54928', '6', 'I think some other changes might have fixed this. Please can you re-test with the latest trunk.', 'Mark Thomas', '2013-05-23 20:38:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (251, '54928', '7', 'I can confirm the exception no longer appears in the logs. Thanks for fixing this!', 'Rossen Stoyanchev', '2013-05-23 23:30:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (252, '54928', '8', '(In reply to  comment #4 )\n> I\'m re-opening this to make this change for 7.0.41\n\nI backported the test case to Tomcat 7 in  r1634259 . The test case passes successfully.', 'Konstantin Kolinko', '2014-10-25 23:25:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (253, '54703', '1', 'New lines are not permitted in header values.', 'Mark Thomas', '2013-03-15 14:56:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (254, '54703', '2', 'Hi, please check the HTTP/1.1 RFC,  http://www.ietf.org/rfc/rfc2616.txt , section 2.2. Here is a cite from it: \'HTTP/1.1 header field values can be folded onto multiple lines if the continuation line begins with a space or horizontal tab\'.\n\nTherefore, I reopen the bug, as I am also experiencing this issue.', 'g.dimitrov', '2013-04-16 13:42:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (255, '54703', '3', 'When an application calls setHeader (or any of the related methods) is is required to pass in the header value, not the value that will appear on the wire. Any wrapping, escaping etc. is the container\'s responsibility (not the application\'s) and new lines are not permitted.', 'Mark Thomas', '2013-04-16 20:13:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (256, '54703', '4', 'Mark,\n\nWe ran into the same problem while upgrading Geronimo (while running TCK). It would be great if you can reconsider fixing this for the following reasons:\n\n1) This can be considered as a regression. A header value with LWS was accepted fine in Tomcat 7.0.27, for example. This, of course, makes things harded for the users as now they might be forced to change their code to work on the latest version of Tomcat.\n\n2) The Servlet 3.0 spec does not talk about (one way or the other) how the header value should look like when using addHeader()/setHeader() API.\n\n3) The HTTP/1.1 spec in section 2.1 talks about \'implied *LWS\':\n\n      \'The grammar described by this specification is word-based. Except\n      where noted otherwise, linear white space (LWS) can be included\n      between any two adjacent words (token or quoted-string), and\n      between adjacent words and separators, without changing the\n      interpretation of a field.\'\n\nSo that would allow LWS within almost any header value - or at least addHeader()/setHeader() should be able to deal with it.\n\n4) The HTTP/1.1 spec in section 2.2 talks about replacing LWS with a single SP before interpreting values. I think that mostly talks about the folding LWS (on the wire format) but since Tomcat is interpreting the values it maybe should follow the same logic in addHeader()/setHeader() API.', 'Jarek Gawor', '2013-05-06 19:34:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (257, '54703', '5', 'Short version:\nThe arguments present here aren\'t valid but they did cause me to look at this again and there is a case for changing the current behaviour.\n\nLong version:\n1. A regression is when valid behaviour is broken. Using CR or LF in setHeader() is not valid behaviour (see point 2) so this is not a regression. The question here is how tolerant should Tomcat be when an application presents invalid input. Those goalposts may be moved and any changes in behaviour will not get treated as regressions (I usually withdraw an in progress release if we find a regression).\n\n2. If a HTTP header is folded, getHeader() returns the unfolded value. If it did anything else, lots of applications would break. Logically, setHeader() and getHeader() should be symmetric. Therefore, they work with the header value not the \'on the wire\' representation. If this was different, I\'d expect to see it called out in the specification. It isn\'t. As an aside, cookies values are handled the same way to avoid a bunch of security issues. See CVE-2007-3385, CVE-2007-3382 & CVE-2007-5333.\n\n3. The format used on the wire is irrelevant. See point 2.\nNote that proxies are free to unfold headers if they wish. There is no point an application trying to specify that a header should be folded because a proxy can unfold it.\n\n4. The idea here is along the right lines but there is a better way to implement it. The skipping of LWS can be pulled out into a separate function and CR and LF added to the characters that are skipped. Currently they are not handled as for input Tomcat has already unfolded all headers and for output the application shouldn\'t use using them.\n\n\nI took a careful look at the Tomcat code while I was researching this response and I believe there is an argument for taking a different approach. Generally, Tomcat doesn\'t validate what gets passed to setHeader() but it does in a few cases where the header value has an impact on Tomcat\'s processing (Content-Type, Content-Length). Tomcat refers to these as special headers.\n\nIf the value passed to setHeader() for a special header is invalid (e.g. non-numeric content length) then Tomcat simply ignores it and passes it to the client as is on the basis the application really does know what it is doing. It is arguable that Tomcat should not do this (servers should be strict in what they send and tolerant in what they accept) but it does mean that applications are given some leeway to bend the HTTP spec if they need to on the understanding that if they shoot themselves in the foot then any resulting mess is an application responsibility (and with headers there are likely to be security implications). How far application servers should go to stop developers shooting themselves in the foot - particularly from a security perspective - is a matter of debate. Certainly validating all header values and dropping invalid ones should be more secure but it would come at a price both in code complexity (writing parsing code for all the headers in RFC2616 would not be fun) and performance.\n\nGetting back to the original point, it is clear from the current code that the intention is to parse headers where they can be parsed and ignore them otherwise - not to validate them and reject invalid headers. Therefore a CR or LF in a header value should not cause the response to fail.\n\nThe question is whether to just ignore the invalid header (and pass it through to the client as-is) or to do as suggested in point 4 and treat all LWS as a single space. I can\'t see any down side to the latter approach and it has the upside if that there is data there Tomcat needs it can extract it. Therefore I will look at implementing this for the next 7.0.x release. Note that this means that any folded content-type header values passed to setHeader() and friends will be unfolded by Tomcat before it is written to the wire.', 'Mark Thomas', '2013-05-06 20:54:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (258, '54801', '1', 'Created  attachment 30153   [details] \nStacktrace (current 7.0 = 7.0.39)', 'Konstantin Kolinko', '2013-04-04 22:27:18 UTC', 'tomcat_attachment/attachment 30153.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (259, '54801', '2', 'Created  attachment 30167   [details] \n2013-04-10_tc8_54801_1.patch\n\n1. The JSP 2.2 specification chapter JSP.1.11 EL Elements says:\n\n\'EL expressions can appear in template data and in attribute values.\'\n\nI deduce that they cannot appear in scripting elements and thus trying to parse them there is a bug.\n\nScripting elements are represented in Jasper by abstract Node.ScriptingElement class. Its non-abstract derived classes are:  Declaration, Expression, Scriptlet.\n\n\n2. Parsing of EL here is performed in JspDocumentParser#processChars()\n\nI am attaching patch that fixes processing for scripting elements in processChars().\n\n\n3. It is strange that processChars() does EL parsing regardless of pageInfo.isELIgnored(). I suspect that it is a bug.\n\n\nThe code in the patch is the same as in \'if (tagDependentNesting > 0)\' block there, so the two could be merged, and be also used to fix the \'isELIgnored\' case.\n\nThere are no testcases in the patch yet.', 'Konstantin Kolinko', '2013-04-09 22:19:03 UTC', 'tomcat_attachment/attachment 30167.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (260, '54801', '3', 'Created  attachment 30168   [details] \npage1.jspx', 'Konstantin Kolinko', '2013-04-09 22:34:45 UTC', 'tomcat_attachment/attachment 30168.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (261, '54801', '4', 'Created  attachment 30169   [details] \npage2.jspx', 'Konstantin Kolinko', '2013-04-09 22:35:14 UTC', 'tomcat_attachment/attachment 30169.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (262, '54801', '5', '> helloWorld.tagx\n\nThis issue is not specific to tag files and is reproducible with JSP documents as well. I attached \'page1.jspx\' and \'page2.jspx\' that reproduce this.\n\nI am changing TITLE of this issue accordingly.\n\nPresence of \'CDATA\' block is not important.\n\n\n(In reply to  comment #2 )\n>\n> 3. It is strange that processChars() does EL parsing regardless of\n> pageInfo.isELIgnored(). I suspect that it is a bug.\n> \n\nConfirmed as a bug. I filed it separately as  bug 54821 .', 'Konstantin Kolinko', '2013-04-09 22:47:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (263, '54178', '1', 'Created  attachment 29615   [details] \npicture of the wrong stack catched by wireshark.', 'wan_jm', '2012-11-21 08:23:46 UTC', 'tomcat_attachment/attachment 29615.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (264, '54178', '2', 'Filters are perfectly capable of changing the request method. This is an application issue, not a Tomcat issue and the users list is the place to seek help.\n\nAlso, if you are going to obscure an IP address, do it properly.', 'Mark Thomas', '2012-11-21 10:46:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (265, '54178', '3', 'thanks for your comments, but most of the time it works properly, just occasionally, it calls the wrong function.\n\nas you said filter may change this. \nI checked the code of the two filter, \n\none set the characterEncodeing to UTF-8;\n\nanother checcked the cookied whethere there is login information.\n\nno one changed the request method;', 'wan_jm', '2012-11-22 01:46:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (266, '54178', '4', 'Valves can change a method even easily than filters. E.g. during the FORM authentication (it is not your case, but as example).\n\n1. What is in access log?\n2. What is the actual full stacktrace of the error?\n3. I think it would be better to discuss on the users@ list, until some way to reproduce the issue is found. Can you reproduce this issue in a simpler configuration?\n4. What Connector protocol implementation are you using?', 'Konstantin Kolinko', '2012-11-22 09:43:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (267, '54178', '5', 'I catched the stack from log file, and there is no record in localhost_access*.log; \n\nfollowing is the stack;\nMar 18, 2013 2:52:48 PM org.apache.catalina.core.StandardWrapperValve invoke\nSEVERE: Servlet.service() for servlet [org.apache.vysper.xmpp.extension.xep0124.BoshServlet] in context with path [/LiveVideoServer] threw exception\njava.lang.IllegalStateException: Cannot call sendError() after the response has been committed\n        at org.apache.catalina.connector.ResponseFacade.sendError(ResponseFacade.java:451)\n        at org.apache.vysper.xmpp.extension.xep0124.BoshServlet.doGet(BoshServlet.java:143)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n        at com.vtc.livemedia.filter.AutoLoginFilter.doFilter(AutoLoginFilter.java:153)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n        at com.vtc.livemedia.filter.CharactorFilter.doFilter(CharactorFilter.java:48)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:928)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:539)\n        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:300)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n        at java.lang.Thread.run(Thread.java:722)', 'wan_jm', '2013-03-18 07:01:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (268, '54178', '6', 'two things I found strange here!\n1. it is the post request, but come to doGet.\n2. in the doGet function, we didn\'t do commit, but the error shows that response has been commited.  in fact there are only two addHeader bofore it.\n\ncode is paste here.\n\n  /*line 129*/  @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.addDateHeader(\'Date\', System.currentTimeMillis());\n        resp.addHeader(\'Server\', SERVER_IDENTIFICATION);\n        if (FLASH_CROSS_DOMAIN_POLICY_URI.equals(req.getRequestURI())){\n            if(accessControlAllowOrigin != null) {\n                resp.setContentType(XML_CONTENT_TYPE);\n                byte[] flashCrossDomainPolicy = createFlashCrossDomainPolicy();\n                resp.setContentLength(flashCrossDomainPolicy.length);\n                resp.getOutputStream().write(flashCrossDomainPolicy);\n            } else {\n                resp.sendError(HttpServletResponse.SC_NOT_FOUND);\n            }\n        } else {\n      /*line 143*/      resp.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, INFO_GET);\n        }\n        resp.flushBuffer();\n    }', 'wan_jm', '2013-03-18 07:22:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (269, '54178', '7', 'Created  attachment 30063   [details] \ntomcat give 500 error when access a static file.\n\ntomcat give 500 internal errors when browser try to download a static file.\nbut it should give 404 error if the file really not exist;\n\nso I think it has some relationship with another problem I come accross in this thread;\n\nalso:\nthe context is configured in server.xml using follow sentence.\n\n<Context crossContext=\'true\' cachingAllowed=\'false\' docBase=\'/home/tomcat/userdata/LiveVideoServer/streams\' path=\'/LiveVideoServer/streams\' reloadable=\'true\'> </Context>', 'wan_jm', '2013-03-18 07:28:54 UTC', 'tomcat_attachment/attachment 30063.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (270, '54178', '8', 'here is the Connector configure.\n\n\n<Connector executor=\'tomcatThreadPool\' port=\'8080\' protocol=\'HTTP/1.1\'\n               connectionTimeout=\'7200000\'\n               keepAliveTimeout=\'7200000\'\n               maxKeepAliveRequests=\'-1\'\n               acceptCount=\'100\'\n               enableLookups=\'false\'\n               disableUploadTimeout=\'true\'\n               maxHttpHeaderSize=\'8192\'\n               redirectPort=\'8443\' URIEncoding=\'UTF-8\' />', 'wan_jm', '2013-03-18 07:32:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (271, '54178', '9', 'Again, this is an application issue not a Tomcat bug. Use the users list.', 'Mark Thomas', '2013-03-19 09:04:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (272, '54178', '10', 'hi Sir, it is reproducible now. after I debug with tomcat source code and my application. first, I will give my analysis; second I will give the opinion that it is a bug, hope I am right; third my question;\n\nfirst: analysis\n  I found that if there is a run-time exception(exclude IOException) in the implication of onComplete, then this exception will be catched in AbstractProtocol$AbstractConnectionHandler.process() in line AbstractProtocol.java:581, and processor is release in line 598 of the same file. \n\nbut the code assume onComplete successfully returned and released org.apache.catalina.connector.Request in function asyncDispatch; So in this scenario Request is not recycled.\n\nwhen the processor is reused again, the browser request will be the processed by the Request that is not recycled, as there is servlet in it. then the request is handled by the wrong servlet.\n\n\nsecond: reason;\n  you may tell me that it is the bug of the application; but in fact if this happens in tomcat, request to another application in the same tomcat will got error result it the client request meets the processor which contains the Request that is not recycled;\n\n  I think tomcat should make sure that one application deployed in it should not be interrupt by others? do you think so?\n\nthird:\n I want to know why AsyncContextImpl.fireOnComplete catches only IOException instead of Throwable; then maybe the above is fixed;\n\n\nSorry for my interrupt.\n\nthanks;', 'wan_jm', '2013-04-02 09:10:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (273, '54178', '11', 'I\'ve run into this also. Test case attached -- watch for log messages like\n\nWARNING: Value of test-attribute: test-value\n\nwhen you browse to /badlyBehaved. I believe that test attribute should never be anything other than null here.', 'Leigh Anderson', '2013-04-23 08:29:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (274, '54178', '12', 'Created  attachment 30221   [details] \nTest case.\n\nDemonstrates that state from the previous request is available in subsequent requests after exception in an AsyncListener.', 'Leigh Anderson', '2013-04-23 08:30:57 UTC', 'tomcat_attachment/attachment 30221.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (275, '54781', '1', 'Comment on  attachment 30129   [details] \nA proposed fix\n\n>Index: java/org/apache/tomcat/websocket/server/WsServerContainer.java\n>===================================================================\n>--- java/org/apache/tomcat/websocket/server/WsServerContainer.java	( revision 1463173 )\n>+++ java/org/apache/tomcat/websocket/server/WsServerContainer.java	(working copy)\n>@@ -232,6 +232,11 @@\n>         SortedSet<TemplatePathMatch> templateMatches =\n>                 configTemplateMatchMap.get(key);\n> \n>+        if (templateMatches == null) {\n>+            // No match\n>+        	return null;\n>+        }\n>+\n>         // List is in alphabetical order of normalised templates.\n>         // Correct match is the first one that matches.\n>         Map<String,String> pathParams = null;\n>Index: java/org/apache/tomcat/websocket/server/WsFilter.java\n>===================================================================\n>--- java/org/apache/tomcat/websocket/server/WsFilter.java	( revision 1463173 )\n>+++ java/org/apache/tomcat/websocket/server/WsFilter.java	(working copy)\n>@@ -120,7 +120,12 @@\n>         } else {\n>             path = req.getServletPath() + pathInfo;\n>         }\n>+\n>         WsMappingResult mappingResult = sc.findMapping(path);\n>+        if (mappingResult == null) {\n>+            chain.doFilter(request, response);\n>+            return;\n>+        }\n> \n>         ServerEndpointConfig sec = mappingResult.getConfig();\n> \n>Index: build.xml\n>===================================================================\n>--- build.xml	( revision 1463173 )\n>+++ build.xml	(working copy)\n>@@ -1000,8 +1000,9 @@\n>              includeantruntime=\'false\'>\n>     </javac>\n> \n>-    <!-- Add sources for examples -->\n>+    <!-- Add sources for examples\n>     <antcall target=\'examples-sources\' />\n>+     -->\n> \n>     <copy file=\'${tomcat-dbcp.jar}\' todir=\'${tomcat.build}/lib\'\n>       failonerror=\'false\'/>', 'Rossen Stoyanchev', '2013-04-01 19:34:23 UTC', 'tomcat_attachment/attachment 30129.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (276, '54781', '2', 'Created  attachment 30130   [details] \nA proposed fix (updated)\n\nAn updated patch containing only the files for the proposed fix.', 'Rossen Stoyanchev', '2013-04-01 19:35:24 UTC', 'tomcat_attachment/attachment 30130.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (277, '54781', '3', '***  Bug 54806  has been marked as a duplicate of this bug. ***', 'Jean-Francois Arcand', '2013-04-05 15:22:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (278, '54800', '1', 'It might be useful to modify WebappClassLoader#clearReferencesThreads() to call Thread#getStackTrace() on the offending thread to see what it is doing.\n\n\nDo you have a recipe & sample application to reproduce your issue?\n\nTomcat usually sets names to threads (e.g. http-nio-8080-exec-1), so I do not remember such name as \'Thread-4\'.', 'Konstantin Kolinko', '2013-04-08 19:25:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (279, '54800', '2', 'Created  attachment 30218   [details] \nPatch that modifies EchoEndpoint to add a client connection\n\nIt should be as easy as opening a client WebSocket connection. See the attached patch that modifies the echo sample. Once the patch is applied, open the echo HTML page and send a message. That will trigger added code. Then shut down the server and you should see this message:\n\nSEVERE: The web application [/examples] appears to have started a thread named [WebSocket background processing] but has failed to stop it. This is very likely to create a memory leak.', 'Rossen Stoyanchev', '2013-04-20 17:40:34 UTC', 'tomcat_attachment/attachment 30218.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (280, '54800', '3', 'You\'ll also see these threads with the units tests e.g. TestWsRemoteEndpoint\n\nThey are a side-effect of using AsynchronousSocketChannel on the client side.\n\nI\'m looking into what I can do either in the WebSocket implementation or in Tomcat\'s memory leak prevention code to address this.', 'Mark Thomas', '2013-04-23 12:51:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (281, '54724', '1', '1) Agreed.\n\n2) It is called when a close frame is received.\n\n3) WsSession.state was not implemented with 1) in mind. Its main role was making sure the socket was closed at the right point. Some additional states / variables may be required.', 'Mark Thomas', '2013-03-19 14:35:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (282, '54724', '2', 'Want to make sure we agree on approach, which is slightly more detailed than the JavaDoc spec:\n\n1. ALL WsSession methods specified by the Session interface will throw IllegalStateException if the session is closed EXCEPT:\n    - close() is a no-op if the session is already closed and will not throw an exception\n    - close(CloseReason) is a no-op if the session is already closed and will not throw an exception\n    - getId() returns an informational String that may not otherwise be acted upon, but may be useful for logging/troubleshooting/tracking after session close.\n    - isOpen() tests whether the socket is open or not and should never throw an exception, but instead return true or false.\n\n2. ALL public, protected, and private WsSession methods NOT specified in the Session interface will NOT throw an IllegalStateException if the session is closed.', 'Nick Williams', '2013-03-19 15:47:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (283, '54724', '3', 'This may need more clarification at the spec level. Created a spec bug:\n\n http://java.net/jira/browse/WEBSOCKET_SPEC-174 ', 'Nick Williams', '2013-03-19 16:11:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (284, '54724', '4', 'I have a patch that does pretty much exactly that but there are some unit test failures I need to resolve before I commit it.', 'Mark Thomas', '2013-03-19 16:54:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (285, '54724', '5', 'Okay. I won\'t work on a patch then.', 'Nick Williams', '2013-03-19 16:56:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (286, '54702', '1', 'Hi,\n\nDid you observe that in some real situation?\n\nBasically the following is specified for org.xml.sax.InputSource [1]\n\n\'However, standard processing of both byte and character streams is to close them on as part of end-of-parse cleanup, so applications should not attempt to re-use such streams after they have been handed to a parser.\'\n\n\nRegards\nVioleta\n[1]  http://docs.oracle.com/javase/6/docs/api/ ', 'Violeta Georgieva', '2013-03-15 09:27:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (287, '54702', '2', 'Hello\n\nThe following file are opened after a WAR deployment on my computer (I\'ve used the command handle written by the sys internal team).\n\njava.exe pid: 3984 CASTCORP JML\n    C: File  (RW-)   C: java apache-tomcat-7.0.33 bin\n   54: File  (R-D)   C: TEMP hsperfdata_jml 3984\n   5C: Section        Sessions 1 BaseNamedObjects hsperfdata_JML_3984\n   E0: File  (RW-)   C: java jdk1.6.0_35_x64 jre lib rt.jar\n  1E8: File  (RW-)   C: java apache-tomcat-7.0.33 bin bootstrap.jar\n  1EC: File  (RW-)   C: java apache-tomcat-7.0.33 bin commons-daemon.jar\n  1F0: File  (RW-)   C: java apache-tomcat-7.0.33 bin tomcat-juli.jar\n  1F4: File  (RW-)   C: java apache-tomcat-7.0.33 logs catalina.2013-03-15.log\n  1F8: File  (RW-)   C: java apache-tomcat-7.0.33 logs localhost.2013-03-15.log\n  1FC: File  (RW-)   C: java apache-tomcat-7.0.33 logs manager.2013-03-15.log\n  200: File  (RW-)   C: java apache-tomcat-7.0.33 logs host-manager.2013-03-15.log\n  204: File  (RW-)   C: java jdk1.6.0_35_x64 jre lib jsse.jar\n  208: File  (RW-)   C: java jdk1.6.0_35_x64 jre lib ext dnsns.jar\n  20C: File  (RW-)   C: java apache-tomcat-7.0.33 lib annotations-api.jar\n  210: File  (RW-)   C: java apache-tomcat-7.0.33 lib catalina-ant.jar\n  214: File  (RW-)   C: java apache-tomcat-7.0.33 lib catalina-ha.jar\n  218: File  (RW-)   C: java apache-tomcat-7.0.33 lib catalina-tribes.jar\n  21C: File  (RW-)   C: java apache-tomcat-7.0.33 lib catalina.jar\n  220: File  (RW-)   C: java apache-tomcat-7.0.33 lib ecj-3.7.2.jar\n  224: File  (RW-)   C: java apache-tomcat-7.0.33 lib el-api.jar\n  228: File  (RW-)   C: java apache-tomcat-7.0.33 lib jasper-el.jar\n  22C: File  (RW-)   C: java apache-tomcat-7.0.33 lib jasper.jar\n  230: File  (RW-)   C: java apache-tomcat-7.0.33 lib jsp-api.jar\n  234: File  (RW-)   C: java apache-tomcat-7.0.33 lib servlet-api.jar\n  238: File  (RW-)   C: java apache-tomcat-7.0.33 lib tomcat-api.jar\n  23C: File  (RW-)   C: java apache-tomcat-7.0.33 lib tomcat-coyote.jar\n  240: File  (RW-)   C: java apache-tomcat-7.0.33 lib tomcat-dbcp.jar\n  244: File  (RW-)   C: java apache-tomcat-7.0.33 lib tomcat-i18n-es.jar\n  248: File  (RW-)   C: java apache-tomcat-7.0.33 lib tomcat-i18n-fr.jar\n  24C: File  (RW-)   C: java apache-tomcat-7.0.33 lib tomcat-i18n-ja.jar\n  250: File  (RW-)   C: java apache-tomcat-7.0.33 lib tomcat-jdbc.jar\n  254: File  (RW-)   C: java apache-tomcat-7.0.33 lib tomcat-util.jar\n  27C: File  (RW-)   C: java jdk1.6.0_35_x64 jre lib ext localedata.jar\n  288: File  (RW-)   C: java jdk1.6.0_35_x64 jre lib resources.jar\n  304: File  (RW-)   C: java jdk1.6.0_35_x64 jre lib jce.jar\n  308: File  (RW-)   C: java jdk1.6.0_35_x64 jre lib ext sunjce_provider.jar\n  31C: File  (R-D)   C: Windows System32 en-US KernelBase.dll.mui\n  338: File  (RW-)   C: java jdk1.6.0_35_x64 jre lib charsets.jar\n  33C: File  (RW-)   C: java apache-tomcat-7.0.33 logs localhost_access_log.2013-03-15.txt\n  354: File  (RW-)   C: java jdk1.6.0_35_x64 jre lib charsets.jar\n  440: File  (RW-)   C: java apache-tomcat-7.0.33 conf web.xml\n  454: File  (RW-)   C: java apache-tomcat-7.0.33 conf web.xml\n  964: File  (RW-)   C: java apache-tomcat-7.0.33 temp system4547162881526958771.jar\n  990: File  (RW-)   C: java apache-tomcat-7.0.33 temp bootstrap5643731443438317122.jar\n  9A8: File  (RW-)   C: workspaces pmc_Contrex jvmagent jvmagent.jar\n\nSo the sys internal utility observes it in a real situation.\n\nI\'ve discoverer this bug thanks a JVM agent which rewrites FileInputStream and FileOutputStream bytecodes. \nThis one ensures that FileInputStream.close is called after the constructor invocation.', 'Jean-Marie LAMARE', '2013-03-15 10:33:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (288, '54702', '3', 'Is the bugs due to a missing close call there ?\n\n1312	        if (entry != null && entry.getGlobalTimeStamp() == globalTimeStamp &&\n1313	                entry.getHostTimeStamp() == hostTimeStamp) {\n1314	            return entry.getWebXml();\n1315	        }\n...\n1321	            entry = hostWebXmlCache.get(host);\n1322	            if (entry != null && entry.getGlobalTimeStamp() == globalTimeStamp &&\n1323	                    entry.getHostTimeStamp() == hostTimeStamp) {\n1324	                return entry.getWebXml();\n1325	            }\n\nSometimes, the web.xml file is not parsed and the stream is not closed', 'Jean-Marie LAMARE', '2013-03-15 11:47:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (289, '54690', '1', 'Here is a simple class to demonstrate Oracle JDK 7 behavior:\n\nimport java.net.ServerSocket;\nimport java.util.Arrays;\n\nimport javax.net.ssl.SSLContext;\nimport javax.net.ssl.SSLServerSocket;\nimport javax.net.ssl.SSLServerSocketFactory;\n\npublic class SSLProtocolsTest {\n\n    public static void main(String[] args) throws Exception {\n        SSLContext context = SSLContext.getInstance(\'TLS\');\n        context.init(null, null, null);\n        \n        SSLServerSocketFactory sslProxy = context.getServerSocketFactory();\n        ServerSocket ssocket = sslProxy.createServerSocket(443);\n        \n        SSLServerSocket socket = (SSLServerSocket) ssocket;\n        // Prints: [SSLv2Hello, SSLv3, TLSv1, TLSv1.1, TLSv1.2]\n        System.out.println(\' Socket enabled protocols: \' + Arrays.asList(socket.getEnabledProtocols()));\n        \n        socket.setEnabledProtocols(context.getDefaultSSLParameters().getProtocols());\n        // Prints: [SSLv3, TLSv1]\n        System.out.println(\'Default enabled protocols: \' + Arrays.asList(socket.getEnabledProtocols()));\n    }\n\n}', 'Ognjen Blagojevic', '2013-03-13 17:11:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (290, '54690', '2', 'Note hidden in the code comments is the fact that support for SSLv2Hello is also dropped.\n\nNote that the change that triggered this bug was 54406.', 'Mark Thomas', '2013-03-13 23:16:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (291, '54690', '3', 'Some issues at $work have prompted me to look into this further.\n\nFundamentally, this is a JVM bug. I think the way forward is to use\n\nsocket.getEnabledProtocols()\n\nto determine what the default protocols really are rather than using\n \ncontext.getDefaultSSLParameters().getProtocols()\n\nThat should then be JVM neutral. We can also add a test case that will pick up if this ever gets fixed in the JVM.\n\nI\'ll look into patching this tomorrow.', 'Mark Thomas', '2013-03-13 23:37:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (292, '54690', '4', '***  Bug 54619  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2013-03-14 11:59:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (293, '54690', '5', 'Digging into the OpenJDK source code it appears that the JVM behaviour is by design.\n\nThe defaults are different for client and server connections and SSLContext.getDefaultSSLParameters() returns the defaults for client connections not server connections.\n\nWe currently use SSLContext.getDefaultSSLParameters() to get the default ciphers and the default protocols. The protocols are different for clients and servers (this bug) and so are the ciphers (an additional issue no-one has reported). Both these issues need to be fixed.', 'Mark Thomas', '2013-03-14 12:45:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (294, '54602', '1', 'I do see code that is meant to recycle the converter. Do you have a test case / can you write a Tomcat unit test that demonstrates that the converter isn\'t being recycled?\n\nIncomplete byte sequences should result in a 400 response. I\'ll take a look at why this isn\'t happening.', 'Mark Thomas', '2013-02-28 01:17:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (295, '54602', '2', 'Part of the problem here is that the UTF-8 decoder should reject bytes 5-8 as an invalid sequence but doesn\'t. That is a JVM bug that needs to be reported to Oracle.\n\nGiven the widespread use of UTF-8 I suspect we\'ll need to look at using the stricter UTF-8 decoder we use in WebSocket more widely.\n\nA second issue (that doesn\'t affect this report) is that the leftover byte array is not big enough for the decoders available in the JRE.', 'Mark Thomas', '2013-02-28 17:17:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (296, '54602', '3', 'InputStreamReader defaults to replacement characters so it won\'t reject those characters just replace them with the replacement.\n\nThe underlying InputStreamReader holds on to those remaining bytes because it is waiting for the last byte or end of stream but because B2CCoverter doesn\'t try to read any more it never sees the the end of stream.\n\nIf B2CConver was changed to just read until ReadConvertor returned -1 then the bytes wouldn\'t be left behind and the those last 4 bytes would be replaced with the replacement character.\n\nIf you want invalid UTF-8 to be rejected you would have to update the constructor of ReadConvertor to call super which takes a CharsetDecoder which uses CodingErrorAction.REPORT, but that is a much bigger change.\n\nI\'ll work on the test at some point, but I don\'t have the time currently to get that working.', 'Nate Clark', '2013-02-28 17:40:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (297, '54602', '4', 'The original report was about URI processing. Now you are talking about request bodies.\n\nThere are multiple issues here. So far I have found / suspect:\na) Invalid sequences are not rejected quickly enough\nb) Partial sequences are not rejected\nc) There is no mechanism for a client of the API to indicate input is complete\nd) The storage for bytes left over between calls is not bug enough for all charsets\ne) Leftover bytes may remain between requests\n\na) is a JVM bug that we can work-around\nb) is a consequence of c)\nc) is now fixed in trunk but the callers of the API need to be reviewed\nd) is fixed in trunk\ne) needs further investigation\n\nAlso, the handling of incomplete/partial data may need to be different for URIs and request bodies. There is an argument for request bodies to be more tolerant.', 'Mark Thomas', '2013-02-28 23:36:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (298, '54602', '5', 'Where do you think I started talking about request bodies?\n\norg.apache.catalina.connector.Request uses a B2CConverter for URIDecoding the variable is called URIConverter. B2CConverter uses ReadConverter, which is a very thin wrapper around InputStreamReader, to do its conversions.InputStreamReader when constructed with just a Charset, like ReadConverter does, calls StreamDecoder.forInputStreamReader() to construct a StreamDecoder. StreamDecoder when not constructed with a CharsetDecoder uses CodingErrorAction.REPLACE for both malformed input and unmappable characters.', 'Nate Clark', '2013-03-01 00:37:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (299, '54602', '6', 'Yes, this is confusing to you probably. Your problem with URI processing and trunk was that I forgot to port a call to recycle, which likely caused a problem there [and you can ignore the rest, it doesn\'t concern you]. As for non trunk, the code is really a bit hopeless IMO.\n\nMark doesn\'t know the new bit of code in trunk, so that\'s what he\'s looking into, and he\'s apparently busy trying to convince himself it needs tons of improvements. Actually, only d) looks real (and nobody complained so far about it, not enough creative encoding use I guess). I found trying to deal with end of input, for example, does not add any value. That\'s why there\'s a isUnderflow flag, it will do the same thing in a more generic way.', 'Remy Maucherat', '2013-03-01 09:54:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (300, '54602', '7', '(In reply to  comment #5 )\n> Where do you think I started talking about request bodies?\n\nSorry about the confusion. You were looking at 7.0.x and I was looking at trunk. When you mentioned an InputStream I started thinking request body as trunk doesn\'t use a Writer to do the conversion.\n\nTo Remy\'s point, I think there are a handful of bugs, inconsistences and potential improvements in both trunk and 7.0.x and there are likely to be differences between the two branches. Exactly what is a bug and what is an improvement is somewhat academic as I intend to address all of them.\n\nMy plan is to write some more test cases for trunk, get them to pass in trunk, back-port the tests to 7.0.x and then get the tests passing in 7.0.x.', 'Mark Thomas', '2013-03-01 16:37:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (301, '54602', '8', 'Thanks again for this bug report. It promoted me to take a much closer look at UTF-8 decoding and I found a number of edge cases in both URI processing and request body processing.\n\ntrunk is now using the Apache Harmony based UTF-8 decoder for all UTF-8 bytes to chars conversion including URIs and request bodies. The test cases have also been expanded considerably.\n\nThe next step is to copy the test cases to 7.0.x and then review. I suspect the fix will involve porting Remy\'s new B2CConverter to 7.0.x.', 'Mark Thomas', '2013-03-05 10:23:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (302, '54552', '1', 'Comment on  attachment 29940   [details] \nPatch to apply changes\n\nFix MIME type', 'Mark Thomas', '2013-02-12 13:58:10 UTC', 'tomcat_attachment/attachment 29940.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (303, '54552', '2', 'We don\'t want trailing white space. Could you please remove it?\n\nYou can check for style violations by setting\n\nexecute.validate=true\n\nin build.properties before running \'ant\'. It will then run checkstyle before compiling and report andy style violations.', 'Rainer Jung', '2013-02-12 14:16:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (304, '54552', '3', 'The patch doesn\'t compile. At least\n\njavax.servlet.http.HttpSessionIdListener\n\nis missing.', 'Rainer Jung', '2013-02-12 14:18:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (305, '54552', '4', 'I added execute.validate=true to the build.properties file, and it downloaded validate and then validated. However, the build succeeded and I see nothing about any violations reported. The \'validate:\' section of the build is empty. Could you tell me where the trailing white space is? I went through the diff file and didn\'t find any trailing white space on any lines. I\'m always very careful about that...\n\nAlso, I forgot to \'svn add\' the HttpSessionIdListener before \'svn diff.\' My bad. It should compile now. I\'ll attach the new diff.', 'Nick Williams', '2013-02-12 14:44:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (306, '54552', '5', 'Created  attachment 29941   [details] \nRevised diff', 'Nick Williams', '2013-02-12 14:44:31 UTC', 'tomcat_attachment/attachment 29941.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (307, '54552', '6', 'Are you using Apache Ant 1.8.x? (1.8.4 recommended)', 'Konstantin Kolinko', '2013-02-12 15:01:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (308, '54552', '7', 'Yes. I am using Ant 1.8.4.', 'Nick Williams', '2013-02-12 15:04:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (309, '54552', '8', 'Trailing whitespace example:\n\n+++ C:/Tomcat-Build/Source/java/javax/servlet/http/HttpServletRequest.java      (working copy)\n@@ -381,6 +381,15 @@\n      * @see #getSession(boolean)\n      */\n     public HttpSession getSession();\n+\n  ^^^HERE\n+    /**\n\nand several more.\n\nExample validate output:\n\nBuildfile: /shared/build/dev/tomcat/read-write/trunk-clean/build.xml\n\nbuild-prepare:\n   [delete] Deleting directory /shared/build/dev/tomcat/read-write/trunk-clean/output/build/temp\n    [mkdir] Created dir: /shared/build/dev/tomcat/read-write/trunk-clean/output/build/temp\n\ncompile-prepare:\n\ndownload-validate:\n\nproxyflags:\n\nsetproxy:\n\ntestexist:\n     [echo] Testing  for /shared/build/dev/tomcat/deps/tomcat8-deps/checkstyle-5.6/checkstyle-5.6-all.jar\n\ndownloadzip:\n\nvalidate:\n[checkstyle] Running Checkstyle 5.6 on 2503 files\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/javax/servlet/http/HttpServletRequest.java:384: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/javax/servlet/http/HttpServletRequest.java:387: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/javax/servlet/http/HttpServletRequestWrapper.java:240: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/javax/servlet/http/HttpSessionIdListener.java:1: Line does not match expected header line of \'^(rem)? W*Licensed to the Apache Software Foundation  (ASF ) under one or more$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/connector/Request.java:2364: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/connector/Request.java:2367: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/connector/Request.java:2374: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/connector/Request.java:2380: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/connector/Request.java:2382: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/connector/Request.java:2386: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/connector/RequestFacade.java:912: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/connector/RequestFacade.java:915: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/connector/RequestFacade.java:920: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/core/ApplicationContext.java:54: Wrong order for \'javax.servlet.http.HttpSessionIdListener\' import.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/core/StandardContext.java:69: Wrong order for \'javax.servlet.http.HttpSessionIdListener\' import.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/ha/session/DeltaManager.java:1477: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/ha/session/DeltaManager.java:1482: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/ha/session/DeltaManager.java:1486: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/ha/session/DeltaManager.java:1487: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/session/ManagerBase.java:768: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/session/ManagerBase.java:773: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/session/ManagerBase.java:777: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/session/ManagerBase.java:778: Line matches the illegal pattern \' s+$\'.\n[checkstyle] /shared/build/dev/tomcat/read-write/trunk-clean/java/org/apache/catalina/websocket/WsHttpServletRequestWrapper.java:363: Line matches the illegal pattern \' s+$\'.\n\nBUILD FAILED', 'Rainer Jung', '2013-02-12 15:34:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (310, '54552', '9', 'Overall the patch looks pretty good.\n\nOne minor nit is the white space issues already mentioned.\n\nThe one area where I think some changes are required is listener notification for clusters. If you look at how session destroyed events are handled, the listeners fire on the non-primary nodes based on the value of notifySessionListenersOnReplication. I think the same attribute should be used to determine if the session ID change listeners are fired on the non-primary nodes.', 'Mark Thomas', '2013-02-12 15:36:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (311, '54552', '10', 'Created  attachment 29943   [details] \nRevised diff with extra whitespace removed and notifySessionListenersOnReplication considered\n\nI hadn\'t noticed notifySessionListenersOnReplication. I have revised the DeltaManager to take that into consideration before notifying HttpSessionIdListeners.\n\nI see what my problem was with validation, now. My execute.validate=true was being overridden by an execute.validate=false later in the file. Should have looked for that. I\'m kind of surprised that y\'all don\'t allow blank lines between code groups to contain tab-spaces to be in line with the rest of the code. It seems such a trivial thing. Your website says \'Apache Tomcat has very loosely defined coding conventions\' (and doesn\'t mention anything about blank lines/whites paces), but I would not call that \'loose\' :-P. But, whatever the rules, my diff complies now, as requested.\n\nBy the way, webapps docs jasper-howto.xml that was just checked in failed the validate test. After fixing all of my code I had to disable validation to get it to completely compile. :-)\n\nI\'ve attached the updated diff with the extra whitespace removed and notifySessionListenersOnReplication taken into consideration.', 'Nick Williams', '2013-02-12 16:52:29 UTC', 'tomcat_attachment/attachment 29943.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (312, '54536', '1', 'The correct revision is 1362000', 'Yannis Thanasoulas', '2013-02-07 12:38:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (313, '54536', '2', 'What status code are you sending and why?', 'Mark Thomas', '2013-02-07 13:19:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (314, '54536', '3', 'I am using custom code \'901\' in order to detect and handle session timeouts in AJAX requests.', 'Yannis Thanasoulas', '2013-02-07 15:09:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (315, '54536', '4', 'Why not 408?', 'Michael Osipov', '2013-02-10 20:32:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (316, '54536', '5', 'My reading of RFC2616 is that custom status codes are not permitted.\n\nIf you set a custom status code that will still be sent to the client - just with a default error page.\n\nI\'m currently on the fence whether to fix this or close it as invalid.\n\nWhy do you need the custom error page to be sent to the client? Why isn\'t the 901 status code and the default error page enough?', 'Mark Thomas', '2013-02-12 11:31:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (317, '54536', '6', '(In reply to  comment #0 )\n>\n> The correct revision is r1362000\n>\n> The change of the             \n>    report = sm.getString(\'http.\' + statusCode, message);\n> to\n>    report = sm.getString(\'http.\' + statusCode);\n> \n> results in \'report==null\' for custom status codes\n\nRegarding the change in  r1362000 \n\nThe 2nd argument to sm.getString(..) is not a default value, but an argument used for \'{0}\' in a MessageFormat.\n\nBUT, there is small difference in the values returned by\n(a) sm.getString(key) and\n(b) sm.getString(key, args)\nwhen the resource is not found.\n\n(a) returns null, (b) returns MessageFormat.format(key, args) which is \'key\'\n\nThis caused a change in behaviour that this code block is now called:\n\n> \n>         if (report == null) {\n>             return;\n>         }\n\nThus instead of rendering the \'default\' error page, a blank page is rendered.\n\n\nBTW, I suspect that you can fix your issue by defining a custom error page in your web.xml, instead of relying on the default one.', 'Konstantin Kolinko', '2013-02-12 13:42:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (318, '54536', '7', '\nStatus code 408 - Request Timeout, as it is described in RFC 2616 occurs when \'The client did not produce a request within the time that the server was prepared to wait. The client MAY repeat the request without modifications at any later time.\'. My understanding of status code 408 is that  when a client(browser) sends a request and while the request is being processed by the server the connection timeouts, which is not the same case. \n\nThe actual problem is that i expect the response body (default error page) to contain a message field with the url in which the user should be redirected (ex login page), because otherwise without this functionality the response body of the request, the session of which has been timed out, returns the login page with status 200, this cannot be handled effectively in the context of an AJAX request (at least with my current implementation). So, i return an error which can be caught in JS level and using the message (<b>message</b> <u>redirectUrl:/test/login?login_error=3</u>) redirects them to the desired page.\n\nAs for RFC2616, in section 6.1.1,  i found the following part which mentions that:\n\n\' HTTP status codes are extensible. HTTP applications are not required\n   to understand the meaning of all registered status codes, though such\n   understanding is obviously desirable.\'\n   \nbut it isn\'t my intention to argue over this, i just found this inconsistency between the releases and i mention it.', 'Yannis Thanasoulas', '2013-02-12 16:37:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (319, '54536', '8', 'Thanks for the explanation.\n\nI read a different part of RFC2616 that indicated to me that custom status codes were outside the spec. I see the part you referenced and agree with your interpretation.\n\nGiven the above I think Tomcat should not return a blank page if you use a custom status code. I\'ll look at getting this patched for the next release.', 'Mark Thomas', '2013-02-12 19:52:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (320, '54239', '1', 'Created  attachment 29685   [details] \nELInterpreterFactory', 'Sheldon Shao', '2012-12-04 06:56:48 UTC', 'tomcat_attachment/attachment 29685.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (321, '54239', '2', 'Created  attachment 29686   [details] \nPatch for Generator.java', 'Sheldon Shao', '2012-12-04 06:57:26 UTC', 'tomcat_attachment/attachment 29686.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (322, '54239', '3', 'Comment on  attachment 29685   [details] \nELInterpreterFactory\n\nIn principle this looks like a good idea.\n\nI have a couple of concerns with the patch as currently written:\n1. No documentation.\n2. No test cases.\n3. The use of enum for the default instance is rather odd.\n4. I dislike the use of system properties when they are not necessary. If the class name was handled as a servlet context initialization parameters then Tomcat already has the necessary plumbing for global, per host and per web application configuration.\n5. Error messages need to use the standard i18n support.', 'Mark Thomas', '2012-12-04 08:37:15 UTC', 'tomcat_attachment/attachment 29685.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (323, '54239', '4', 'Thanks Mark.\n\nI\'ll provide document & test cases for  BUG 54239 -54242.', 'Sheldon Shao', '2012-12-04 13:46:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (324, '54239', '5', 'Created  attachment 29693   [details] \nInterface of ELInterpreter\n\nAdd more comments', 'Sheldon Shao', '2012-12-05 09:37:12 UTC', 'tomcat_attachment/attachment 29693.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (325, '54239', '6', 'Created  attachment 29694   [details] \nELInterpreterFactory\n\nAdded more comments', 'Sheldon Shao', '2012-12-05 09:37:47 UTC', 'tomcat_attachment/attachment 29694.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (326, '54239', '7', 'Created  attachment 29695   [details] \nPatch for Generator.java\n\nPatch for Generator.java & LocalStrings.*', 'Sheldon Shao', '2012-12-05 09:38:30 UTC', 'tomcat_attachment/attachment 29695.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (327, '54239', '8', 'Created  attachment 29696   [details] \nTest case for ELInterpreterFactory\n\nTest case for ELInterpreterFactory', 'Sheldon Shao', '2012-12-05 09:39:24 UTC', 'tomcat_attachment/attachment 29696.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (328, '54239', '9', '(In reply to  comment #3 )\n> Comment on  attachment 29685   [details] \n> ELInterpreterFactory\n> \n> In principle this looks like a good idea.\n> \n> I have a couple of concerns with the patch as currently written:\n> 1. No documentation.\n     ~~~~~~~~~~~~~~~~~ Added more comments in ELInterpreter & ELInterpreterFactory\n> 2. No test cases.\n     ~~~~~~~~~~~~~~~~~ Provided a test case for ELInterpreterFactory\n\n> 3. The use of enum for the default instance is rather odd.\n     ~~~~~~~~~~~~~~~~~ Fixed\n\n> 4. I dislike the use of system properties when they are not necessary. If\n> the class name was handled as a servlet context initialization parameters\n> then Tomcat already has the necessary plumbing for global, per host and per\n> web application configuration.\n     ~~~~~~~~~~~~~~~~~~ Supported passing the class name from context initialization parameters. Still keep the feature from System Property. \n     In our case, System Property can be easily passed in from such kind of Daemon-Watcher, For example: JSW.\n\n> 5. Error messages need to use the standard i18n support.\n     ~~~~~~~~~~~~~~~~~~ Fixed', 'Sheldon Shao', '2012-12-05 09:50:06 UTC', 'tomcat_attachment/attachment 29685.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (329, '54239', '10', '(In reply to  comment #9 )\n> (In reply to  comment #3 )\n\n> > 4. I dislike the use of system properties when they are not necessary. If\n> > the class name was handled as a servlet context initialization parameters\n> > then Tomcat already has the necessary plumbing for global, per host and per\n> > web application configuration.\n>      ~~~~~~~~~~~~~~~~~~ Supported passing the class name from context\n> initialization parameters. Still keep the feature from System Property. \n>      In our case, System Property can be easily passed in from such kind of\n> Daemon-Watcher, For example: JSW.\n\nI haven\'t looked at the details here but it might be useful for you that system properties are automaticaly supported in most Tomcat config files, e.g. in server.xml and context.xml. What should work if you already support a className attribute is className=\'${my.el.interpreter}\' (using a system property reference) and setting the system property via \'-Dmy.el.interpreter=some.class.i.Use\'. No need for special code or a fixed system property name for this type of use case.\n\nRegards,\n\nRainer', 'Rainer Jung', '2012-12-05 13:50:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (330, '54239', '11', 'Thank you very much for your information! \nI\'ll try to follow up with this approach.\n\n(In reply to  comment #10 )\n> (In reply to  comment #9 )\n> > (In reply to  comment #3 )\n> \n> > > 4. I dislike the use of system properties when they are not necessary. If\n> > > the class name was handled as a servlet context initialization parameters\n> > > then Tomcat already has the necessary plumbing for global, per host and per\n> > > web application configuration.\n> >      ~~~~~~~~~~~~~~~~~~ Supported passing the class name from context\n> > initialization parameters. Still keep the feature from System Property. \n> >      In our case, System Property can be easily passed in from such kind of\n> > Daemon-Watcher, For example: JSW.\n> \n> I haven\'t looked at the details here but it might be useful for you that\n> system properties are automaticaly supported in most Tomcat config files,\n> e.g. in server.xml and context.xml. What should work if you already support\n> a className attribute is className=\'${my.el.interpreter}\' (using a system\n> property reference) and setting the system property via\n> \'-Dmy.el.interpreter=some.class.i.Use\'. No need for special code or a fixed\n> system property name for this type of use case.\n> \n> Regards,\n> \n> Rainer', 'Sheldon Shao', '2012-12-06 00:45:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (331, '54239', '12', 'Created  attachment 29704   [details] \nTest case for ELInterpreterFactory', 'Sheldon Shao', '2012-12-06 05:09:32 UTC', 'tomcat_attachment/attachment 29704.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (332, '54239', '13', 'Created  attachment 29705   [details] \nELInterpreterFactory', 'Sheldon Shao', '2012-12-06 05:10:14 UTC', 'tomcat_attachment/attachment 29705.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (333, '54239', '14', 'All have been fixed by your suggestion. Please take a look. Thanks.\n\n(In reply to  comment #3 )\n> Comment on  attachment 29685   [details] \n> ELInterpreterFactory\n> \n> In principle this looks like a good idea.\n> \n> I have a couple of concerns with the patch as currently written:\n> 1. No documentation.\n> 2. No test cases.\n> 3. The use of enum for the default instance is rather odd.\n> 4. I dislike the use of system properties when they are not necessary. If\n> the class name was handled as a servlet context initialization parameters\n> then Tomcat already has the necessary plumbing for global, per host and per\n> web application configuration.\n> 5. Error messages need to use the standard i18n support.', 'Sheldon Shao', '2012-12-06 05:11:16 UTC', 'tomcat_attachment/attachment 29685.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (334, '54239', '15', 'Created  attachment 29706   [details] \nInterface of ELInterpreter\n\nAdded License information at the front of java file', 'Sheldon Shao', '2012-12-06 06:01:30 UTC', 'tomcat_attachment/attachment 29706.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (335, '54239', '16', 'Created  attachment 29707   [details] \nELInterpreterFactory\n\nAdded APLV2.0 into ELInterpreterFactory.java', 'Sheldon Shao', '2012-12-06 06:02:32 UTC', 'tomcat_attachment/attachment 29707.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (336, '54239', '17', 'Created  attachment 29708   [details] \nTest case for ELInterpreterFactory\n\nAdded APL into TestELInterpreterFactory.java', 'Sheldon Shao', '2012-12-06 06:03:46 UTC', 'tomcat_attachment/attachment 29708.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (337, '54239', '18', 'Hi Mark,\n\nThe code has been refined. Test cases and document also have been provided. \n\nCould you please take a look ?', 'Sheldon Shao', '2013-01-04 09:15:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (338, '54456', '1', 'Which HTTP connector are you using? I\'m having trouble reproducing this. I\'m not against the patch but I\'d like to understand what is going on first.', 'Mark Thomas', '2013-01-23 11:33:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (339, '54456', '2', 'Restoring the severity to something sensible.\n\nNeed requested information to progress this.', 'Mark Thomas', '2013-01-23 19:49:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (340, '54456', '3', 'I found the issue after we switched to protocol=\'HTTP/1.1\'.\nBut I have tested my patch with \'HTTP/1.1\' as well as NIO connector.\nI am getting EOFException(\'Unexpected end of stream while reading chunk body\') with both.\nClient is sending 8kB chunks. The test cases that are failing send around 18mB data before closing connection.\n\nWhy I was not getting EOF in my servlet with NIO connector is something I need to check. ChunkedInputFilter is returning -1 for sure. I wanted to check that before giving update here but not getting time.\nWill check and give details as soon as possible. May be some time next week.\n\nOne sure way of reproducing the issue is setting chunk size as 200 and sending only 100 bytes and then closing connection. \nMy test case is not doing that and why is it happening in my case is something I need to check. I am sending complete 8kB chunks from client. In my case it should fail while reading header (which is handled properly).', 'Sudhan Moghe', '2013-02-01 17:33:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (341, '54456', '4', 'The following lines in ChunkedInputFilter.java (162-164 in trunk)\n\n        if (pos >= lastValid) {\n            readBytes();\n        }\n\nis the only place in this file where the return value of \'readBytes()\' is not checked. \n\nLooking at the code, if the method returns -1 then (lastValid - pos) will be -1 and it will proceed with \'chunk.setBytes(buf, pos, result);\', which seems a wrong thing to do in such a case.\n\nI have not tested what is the actual behaviour here, but an explicit \'return -1\' or \'throw new EOFException()\' would be better.', 'Konstantin Kolinko', '2013-02-05 22:34:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (342, '54456', '5', '(In reply to  comment #4 )\n> \'throw new EOFException()\' would be better.\n\nOn a thought, it would be better to use org.apache.catalina.connector.ClientAbortException or a generic IOException.\n\nIt is abnormal abort of connection by the client. It is not a proper end of stream.', 'Konstantin Kolinko', '2013-02-06 10:46:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (343, '54456', '6', 'Tested with protocol=\'HTTP/1.1\' and <async-supported>false</async-supported>\n\nTook latest code from trunk and then added following debug statements to ChunkedInputFilter.\n\nif (pos >= lastValid) {\n        	int readBytes = readBytes();\n			if (readBytes <= 0){\n				System.out.println(\'ChunkedInputFilter.doRead()1 readBytes returned : \' + readBytes);\n			}\n        }\n\n        if (remaining > (lastValid - pos)) {\n            result = lastValid - pos;\n            System.out.println(\'ChunkedInputFilter.doRead()2 result: \' + result + \' remaining: \' + remaining + \' lastValid: \' + lastValid + \' pos: \' + pos);\n\nOutput on console\nChunkedInputFilter.doRead()1 readBytes returned : -1\nChunkedInputFilter.doRead()2 result: -1 remaining: 8192 lastValid: 334 pos: 335\n\nMethod returns -1, which is treated as normal EOF. And application ends up processing incomplete data.\n\n\'return -1\' won\'t do as that is what is being returned.\n\n\'throw new EOFException(\'Unexpected end of stream while reading chunk body\');\'\nor\n\'throw new org.apache.catalina.connector.ClientAbortException()\'\nlooks appropriate.', 'Sudhan Moghe', '2013-02-06 20:10:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (344, '54456', '7', '(In reply to  comment #5 )\n> On a thought, it would be better to use\n> org.apache.catalina.connector.ClientAbortException or a generic IOException.\n\nClientAbortException is a disallowed import for org.apache.coyote. It will have to be IOException.', 'Mark Thomas', '2013-02-07 11:53:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (345, '54513', '1', 'Created  attachment 29911   [details] \nTEST-org.apache.catalina.loader.TestVirtualContext.APR.txt\n\nJUnit test result file', 'Konstantin Kolinko', '2013-01-31 23:18:25 UTC', 'tomcat_attachment/attachment 29911.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (346, '54513', '2', 'Created  attachment 29912   [details] \nthread_dump_2013-02-01.txt\n\nThread dump, taken with jvisualvm during the 15-minutes pause', 'Konstantin Kolinko', '2013-01-31 23:20:09 UTC', 'tomcat_attachment/attachment 29912.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (347, '54513', '3', '> I suspect that \'wrapper\' is null here.\n\nYes, it is null. I added the following code at line 1632: \n\n[[[\nif (wrapper==null) throw new NullPointerException(\'wrapper is null, n: \' + n + \', rv: \'+rv+\', desc[n*2+1]: \' + desc[n*2+1]);\n]]]\n\nIt results in the following on console:\n    [junit] WARNING: Unexpected poller error\n    [junit] java.lang.NullPointerException: wrapper is null, n: 0, rv: 1, desc[n*2+1]: 52898296\n    [junit] 	at org.apache.tomcat.util.net.AprEndpoint$Poller.run(AprEndpoint.java:1632)\n    [junit] 	at java.lang.Thread.run(Thread.java:722)', 'Konstantin Kolinko', '2013-01-31 23:55:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (348, '54513', '4', 'Reproduced this issue with Native 1.1.24, but a bit different.\nI was not able to reproduce the NPE, but SocketInputStream.socketRead0 in the test hung in the same way. There were two variants:\na) no error message is printed\nb) Feb 01, 2013 H:MM:SS AM org.apache.tomcat.util.net.AprEndpoint$Poller run\nWARNING: Error processing socket timeout\n\n\nThere were a pair of runs with 1.1.26 and with 1.1.24 when the issue did not reproduce.\n\n\n>  thread_dump_2013-02-01.txt (14.90 KB, text/plain) \n\nWhat is odd in the thread dump is that there are two threads:\n\'http-apr-127.0.0.1-auto-2-Poller\'\n\'http-apr-127.0.0.1-auto-1-Poller\'\n\nAll other threads besides this poller one are \'auto-2\'.\nIt is the second test, but the poller thread from the first test has not stopped.', 'Konstantin Kolinko', '2013-02-01 01:16:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (349, '54513', '5', 'I can repeat this on 64-bit Windows.', 'Mark Thomas', '2013-02-01 13:33:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (350, '54513', '6', 'I believe I have found the root cause of this. There is a bug in tc native introduced in  r1412919  in the implementation of Poll.pollset(). n is incremented twice inside the for each loop for each entry in the poller. That means the return value is 2 * number of entries rather than number of entries.', 'Mark Thomas', '2013-02-01 21:05:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (351, '54513', '7', 'Hmm. There may be more to this problem than just that. I still see issues even with a workaround for the Poll.poollset() return value problem.', 'Mark Thomas', '2013-02-01 21:10:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (352, '54513', '8', 'Hmm, reading the code it seems that a socket is member of two pollsets (timeouts and connections). Is this correct. Note that socket can be member of only one pollset and 1.1.26 kind of enforces that.', 'Mladen Turk', '2013-02-02 11:41:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (353, '54513', '9', '(In reply to  comment #8 )\n> Hmm, reading the code it seems that a socket is member of two pollsets\n> (timeouts and connections). Is this correct. Note that socket can be member\n> of only one pollset and 1.1.26 kind of enforces that.\n\nNeither of those are pollsets. There are local lists of sockets.\n\nThere are a handful of bugs I have found in the new AprEndpoint. Fixes are on the way. In the meantime, I would be helpful if you could look at the return value of Poll.pollset. The use of n++ twice inside the loop looks like a bug to me.', 'Mark Thomas', '2013-02-02 18:49:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (354, '54513', '10', 'Not sure what you mean by double increment. Is it?\n\n        p->set[n++]   = (jlong)(fd->rtnevents);\n        p->set[n++]   = P2J(fd->client_data);\n\nThat should be fine.\nThe returned array consist of pair of values odd being event and even being the socket. It was always like that.\n\nBut you are right, there is a bug. Returned number should be n/2 not n.\nI\'ll fix that.\nIf you create a shortcut in Java which calls .pollset(...)\nand divide by two in case the value is > 0 doesn\'t that help?\nAnyhow, I\'ll fix the native and create test 1.1.27-dev binaries for further test.', 'Mladen Turk', '2013-02-02 19:22:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (355, '54513', '11', '(In reply to  comment #10 )\n> Not sure what you mean by double increment. Is it?\n> \n>         p->set[n++]   = (jlong)(fd->rtnevents);\n>         p->set[n++]   = P2J(fd->client_data);\n> \n> That should be fine.\n> The returned array consist of pair of values odd being event and even being\n> the socket. It was always like that.\n> \n> But you are right, there is a bug. Returned number should be n/2 not n.\n> I\'ll fix that.\n\nThanks.\n\n> If you create a shortcut in Java which calls .pollset(...)\n> and divide by two in case the value is > 0 doesn\'t that help?\n\nAlready doing this locally. That was how I moved past this issue and found the others.\n\n> Anyhow, I\'ll fix the native and create test 1.1.27-dev binaries for further\n> test.\n\nPerfect. I see your commit, so I\'m going to move this back to Tomact 8 to track the remaining AprEndpoint issies.', 'Mark Thomas', '2013-02-02 19:30:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (356, '53869', '1', 'Created  attachment 29373   [details] \nTime taken percentage from one sample page', 'Sheldon Shao', '2012-09-13 13:57:20 UTC', 'tomcat_attachment/attachment 29373.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (357, '53869', '2', 'Can somebody please take a look at this patch?', 'Jarek Gawor', '2012-09-18 19:56:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (358, '53869', '3', 'Please provide a test case that demonstrates the difference. The test case doesn\'t need to compare the old and new. As long as it generates timing information for the current implementation then both implementations may be tested in turn.', 'Mark Thomas', '2012-10-28 21:08:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (359, '53869', '4', 'Created  attachment 29586   [details] \nOld JspContextWrapper', 'Sheldon Shao', '2012-11-12 05:56:09 UTC', 'tomcat_attachment/attachment 29586.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (360, '53869', '5', 'Created  attachment 29587   [details] \nTest case comparison for performance tuning', 'Sheldon Shao', '2012-11-12 05:56:42 UTC', 'tomcat_attachment/attachment 29587.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (361, '53869', '6', 'Hi Mark.\n\nI added the test case.\nHere is a result of this case:\n\nDuration:422\nDurationOld:748\nDuration:203\nDurationOld:717\nDuration:187\nDurationOld:702\nDuration:187\nDurationOld:686', 'Sheldon Shao', '2012-11-12 05:59:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (362, '53869', '7', '1. This change in JspContextWrapper constructor means that it will create EL context regardless of whether it will be used or not:\n\n+ this.elContext = rootJspCtxt.getELContext();\n\nSee PageContextImpl.getELContext(), JspApplicationContextImpl.createELContext(..).\n\nThe EL Context creation operation involves using a PrivilegedAction and firing an event through listeners. It is not cheap.\n\nI think this change in behaviour is undesireable.\n\n\n2. I do not expect much from your proposed optimization. Using a delegation is a common pattern. Replacing 4 chained redirects with 1 redirect is not much of a change.\n\n3. If someone extends JspContextWrapper, its behaviour will be broken by this change. (Is it a concern? Would anyone extend it? Isn\'t it Jasper internals?)', 'Konstantin Kolinko', '2012-11-12 08:56:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (363, '53869', '8', 'To get performance improvements above has required 5 levels of nesting and 10^7 iterations. That works out to around 50 nanoseconds per request.\n\nI am far from convinced that the test case used to justify this changes represents a typical use case.\n\nI share Konstantin\'s concerns regarding the ELContext.\n\nI do not believe folks would be extending JspContextWrapper.\n\nWithout a better justification for this change, I am leaning towards WONTFIX.', 'Mark Thomas', '2012-11-12 22:28:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (364, '53869', '9', 'Created  attachment 29604   [details] \nScreenshot from JProfiler\n\nActually, There are 8-level tag files cascaded in our page. You can refer this screenshot.\nIn this screenshot. Index.jsp was hit 80 times.  It has almost 10000 ELs in runtime. In this situation, JspContextWrapper.findAttribute becomes a big one of EL evaluation.', 'Sheldon Shao', '2012-11-19 02:04:08 UTC', 'tomcat_attachment/attachment 29604.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (365, '53869', '10', 'Actually, There are 8-level tag files cascaded in our page. You can refer this screenshot.\nIn this screenshot. Index.jsp was hit 80 times.  It has almost 10000 ELs in runtime. In this situation, JspContextWrapper.findAttribute becomes a big one of EL evaluation.', 'Sheldon Shao', '2012-11-21 08:36:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (366, '53869', '11', 'The test case used to evaluate this patch is flawed. It fails to take account of the call to rootJspCtxt.getELContext() and does not compare the performance of the new implementation for a simple JSP page that does not use EL and does not have nested tags. When these additional issues are taken into consideration the proposed patch significantly impacts performance for these simple pages. Performance (as measured by this test case) is 1.5 to 2 times slower for simple pages.\n\nHowever, it is not all doom and gloom. A small tweak to the proposed patch to use lazy instantiation for the EL context and performance is (as near as makes no difference) back to where it was for simple pages and still noticeably improved for the more complex case.', 'Mark Thomas', '2013-01-25 12:02:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (367, '54324', '1', 'I\'m looking at OpenSSL to see how to do this. Any proper solution will likely depend on  bug 53969  in tcnative, and therefore require tcnative 1.1.25 which has not yet been released.', 'Christopher Schultz', '2012-12-21 15:01:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (368, '54324', '2', 'Is there a road map for releases available for TC Native/Apache/Tomcat in general?\n\nPerhaps this is related?  https://issues.apache.org/bugzilla/show_bug.cgi?id=53219 ', 'Maik Hemani', '2012-12-21 20:18:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (369, '54324', '3', 'tcnative is independent from Apache httpd, though it does depend upon the Apache Portable Runtime library which is \'part\' of Apache httpd.\n\nIn this case, we\'re only relying on support from OpenSSL, so the version of Apache httpd is not relevant.\n\nTomcat 7.x releases have historically come about once per month. There is no guarantee this will continue, but it\'s a reasonable bet.\n\ntcnative 1.1.24 was released 2012-06-13. I\'ve just added a number of SSL_OP_* from OpenSSL 1.0 that were missing to tcnative\'s option-support capabilities, and the option-support caps-detection has been added since 1.1.24 so I\'m going to propose 1.1.25 sometime soon.\n\nOnce you have both of these (tcnative + Tomcat) supporting SSL_OP_NO_COMPRESSION then you should be able to pass your audit.\n\nNote that no current versions of mainstream browsers enable SSL compression by default, so this issue is, for the most part, a non-issue.', 'Christopher Schultz', '2012-12-21 20:38:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (370, '54324', '4', 'Note also, that as a short time workaround you can compile OpenSSL without compression support.', 'Rainer Jung', '2012-12-22 00:33:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (371, '54324', '5', 'It looks like there is movement on getting tcnative 1.1.25 released. I have a patch for this that I will commit soon.', 'Christopher Schultz', '2013-01-15 21:56:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (372, '54324', '6', 'Fixed in trunk and Tomcat 7.0.x. Will be in Tomcat 7.0.36.\n\nProposed for Tomcat 6.0.x.', 'Christopher Schultz', '2013-01-17 20:15:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (373, '54324', '7', 'Implemented in Tomcat 6.0 by  r1461021  , will be in 6.0.37', 'Konstantin Kolinko', '2013-03-26 08:54:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (374, '54324', '8', '(In reply to Konstantin Kolinko from  comment #7 )\n> Implemented in Tomcat 6.0 by  r1461021  , will be in 6.0.37\n\nKonstantin,\n\nthe fix for 6.0.x strays from the convention lowercase name for variables. See  http://svn.apache.org/viewvc/tomcat/tc6.0.x/trunk/java/org/apache/tomcat/util/net/AprEndpoint.java?r1=1461021&r2=1461020&pathrev=1461021 \n\n> protected boolean SSLDisableCompression = false;', 'Michael Osipov', '2013-08-13 09:05:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (375, '54324', '9', '(In reply to Michael Osipov from  comment #8 )\n> (In reply to Konstantin Kolinko from  comment #7 )\n> > Implemented in Tomcat 6.0 by  r1461021  , will be in 6.0.37\n> \n> Konstantin,\n> \n> the fix for 6.0.x strays from the convention lowercase name for variables.\n> See\n>  http://svn.apache.org/viewvc/tomcat/tc6.0.x/trunk/java/org/apache/tomcat/ \n> util/net/AprEndpoint.java?r1=1461021&r2=1461020&pathrev=1461021\n> \n> > protected boolean SSLDisableCompression = false;\n\nAnd the boolean should be private.\nIt has both getter and setter so there is no need to expose it outside the class.', 'Sebb', '2013-08-13 09:52:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (376, '54379', '1', 'Hi,\n\nI\'m going to work on this.\n\nRegards\nVioleta', 'Violeta Georgieva', '2013-01-07 20:27:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (377, '54379', '2', 'Could you provide a progress update please. This is (currently) the only remaining issue that needs fixing before the 7.0.35 tag.', 'Mark Thomas', '2013-01-09 12:02:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (378, '54379', '3', 'I\'m preparing the test cases just now.\nI\'ll be ready till end of the day is that OK?', 'Violeta Georgieva', '2013-01-09 12:10:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (379, '54379', '4', 'That sounds great. Thanks.', 'Mark Thomas', '2013-01-09 12:16:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (380, '54379', '5', 'Created  attachment 29840   [details] \nPatch proposal + tests\n\nHi,\n\nPlease find attached a patch proposal and tests.\n\nImportant notes to the implementation:\n1. Only one method per given event is allowed per class.\n2. As per javaee_6.xsd if \'lifefycle-callback-class\' element is not specified then the component that contains definitions for post-construct or pre-destroy should be used. For web applications we can specify this functionality only per web application and not per web component so in the implementation if the class is not specified then IllegalArgumentException will be thrown.\n3. If method for a given event is specified in deployment descriptor and with annotation - the definition in the descriptor will be used.\n4. If there are definitions in web.xml and in web-fragment.xml then web-fragment.xml will be ignored.\n5. If there are no definitions in the web.xml and we have definitions in web fragments then they will be merged. However if there are conflicts - more than one method per given event per class - the merge operation will not succeed.\n6. If the method specified in the deployment descriptor cannot be found in the class then IllegalArgumentException will be thrown.\n\nI\'m looking forward to your comment.\n\nRegards\nVioleta', 'Violeta Georgieva', '2013-01-10 07:32:02 UTC', 'tomcat_attachment/attachment 29840.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (381, '54379', '6', 'Many thanks for the patch. That was a much bigger job than I realised.\n\nI have applied the patch to trunk with just a few minor tweaks:\n- fixed various IDE / Checkstyle warnings (Java 7 <>, whitespace etc)\n- removed unnecessary use of this (just a style thing)\n- removed syncs from new maps in StandardContext (deployment is always single threaded for an app)\n- renamed a test class for consistency\n- correct a few indents\n- Used Tomcat.enableNaming() rather than system property\n\nI\'ll back-port to 7.0.x shortly.', 'Mark Thomas', '2013-01-10 11:43:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (382, '54377', '1', 'Created  attachment 29820   [details] \npatch proposal', 'Violeta Georgieva', '2013-01-06 20:19:29 UTC', 'tomcat_attachment/attachment 29820.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (383, '54377', '2', 'Created  attachment 29821   [details] \ntest case', 'Violeta Georgieva', '2013-01-06 20:19:53 UTC', 'tomcat_attachment/attachment 29821.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (384, '54377', '3', '+1\n\nPlease find a patch proposal and a test case.\nRemoteIpValve sets the correct request attributes, only RequestIpFilter need correction.\n\nRegards\nVioleta', 'Violeta Georgieva', '2013-01-06 20:21:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (385, '54284', '1', 'I just recognized that i created the bug with a wrong affected version number.\nThe bug happens in Rel. 7.0.34, probably as a result of fixing #54170', 'benjamin.gehrels_external', '2012-12-13 11:45:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (386, '54284', '2', 'Hi,\n\nI\'m going to work on this.\n\nRegards\nVioleta', 'Violeta Georgieva', '2013-01-02 21:56:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (387, '54284', '3', 'Hi,\n\nServlet 3.0 javadoc does not specify what should be the behavior when filterName is NULL.\nI requested a clarification [1] from the Servlet Specification expert group.\nI\'m changing the status to NEEDINFO.\n\nRegards\nVioleta\n\n[1]  http://java.net/jira/browse/SERVLET_SPEC-51 ', 'Violeta Georgieva', '2013-01-03 16:30:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (388, '54284', '4', 'Created  attachment 29817   [details] \nPatch proposal', 'Violeta Georgieva', '2013-01-05 12:48:28 UTC', 'tomcat_attachment/attachment 29817.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (389, '54284', '5', 'Created  attachment 29818   [details] \nTest case', 'Violeta Georgieva', '2013-01-05 12:51:17 UTC', 'tomcat_attachment/attachment 29818.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (390, '54284', '6', 'Hi,\n\nAs per clarification provided by Servlet Specification expert group - IllegalArgumentException should be thrown when filter name is NULL or empty string.\n\nPatch proposal and test case are attached.\n\nAny comments will be appreciated.\n\nRegards\nVioleta', 'Violeta Georgieva', '2013-01-05 12:55:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (391, '54284', '7', 'Created  attachment 29822   [details] \npatch proposal', 'Violeta Georgieva', '2013-01-07 11:57:14 UTC', 'tomcat_attachment/attachment 29822.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (392, '54262', '1', 'Created  attachment 29736   [details] \nresources1.jar\n\nConfirming.\n\nSteps to reproduce with 7.0.34:\n1. Download attached resources1.jar and put it into webapps/examples/WEB-INF/lib\n\nThe file is based on test/webapp-3.0-fragments/WEB-INF/lib/resources.jar from Tomcat sources. I\na) removed all resources except \'resourceA.jsp\' and\nb) declared an instance of HelloWorldServlet in web-fragment.xml.\n\n2. Edit webapps/examples/WEB-INF/web.xml:\na) change metadata-complete attribute s/true/false/\nb) add <absolute-ordering />\n\n3. Start Tomcat.\n4. Actual result: The following two URLs work:\n[1]  http://localhost:8080/examples/resourceA.jsp \n[2]  http://localhost:8080/examples/resources1/HelloWorldExample \n\nExpected result: [2] should return 404 as web-fragment.xml should be ignored and the servlet mapping declared there should be ignored.\n\n<quote from=\'Servet Spec 3.0 Rev a - page #67 (89/230)\'>\n1.d. (..) If the\n <absolute-ordering> element does not contain an <others/> element,\n any web-fragment not specifically mentioned within <name /> elements\n MUST be ignored. (...)\n</quote>\n\nRegarding [1], I do not see any specific reference that such exclusion affects static resources in META-INF/resources. Thus I think that the expected behaviour of [1] is to display resourcesA.jsp page. 7.0.34 behaves correctly here.', 'Konstantin Kolinko', '2012-12-09 20:27:10 UTC', 'tomcat_attachment/attachment 29736');
INSERT INTO `tomcatbeforefixcomments` VALUES (393, '54262', '2', 'Hi,\n\nI\'m going to work on this.\n\nRegards\nVioleta', 'Violeta Georgieva', '2013-01-03 18:02:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (394, '54262', '3', 'Created  attachment 29811   [details] \nPatch proposal', 'Violeta Georgieva', '2013-01-04 09:34:10 UTC', 'tomcat_attachment/attachment 29811.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (395, '54262', '4', 'Created  attachment 29812   [details] \nTest case', 'Violeta Georgieva', '2013-01-04 09:34:52 UTC', 'tomcat_attachment/attachment 29812.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (396, '54262', '5', 'Please find attached a patch proposal and a test case for it.\n\nAny comments will be appreciated.\n\nRegards\nVioleta', 'Violeta Georgieva', '2013-01-04 09:36:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (397, '54262', '6', 'Created  attachment 29813   [details] \nresources.jar\n\nresources.jar should be placed in <TC7-Trunk>/test/webapp-3.0-fragments-empty-absolute-ordering/WEB-INF/lib', 'Violeta Georgieva', '2013-01-04 09:42:15 UTC', 'tomcat_attachment/attachment 29813');
INSERT INTO `tomcatbeforefixcomments` VALUES (398, '54241', '1', 'I have a number of concerns with this proposed change:\n\n1. Writers generally do throw NPEs when called with null.\n\n2. I\'m not convinced 35410 should have been fixed since toString() should never return null (else all sorts of standard code patterns break).\n\n3. The patch should ideally include a test case.\n\n4. The proposed patch only addresses one possible NPE of many.', 'Mark Thomas', '2012-12-04 08:25:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (399, '54241', '2', 'What is your stacktrace and in what case this issue is triggered?\n\n\n1. I agree with Mark that Writer.write((String)null) should throw an NPE\n\n2. Regarding  bug 35410  I think that the fix is wrong but in another way\n\nExpressions are defined in two places in JSP 2.2,\na) JSP.1.12.3 \'Expressions\'\nb) JSP.9.4.3 \'Expressions\'\n\nb) says that <%= expr %> is out.print(expr)\nand JspWriter.print(String) is defined to print null value as \'null\', not \'\'.\n\nSo using the test from  bug 35410  I expect \'null null null\'. The actual result in 7.0.33 is \'null null\'.\n\nThe generated java code is\n      out.print( test );\n\nI think it should generate\n      out.print( String.valueOf(test) );\n\n\nThe behaviour of JspWriterImpl.print(Object) could be \'improved\' to handle obj.toString() returning null,  but I do not think that such change is needed, because its current behaviour is consistent with PrintWriter.print(Object) which results in an NPE.\n\nMy reading is that the spec says that the value of the expression should be coerced to String *before* printing it.', 'Konstantin Kolinko', '2012-12-04 12:38:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (400, '54241', '3', '+1 to Konstantin\'s analysis. I\'ll work on a test case and patch based on  bug 35410 . We could re-open that one but since it is for 5.5.x which is now unsupported I\'d rather just deal with it here.', 'Mark Thomas', '2013-01-02 11:58:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (401, '54220', '1', 'Fixed in trunk and 7.0.x and will be included in 7.0.34 onwards.', 'Mark Thomas', '2012-12-03 14:21:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (402, '54220', '2', 'Opps. Need to keep this open until 6.0x. is fixed.', 'Mark Thomas', '2012-12-03 14:23:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (403, '54220', '3', 'Proposed for 6.0.x', 'Mark Thomas', '2012-12-03 14:42:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (404, '54217', '1', 'You are not closing your connection pool properly. You need to specify closeMethod=\'close\'. Without that the pool would not know when to close those 10 \'minIdle\' connections.\n\nThe attribute is documented here:\n http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Resource_Definitions \n\n\nThis is going to be close as INVALID. Just holding it open for a while as a chance to improve documentation: it would be better to add closeMethod to the examples in jndi-datasource-examples-howto.html', 'Konstantin Kolinko', '2012-11-29 06:21:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (405, '54217', '2', '(In reply to  comment #1 )\n> You are not closing your connection pool properly. You need to specify\n> closeMethod=\'close\'. Without that the pool would not know when to close\n> those 10 \'minIdle\' connections.\n> \n> The attribute is documented here:\n>  http://tomcat.apache.org/tomcat-7.0-doc/config/context .\n> html#Resource_Definitions\n> \n> \n> This is going to be close as INVALID. Just holding it open for a while as a\n> chance to improve documentation: it would be better to add closeMethod to\n> the examples in jndi-datasource-examples-howto.html\n\nThank you so much for your help!\nI added the attribute closeMethod=\'close\' to the Resource element in my \n/META-INFO/context.xml and it works!\n\nI asked about how to handle this issue on stackoverflow.com and nobody seems to know. So I\'ll post the answer to my question myself referencing this page and your help.\n\nСпасибо!', 'Levan', '2012-11-29 15:34:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (406, '54217', '3', '(In reply to  comment #1 )\n> You are not closing your connection pool properly. You need to specify\n> closeMethod=\'close\'. Without that the pool would not know when to close\n> those 10 \'minIdle\' connections.\n> \n> The attribute is documented here:\n>  http://tomcat.apache.org/tomcat-7.0-doc/config/context .\n> html#Resource_Definitions\n> \n> \n> This is going to be close as INVALID. Just holding it open for a while as a\n> chance to improve documentation: it would be better to add closeMethod to\n> the examples in jndi-datasource-examples-howto.html\n\nThis attribute is not available to Tomcat 6, is it? I checked the docs. Seems to be Tomcat 7 specific. I am using JDBC Pool happily with Tomcat 6 in production.', 'Michael Osipov', '2012-11-30 19:00:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (407, '54217', '4', 'There looks to be a memory leak here. Stopping the context should make the connections eligible for GC but a reference is being retained by the PoolCleaner thread.', 'Mark Thomas', '2012-12-03 10:54:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (408, '54217', '5', 'Confirmed. This is a memory leak bug in jdbc-pool. PoolCleaner instances are retaining references to the ConnectionPool preventing it from being GC\'d.', 'Mark Thomas', '2012-12-03 11:47:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (409, '54217', '6', 'This has been fixed in trunk and 7.0.x and will be included in 7.0.34 onwards.', 'Mark Thomas', '2012-12-03 11:48:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (410, '54217', '7', '(In reply to  comment #6 )\n> This has been fixed in trunk and 7.0.x and will be included in 7.0.34\n> onwards.\n\nWow it turned out to be a bug. Glad I unintentionally found it )\n\nI will update my answer on StackOverflow.com\n\nThank you for the clarification!', 'Levan', '2012-12-03 12:38:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (411, '54217', '8', '(In reply to  comment #5 )\n> Confirmed. This is a memory leak bug in jdbc-pool. PoolCleaner instances are\n> retaining references to the ConnectionPool preventing it from being GC\'d.\n\nIt still doesn\'t make the closeMethod call obsolete, does it?', 'Michael Osipov', '2012-12-03 16:55:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (412, '54217', '9', 'As per the docs for closeMethod, that method exists solely to speed up the freeing of resources that would otherwise be freed by GC.', 'Mark Thomas', '2012-12-03 17:00:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (413, '54217', '10', 'Hi.\n\nIt seems like the issue initially described in this bug report is still present for the currently latest Tomcat version 7.0.50. Although now Tomcat sometimes manages to close additional connections after reloading, sometimes the number of connections are increased after one reload and then kept steady.\n\nBut I still could reproduce the initially described issue (although again not that easy: it may be related to the frequency of successive reloads). Seems like it\'s just a matter of time, i.e. if Tomcat has enough time after reload, it manages the connection pool more or less as it should. As Mark mentioned in the \' Comment 9 \' the closeMethod \'speeds up the freeing of resources that would otherwise be freed by GC.\', and it looks like the speed is the defining factor.\n\nWhen using the solution presented by Konstantin Kolinko (to use closeMethod=\'close\') all WORKS just fine, and the number of connections reserved are kept STRICTLY as defined in the context.xml file. So it appears that using closeMethod=\'close\' is the ONLY true way (at the moment) to avoid \'PSQLException: FATAL: sorry, too many clients already\' exception.\n\nI\'ll update my post at Stack Overflow ( http://stackoverflow.com/questions/13595794/jdbc-connection-pool-runs-out-of-connections-when-context-reload-true-is-enabl ) to reflect this situation.', 'Levan', '2014-01-13 03:30:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (414, '54144', '1', '3. JSTL spec says (under \'Null & Error Handling\'):\n\'If no default value is specified, it itself defaults to an empty string.\'\n\nIn the current code:\na) A null is used instead of \'\' as the value of strDefName.\nb) I suspect that the following check for \'no default value specified\' is incorrect:\n            ctxt.generateJavaSource(\'if(\');\n            ctxt.generateAttribute(\'default\');\n            ctxt.generateJavaSource(\' != null){\');\n\nOne has to check whether the attribute is present, instead of checking whether its value is null.', 'Konstantin Kolinko', '2012-11-15 05:03:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (415, '54144', '2', '(In reply to  comment #1 )\n> One has to check whether the attribute is present, instead of checking\n> whether its value is null.\n\nActually checking for null should be OK here. Apache implementation of JSTL tests for null there. \'if (def != null)\' on line 100 in\n http://svn.apache.org/viewvc/tomcat/taglibs/standard/tags/standard-112/src/org/apache/taglibs/standard/tag/common/core/OutSupport.java?view=markup \n\n\n4. If default is not specified, the body of the tag has to be used as the default value. This feature was completely broken by  r1401816  as the following lines were removed:\n\n-        ctxt.generateJavaSource(\'    }else{\');\n-        ctxt.generateBody();\n-        ctxt.generateJavaSource(\'    }\');', 'Konstantin Kolinko', '2012-11-15 08:48:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (416, '54144', '3', 'I\'ve fixed using body as the default issue in trunk and 7.0.x.', 'Mark Thomas', '2012-11-16 22:49:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (417, '54087', '1', 'There is a grey(ish) area here.\n\nSRV.3.4 states \'If the getDateHeader method cannot translate the header to a Date object, an IllegalArgumentException is thrown\'\n\nRFC2616-3.3.1 states \'Recipients of date values are encouraged to be robust in accepting date values\'. I take \'robust\' in this case to mean tolerant rather than strict. It could be read as either.\n\nRFC2616-14.25.a as already quoted\n\nTogether, these suggest that Tomcat should try and parse the header regardless of the format and if it can\'t parse it ignore it if the header is an \'If-Modified-Since\' header.\n\nWhen processing the If-Modified-Since header in the DefaultServlet, Tomcat does follow RFC2616-14.25.a and effectively ignores the header.\n\nThe Javadoc for getDateHeader() states that \'returns ... -1 if the named header was not included with the request\'. That is the only circumstance in which -1 is a permitted return value so if the header is present but in the wrong format Tomcat\'s only options are a) throw an IAE, b) parse it anyway. The problem with b) is that Tomcat would have to guess what the invalid format was. That is easier said than done. Therefore, all Tomcat can realistically do here is throw IAE.\n\nThat, therefore, passes responsibility for adhering to RFC2616-14.25.a to whatever code is calling getDateHeader(). In this case the application; making it an application issue not a Tomcat one.', 'Mark Thomas', '2012-11-12 00:20:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (418, '54087', '2', '(In reply to  comment #1 )\n> \n> When processing the If-Modified-Since header in the DefaultServlet, Tomcat\n> does follow RFC2616-14.25.a and effectively ignores the header.\n> \n\nI am REOPENing this. The DefaultServlet is OK and has the necessary try/catches around getDateHeader() calls.\n\nThe problem is in javax.servlet.http.HttpServlet#service() where a try/catch is missing.\n\nI see two options: a) ignore the invalid header, like it is done by DefaultServlet, b) silently fail with error 400. Failing with error 500 isn\'t good.', 'Konstantin Kolinko', '2012-11-12 09:12:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (419, '54087', '3', 'Thanks for catching that. I should have read the stack trace more carefully.', 'Mark Thomas', '2012-11-12 11:26:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (420, '54087', '4', 'Fixed in trunk and 7.0.x and will be included in 7.0.33 onwards.', 'Mark Thomas', '2012-11-12 13:20:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (421, '54087', '5', 'I proposed the patch ( r1408254 ) for Tomcat 6.', 'Konstantin Kolinko', '2012-11-12 21:16:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (422, '54076', '1', 'Is that really a DoS (in that the server is unavailable to other clients) or do you mean that the client gets stuck in an infinite loop?\n\nFor a DoS, the resources used by Tomcat need to be out of proportion to the number of requests. i.e. If a client just sending a request again and again uses roughly the same server resources as this case then it is not a DoS. The report does not (at this point) sound like a DoS.', 'Mark Thomas', '2012-10-30 16:34:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (423, '54076', '2', 'Well, I guess the latter applies but I have tried only one client at the same time. I was able to loop client and server within seconds for tens of thousands of requests (as you have seen in the screenshot). I guess if you scale to 100 parallel connections or more what would happen to a Tomcat instance?\n\nMay this lead to a DoS?', 'Michael Osipov', '2012-10-30 16:59:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (424, '54076', '3', 'There is no evidence of a DoS in this report.', 'Mark Thomas', '2012-11-03 20:59:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (425, '53867', '1', 'Created  attachment 29370   [details] \nComparison test case', 'Sheldon Shao', '2012-09-13 13:41:37 UTC', 'tomcat_attachment/attachment 29370.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (426, '53867', '2', 'Created  attachment 29376   [details] \nPatch for PageContextImpl.java', 'Sheldon Shao', '2012-09-13 14:06:21 UTC', 'tomcat_attachment/attachment 29376.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (427, '53867', '3', 'Can somebody please take a look at this patch? It\'s a nice & clean optimization.', 'Jarek Gawor', '2012-09-18 19:55:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (428, '54012', '1', 'Comment on  attachment 29485   [details] \nPatch for org.apache.jasper.tagplugins.jstl.core.Set.java\n\n>Index: org/apache/jasper/tagplugins/jstl/core/Set.java\n>===================================================================\n>--- org/apache/jasper/tagplugins/jstl/core/Set.java	( revision 1370136 )\n>+++ org/apache/jasper/tagplugins/jstl/core/Set.java	(working copy)\n>@@ -70,14 +70,20 @@\n>         \n>         //if the attribute var has been specified then assign the result to the var;\n>         if(hasVar){\n>+            String jspCtxt = null;\n>+            if (ctxt.isTagFile()) {\n>+                jspCtxt = \'this.getJspContext()\';\n>+            } else {\n>+                jspCtxt = \'_jspx_page_context\';\n>+            }\n>             String strVar = ctxt.getConstantAttribute(\'var\');\n>             ctxt.generateJavaSource(\'if(null != \' + resultName + \'){\');\n>-            ctxt.generateJavaSource(\'    pageContext.setAttribute( \'\' + strVar + \' \',\' + resultName + \',\' + iScope + \');\');\n>+            ctxt.generateJavaSource(\'    \'+jspCtxt+\'.setAttribute( \'\' + strVar + \' \',\' + resultName + \',\' + iScope + \');\');\n>             ctxt.generateJavaSource(\'} else {\');\n>             if(hasScope){\n>-                ctxt.generateJavaSource(\'    pageContext.removeAttribute( \'\' + strVar + \' \',\' + iScope + \');\');\n>+                ctxt.generateJavaSource(\'    \'+jspCtxt+\'.removeAttribute( \'\' + strVar + \' \',\' + iScope + \');\');\n>             }else{\n>-                ctxt.generateJavaSource(\'    pageContext.removeAttribute( \'\' + strVar + \' \');\');\n>+                ctxt.generateJavaSource(\'    \'+jspCtxt+\'.removeAttribute( \'\' + strVar + \' \');\');\n>             }\n>             ctxt.generateJavaSource(\'}\');\n>', 'Sheldon Shao', '2012-10-16 09:02:18 UTC', 'tomcat_attachment/attachment 29485.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (429, '54012', '2', 'Created  attachment 29486   [details] \nPatch for Compiler.java', 'Sheldon Shao', '2012-10-16 09:02:40 UTC', 'tomcat_attachment/attachment 29486.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (430, '54012', '3', 'Created  attachment 29487   [details] \nPatch for PageInfo.java', 'Sheldon Shao', '2012-10-16 09:03:03 UTC', 'tomcat_attachment/attachment 29487.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (431, '54012', '4', 'Created  attachment 29488   [details] \nPatch for TagPluginContext.java', 'Sheldon Shao', '2012-10-16 09:03:26 UTC', 'tomcat_attachment/attachment 29488.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (432, '54012', '5', 'Created  attachment 29489   [details] \nPatch for TagPluginManager.java', 'Sheldon Shao', '2012-10-16 09:03:47 UTC', 'tomcat_attachment/attachment 29489.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (433, '53986', '1', 'Confirmed broken in 7.0.32, working in 7.0.30.\n\nI played-around with it a bit and it appears that any odd number of - symbols before %> will cause the page to fail to compile (the original example has 7 - symbols before the final %> in the comment).', 'Christopher Schultz', '2012-10-09 21:19:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (434, '53986', '2', 'I thought there might be language in the spec to say that (like XML) the string \'--\' cannot appear in the comment itself but that\'s not the case.\n\nFrom the 2.2 spec:\n\'\nJSP.1.5.1.2 JSP Comments\n\nA JSP comment is of the form\n<%-- anything but a closing --%> ... --%>\n\nThe body of the content is ignored completely.\n\'\n\nSo this is both a regression and a spec violation.', 'Christopher Schultz', '2012-10-09 21:25:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (435, '53986', '3', 'Possible cause:  r1381417 \n\nI haven\'t looked into this yet but that is where I\'d start.', 'Mark Thomas', '2012-10-09 21:30:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (436, '53986', '4', '(In reply to  comment #3 )\n> Possible cause: r1381417\n\nReverting that patch resolves the issue in 7.0.x/trunk, so the regression appears to be in there. I\'m not sure where, though.\n\nSteve, a workaround might be replacing \'([^-])-------%>\' with \' 1------%>\' in your JSPs (or just stick with 7.0.30 for the time being).', 'Christopher Schultz', '2012-10-09 22:07:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (437, '53986', '5', '(In reply to  comment #4 )\n\nThanks Chris.  I actually only had a single JSP with this problem, so I already fixed the JSP and am up and running on 7.0.32.  However, since it appeared to be a regression from the previous version I thought it best to report the issue.', 'Steve Ratay', '2012-10-10 01:40:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (438, '53986', '6', 'Found the problem. It is line 429 of JspReader:\n\nsetCurrent(restart);\n\nThis makes the current Mark and the reset Mark the same object and they need to be kept separate. Looking at a fix now. It is possible that this issue will have have wider impacts that just comment tag parsing. We\'ll need to keeo an eye on it in case an early 7.0.33 is required.', 'Mark Thomas', '2012-10-10 14:05:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (439, '53854', '1', 'Created  attachment 29357   [details] \nPatch to DefaultServlet to workaround the error.\n\nI was able to work around this error with a slight modification to the DefaultServlet code.  Not sure if this is the best solution, but it seems to work without breaking anything so I\'m attaching it here.', 'Daniel Mikusa', '2012-09-11 20:50:29 UTC', 'tomcat_attachment/attachment 29357.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (440, '53854', '2', 'The proposed patch fixes the symptom rather than the cause. The fix needs to be in BaseDirContext and other classes in the same package.', 'Mark Thomas', '2012-09-17 16:24:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (441, '53854', '3', 'Created  attachment 29384   [details] \nUpdated patch, works with BaseDirContext and FileDirContext', 'Daniel Mikusa', '2012-09-18 16:37:57 UTC', 'tomcat_attachment/attachment 29384.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (442, '53854', '4', 'The patch is not functionally correct for FileDirContext and still does not address the root cause.\n\nIssue include:\n- ignores WARDirContext\n- ignores 3rd party sub-classes\n- does not use correct priority for aliases', 'Mark Thomas', '2012-09-18 17:22:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (443, '53713', '1', 'Created  attachment 29224   [details] \nPatch for Mark.java', 'Sheldon Shao', '2012-08-14 06:29:38 UTC', 'tomcat_attachment/attachment 29224.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (444, '53713', '2', 'Moving to enhancement since there is no bug here.\n\nPlease provide a test case that demonstrates the performance improvement.', 'Mark Thomas', '2012-08-15 20:43:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (445, '53713', '3', 'Created  attachment 29242   [details] \nPatch for JspReader.java', 'Sheldon Shao', '2012-08-17 14:29:52 UTC', 'tomcat_attachment/attachment 29242.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (446, '53713', '4', 'Created  attachment 29243   [details] \nPatch for Mark.java', 'Sheldon Shao', '2012-08-17 14:30:23 UTC', 'tomcat_attachment/attachment 29243.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (447, '53713', '5', 'Created  attachment 29244   [details] \nComparison test case for JspReader', 'Sheldon Shao', '2012-08-17 14:31:30 UTC', 'tomcat_attachment/attachment 29244.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (448, '53713', '6', 'Created  attachment 29245   [details] \nOldJspReader.java renamed from original JspReader.java', 'Sheldon Shao', '2012-08-17 14:32:25 UTC', 'tomcat_attachment/attachment 29245');
INSERT INTO `tomcatbeforefixcomments` VALUES (449, '53713', '7', 'Created  attachment 29246   [details] \nOldMark.java renamed from the original Mark.java', 'Sheldon Shao', '2012-08-17 14:33:04 UTC', 'tomcat_attachment/attachment 29246');
INSERT INTO `tomcatbeforefixcomments` VALUES (450, '53713', '8', 'Test case for comparison,\n\nWebapp test/webapp-2.3 New JspReader:529\nWebapp test/webapp-2.3 Old JspReader:2256\n\nWebapp test/webapp-2.4 New JspReader:362\nWebapp test/webapp-2.4 Old JspReader:1392\n\nWebapp test/webapp-2.5 New JspReader:441\nWebapp test/webapp-2.5 Old JspReader:1338\n\nWebapp test/webapp-3.0 New JspReader:9525\nWebapp test/webapp-3.0 Old JspReader:26608\n\nWebapp test/webapp-3.0-fragments New JspReader:1416\nWebapp test/webapp-3.0-fragments Old JspReader:3417\n\nWebapp test/webapp-3.0-servletsecurity2 New JspReader:406\nWebapp test/webapp-3.0-servletsecurity2 Old JspReader:1011\n\nWebapp test/webapp-3.0-virtual-webapp New JspReader:2495\nWebapp test/webapp-3.0-virtual-webapp Old JspReader:4935\n		\n\nHere is part of the test case,\n\n                 int count = 1000;\n		long start = System.currentTimeMillis();\n		for(int i = 0; i < count; i ++) {\n			goThroughAllJsp(appDir, true);\n		}\n		System.out.println(\'Webapp \' + folder + \' New JspReader:\'\n				+ (System.currentTimeMillis() - start));\n		start = System.currentTimeMillis();\n		for(int i = 0; i < count; i ++) {\n			goThroughAllJsp(appDir, false);\n		}\n		System.out.println(\'Webapp \' + folder + \' Old JspReader:\'\n				+ (System.currentTimeMillis() - start));', 'Sheldon Shao', '2012-08-17 14:37:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (451, '53713', '9', 'Comment on  attachment 29244   [details] \nComparison test case for JspReader\n\nChange mime type', 'Mark Thomas', '2012-09-03 15:05:42 UTC', 'tomcat_attachment/attachment 29244.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (452, '53713', '10', 'Nice improvement. I\'ll take a closer look at the patch with a view to including it in the next release.', 'Mark Thomas', '2012-09-05 16:42:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (453, '53793', '1', 'Implemented in 7.0 with  r1378367  and will be in 7.0.30 onwards.', 'Konstantin Kolinko', '2012-08-28 22:20:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (454, '53793', '2', 'Created  attachment 29296   [details] \n2012-08-29_tc6_53793.patch\n\nPatch for Tomcat 6', 'Konstantin Kolinko', '2012-08-28 22:41:35 UTC', 'tomcat_attachment/attachment 29296.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (455, '53793', '3', 'Fixed in 6.0.x and will be included in 6.0.36 onwards.', 'Mark Thomas', '2012-10-04 16:31:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (456, '42181', '1', 'The HTTP request is most likely invalid.', 'Remy Maucherat', '2007-04-22 03:26:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (457, '42181', '2', '***  Bug 53752  has been marked as a duplicate of this bug. ***', 'Konstantin Kolinko', '2012-08-27 22:54:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (458, '42181', '3', 'Fixed in Tomcat 7 with  r1377909 . It will be in 7.0.30.', 'Konstantin Kolinko', '2012-08-28 00:41:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (459, '42181', '4', 'Created  attachment 29288   [details] \n2012-08-28_tc6_42181.patch\n\nPatch for Tomcat 6', 'Konstantin Kolinko', '2012-08-28 00:50:53 UTC', 'tomcat_attachment/attachment 29288.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (460, '42181', '5', 'Created  attachment 29295   [details] \n2012-08-29_tc55_42181.patch\n\nPatch for Tomcat 5.5\nIncludes backport of  r423453 \n\nThe patches have been proposed for 6.0 and 5.5.', 'Konstantin Kolinko', '2012-08-28 20:58:49 UTC', 'tomcat_attachment/attachment 29295.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (461, '42181', '6', 'Fixed in 6.0 with  r1381038 . It will be in Tomcat 6.0.36 onwards.', 'Konstantin Kolinko', '2012-09-05 07:24:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (462, '53783', '1', 'Created  attachment 29284   [details] \nPatch proposal', 'Violeta Georgieva', '2012-08-27 13:32:45 UTC', 'tomcat_attachment/attachment 29284.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (463, '53783', '2', 'Does specification allow JAR files that do not have directory entries?\n\n1. The \'jar\' tool always creates entries for directories.\nThere are no options to omit them,\n\n http://docs.oracle.com/javase/7/docs/technotes/tools/solaris/jar.html \n\n2. The spec says \'in the META-INF/resources directory of a JAR file\'.\nThere is no such \'directory\' in this resource.jar.\n\n\nThat said, I am OK with the patch.\n\nFor stream access to a jar file (o.a.t.util.scan.UrlJar) the entryExists() method does such iteration internally, so proposed patch would not slow it down.\n\nFor random access to a jar file (o.a.t.util.scan.FileUrlJar) the ZIP archive index is read when JAR file is opened and iteration over the index (JarFile.entries()) should not waste much time.', 'Konstantin Kolinko', '2012-08-27 14:07:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (464, '53783', '3', '(In reply to  comment #2 )\n> Does specification allow JAR files that do not have directory entries?\n> \n> 1. The \'jar\' tool always creates entries for directories.\n> There are no options to omit them,\n> \n\nEclipse IDE is used for jar creation (project type \'java project\' and export artifact jar)', 'Violeta Georgieva', '2012-08-27 17:04:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (465, '53725', '1', 'Thanks for the test case. It made fixing this a whole lot easier than it would otherwise have been.\n\nThe fix has been applied to trunk and 7.0.x and will be included in 7.0.30 onwards.\n\nI haven\'t included the test case in the unit tests due to the size of the file required to trigger this issue. (It would significantly increase the size of the source distribution.)', 'Mark Thomas', '2012-08-25 20:11:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (466, '53725', '2', 'Good catch.\nI proposed backport of this fix ( r1377342 ) to Tomcat 6.0.', 'Konstantin Kolinko', '2012-08-26 14:43:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (467, '53725', '3', 'Created  attachment 29286   [details] \nDemonstrates the same problem post-fix.\n\nPlease unzip to obtain the data.bin which causes the issue.', 'kevin.l.stern', '2012-08-27 20:52:56 UTC', 'tomcat_attachment/attachment 29286');
INSERT INTO `tomcatbeforefixcomments` VALUES (468, '53725', '4', 'I have attached a new data.bin which demonstrates that the problem remains post-fix.', 'kevin.l.stern', '2012-08-27 20:53:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (469, '53725', '5', 'Note that, not surprisingly, using Java 7\'s GZIPOutputStream with syncFlush=true resolves the issue.', 'kevin.l.stern', '2012-08-27 21:10:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (470, '53725', '6', 'That is an option for Tomcat 8 (which will require Java 7) but not for Tomcat 7 and earlier.', 'Mark Thomas', '2012-08-27 21:12:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (471, '53725', '7', 'Very different failure mode (a whole chunk of data is missing from the end). Probably a different bug. I\'ll start digging.', 'Mark Thomas', '2012-08-28 21:14:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (472, '53725', '8', 'Easy solution implemented for trunk (Tomcat 8).\n\nStill trying to find a fix for Tomcat 7.', 'Mark Thomas', '2012-08-28 22:41:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (473, '53725', '9', 'Created  attachment 29297   [details] \n2012-08-29_tc6_53725.patch\n\nThank you for the test!\n\nFixed in 7.0 with  r1378378 . Will be in 7.0.30.\n\nHere is patch for Tomcat 6 ( r1377343  +  r1378378 ).', 'Konstantin Kolinko', '2012-08-28 23:21:29 UTC', 'tomcat_attachment/attachment 29297.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (474, '53697', '1', 'Without a test case to reproduce the problem there is little the Tomcat developers can do. It looks like multiple threads are acting on the same socket at the same time. What I can\'t tell is if that is intentional, the result of a Tomcat bug or something the frameworks/app is doing.\n\nThe NPE is avoidable in one of the two stack traces provided but I am not yet sure avoiding it is a good thing (depending on the root cause).\n\nI would add that a test case isn\'t essential - the Tomcat developers have made changes in the past for hard to reproduce bugs based purely on the bug reporters analysis of their code, the Tomcat code and what is going wrong where. That said, it is also the case that the Tomcat developers have refused to apply speculative patches that the bug reporter claims fixes the issue that did not come with an explanation of what the bug was and why the patch fixed it.', 'Mark Thomas', '2012-08-11 19:59:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (475, '53697', '2', 'Please find the test case at:\n https://chrislacy.net/downloads/tomcat-bug-53697.tar.gz \n\nSteps:\n- install apr and dependencies\n- compile and install native\n- startup tomcat (./startup.sh)\n- hit  https://localhost:8443/AtmosphereTest \n- hit  http://localhost:8080/AtmosphereTest \n- repeat hits if necessary (usually first round does it, but sometimes\nanother hit to https is needed)\n\nI used firefox and tested on both the server I mentioned and another\ndevelopment box.  A second, related, error that happends ~1/2 of the time, is currently in catalina.out\nand has the pid error file in CATALINA_HOME - copied here:\n\n#\n# A fatal error has been detected by the Java Runtime Environment:\n#\n#  SIGSEGV (0xb) at pc=0x00007fd3840a78d0, pid=28351, tid=140546779842304\n#\n# JRE version: 7.0_05\n# Java VM: OpenJDK 64-Bit Server VM (23.0-b21 mixed mode linux-amd64 compressed oops)\n# Problematic frame:\n# C  0x00007fd3840a78d0\n#\n# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try \'ulimit -c unlimited\' before starting Java again\n#\n# An error report file with more information is saved as:\n# /home/chris/Documents/apache-tomcat-7.0.29/bin/hs_err_pid28351.log\n#\n# If you would like to submit a bug report, please include\n# instructions on how to reproduce the bug and visit:\n#    http://icedtea.classpath.org/bugzilla \n#', 'lacycb', '2012-08-12 21:31:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (476, '53697', '3', ' https://chrislacy.net/downloads/tomcat-bug-53697.tar.gz  returns a 404 reponse\n\nWithout a test case that demonstrates the issue, this is going to get closed as wontfix.', 'Mark Thomas', '2012-08-15 18:31:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (477, '53697', '4', 'Please try again.  Server overhaul yesterday evening took download down.', 'lacycb', '2012-08-15 19:05:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (478, '53697', '5', 'I don\'t think a 43MB download could be classed as a minimal test case.\n\nWhile it is true that having a complete copy of the entire Tomcat directory means we have all the config info we might ever need, normally the WAR would suffice.', 'Mark Thomas', '2012-08-15 20:59:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (479, '53697', '6', 'OK. I can reproduce this now. I\'m not sure how long it will take to track down the root cause.', 'Mark Thomas', '2012-08-15 21:18:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (480, '53654', '1', 'It is hard to understand your description.\n\nPlease provide the following:\n1. Small simple web application that demonstrates the issue.\n2. Step-by-step instructions to reproduce the issue.\nDescribe what you are observing and what you are expecting.', 'Konstantin Kolinko', '2012-08-05 15:11:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (481, '53654', '2', 'Created  attachment 29169   [details] \nhandle file:/\n\nPls review the patch', 'viola.lu', '2012-08-06 09:12:15 UTC', 'tomcat_attachment/attachment 29169.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (482, '53654', '3', 'Now compile only handles taglib jar file as jar:/file:/***.jar!/META-INF/taglib.tld or /WEB-INF/taglib.tld, but if tag lib file exists as expanded folder for example: file:/***.jar/META-INF/taglib.tld, Compiler.isOutDated() will return true and compile jsp always. So provide this patch to make it can handle file:/ URL also', 'viola.lu', '2012-08-06 09:19:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (483, '53545', '1', 'You should not be writing content after a forward. That it works in any circumstances is pure luck.', 'Mark Thomas', '2012-08-01 10:15:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (484, '53545', '2', 'I know that. But jsp:forward action throws IllegalState only when the page is unbuffered. If it\'s buffered, the buffer clears, the forwarding executes and the rest of the page doesn\'t execute.\n\n\nIn the generated java files for classic tags there is a finally block that calls a method that invokes getOutputStream and I think it shouldn\'t. If I use SimpleTag the forward works as it should.\n\n\nQuote from specs:\n\'And as with jsp:forward actions from one JSP page to another, the following statement would clear the page buffer, terminate the execution of the JSP page, and execute the servlet: \n<jsp:forward page=\'/servlet/MyServlet\' />\'\n\n\nI am not writing anything inside doStartTag(), etc. \n\n\nPlease reconsider. I won\'t open the issue again and sorry if I am too insistent.\nThank you.', 'Radu Gancea', '2012-08-01 10:38:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (485, '53545', '3', 'OK. I see what is going on here now. A bug (now fixed) in the custom error page handling wasn\'t helping.\n\nTomcat isn\'t clearing the buffer of the containing page when the forward happens. When Tomcat tries to write that content (after the forward) the ISE happens.\n\nI think I have a fix but I need to do some more testing of the behavior with nested tags before I commit the fix.', 'Mark Thomas', '2012-08-10 22:43:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (486, '53481', '1', 'Created  attachment 29148   [details] \nPatch that adds SSLHonorCipherOrder option\n\nActually, this can be already supported by current tcnative, but it needs to be added to tomcat itself. I\'ve created a patch (should fit both 7.x and 8.x sources). It is compile-tested only. Perhaps it would be a good idea to reassign this bug to a more appropriate project.', 'Marcel Šebek', '2012-08-01 18:01:25 UTC', 'tomcat_attachment/attachment 29148.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (487, '53481', '2', 'I\'m looking at applying this, but I have to check on what SSLContext.setOptions does -- I think the patch will un-set previously-set options when setting SSL_HONOR_CIPHER_ORDER. Once I verify the behavior of SSLContext.setOptions, I\'ll make any necessary adjustments.', 'Christopher Schultz', '2012-08-09 15:33:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (488, '53481', '3', 'Nope, SSL_CTX_set_options (which is what SSLContext.setOptions calls) only flips the bit(s) passed-into it, so the patch is fine.', 'Christopher Schultz', '2012-08-09 16:06:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (489, '53606', '1', 'Sorry:\n\nForget first solution (v1) we cannot set a weak reference.\nNeed to modify sendPing method to check null pointer.\n\nregards\nfred', 'F.Arnoud', '2012-07-26 16:21:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (490, '53606', '2', 'I used this solution:\n\n    protected void sendPing() {\n        TcpFailureDetector tcpFailureDetector = failureDetector!=null ? failureDetector.get() : null;\n        if (tcpFailureDetector!=null) {\n            //we have a reference to the failure detector\n            //piggy back on that dude\n            tcpFailureDetector.checkMembers(true);\n        }else {\n            StaticMembershipInterceptor staticMembershipInterceptor = staticOnly && staticMembers!=null ? staticMembers.get() : null;\n            if (staticMembershipInterceptor!=null) {\n                sendPingMessage(staticMembershipInterceptor.getMembers());\n            } else {\n                sendPingMessage(getMembers());\n            }\n        }\n    }', 'F.Arnoud', '2012-07-26 16:26:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (491, '53606', '3', '(In reply to  comment #2 )\n> I used this solution:\n> \n>     protected void sendPing() {\n>         TcpFailureDetector tcpFailureDetector = failureDetector!=null ?\n> failureDetector.get() : null;\n>         if (tcpFailureDetector!=null) {\n\nThat\'s nice; and better than v2 as it also protects against another possible NPE, i.e.:\n\nfailureDetector.get() can return null (it\'s a WeakReference, so get() can return null at any time).', 'Sebb', '2012-07-26 18:00:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (492, '53606', '4', 'You\'re right, only one access to get() for WeakReference (and brother classes).', 'F.Arnoud', '2012-07-26 18:36:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (493, '53606', '5', 'Fixed in trunk and 7.0.x and will be included in 7.0.30 onwards. Thanks for the patch.', 'Mark Thomas', '2012-07-29 21:52:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (494, '53606', '6', 'Whoops. Re-open for Tomcat 6.', 'Mark Thomas', '2012-07-29 21:54:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (495, '53535', '1', 'Looks like a sensible improvement to me. Can you provide the patch in diff -u format to save me unpicking it please.', 'Mark Thomas', '2012-07-11 18:20:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (496, '53535', '2', 'Created  attachment 29051   [details] \ndiff -u\n\nHere it is!', 'Cedomir Igaly', '2012-07-11 21:38:18 UTC', 'tomcat_attachment/attachment 29051.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (497, '53535', '3', '***  Bug 53615  has been marked as a duplicate of this bug. ***', 'Sergey Grigoriev', '2012-07-28 11:12:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (498, '53469', '1', 'Your relative URL is not valid. The absolute URL will look something like:\n\n http://host:port/something/../../resources/etc \n\nThat relative URL is not valid since you can\'t go up a level once you get to the root of the host.\n\nPrevious versions of Tomcat did not include this check. Tomcat 7.0.28 onwards does.', 'Mark Thomas', '2012-06-27 19:24:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (499, '53469', '2', 'Hi Mark,\n\nI see there is no test case attached and one can only speculate but why do you think that the absolute url will have just \'something\' in the servlet path ?\n\nIt could be \'something/else/here/../../resources/etc\' and in this case it will be OK.\n\nThe reporter filed an issue in Wicket Jira too:  https://issues.apache.org/jira/browse/WICKET-4645  and the pasted urls seem OK to me.\n\n@Jens: can you attach a simple application that demonstrates the failure so it should be easier for Tomcat devs to debug it.', 'mgrigorov', '2012-07-09 12:20:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (500, '53469', '3', 'Because I tested it and included the tests in the Tomcat unit tests\n\n http://host:port/something/../../resources/etc \nfails\n\n http://host:port/soemthing/else/../../resources/etc \nworks', 'Mark Thomas', '2012-07-09 12:41:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (501, '53469', '4', 'OK, thanks!\n\nIn this case I\'ll let the reporter follow up with a test case that demonstrates the problem with the urls provided in Wicket Jira.', 'mgrigorov', '2012-07-09 12:52:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (502, '53469', '5', 'Created  attachment 29043   [details] \nSample app source\n\nAccording to Martin in  https://issues.apache.org/jira/browse/WICKET-4645 \nThis still seems to be a tomcat issue.\n\nSo here\'s a sample app source. I\'ll attach the war as well.', 'Thyzz', '2012-07-09 13:51:05 UTC', 'tomcat_attachment/attachment 29043.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (503, '53469', '6', 'Not allowed to upload the war file.\n\nunzip the zip.\ninside test run: mvn clean package\ndeploy the target/test-1.war to tomcat\nhit it with  http://localhost:8080/test-1 , click the link and everything works \ndo the same with  http://localhost:8080/test-1/testpage/param1/value1 , then click the link and check the tomcat log...', 'Thyzz', '2012-07-09 14:02:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (504, '53469', '7', 'Both the Tomcat access log and Firebug show that the request when clicking on the link displayed on  http://localhost:8080/test-1/testpage/param1/value1  is for:\n\n http://localhost:8080/test-1/?wicket:interface=:9:link::IBehaviorListener:0:2&random=0.9448873634935631 \n\nThe application then attempts to generate a redirect from this page to:\n http://localhost:8080/test-1/../../?wicket:interface=:9 ::::\n\nThat redirect is not valid.', 'Mark Thomas', '2012-07-09 14:39:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (505, '53469', '8', 'The problem lies in the fact that encodeURL rewrites the url to absolute. I think this should only be done in encodeRedirectURL. Wicket also calls encodeURL to encode urls that are rendered in hrefs on the response page. Tomcat rewriting them to absolute breaks this badly. This is best illustrated by an example:\n\nSuppose you are at /a/b and you click a link to /a/b/c/d. This page contains a link to /1/2. Wicket renders all urls relative, so the link to /1/2 will be ../../../1/2 (it is relative to /a/b/c/d). This link will be passed to Response.encodeURL, which rewrites it to /a/../../../1/2, which obviously is wrong and fails.\n\nIf you go the other way: you are at /a/b/c/d and click a link to /a/b, which contains a link to /1/2, things go wrong in a different way. The link to /1/2, relative to /a/b, will be ../1/2. Tomcat will rewrite it to the absolute url /a/b/c/../1/2, which is normalized to /a/b/1/2. However, because I\'ve got cookies enabled, isEncodeable returns false and the unencoded url is returned.', 'papegaaij', '2012-07-17 09:27:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (506, '53469', '9', '(In reply to  comment #8 )\n> The problem lies in the fact that encodeURL rewrites the url to absolute. I\n> think this should only be done in encodeRedirectURL.\n\nThat is a fair point. We\'ll get that addressed for the next release. However...\n\n> Wicket also calls\n> encodeURL to encode urls that are rendered in hrefs on the response page.\n> Tomcat rewriting them to absolute breaks this badly.\n\nThat suggests something else is going on that I\'d like to get to the bottom of.\n\n> Suppose you are at /a/b and you click a link to /a/b/c/d. This page contains\n> a link to /1/2. Wicket renders all urls relative, so the link to /1/2 will\n> be ../../../1/2 (it is relative to /a/b/c/d). This link will be passed to\n> Response.encodeURL, which rewrites it to /a/../../../1/2, which obviously is\n> wrong and fails.\n\nHuh? If you click a link to /a/b/c/d and the response contains a relative link ../../../1/2 then the result should be /a/b/c/../../../1/2 == /1/2 (i.e. relative to the current request). Why does Tomcat/Wicket think it should be relative to the previous request for /a/b ?', 'Mark Thomas', '2012-07-20 20:40:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (507, '53469', '10', '(In reply to  comment #9 )\n> > Suppose you are at /a/b and you click a link to /a/b/c/d. This page contains\n> > a link to /1/2. Wicket renders all urls relative, so the link to /1/2 will\n> > be ../../../1/2 (it is relative to /a/b/c/d). This link will be passed to\n> > Response.encodeURL, which rewrites it to /a/../../../1/2, which obviously is\n> > wrong and fails.\n> \n> Huh? If you click a link to /a/b/c/d and the response contains a relative\n> link ../../../1/2 then the result should be /a/b/c/../../../1/2 == /1/2\n> (i.e. relative to the current request). Why does Tomcat/Wicket think it\n> should be relative to the previous request for /a/b ?\n\nThis has to do with the way Wicket renders links and handles requests. The link on /a/b, might look like ./b?2-1.ILinkListener-link. During processing of this link, user-code can send the user to /a/b/c/d. This causes the page for /a/b/c/d to be rendered as part of the request on /a/b?2-1.ILinkListener-link. The result of this request is a redirect to /a/b/c/d. The GET on this url simply fetches the rendered page from a buffer.', 'papegaaij', '2012-07-23 06:32:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (508, '53469', '11', 'OK. I see what the problem is here. It isn\'t quite as clear cut as  comment #8  suggests.\n\nTo determine if the URL should be encoded, Tomcat attempts the following checks:\na) is it not an intra-document reference\nb) is there a current session\nc) are cookies being used\nd) is URL re-writing permitted\ne) does the absolute URL match down to the context path\n\nThe problem is with check e). Now Tomcat normalizes any absolute URLs (a perfectly valid thing to do) then absolute URLs that fail normalization now fail the encoding process.\n\nNote that prior to the addition of normalization, check e) always passed for any relative URL. That is a bug that has gone unnoticed for many years. (With the addition of mormalization, it is now fixed).\n\nNote also that while Tomcat normalizes the URL for check e) it uses the original URL to construct the returned value.\n\nThe failed normalization is easily caught in Tomcat but it means that any URLs for which normalization fails will not have the session ID encoded in the URL.\n\nThis then comes back to what Wicket is trying to do. From your description, during the generation of the response to /a/b Wicket is pre-generating the content for /a/b/c/d and /a/b/c/d may contain links with relative URLs. It is the encoding of these URLs that is failing since Tomcat believes there are relative to the current request/response for /a/b rather than /a/b/c/d. This does seem a little unusual and not something that was anticipated by either the Tomcat developers or the Servlet EG.\n\nI\'m not sure how to handle this. The Servlet specification does not state that relative URLs passed to encodeURL must be treated as relative to the current request/response but equally, what else could they be relative to? It is more clear cut for sendRedirect since Tomcat is required to return the absolute (and now normalized) URL.\n\nI am tempted to say the Wicket should be wrapping the HttpServletRequest during the generation of /a/b/c/d to return the correct URL and wrapping the HttpServletResponse to link it to the wrapped request although I\'m not sure how well that would go down with the Wicket developers.\n\nAs a minimum, Tomcat needs to be patched to catch a normalization failure and simply not encode the URL in that case.\n\nThoughts, feedback and corrections welcome.', 'Mark Thomas', '2012-07-24 16:47:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (509, '53469', '12', 'In my opinion, Tomcat should not convert relative URLs to absolute in encodeURL. That should only be done in encodeRedirectURL. encodeURL can still perform normalization, as long as it preserves relative URLs. For example, ./a/../b can be normalized to ./b, but it should not be converted into an absolute URL.', 'papegaaij', '2012-07-25 09:07:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (510, '53469', '13', 'I agree with Emond.\nBy Servlet spec (actually the javadoc of javax.servlet.http.HttpServletResponse#sendRedirect) only #sendRedirect() should convert the url from relative to absolute. I think this is the place where URL normalization should happen.\n\nUsing HttpServletRequestWrapper in Wicket in an option but this will solve the problem only in Wicket. Every other framework or plain application may face the same problem.', 'mgrigorov', '2012-07-25 09:15:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (511, '53469', '14', 'Folks, please re-read  comment #11 .\n\nThe output of encodeURL() is not and never will be normalized.\n\nHowever, the Javadoc for encodeURL() allows/requires Tomcat to check if the session needs to be encoded in the provided URL. One of the checks Tomcat uses is whether or not the URL provided to encodeURL() is part of the web application. To do this correctly Tomcat has to construct a absolute, normalized URL to check whether the resulting URL is within the web application. This requires converting relative URLs to absolute and the only basis Tomcat has for doing this is the current request URL.\n\nWicket is doing \'unusual\' things in pre-generating content for a different URL than the current one. This is causing problems for relative URLs. I have yet to find any evidence that any other framework does this. At the moment this looks like a Wicket specific issue.\n\nAs previously stated, I will be changing Tomcat so that if the \'is the URL part of the webapp\' test fails (e.g. because normalization fails) the result will be that the session ID is not added to the URL. That may or may not be sufficient to fix this for Wicket. Some feedback on this would be appreciated.\n\nIn terms of further fixing, I am leaning towards this being a Wicket specific issue (and hence a Wicket problem to fix) but I am open to contrary arguments.', 'Mark Thomas', '2012-07-25 18:02:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (512, '53469', '15', 'Ok, things are getting more clear to me now. Isn\'t it better to assume that relative URLs always fall within the webapplication? The worst thing that could happen, is that a jsessionid gets appended where it was not needed, which I think is better than leave it out in cases where it should have been appended.\n\nThe specification is not clear at this point. For sendRedirect it is: \'If the location is relative without a leading \'/\' the container interprets it as relative to the current request URI.\'. The absence of such a statement in the documentation of encodeURL indicates to me that it is not safe to make the assumption that relative URLs passed to encodeURL are relative to the current request. I think Tomcat should do the best it can without assuming anything that\'s not backed up by the documentation, even if it means that the outcome may be less than perfect.', 'papegaaij', '2012-07-26 07:05:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (513, '53469', '16', 'I have fixed the IAE in trunk and 7.0.x.\n\nI am leaving this open while I wait for clarification from the Servlet EG as to how relative URLs passed to encodeURL should be treated.\n\nSee  http://java.net/jira/browse/SERVLET_SPEC-43 ', 'Mark Thomas', '2012-07-29 20:35:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (514, '53469', '17', '(In reply to  comment #16 )\n> I have fixed the IAE in trunk and 7.0.x.\n> \n> I am leaving this open while I wait for clarification from the Servlet EG as\n> to how relative URLs passed to encodeURL should be treated.\n> \n> See  http://java.net/jira/browse/SERVLET_SPEC-43 \n\nTomcat needs to be patched to catch a normalization failure and simply not encode the URL in that case.\n\nI totally agree with this solution. Has it been so fixed anywhere?\nMy webapplication generated something like this: \n https://localhost:3443/vcbs/../../../../../?wicket:interface=:18 ::::\nwhich absolutely failed the \'within-server-root\' test after normalization.\n\nI look forward to this being patched in Tomcat.', 'wanshoupu', '2012-08-20 22:29:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (515, '53469', '18', '(In reply to  comment #16 )\n> I have fixed the IAE in trunk and 7.0.x.\n\nUnfortunately with this fix apps that work only with jsessionid encoded in the url will still break. If JSESSIONID is in a cookie then all is OK because Tomcat wont even try to normalize in this case. But if Tomcat is configured to always encode it in the url and the normalization fails then with this fix the relative url will not have the jsessionid and next request will be considered as not authenticated and depending on the application configuration it will most probably lead to a redirect to the login page.\n\nUnfortunately I don\'t see how to fix this in Wicket too. There is no way to inform the servlet container that there is a new base url which should be used for the resolving. The only solution is to configure the Wicket application to use REDIRECT_TO_RENDER strategy instead of REDIRECT_TO_BUFFER (the default one). With REDIRECT_TO_RENDER Wicket will make a http redirect before starting the render of the page responsible for /a/b/c/d.', 'mgrigorov', '2012-08-27 08:27:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (516, '53469', '19', 'I think I found the solution. Wicket can pass always an absolute url to the web container for encoding. Wicket knows the current base url and can make it absolute safely. This way the web container will only try to normalize it but this will do nothing since there are no \'../\' in the passed absolute url. After encoding it Wicket can make it relative again and write it in the response.', 'mgrigorov', '2012-08-27 11:55:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (517, '53469', '20', 'Marking as NEEDINFO as I am waiting for a response from the Servlet EG.', 'Mark Thomas', '2012-09-16 18:22:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (518, '53469', '21', 'At our current system we\'re getting the IllegalArgumentException when Tomcat tries to normalize such a relative url for a redirect.\n\njava.lang.IllegalArgumentException\n	at org.apache.catalina.connector.Response.normalize(Response.java:1821)\n	at org.apache.catalina.connector.Response.toAbsolute(Response.java:1741)\n	at org.apache.catalina.connector.Response.encodeRedirectURL(Response.java:1210)\n	at org.apache.catalina.connector.ResponseFacade.encodeRedirectURL(ResponseFacade.java:418)\n	at javax.servlet.http.HttpServletResponseWrapper.encodeRedirectURL(HttpServletResponseWrapper.java:85)\n	at javax.servlet.http.HttpServletResponseWrapper.encodeRedirectURL(HttpServletResponseWrapper.java:85)\n	at org.apache.wicket.protocol.http.WebResponse.redirect(WebResponse.java:210)\n	at org.apache.wicket.protocol.http.BufferedWebResponse.close(BufferedWebResponse.java:67)\n\nDo you think that this is related to this bug or to  bug 53062 ?', 'Tino Kissig', '2012-10-29 13:33:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (519, '53469', '22', 'Wicket has a fix in versions 1.5.9 (not released yet) and 6.1.0.\nWhich version do you use ?', 'mgrigorov', '2012-10-29 13:37:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (520, '53469', '23', '(In reply to  comment #22 )\n> Wicket has a fix in versions 1.5.9 (not released yet) and 6.1.0.\n> Which version do you use ?\n\nUnfortunately we still use 1.4.18 and don\'t have the resources yet to upgrade to 1.5.x or even 6.x.', 'Tino Kissig', '2012-10-29 13:39:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (521, '53513', '1', 'In case it\'s helpful, here\'s the Cluster configuration...fairly basic stuff:\n\n\n        <Cluster className=\'org.apache.catalina.ha.tcp.SimpleTcpCluster\'>\n          <Manager  className=\'my.deltamanager.extension.CustomManager\'\n            expireSessionsOnShutdown=\'false\'\n            notifyListenersOnReplication=\'true\'/>\n\n          <Channel className=\'org.apache.catalina.tribes.group.GroupChannel\'>\n          \n            <Membership className=\'org.apache.catalina.tribes.membership.McastService\'\n                        address=\'239.1.1.1\'\n                        port=\'45564\'\n                        frequency=\'500\'\n                        dropTime=\'3000\'/>\n            <Receiver className=\'org.apache.catalina.tribes.transport.nio.NioReceiver\'\n                      address=\'auto\'\n                      port=\'4000\'\n                      autoBind=\'100\'\n                      selectorTimeout=\'5000\'\n                      maxThreads=\'6\'/>\n\n            <Sender className=\'org.apache.catalina.tribes.transport.ReplicationTransmitter\'>\n              <Transport className=\'org.apache.catalina.tribes.transport.nio.PooledParallelSender\'/>\n            </Sender>\n\n            <Interceptor className=\'org.apache.catalina.tribes.group.interceptors.TcpFailureDetector\'/>\n\n            <Interceptor className=\'org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor\'/>\n\n          </Channel>\n\n          <Valve className=\'org.apache.catalina.ha.tcp.ReplicationValve\'\n                 filter=\' * .page\'/>\n          <Valve className=\'org.apache.catalina.ha.session.JvmRouteBinderValve\'/>\n\n          <ClusterListener className=\'org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener\'/>\n          <ClusterListener className=\'org.apache.catalina.ha.session.ClusterSessionListener\'/>\n\n        </Cluster>', 'David Johle', '2012-07-05 22:25:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (522, '53513', '2', 'Thanks for the report.\n\nI think there is a problem with the behavior of the DeltaManager.\n\nAs you know, DeltaManager is responsible for synchronizing the session on startup.\nA node receiving the EVT_GET_ALL_SESSIONS message is to serialize all session, \nand then sends back a EVT_ALL_SESSION_DATA message.\nAfter completing  EVT_ALL_SESSION_DATA message, sends a EVT_ALL_SESSION_TRANSFERCOMPLETE message.\n\nAt this time, if channelSendOptions is asynchronous(default),\nEVT_ALL_SESSION_DATA message is sent asynchronously.\n\nAs a result, will be a race condition between the processing of the message containing \nthe actual session data and the \'transfer complete\' message.\n\nI\'m going to fix this behavior.\nI intend to make EVT_ALL_SESSION_DATA message always send in synchronous mode.\n\nAnyway the current workaround is to set 6 (sync + ack) to channelSendOptions.\n\nBest Regards.', 'Keiichi Fujino', '2012-07-09 08:00:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (523, '53513', '3', 'Fixed in trunk and 7.0.x and will be included in 7.0.30 onwards.\nProposed for 6.0.x.\n\nNote:\nIn this fix, EVT_ALL_SESSION_DATA message is sent in synchronous mode. \nTherefore, it waits for completion of a the message till Sender#timeout (default 3000 milliseconds). \nWhen timeout occurs while sending the EVT_ALL_SESSION_DATA message, \nyou can configure following attributes. \nSender#timeout\nDeltaManager#sendAllSessions DeltaManager#sendAllSessionsSize \nDeltaManager#sendAllSessionsWaitTime', 'Keiichi Fujino', '2012-07-09 10:49:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (524, '53513', '4', 'Moving to Tomcat 6 since it has been fixed in 7.', 'Mark Thomas', '2012-07-11 18:22:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (525, '52135', '1', 'There is no \'new Servlet 3.0 global error page\' I can find references to in the Servlet 3.0 specification.\n\nTomcat uses error pages with some of the applications that ship with Tomcat and error pages work correctly in those applications.\n\nPlease feel free to re-open this issue but if you do you are going to have to provide a lot more detail else it will simply be re-closed as invalid. You\'ll need to provide the full steps to reproduce this issue on a clean install of the latest Tomcat 7 release. Providing the simplest possible web application (with source code) that demonstrates the issue is one way to do this.', 'Mark Thomas', '2011-11-04 19:41:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (526, '52135', '2', 'The <exception-type> and <error-page> entries are now *optional* by XSD, before either one of them was required.', 'balusc', '2011-11-04 21:01:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (527, '52135', '3', '(where\'s the edit comment link?) Sorry, in the previous comment I meant to say <error-code> instead of <error-page>. Also the figure 14-10 in Servlet 3.0 spec identifies those options with a dotted line which means that they are optional.', 'balusc', '2011-11-04 21:05:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (528, '52135', '4', 'I have tested this on Apache Tomcat/7.0.23\n\nIf I declare following without <error-code> or <exception-type> :\n    <error-page>\n        <location>/error</location>\n    </error-page> \n\nIt does not take effect, i.e. /error does not get invoked when any http error or exception from servlet occurs.\n\nNot sure if this is a valid declaration per servlet 3.0 spec. But if supported it\'s very useful to allow a \'catch-all\' error handler.', 'Sutanu Ghosh', '2012-03-30 19:43:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (529, '52135', '5', 'There is no reference in section 10.9.2 for the behaviour described. That it works in Glassfish does not make it part of the specification. There is no explanation of why those elements are now optional. Nor does section 10.9.2 explain how the case where neither is provided should be handled.', 'Mark Thomas', '2012-03-30 19:53:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (530, '52135', '6', 'Mark, what\'s the process of getting a clarification? This is a useful feature for example in REST-ful web service scenarios where the behavior of ServletResponse.sendError() to send HTML is not desirable:\n\n http://blog.newsplore.com/2010/08/04/restful-error-handling-with-tomcat-springmvc ', 'Rossen Stoyanchev', '2012-03-30 20:13:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (531, '52135', '7', 'The XSD for Servlet 3.0\'s web.xml clearly allows a <error-page> element containing only a <location> sub-element. Older versions of the XSD do not. This is an indication this is a Servlet 3.0 feature.\n\nThis feature is useful. Most REST API implementations need to report unhandled errors the same way: by returning a JSON body containing the error message (reason). Having to define a error-page entry for each error code that may be set by the application via HttpServletResponse#sendError is more work than it should be. Having a single error-page entry for a default error handler is a lot simpler and future proof.\n\nI consider this a bug in Tomcat 7. Shoot me down if you want!', 'Keith Donald', '2012-03-30 20:17:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (532, '52135', '8', 'e-mail the Servlet EG (of which I am a member but only since JSR 340 so I do not have access to the thinking behind the changes in JSR 315).\n\nYou\'ll need to join the JSR-340 users mailing list. See  http://java.net/projects/servlet-spec ', 'Mark Thomas', '2012-03-30 20:19:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (533, '52135', '9', 'There is no bug here since there is no documented behaviour in the specification (nor the Javadoc, nor the XSD) that Tomcat is not implementing.\n\nThe change in the XSD is indicative of something but there is zero clarity on what that might be. The surrounding comment text in the XSD gives no clues. Neither, as I pointed out earlier, does the spec document.\n\nI can see the usefulness of this feature but (absent clarification from the EG) it would be as a Tomcat specific extension. I am therefore moving this to an enhancement request. Enhancement requests with patches tend to get addressed sooner than those with out.', 'Mark Thomas', '2012-03-31 12:39:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (534, '52135', '10', 'Mark, I agree with your assessment. It is an enhancement, and a useful one. The spec itself is, and will remain, fairly limited on feature set, and as Tomcat evolves nothing prevents us from adding usability to the container.', 'Filip Hanik', '2012-04-02 14:36:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (535, '52135', '11', 'Maybe useful to \'is/isn\'t part of Servlet 3.0\' discussion:  https://blogs.oracle.com/arungupta/entry/totd_136_default_error_page \n\nBut no matter if it is \'de iure\' part of spec, this feature is very handy and I hope that will be added soon.', 'Libor Jelinek', '2012-04-13 10:43:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (536, '52135', '12', 'I think this would be a very good thing to have from a security perspective - makes it very easy to reduce the amount of error information that is disclosed by specifying one single error page that handles all errors and returns some generic message.', 'Jens Borgland', '2012-06-19 17:29:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (537, '52135', '13', 'There is a number of circumstantial pieces of evidence that all suggest the Servlet 3.0 EG intended to include this in the 3.0 specification, updated the XSD for web.xml accordingly and then forgot to actually add the feature to the specification document.\n\nI have added support for this to trunk and 7.0.x and it will be included in 7.0.29 onwards.', 'Mark Thomas', '2012-06-30 13:14:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (538, '52135', '14', 'The fix is said to have gone into 7.0.29\n\'I have added support for this to trunk and 7.0.x and it will be included in 7.0.29 onwards.\'\n\nI tested this on 7.0.30.Iam still facing this issue.', 'Shivakumar P', '2012-12-17 08:18:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (539, '53416', '1', 'Created  attachment 29000   [details] \nJMX Registration of two pools\n\nThe name of the JMX bean that gets registered is unique to the web application, so your example must have something else wrong\n\nI\'ve attached an image of what JMX registration looks like when two web applications define an identical data source\n\nIf we examine your object name:\n\ntomcat.jdbc:name=\'jdbc/soscvuk\',context=/,type=ConnectionPool,host=localhost,class=org.apache.tomcat.jdbc.pool\n\nyou can see that it contains the \'context\' and the \'host\' as part of the name. Two web applications can not have the same context.\n\nThere must be something misconfigured in your application.', 'Filip Hanik', '2012-06-26 20:32:59 UTC', 'tomcat_attachment/attachment 29000.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (540, '53416', '2', 'Tested, unable to reproduce.\nPlease reopen with enough information to reproduce the issue, and I will take another look at it.', 'Filip Hanik', '2012-06-26 20:33:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (541, '53416', '3', 'We have two services with one web application in each.  One is for our secure site and one for our non secure.  We use Apache as the ssl endpoint and reverse proxy using ajp connectors.  Both web applications have the root context in their service.  This configuration works and we had no problems with the default connection pooling.  I got the error when switching to the tomcat connection pool.\n\nOur server.xml looks something like\n\n<Server>\n  <Service name=\'Catalina\'>\n    <Engine name=\'Catalina\' defaultHost=\'${host.mainsite.name}\'>\n      <Host name=\'${host.mainsite.name}\' \n            appBase=\'webapps/${host.mainsite.name}\' unpackWARs=\'true\' \n            autoDeploy=\'false\'>\n      </Host>\n    </Engine>\n  </Service>\n\n  <Service name=\'Catalina-Secure\'>\n    <Engine name=\'Catalina-Secure\' defaultHost=\'${host.mainsite.name}\'>\n      <Host name=\'${host.mainsite.name}\' \n          appBase=\'webapps/${host.mainsite.name}-ssl\' unpackWARs=\'true\' \n          autoDeploy=\'false\'>\n      </Host>\n    </Engine>\n  </Service>\n</Server>\n\nI\'ve subsequently worked around this using <ResourceLink /> which I think is more appropriate for our set-up anyway.  However I still think this is a bug.', 'Anthony Gerrard', '2012-06-26 21:05:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (542, '53416', '4', 'Use of multiple versions of a web application may also trigger the issue (I haven\'t tested it).', 'Mark Thomas', '2012-06-26 21:12:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (543, '53416', '5', 'Roger, I will fix this.', 'Filip Hanik', '2012-06-27 17:20:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (544, '53416', '6', '(In reply to  comment #4 )\n> Use of multiple versions of a web application may also trigger the issue (I\n> haven\'t tested it).\n\nThat wont be issue, as the ObjectName will have something like context=/test##001 instead of context=/test\n\nthe problem we encountered here is that the JNDI names in tomcat 6 would have path=/test whereas 7 has context=/test', 'Filip Hanik', '2012-06-27 17:32:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (545, '53406', '1', 'The following are remarkable points in this stacktrace:\n\n> org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n> org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n\nNioEndpoint$Poller.add(NioChannel socket, int interestOps):\n[[[\n            if (close) {\n                processSocket(socket, SocketStatus.STOP, false);\n            }\n]]]\n\n> org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n\n[[[\n            } else {\n                //...\n                socket.getSocket().getPoller().add(socket.getSocket());\n]]]\n\nso this happens with an application that uses Comet (those event() calls), when longPoll() is processed, but endpoint is being closed at the same time.\n\nIt looks like SocketStatus.STOP value is not being honored. The poller#close flag is inaccessible from outside.', 'Konstantin Kolinko', '2012-06-13 07:08:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (546, '53406', '2', 'Thanks for the analysis.\n\nHere is what I think will fix it\n\nIndex: java/org/apache/coyote/http11/Http11NioProcessor.java\n===================================================================\n--- java/org/apache/coyote/http11/Http11NioProcessor.java       ( revision 1349898 )\n+++ java/org/apache/coyote/http11/Http11NioProcessor.java       (working copy)\n@@ -155,7 +155,7 @@\n\n         rp.setStage(org.apache.coyote.Constants.STAGE_ENDED);\n\n-        if (error) {\n+        if (error || status==SocketStatus.STOP) {\n             return SocketState.CLOSED;\n         } else if (!comet) {\n             if (keepAlive) {\n\nWhat this does, is that it prevents reuse of connections after a Comet transaction has been notified of a STOP event.', 'Filip Hanik', '2012-06-13 15:35:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (547, '53406', '3', 'I was thinking along the same lines but fixing it in the Adaptor rather than just for NIO. The issue with my fix is that it somewhat abused the error flag (by changing it\'s meaning to mean \'close the connection for any reason\' rather than \'something went wrong\'.\n\nYour fix is clearer as to intention but it needs to be made to APR too. I\'ll so that now unless you beat me to it.', 'Mark Thomas', '2012-06-13 15:45:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (548, '53374', '1', 'Created  attachment 28897   [details] \nPatch for the fix.\n\nAttaching the patch for the fix to support commitOnReturn in DataSourceFactory.', 'Suresh Avadhanula', '2012-06-06 21:01:53 UTC', 'tomcat_attachment/attachment 28897.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (549, '53374', '2', 'Comment on  attachment 28897   [details] \nPatch for the fix.\n\nYou patch includes a lot of formatting changes. This is a no-go. Please include only changes relevant to your fix.\n\nThose seem to be\n\n-        PROP_ALTERNATE_USERNAME_ALLOWED\n+            PROP_ALTERNATE_USERNAME_ALLOWED,\n+            PROP_COMMIT_ON_RETURN\n\nand\n\n+        value = properties.getProperty(PROP_COMMIT_ON_RETURN);\n+        if (value != null) {\n+            poolProperties.setCommitOnReturn(Boolean.parseBoolean(value));\n+        }\n+', 'Konstantin Kolinko', '2012-06-06 21:37:52 UTC', 'tomcat_attachment/attachment 28897.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (550, '53374', '3', 'Created  attachment 28898   [details] \nCleaned up Patch for the fix\n\nCleaned up the formatting changes. Including only the relevant changes.', 'Suresh Avadhanula', '2012-06-06 22:11:11 UTC', 'tomcat_attachment/attachment 28898.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (551, '53367', '1', 'Fixed in  r1346691 ', 'Filip Hanik', '2012-06-06 01:03:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (552, '53367', '2', 'I don\'t believe this is fixed.  Pulled down from svn trunk, buit, and can still easily reproduce.', 'monteslu', '2012-07-07 16:55:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (553, '53367', '3', 'I\'ll take a look today', 'Filip Hanik', '2012-07-09 15:55:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (554, '53367', '4', 'Please post your configuration. Reran all tests and I\'m unable to reproduce this issue.', 'Filip Hanik', '2012-07-09 16:22:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (555, '53367', '5', 'Unable to reproduce after ticket has been reopened. Please reopen with at a minimum your configuration.', 'Filip Hanik', '2012-07-09 17:43:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (556, '53367', '6', 'I\'m able to reproduce the error on tomact 7.0.37\n\nException: [http-bio-8080-exec-41] Timeout: Pool empty. Unable to fetch a connection in 30 seconds, none available[size:120; busy:119; idle:0; lastwait:30000].\nException: [http-bio-8080-exec-33] Timeout: Pool empty. Unable to fetch a connection in 30 seconds, none available[size:120; busy:119; idle:0; lastwait:30000].\nException: [http-bio-8080-exec-3] Timeout: Pool empty. Unable to fetch a connection in 30 seconds, none available[size:120; busy:119; idle:0; lastwait:30000].', 'Avinash', '2014-03-20 06:45:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (557, '53367', '7', 'How about Tomcat 7.0.52 -- the latest?\n\nAlso, you haven\'t provided any indication that this is a problem with the pool... it could just be misuse of the pool. You\'ll need configuration, thread dumps, etc. to justify reopening this bug.', 'Christopher Schultz', '2014-03-20 19:14:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (558, '53367', '8', 'I think you may experience a different scenario here, than the actual bug reported.\n http://svn.apache.org/viewvc/tomcat/tc7.0.x/trunk/modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java?view=markup \n\nLine\nthrow new PoolExhaustedException(\'[\' + Thread.currentThread().getName()+\'] \' +\n                        \'Timeout: Pool empty. Unable to fetch a connection in \' + (maxWait / 1000) +\n                        \' seconds, none available[size:\'+size.get() +\'; busy:\'+busy.size()+\'; idle:\'+idle.size()+\'; lastwait:\'+timetowait+\'].\');\n\nThe statement\n  busy.size()\nis not just a counter, it actually measures the number of connections that are placed in the busy queue.\n\nHere is what I would do\n\n1. set logAbandoned=\'true\'\n//this will print a log entry of places in your code that are leaking connections (ie failing to call Connection.close())\n\nWith the log output from 1, we should be able to resolve all your problems.', 'Filip Hanik', '2014-03-21 14:29:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (559, '53367', '9', 'Created  attachment 31838   [details] \nTest demonstrating jdbc-pool connection leakage\n\nI wrote a test which demonstrates how connections can be leaked. To execute the test you need MySQL server running on port 3306.', 'Anton', '2014-07-22 01:36:19 UTC', 'tomcat_attachment/attachment 31838.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (560, '53367', '10', 'Created  attachment 31840   [details] \nUnit test demonstrating fair queue not working properly\n\nThis tests correctly fails (assertion fails) when it is supposed to properly show the bug.', 'Filip Hanik', '2014-07-22 09:56:36 UTC', 'tomcat_attachment/attachment 31840.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (561, '53367', '11', '(In reply to Anton from  comment #9 )\n> Created  attachment 31838   [details] \n> Test demonstrating jdbc-pool connection leakage\n> \n> I wrote a test which demonstrates how connections can be leaked. To execute\n> the test you need MySQL server running on port 3306.\n\nAnton, thank you for your test. I do confirm the bug you are seeing.\nHere is what I got\n\n1. work around is to set poolProperties.setFairQueue(false)\n2. I did modify the test to properly fail on assertion to demonstrate the actual bug\n\nI will get this fixed.', 'Filip Hanik', '2014-07-22 09:57:54 UTC', 'tomcat_attachment/attachment 31838.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (562, '53367', '12', 'Great, thank you!', 'Anton', '2014-07-22 16:40:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (563, '53367', '13', 'Fixed in trunk at  r1613123 ', 'Filip Hanik', '2014-07-24 13:44:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (564, '53032', '1', 'Relevant to 53011, 53012, 53031 and 53032: Per discussions with Chris Schultz in the users list, we agree that it would probably make more sense to separate the Ant task from the JspC class and place a new Ant task in the o.a.catalina.ant package (possibly o.a.catalina.ant.jasper?). Research about the state of the task needs to be completed. Further discussions about this will take place in the developer\'s list, and then these issues will be updated when a consensus is reached.', 'Nick Williams', '2012-04-03 22:07:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (565, '53032', '2', 'Since JspC is the only Tomcat Ant task that doesn\'t work with namespaces, and JspC is also the only Tomcat Ant task that /doesn\'t/ extend o.a.tools.ant.Task, it seems likely that is the culprit. I don\'t know this for sure, but from my initial examination of all of the code involved, it appears that is the case.\n\nJspC doesn\'t extend or implement /any/ Ant classes. As far as Ant goes, it appears to purely be a hacked-together class that just happens to implement the minimum methods that Ant expects a task to implement, and this can run as a task. But it is not, as for as Ant is concerned, an actual Task. It seems very unlikely that something other than this fact is causing this issue.', 'Nick Williams', '2012-04-04 15:18:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (566, '53032', '3', 'Confirmed. Extending Task does fix this.\n\nI\'m not convinced that it makes sense to separate the Ant task and JspC. While the current approach isn\'t the one I\'d select if starting from a clean sheet, I don\'t see a compelling argument to change it now.\n\nFixed in trunk and 7.0.x and will be included in 7.0.28 onwards.\n\nProposed for 6.0.x', 'Mark Thomas', '2012-06-05 23:02:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (567, '53337', '1', 'Created  attachment 28866   [details] \n.war demonstrating the issue', 'Rossen Stoyanchev', '2012-05-31 17:07:59 UTC', 'tomcat_attachment/attachment 28866');
INSERT INTO `tomcatbeforefixcomments` VALUES (568, '53337', '2', 'By the way, in the description above I only meant to refer to the methods asyncContext.dispatch and request.getRequestDispatcher. I am not actually passing \'\'. See the link to the source code for full details.', 'Rossen Stoyanchev', '2012-06-01 00:19:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (569, '53337', '3', 'Created  attachment 28873   [details] \nUpdated .war file', 'Rossen Stoyanchev', '2012-06-01 14:44:05 UTC', 'tomcat_attachment/attachment 28873');
INSERT INTO `tomcatbeforefixcomments` VALUES (570, '53337', '4', 'Created  attachment 28874   [details] \nUpdated .war file', 'Rossen Stoyanchev', '2012-06-01 14:44:40 UTC', 'tomcat_attachment/attachment 28874');
INSERT INTO `tomcatbeforefixcomments` VALUES (571, '53337', '5', 'I corrected one issue with the sample. Calling ServletB succeeds in all cases. Calling ServletA doesn\'t. I updated the instructions at the project page and updated the .war attachment.', 'Rossen Stoyanchev', '2012-06-01 14:46:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (572, '53301', '1', 'This is user error. Use the users mailing list to debug.', 'Mark Thomas', '2012-05-26 22:30:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (573, '53301', '2', 'Don\'t understand why you claim it is a user error', 'Jeff MAURY', '2012-05-27 19:17:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (574, '53301', '3', '> Don\'t understand why you claim it is a user error\n\nIt is your responsibility to provide enough details to prove and reproduce the issue. Your report is lacking and there are several statements in it that appear to be based on false assumptions.\n\nYou should ask for help on the users list to better diagnose your problem. Bugzilla is not a support forum.\n\nFYI:\n1. tomcat7:run uses embedded Tomcat \n2. init() can be called as many times as many instances of a Servlet are there', 'Konstantin Kolinko', '2012-05-28 11:35:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (575, '53301', '4', 'Sorry, but the intent was not to get support but rather to signal the Tomcat community of the problem.\nI agree I should have given more materials about the problem: so you should find now a sample Maven project that demonstrate the problem. Just run \'mvn test\' and you should get the error.\nThis has been tested against 7.0.27, 7.0.26 and 7.0.25 (using the tomcatVersion property)', 'Jeff MAURY', '2012-05-28 19:25:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (576, '53301', '5', 'Created  attachment 28844   [details] \nSample Maven project with a test', 'Jeff MAURY', '2012-05-28 19:26:13 UTC', 'tomcat_attachment/attachment 28844.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (577, '53301', '6', 'Ok. Reproducible.\n\nI modified your SampleServlet to print stacktrace when init() is called, like this:\n[[[\n    @Override\n    public void init( ServletConfig config )\n        throws ServletException\n    {\n        log.info( \'Init called, config=\'+config, new Throwable() );\n        super.init( config );\n...\n]]]\n\nI\'ll attach full source later. There are two calls to init() in a row and stack traces are the following:\n[[[\n00:58:32.187 [main] INFO  init - Tomcat started on port:4396\n00:58:32.609 [http-bio-auto-1-exec-1] INFO  init - Init called, config=org.apache.catalina.core.StandardWrapperFacade@15e2075\njava.lang.Throwable: null\n at org.apache.tomcat.tomcat53301.SampleServlet.init(SampleServlet.java:43) [classes/:na]\n at org.apache.catalina.startup.Tomcat$ExistingStandardWrapper.loadServlet(Tomcat.java:854) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:857) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:136) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [na:1.6.0_32]\n at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [na:1.6.0_32]\n at java.lang.Thread.run(Thread.java:662) [na:1.6.0_32]\n00:58:32.625 [http-bio-auto-1-exec-1] INFO  init - Init called, config=org.apache.catalina.core.StandardWrapperFacade@15e2075\njava.lang.Throwable: null\n at org.apache.tomcat.tomcat53301.SampleServlet.init(SampleServlet.java:43) [classes/:na]\n at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:877) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:136) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [na:1.6.0_32]\n at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [na:1.6.0_32]\n at java.lang.Thread.run(Thread.java:662) [na:1.6.0_32]\n]]]\n\nEssentially it is the same single call to\norg.apache.catalina.core.StandardWrapper.allocate()\nand it calls init() twice with the following stack traces\na)\n[[[\n at org.apache.tomcat.tomcat53301.SampleServlet.init(SampleServlet.java:43) [classes/:na]\n at org.apache.catalina.startup.Tomcat$ExistingStandardWrapper.loadServlet(Tomcat.java:854) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:857) [tomcat-embed-core-7.0.27.jar:7.0.27]\n]]]\nb)\n[[[\n at org.apache.tomcat.tomcat53301.SampleServlet.init(SampleServlet.java:43) [classes/:na]\n at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266) [tomcat-embed-core-7.0.27.jar:7.0.27]\n at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:877) [tomcat-embed-core-7.0.27.jar:7.0.27]\n]]]\n\nThe second call happens because StandardWrapper#instanceInitialized flag is still false, but init() has already been called by Tomcat$ExistingStandardWrapper.loadServlet().\n\nSo either Tomcat$ExistingStandardWrapper should not call init(), or it should update the flag when doing so.', 'Konstantin Kolinko', '2012-05-28 21:13:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (578, '53301', '7', 'Created  attachment 28845   [details] \nSampleServlet.java\n\nSampleServlet.java update.\nAdded stackstace printing in init(). Overwrote destroy().', 'Konstantin Kolinko', '2012-05-28 21:15:20 UTC', 'tomcat_attachment/attachment 28845.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (579, '53074', '1', 'Must we set the timeout to unlimited, or you thing it is better that client can overwrite it?', 'Peter Rossbach', '2012-04-14 12:31:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (580, '53074', '2', 'Salut,\n\nI think it should be unlimited, but an idle timeout setting would be useful (I do support idle timeout with Atmosphere, but I think Tomcat could support the same as well).\n\nIf you want to test using Atmosphere, download atmosphere-spring-websocket.war from search.maven.org (remove the -0.9 in the name) and deploy. After 20 seconds the app will stop working and Chrome will display a protocol exception. Ping me directly if that can help.\n\nThanks!\n\n-- Jeanfrancois', 'Jean-Francois Arcand', '2012-04-14 13:16:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (581, '53074', '3', 'I\'ve been thinking about this and I think the following is the way to go.\n\n1. Make the connection timeout infinite.\n2. Add an idle timeout to the WebSocket implementation (defaults to infinite) that times out if there is no input or output after a predefined amount of time. This should be configurable per connection.\n3. Add a \'ping every n milliseconds\' feature (disabled by default) to save applications re-inventing the wheel.\n\nThoughts?\n\nAs an aside, 1) will be tricky with the APR/native connector. That needs some separate work. I\'ll start a thread on that on the dev list.', 'Mark Thomas', '2012-05-15 08:18:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (582, '53074', '4', 'Hi Mark,\n\n+1 for making the connection timeout infinite. +1 also to add support for websocket timeout property/attribute (will be really useful). \n\nNot sure for the ping ... some applications don\'t need ping or that extra traffic on the wire. At least this should be configurable.\n\nThanks for the work.\n\n-- Jeanfrancois', 'Jean-Francois Arcand', '2012-05-15 14:12:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (583, '53074', '5', 'Hi,\n\n+1 here for the option of configuring the timeout. My application requires an infinite connection which will be closed when required. I was negatively suprised to see tomcat has such a short timeout option.\n\nplease add an option to configure this at the very least.\n\n\nmeanwhile is there a workaround other than constant client reconnection?\n\nthanks', 'huck', '2012-05-20 13:43:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (584, '53074', '6', 'Just a short progress update.\n\nI have committed a set of changes to the APR/native connector to permit per socket timeouts. It works with my simple tests but needs more testing and review by some proper C coders (which I am not).\n\nI also have a first draft of the changes to trunk to enable infinite timeouts for WebSocket connections. That also needs some testing. I should have something to commit in the next couple of days.', 'Mark Thomas', '2012-05-23 21:15:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (585, '53074', '7', 'Fixed in trunk. Will be back-ported to 7.0.x once there has been a new release of the APR/native connector.', 'Mark Thomas', '2012-05-25 16:40:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (586, '53074', '8', 'Ok thanks! I will go ahead and test using trunk. Will report if I see any issues.', 'Jean-Francois Arcand', '2012-05-25 16:45:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (587, '50864', '1', 'To note in this context is also the fact that currently (Tomcat JDBC Connection Pool 1.1.0.0) several setter-methods in org.apache.tomcat.jdbc.pool.jmx.ConnectionPools\nhave an empty body.\n\nAs long as they are not implemented it is better to remove them (the settermethods, not the getter-methods) from the mbean interface, otherwise the user believes to can change these values, but in truth the changes are not considered at all.', 'guenther', '2012-02-13 16:06:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (588, '50864', '2', 'We also ran into this issue recently. For example, it would be very useful to increase max size of the pool without restarting the server.\n\nIs there a traction on this? Would it help if we submit a patch?', 'Raja', '2012-04-02 23:14:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (589, '50864', '3', 'you got it, changes are underway', 'Filip Hanik', '2012-04-05 17:57:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (590, '53001', '1', 'Tomcat is no longer following the EL spec.\n\nThe behaviour prior to the fix for  bug 46915  was correct.\n\nI\'m not sure it is possible to fix  bug 46915  and be specification compliant.\n\nI\'ll revert the fix for  bug 46915 , put together some test cases and see what I can come up with. Depending on how well things go,  bug 46915  will either stay as FIXED or be changed to INVALID.', 'Mark Thomas', '2012-03-30 09:37:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (591, '53001', '2', 'Thanks for the quick reply. I did not check the spec so wasn\'t aware that the current behaviour actually violates the el specs. Why was the fix for  bug 46915  done in the first place? Did the specs change from then to now? Anyways, keep up the good work. Tomcat is an impressive and very reliable product.', 'b.diedrichsen', '2012-03-30 10:09:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (592, '53001', '3', 'No change in the spec. I failed to check the EL spec before I fixed  bug 46915 . If I had, that would have been resolved as INVALID. It looks like EL 2.2 (Tomcat 7) has some new features that would allow the requirement in  bug 46915  to be met. Time to write some unit tests.', 'Mark Thomas', '2012-03-30 15:23:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (593, '53001', '4', 'Fixed in trunk and 7.0.x and will be included in 7.0.27 onwards.\n\nThe fixed has been proposed for 6.0.x.', 'Mark Thomas', '2012-03-30 16:35:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (594, '53001', '5', 'Thank you Mark,\nthis was really a quick resolution of the issue.', 'b.diedrichsen', '2012-03-30 18:09:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (595, '52833', '1', 'Created  attachment 28422   [details] \nattach a patch for review\n\nsimply adding a NPE check.', 'olamy', '2012-03-05 23:45:50 UTC', 'tomcat_attachment/attachment 28422.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (596, '52833', '2', 'Hmm. I\'m failing to understand how the StandardServer ends up with a parent class loader that is not a child of the system class loader.\n\nAt the moment this looks like a configuration error and I am leaning towards resolving this as INVALID.', 'Mark Thomas', '2012-03-06 14:21:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (597, '52833', '3', 'see  http://svn.apache.org/viewvc/tomcat/maven-plugin/trunk/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/AbstractRunMojo.java?revision=1297073&view=markup  line 674.\nBTW works fine with 7.0.25.', 'olamy', '2012-03-06 14:28:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (598, '52833', '4', 'I\'m not exactly sure what is going on here as I can\'t repeat this with a simple test case. However, it does appear that  r1242101  is the root cause.\n\nI can only repeat this is I set Catalina\'s parent class loader to null. I guess that is what the plug-in code is doing somewhere and while in the past it has got away with it, as a result of  r1242101  it is now failing.\n\nI\'m having a hard time coming up with a valid reason for setting the parent class loader to null. I am therefore leaning towards INVALID for this, although I\'m not adverse to adding a null check to setParentClassLoader() and throwing an IAE if null is passed in to make this easier to debug.', 'Mark Thomas', '2012-03-09 15:09:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (599, '52833', '5', 'Without any further input, this is going to get resolved as INVALID prior to the 7.0.27 release.', 'Mark Thomas', '2012-03-14 15:08:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (600, '52833', '6', 'Sorry didn\'t have time to do more testing. \nI will try to find change something to make that work again with version 7.0.26.\nBTW what prevent you to do a simple null check in the code ?', 'olamy', '2012-03-14 22:14:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (601, '52833', '7', 'I\'m against the patch proposed since that addresses the symptom rather than the cause. I\'m not against added a null check that throws an IAE at the point where the parent class loader is set to null, if you (as the user) would find that useful. However, if you don\'t think it would be useful, there isn\'t much point me adding it :)\n\nAll of this assumes that something in your code is setting the parent class loader to null. If the root cause is something else then all bets are off and we\'ll have to look at this aginan.', 'Mark Thomas', '2012-03-15 09:10:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (602, '52833', '8', 'What I don\'t understand is why in the parent classLoader chain having SystemClassLoader is mandatory!\nThat\'s what the current code assume. Frankly I don\'t understand why you consider that mandatory. In some env especially osgi it\'s not!. \nThe patch just prevent a NPE in case of SystemClassLoader is not in the parent classLoader chain.\nWhy that could not be a valid use case ?', 'olamy', '2012-03-17 22:06:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (603, '52833', '9', '(In reply to  comment #8 )\n> What I don\'t understand is why in the parent classLoader chain having\n> SystemClassLoader is mandatory!\n\nOK.\n\n> That\'s what the current code assume.\n\nI know.\n\n> Frankly I don\'t understand why you consider that mandatory.\n\nI don\'t. The original developers of Tomcat did. While I can make some educated guesses why this was done based on the Servlet and J2EE specifications I can\'t be sure. However, since it is an assumptions that appears in multiple places across the code base I am very reluctant to change it without fully understanding the impacts that might have.\n\n> In some env especially osgi it\'s not!.\n\nOK.\n \n> The patch just prevent a NPE in case of SystemClassLoader is not in the parent\n> classLoader chain.\n\nNo, that patch addresses that particular symptom in one place in the code. As I stated previously, it is the root cause I am interested in fixing rather than one particular symptom.\n\n> Why that could not be a valid use case ?\n\nAs I stated previously, I\'m having a hard time coming up with a valid reason for setting the parent class loader to null.\n\nHaving looked more widely at this issue, it is clear that the implementation of Catalina#getParentClassLoader() is not consistent with other implementations. I\'ll get that fixed shortly. Depending on what you are doing (which you have yet to be clear about) that may resolve the problem you are seeing.\n\nIt would be helpful if you could identify which of the following cases is triggering this problem:\na) calling Catalina.setParentClassLoader() and passing null\nb) calling Catalina.setParentClassLoader() and passing a class loader that does not have the system class loader as an ancestor\nc) Something else.\n\nIf a) or b) any further details of why this is being done would be helpful.\nIf c) you\'ll need to provide details.', 'Mark Thomas', '2012-03-19 20:43:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (604, '52833', '10', '>It would be helpful if you could identify which of the following cases is\n>triggering this problem:\n>a) calling Catalina.setParentClassLoader() and passing null\n>b) calling Catalina.setParentClassLoader() and passing a class loader that does\n>not have the system class loader as an ancestor\n>c) Something else.\n\nhappen for b).\nThe c) case is not using setParentClassLoader(). I discovered my trouble using this.\nBTW I saw your commit which should fix (not tested yet)', 'olamy', '2012-03-19 21:40:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (605, '52833', '11', 'Maybe (In reply to  comment #0 )\n> Upgrading the maven plugin 7.0.26, the goal which runs tomcat with a conf dir\n> (not the embed version) generate the following NPE \n> Log:\n>     at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:236)\n\n1. Where is \'Caused by\' and its stacktrace?\n\nLine 236 wraps other exception and rethrows it, but you are not saying what it is and where it comes from.\n\n2. This LifecycleBase.stop() is called from LifecycleBase.start() on line 141 which is unusual and happens only if the component is already in the state of FAILED.\n\nThus there must be some preceding messages in the logs.', 'Konstantin Kolinko', '2012-03-20 14:40:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (606, '52833', '12', '20 mars 2012 15:55:11 org.apache.catalina.startup.Catalina load\nGRAVE: Catalina.start\norg.apache.catalina.LifecycleException: Failed to initialize component [StandardServer[2008]]\n	at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:106)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:594)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:633)\n	at org.apache.tomcat.maven.plugin.tomcat7.run.AbstractRunMojo.startContainer(AbstractRunMojo.java:684)\n	at org.apache.tomcat.maven.plugin.tomcat7.run.AbstractRunMojo.execute(AbstractRunMojo.java:372)\n	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)\n	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)\n	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)\n	at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)\n	at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)\n	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)\n	at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)\n	at org.apache.maven.cli.MavenCli.execute(MavenCli.java:544)\n	at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:197)\n	at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)\nCaused by: java.lang.NullPointerException\n	at org.apache.catalina.core.StandardServer.initInternal(StandardServer.java:810)\n	at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)\n	... 25 more\n20 mars 2012 15:55:11 org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 681 ms\n20 mars 2012 15:55:11 org.apache.catalina.startup.Catalina start\nGRAVE: Catalina.start: \norg.apache.catalina.LifecycleException: Failed to stop component [StandardServer[2008]]\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:236)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:141)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:645)\n	at org.apache.tomcat.maven.plugin.tomcat7.run.AbstractRunMojo.startContainer(AbstractRunMojo.java:684)\n	at org.apache.tomcat.maven.plugin.tomcat7.run.AbstractRunMojo.execute(AbstractRunMojo.java:372)\n	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)\n	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)\n	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)\n	at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)\n	at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)\n	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)\n	at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)\n	at org.apache.maven.cli.MavenCli.execute(MavenCli.java:544)\n	at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:197)\n	at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)\nCaused by: org.apache.catalina.LifecycleException: An invalid Lifecycle transition was attempted ([before_stop]) for component [org.apache.catalina.deploy.NamingResources@7f1f91ac] in state [INITIALIZED]\n	at org.apache.catalina.util.LifecycleBase.invalidTransition(LifecycleBase.java:408)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:219)\n	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:756)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\n	... 25 more', 'olamy', '2012-03-20 14:57:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (607, '52833', '13', '(In reply to  comment #8 )\n(In reply to  comment #9 )\n\nAbstractRunMojo#startContainer() creates a \'new Catalina()\'. I do not see it ever calling setParentClassLoader() and Catalina#parentClassLoader defaults to its own classloader.\n\nIs Catalina.class.getClassLoader() the one that does not have system CL in its parents chain?\n\n\n> What I don\'t understand is why in the parent classLoader chain having\n> SystemClassLoader is mandatory!\n\n\nAnyway as far as WebappClassLoader class goes\n\n1) It has to follow its documentation, [1] in 7.0 and in more details in 5.5, where shared class loader was actually used. There is lookup sequence,\n\n\'Therefore, from the perspective of a web application, class or resource loading looks in the following repositories, in this order: (...)\' - see [1]\n\n[1]  http://tomcat.apache.org/tomcat-7.0-doc/class-loader-howto.html \n\n\n2) WebappClassLoader has its own explicit call to getSystemClassLoader() and treats the system class loader specially and separately from its parent, to follow its specific delegating pattern of calling\n A system CL\n B webapp CL\n C parent CL.\n\nTherefore for the WebappClassLoader class it does not matter where its \'parent CL\' is rooted. It does not impact its behaviour.\n\nSo using shared CL that does not have system CL as a parent does not seriously impact Tomcat.\n\nI do not mind a (cl != null) check to be added in the loop in  r1242101 .\n\n\nIt seems that the code in  r1242101  is the first one that actually looks into the shared classloader and is outside of a webapp. Such work is usually scoped to the web application. The shared CL is actually used in\nWebappLoader#createClassLoader().\n\nSee also my comments in \'Re: r1242101\' on dev@.\n http://markmail.org/message/rgd7tzz5zks6l5wn \n\n(In reply to  comment #12 )\n> \n> Caused by: org.apache.catalina.LifecycleException: An invalid Lifecycle\n> transition was attempted ([before_stop]) for component\n> [org.apache.catalina.deploy.NamingResources@7f1f91ac] in state [INITIALIZED]\n\nInteresting... A small issue though. It tries to stop a component that has not been started?', 'Konstantin Kolinko', '2012-03-20 16:53:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (608, '52066', '1', '1. Thread.interrupted() - clears the flag\n2. new SQLException() - bails out\n\nIt does sx.initCause(ex), so original InterruptedException is still there.\n\nDo you have trouble dealing with this SQLException?\n\nWhether you should follow the advise from the book depends on why the interruption was requested. I do not see any problem here.', 'Konstantin Kolinko', '2011-10-26 14:13:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (609, '52066', '2', '(In reply to  comment #1 )\n\nThere may be quite a few clients down the call chain that require the knowledge that interrupt is in progress, and clearing of the interrupted flag destroys this knowledge.\n\nIt is semantically very similar to the olden days practice of swallowing exception in the library code, e.g.\n\ntry\n{\n   doSomethingRisky( );\n}\ncatch ( Throwable ex )\n{\n}\n\nPlus, it\'s not OK for the general user of the library to depend on your specific wrapper of InterruptedException into the SQLException.  A user can switch to another implementation of connection pool and that particular library reporting policy may not be the same as this library\'s. \n\nThe right thing to do is to preserve the thread interruption status by calling Thread.currentThread( ).interrupt( ), and let the client code deal with it.\n\nBTW, setting InterruptedException as a cause of SQLException is a GOOD THING, I don\'t want you to change that.', 'Alexander Pogrebnyak', '2011-10-26 14:31:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (610, '52066', '3', '(In reply to  comment #2 )\n> (In reply to  comment #1 )\n> \n\n> \n> Plus, it\'s not OK for the general user of the library to depend on your\n> specific wrapper of InterruptedException into the SQLException.  A user can\n> switch to another implementation of connection pool and that particular library\n> reporting policy may not be the same as this library\'s. \n\nI am not sure I agree with this. The user has not invoked an \'interruptable\' action, the user invoked DataSource.getConnection\n http://docs.oracle.com/javase/6/docs/api/javax/sql/DataSource.html#getConnection ()\nThis call says nothing about interruption nor does it declare it.\n\nIt is a totally different call than poll(...)\n http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html#poll%28long,%20java.util.concurrent.TimeUnit%29 \n\n> \n> The right thing to do is to preserve the thread interruption status by calling\n> Thread.currentThread( ).interrupt( ), and let the client code deal with it.\n\nThe reason an interrupt here would happen is cause we want to interrupt the call to queue.poll, to the user, they need to be notified that their call will fail using a SQLException. \n\n> \n> BTW, setting InterruptedException as a cause of SQLException is a GOOD THING, I\n> don\'t want you to change that.\n\nWe do specify the root cause for troubleshooting reasons. If we don\'t clear the flag, the thread can continue to run with a interrupted status, and I\'m not sure that is a good thing.\n\nFeel free to reopen with a use case that may change the course of this resolution.', 'Filip Hanik', '2012-03-20 16:32:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (611, '52066', '4', '(In reply to  comment #3 )\n \n> The reason an interrupt here would happen is cause WE want to interrupt the\n> call to queue.poll, to the user, they need to be notified that their call will\n> fail using a SQLException. \n> \n\nI capitalized WE in the above quote to highlight the wrong approach to this problem.\n\nYOU, the tomcat-jdbc, would never interrupt a thread that is stuck in a `borrowConnection`.  This action can only be done by the user of your library.\n\n> If we don\'t clear the\n> flag, the thread can continue to run with a interrupted status, and I\'m not\n> sure that is a good thing.\n\nit IS a good thing, because, once again, your library should never initiate the interruption, and if the user does not handle interruption correctly it will get reminded sooner rather than later that something is wrong.  Think of it as a RuntimeException.  If you know how to hanlde it you will, if you don\'t let the framework handle it.\n\nSwallowing interrupted status is exactly the same issue that plagued Java samples in the early days, when Exception would be swallowed and nothing reported to the caller.', 'Alexander Pogrebnyak', '2012-03-20 17:34:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (612, '52066', '5', 'Our library could definitely initiate the interruption. The easiest use case would be pool.close() to get rid of all the waiting threads. and the waiting thread in this case, would receive a SQLException\n\nIn the above use case, it should absolutely be cleared.\n\nSince the waiting thread receives the SQLException, I am still not convinced. the call DataSource.getConnection does not have any interrupted exceptions associated with it.', 'Filip Hanik', '2012-03-27 15:16:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (613, '52066', '6', '(In reply to  comment #5 )\n> Our library could definitely initiate the interruption. The easiest use case\n> would be pool.close() to get rid of all the waiting threads. and the waiting\n> thread in this case, would receive a SQLException\n> \n> In the above use case, it should absolutely be cleared.\n> \n> Since the waiting thread receives the SQLException, I am still not convinced.\n> the call DataSource.getConnection does not have any interrupted exceptions\n> associated with it.\n\nOK, Let\'s get to this problem from the other end.  Is it possible to provide a user preference that by default executes a current code, but when set preserved the thread interrupted status?\n\nI really hate to implement yet another facade to your otherwise feature complete product.\n\nIf this approach is acceptable to you I am willing to contribute the required patch for review.', 'Alexander Pogrebnyak', '2012-03-27 17:03:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (614, '52066', '7', 'Good idea \n\nFixed in\n  r1305931  \n  r1305933 ', 'Filip Hanik', '2012-03-27 17:59:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (615, '52066', '8', 'Please note that the interrupt flag was already cleared, this commit does change things around a bit\n http://svn.apache.org/viewvc?rev=1306410&view=rev \nI\'ve made an adjustment based on a suggestion on the dev list', 'Filip Hanik', '2012-03-28 15:25:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (616, '52066', '9', '(In reply to  comment #8 )\n> Please note that the interrupt flag was already cleared, this commit does\n> change things around a bit\n>  http://svn.apache.org/viewvc?rev=1306410&view=rev \n> I\'ve made an adjustment based on a suggestion on the dev list\n\nReviewing the code I see these lines in close() and borrowConnection\n\n    catch (InterruptedException ex) {\n        ...\n        if (!getPoolProperties().getPropagateInterruptState()) {\n           Thread.interrupted();\n        }\n        ...\n    }\n\nThe problem is that this still does not set the interrupted status on the thread, that\'s the common behavior of many flavors of wait methods.  So, in this case the handler have to make a call to interrupt itself.\n\nThe exception handler code should do this:\n\n    catch (InterruptedException ex) {\n        ...\n        if (getPoolProperties().getPropagateInterruptState()) {\n           Thread.currentThread().interrupt();\n        } else {\n           Thread.interrupted();\n        }\n        ...\n    }\n\nThe fix should be applied to lines 384 and and 631 of org.apache.tomcat.jdbc.pool.ConnectionPool in  http://svn.apache.org/viewvc?view=revision&revision=1305931 ', 'Alexander Pogrebnyak', '2012-03-29 14:52:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (617, '52066', '10', 'BTW, it is not related to this bug, but I don\'t know where to submit it otherwise.\n\nWhen I add a comment to this bug report and press `Save Changes` button Bugzilla does not redirect we to this report (52066), but instead goes to \'ASF Bugzilla –  Bug 48001 \'.\n\n48001 is completely unrelated report, but it was also submitted by me.\n\nIf you could kindly reply to this comment with a proper channel I will submit this bug there.  Thanks!', 'Alexander Pogrebnyak', '2012-03-29 14:57:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (618, '52066', '11', ' http://www.apache.org/dev/#infrastructure ', 'Filip Hanik', '2012-03-29 16:19:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (619, '52066', '12', '(In reply to  comment #11 )\n>  http://www.apache.org/dev/#infrastructure \n\nCreated bug report  https://issues.apache.org/jira/browse/INFRA-4620 ', 'Alexander Pogrebnyak', '2012-03-29 16:30:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (620, '52066', '13', 'Reopening this bug, as there is no reply to my  comment #9  ->  https://issues.apache.org/bugzilla/show_bug.cgi?id=52066#c9 .', 'Alexander Pogrebnyak', '2012-03-29 16:32:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (621, '52850', '1', 'Created  attachment 28433   [details] \nsrc code fixes to WebappClassLoader and new tests for memory leak detection\n\nmemory leak detection src code fixes to org.apache.catalina.loader.WebappClassLoader', 'Rohit Kelapure', '2012-03-07 15:02:53 UTC', 'tomcat_attachment/attachment 28433.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (622, '52850', '2', 'Created  attachment 28434   [details] \nnew threadlocal and executor classloader leak detection tests\n\nnew tests for memory leak detection feature', 'Rohit Kelapure', '2012-03-07 15:03:37 UTC', 'tomcat_attachment/attachment 28434.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (623, '52850', '3', 'Developers please code review and proceed with next steps  --Thanks, Rohit Kelapure', 'Rohit Kelapure', '2012-03-07 15:05:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (624, '52850', '4', 'Created  attachment 28442   [details] \nreworked patch after making some modifications to loadedByThisOrChild', 'Rohit Kelapure', '2012-03-08 18:19:21 UTC', 'tomcat_attachment/attachment 28442.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (625, '52850', '5', '(In reply to  comment #0 )\n> - Most of the detection and fixing code has been tested ONLY on Sun JVMs.\nCorrect.\n\n> - Tests in tomcat7.source test org apache catalina loader do not seem to run\n> successfully and are incomplete for all the protection that Tomcat provides for\n> classloader memory leaks.\nThe tests that are present do work. Yes, code coverage of the tests is a long way from 100%.\n\n> - For some categories of threadlocal memory leaks the key and value are not\n> displayed correctly in the warning messages; particularly ones dealing with\n> indirect references to threadlocals\nI don\'t see any changes to address this. Did I miss them?\n\n> -  org.apache.catalina.loader.WebappClassLoader.loadedByThisOrChild(Object)\n> incorrectly traverses the object classloader hierarchy instead of the current\n> (this) classloader hierarchy\nNo. The test is not \'loaded by this or parent\', it is \'loaded by this or child\' and is correct.\n\nI haven\'t looked at the tests yet. I\'ll commit the fixes (less the change to WebappClassLoader.loadedByThisOrChild(Object)) with the tests once I have reviewed the new tests.', 'Mark Thomas', '2012-03-09 15:29:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (626, '52850', '6', 'Fixed in trunk and 7.0.x and will be included in 7.0.27 onwards.\n\nMany thanks for the patch.', 'Mark Thomas', '2012-03-09 19:13:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (627, '52850', '7', '(In reply to  comment #5 )\n\nThanks for accepting the patch\n\n\'I don\'t see any changes to address this. Did I miss them?\'\nEnsure that key and value types ALWAYS show up for all types of threadlocal leaks (direct & indirect)\nMethod expungeStaleEntriesMethod = tlmClass.getDeclaredMethod(\'expungeStaleEntries\');\nexpungeStaleEntriesMethod.setAccessible(true);\n\n\nI had to change WebappClassLoader.loadedByThisOrChild(Object)) to get the Threadlocal leak test cases to pass.\n\nI will be grateful if you add a check in the tests that confirms that the leak warnings have showed up in the log. I did not add junit asserts for the presence of log warnings. \n\n--Thanks\n\n\n> (In reply to  comment #0 )\n> > - Most of the detection and fixing code has been tested ONLY on Sun JVMs.\n> Correct.\n> \n> > - Tests in tomcat7.source test org apache catalina loader do not seem to run\n> > successfully and are incomplete for all the protection that Tomcat provides for\n> > classloader memory leaks.\n> The tests that are present do work. Yes, code coverage of the tests is a long\n> way from 100%.\n> \n> > - For some categories of threadlocal memory leaks the key and value are not\n> > displayed correctly in the warning messages; particularly ones dealing with\n> > indirect references to threadlocals\n> I don\'t see any changes to address this. Did I miss them?\n> \n> > -  org.apache.catalina.loader.WebappClassLoader.loadedByThisOrChild(Object)\n> > incorrectly traverses the object classloader hierarchy instead of the current\n> > (this) classloader hierarchy\n> No. The test is not \'loaded by this or parent\', it is \'loaded by this or child\'\n> and is correct.\n> \n> I haven\'t looked at the tests yet. I\'ll commit the fixes (less the change to\n> WebappClassLoader.loadedByThisOrChild(Object)) with the tests once I have\n> reviewed the new tests.\n\n(In reply to  comment #5 )\n> (In reply to  comment #0 )\n> > - Most of the detection and fixing code has been tested ONLY on Sun JVMs.\n> Correct.\n> \n> > - Tests in tomcat7.source test org apache catalina loader do not seem to run\n> > successfully and are incomplete for all the protection that Tomcat provides for\n> > classloader memory leaks.\n> The tests that are present do work. Yes, code coverage of the tests is a long\n> way from 100%.\n> \n> > - For some categories of threadlocal memory leaks the key and value are not\n> > displayed correctly in the warning messages; particularly ones dealing with\n> > indirect references to threadlocals\n> I don\'t see any changes to address this. Did I miss them?\n> \n> > -  org.apache.catalina.loader.WebappClassLoader.loadedByThisOrChild(Object)\n> > incorrectly traverses the object classloader hierarchy instead of the current\n> > (this) classloader hierarchy\n> No. The test is not \'loaded by this or parent\', it is \'loaded by this or child\'\n> and is correct.\n> \n> I haven\'t looked at the tests yet. I\'ll commit the fixes (less the change to\n> WebappClassLoader.loadedByThisOrChild(Object)) with the tests once I have\n> reviewed the new tests.', 'Rohit Kelapure', '2012-03-09 22:20:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (628, '52850', '8', 'I\'ve been looking at this some more.\n\nThe test cases don\'t do what they are meant to because they don\'t trigger a leak because the web application class loader isn\'t used to load the servlets and associated classes. That is almost certainly why you incorrectly thought you needed to rework loadedByThisOrChild.\n\nI have re-worked the tests and direct leaks are now being created and detected as intended.\n\nIndirect leaks appear to be being generated (although I need to double check that it is the intended leak rather than some other leak) but are not yet being logged. Work continues.\n\nI have also have found and fixed a JMX related memory leak.', 'Mark Thomas', '2012-03-19 19:12:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (629, '52500', '1', 'Created  attachment 28190   [details] \nJava Code\n\nCode that allow to improve current implementation of the client certificate authentication (SSLAuthenticator)', 'Michael', '2012-01-23 13:20:15 UTC', 'tomcat_attachment/attachment 28190.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (630, '52500', '2', 'Created  attachment 28191   [details] \nExamples of x509 authentication', 'Michael', '2012-01-23 13:21:33 UTC', 'tomcat_attachment/attachment 28191');
INSERT INTO `tomcatbeforefixcomments` VALUES (631, '52500', '3', 'Hi!\nI want to improve current implementation of the client certificate authentication (SSLAuthenticator)\nCurrent implementation of SSLAuthenticator takes the user identifier from the whole SubjectDN.\nDuring my work with our enterprise customers I have found the following:\n1)	It is common case when the user identifier is stored in the Subject Alternative Name of the client certificate.\n2)	When the user identifier is stored in the SubjectDN of the client certificate it can be stored in e-mail, CN or in the hold SubjectDN\nSee the attached x509Examples.docx\nI recommend to improve the Tomcat client certificate authentication and allow to take user identifier from the Subject Alternative Name or from SubjectDN. \nThe attached code allows to do it using the following configuration:\n<Context>\n	<Valve className=\'org.apache.catalina.authenticator.SSLAuthenticator\' userIdentifierRetrieveField=\'SubjectAlternativeName\'  userIdentifierRetrieveFieldPart=\'otherName\' />  \n</Context>\n\n<Context>\n	<Valve className=\'org.apache.catalina.authenticator.SSLAuthenticator\' userIdentifierRetrieveField=\'SubjectDN\'  userIdentifierRetrieveFieldPart=\'e\' />  \n</Context>\n\n\nThe attached code already works more than year at production in more than one customer. \nOpen issues:\n1)	The implementation of SubjectAlternativeNameRetriever depend on bouncy castel jar. If it is a problem possible to get all required source files into Tomcat source files. Alternatively, it is possible not to support Subject Alternative Name – but it is very common use case\n2)	I am not sure if the configuration above is the best option – possible to discuss it\nI will happy for your comments.\nBest regards,\n   Michael', 'Michael', '2012-01-23 13:22:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (632, '52500', '4', 'Patches should be provided in diff -u format against, in preference order:\n- trunk\n- 7.0.x/trunk\n- 7.0.x/tags/<latest release>\n- 7.0.x/tags/<other release>\n\nThe intended way to do this is to override the Realm implementation and provide an alternative implementation of getPrincipal(X509Certificate).\n\nI\'d be prepared to consider changes to RealmBase to provide options for extracting the user name from the certificate but I am -1 on doing this in the Authenticators.\n\nAn additional dependency on bouncy castle is not acceptable. On that topic, what is wrong with X509Certificate.getSubjectAlternativeNames() that has been present since Java 1.4?', 'Mark Thomas', '2012-01-23 13:32:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (633, '52500', '5', 'Moving to an enhancement.', 'Mark Thomas', '2012-01-23 13:34:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (634, '52500', '6', 'Dear Mark,\nThank you for the fastest comment!\n\n>Patches should be provided in diff -u format against, in preference order:\n\nI will try to do it when we will finalize patch.\n\n\n\n>The intended way to do this is to override the Realm implementation and >provide an alternative implementation of getPrincipal(X509Certificate).\n\nI have tried to explore the best way to provide the patch.\nAll realms in Tomcat extend RealmBase.\nDo you suggest to create the new realm that will extend RealmBase (with the new implementation of getPrincipal) and all realms will extend the realm? \nOr do you want to override each realm?\n\n\n\n\n>I\'d be prepared to consider changes to RealmBase to provide options for\n>extracting the user name from the certificate but I am -1 on doing this in >the Authenticators.\n\nI just need Authenticator for the configuration and I need your help with the realm configuration.\n\nCan you explain me how can I configure realms?\n\n>An additional dependency on bouncy castle is not acceptable. On that topic,\n>what is wrong with X509Certificate.getSubjectAlternativeNames() that has \n>been present since Java 1.4?\n\nThe SubjectAlternativeNameRetriever class uses X509Certificate.getSubjectAlternativeNames()\nUnfortunately, generally the SubjectAlternativeName is stored in ASNDerEncodedByteArray\nI use the bouncy castle classes to convert the value to string. Is bouncy castle open source?\nWhy it is not possible to copy 5 sources in the Tomcat baseline?\nAlternatively, do you know in Apache foundation a library that provides the following services:\nASN1InputStream\nASN1Sequence\nASN1TaggedObject\nDERObject\nDERUTF8String\n\nThanks and best regards,\n   Michael', 'Michael', '2012-01-23 19:28:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (635, '52500', '7', 'Hi!\nCan we copy the following classes to Tomcat baseline?\n http://geronimo.apache.org/apidocs/2.0.1/org/apache/geronimo/util/asn1/ASN1InputStream.html \n http://geronimo.apache.org/apidocs/2.0.1/org/apache/geronimo/util/asn1/ASN1Sequence.html \n http://geronimo.apache.org/apidocs/2.0.1/org/apache/geronimo/util/asn1/ASN1TaggedObject.html \n http://geronimo.apache.org/apidocs/2.0.1/org/apache/geronimo/util/asn1/DERObject.html \n http://geronimo.apache.org/apidocs/2.0.1/org/apache/geronimo/util/asn1/DERUTF8String.html \nThanks and best regards,\n   Michael', 'Michael', '2012-01-23 19:49:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (636, '52500', '8', 'The suggestion is to make all Realm\'s more configurable be modifying RealmBase. One option would be:\n- define an interface for transforming certs to user names\n- allow users to write their own implementations of this interface\n- add an attribute to RealmBase that allows custom implementations of this transform to be specified (by full class name)\n- modify RealmBase to use this transformation\n- provide a default transformation that is the same as the current code\n\nSee the Tomcat docs for how to configure Realms.\n\nBouncy castle is licensed under terms that would allow us to use it in Tomcat but I am -1 for adding a dependency for this feature. I would much rather add the extension point as outlined above and allow users to implement whatever they need using whatever libraries they choose.\n\nAt the moment, I am +0 for adding additional transformations such such as the one proposed here. My final view would depend on how much demand there was for the feature, how much new code was required and how complex it was.', 'Mark Thomas', '2012-01-24 11:03:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (637, '52500', '9', 'Created  attachment 28199   [details] \nThe document that describe client certificate and its configuration', 'Michael', '2012-01-24 15:48:35 UTC', 'tomcat_attachment/attachment 28199');
INSERT INTO `tomcatbeforefixcomments` VALUES (638, '52500', '10', 'Created  attachment 28200   [details] \nx509 java code\n\nDiff from trunk java', 'Michael', '2012-01-24 15:49:44 UTC', 'tomcat_attachment/attachment 28200.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (639, '52500', '11', 'Dear Mark,\nThank you for the comments!\n- I have defined an interface for transforming certs to user names - UserIdentifierRetriever\n- I have added an attribute to RealmBase that allows custom implementations of this transform to be specified (by full class name) - x509UserIdentifierRetrieverClassName\n- I have modified RealmBase to use this transformation\n- I have provided a default transformation that is the same as the current code - DefaultSubjectDnRetriever \n\nAny case, I strongly recommend to add additional transformations out of the box since it will allow to use Tomcat for the client certificate authentication.\nIt will allow easy configuration to do it. See and the examples below: \n<Realm className=\'…\' x509UserIdentifierRetrieveField=\'SubjectAlternativeName\'  x509UserIdentifierRetrieveFieldPart=\'otherName\' />\n<Realm className=\'…\' x509UserIdentifierRetrieveField=\'SubjectDN\'  x509UserIdentifierRetrieveFieldPart=\'e\' />\nI also can contribute the attached x509Configuration.docx for better explanation.\nIn addition, I strongly recommend to add out of the box SubjectAlternativeNameRetriever. It is used by big enterprise customers. For example, you can not take information from CAC ( http://www.cac.mil/ ) without SubjectAlternativeNameRetriever \nAs I stated before, I can copy 5 required classes from geronimo.apache.org to Tomcat baseline if you do not have objections.\nPlease find attached diff for asf/tomcat/trunk\nMy questions / Action items:\n1)	I do not like the place that I use now to call to createUserIdentifierRetriever method\nI want to call it when Realm is instantiated and all properties are set.\nI need method like afterPropertiesSet of Spring :)\nDo you have something like this for Realm?\n2)	I need to add Javadocs for the new methods in Realm.\nI will happy for your comments.\nBest regards,\n   Michael', 'Michael', '2012-01-24 15:51:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (640, '52500', '12', 'Dear Mark,\nOn the second mind: if you will agree for my suggestion to provide OOTB both SubjectAlternativeNameRetriever and SubjectDnRetriever you will not need to support users transforms by full class name.\nThe SubjectAlternativeNameRetriever and SubjectDnRetriever provide all required information from x509 certificate.\nI do not believe it will be required to add transforms by users.\nI will happy for your comments.\nBest regards,\n   Michael', 'Michael', '2012-01-26 04:22:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (641, '52500', '13', 'Dear Mark,\nI still need your inputs on my suggestions.\n1)	I do not understand if you want to use SubjectAlternativeNameRetriever OOTB\n2)	I do not understand if you want support user transforms by full class name.\n3)	I do not know the best way to call to createUserNameRetriever method\n\nPlease find attached patch with the following modifications:\n1)	UserIdentifier was replaced by UserName in all places\n2)	DefaultSubjectDnRetriever was removed since SubjectDnRetriever with the default constructor performs the same job.\nOnce again: \n1)	SubjectAlternativeNameRetriever and SubjectDnRetriever provide all required information from x509 certificate.\n2)	Classes work already in production\n3)	It works for the following browsers: IE, FF and Chrome\n\nI will more than happy for your comments.\nBest regards,\n   Michael', 'Michael', '2012-01-30 20:27:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (642, '52500', '14', 'Created  attachment 28237   [details] \nx509 java code\n\nPlease find attached patch with the following modifications:\n1)	UserIdentifier was replaced by UserName in all places\n2)	DefaultSubjectDnRetriever was removed since SubjectDnRetriever with the default constructor performs the same job.', 'Michael', '2012-01-30 20:28:45 UTC', 'tomcat_attachment/attachment 28237.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (643, '52500', '15', 'Created  attachment 28238   [details] \nThe document that describe client certificate and its configuration\n\nUserIdentifier was replaced by UserName in all places', 'Michael', '2012-01-30 20:29:50 UTC', 'tomcat_attachment/attachment 28238');
INSERT INTO `tomcatbeforefixcomments` VALUES (644, '52500', '16', '(In reply to  comment #11 )\n> - I have provided a default transformation that is the same as the current code\n> - DefaultSubjectDnRetriever \n> \n> Any case, I strongly recommend to add additional transformations out of the box\n> since it will allow to use Tomcat for the client certificate authentication.\n> It will allow easy configuration to do it. See and the examples below: \n> <Realm className=\'…\' x509UserIdentifierRetrieveField=\'SubjectAlternativeName\' \n> x509UserIdentifierRetrieveFieldPart=\'otherName\' />\n\nI think the idea was that you would be able to configure the realm like this:\n\n<Realm className=\'...\' x509UserIdentifierRetriever=\'....SubjectDnRetriever\' />\n\n(Where my example shown above is the default)\n\nThat way, the x509UserItentifierRetriever can support whatever requirements are necessary in the deployment environment, rather than having a large list of attributes for RealmBase to juggle-around.\n\n> I also can contribute the attached x509Configuration.docx for better\n> explanation.\n\nIn the future, please provide more democratic documentation. For instance, plain-text or OpenDocument format. Plain text is better because it does not require a viewer external to the we browser.\n\n> In addition, I strongly recommend to add out of the box\n> SubjectAlternativeNameRetriever.\n\nLet\'s get the interface nailed-down first, then we can implement as many UserIdentifierRetrievers as are appropriate.', 'Christopher Schultz', '2012-02-01 20:57:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (645, '52500', '17', 'Dear Christopher,\nThank you for your comments!\nI need couple of clarifications\n1)	I do not like the place that I use now to call to createUserIdentifierRetriever method\nI want to call it when Realm is instantiated and all properties are set.\nI need method like afterPropertiesSet of Spring or like javax.annotation.PostConstruct.\nDo you have something like this for Realm?\n2)\n>In the future, please provide more democratic documentation. For instance,\n>plain-text or OpenDocument format. Plain text is better because it does not\n>require a viewer external to the we browser.\n\nHow can I provide a plain text together with pictures?\nDo you know a tool for conversion from MS-Word documents to OpenDocument format?\n I will more than happy for your comments.\nBest regards,\n   Michael', 'Michael', '2012-02-02 18:31:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (646, '52500', '18', '(In reply to  comment #17 )\n> 1)    I do not like the place that I use now to call to\n> createUserIdentifierRetriever method\n> I want to call it when Realm is instantiated and all properties are set.\n> I need method like afterPropertiesSet of Spring or like\n> javax.annotation.PostConstruct.\n> Do you have something like this for Realm?\n\nRealmBase (which you should be using) implements the Lifecycle interface which gets all kinds of notifications about lifecycle events. Read the javadoc for that interface to see what event is most appropriate in your estimation.\n\n> 2)\n> >In the future, please provide more democratic documentation. For instance,\n> >plain-text or OpenDocument format. Plain text is better because it does not\n> >require a viewer external to the we browser.\n> \n> How can I provide a plain text together with pictures?\n\nMultiple attachments?\n\n> Do you know a tool for conversion from MS-Word documents to OpenDocument\n> format?\n\nOpenOffice.org, LibreOffice, or just about any software that can read Microsoft file formats and write-out OpenDocument. They are pretty much all completely free to download and use.', 'Christopher Schultz', '2012-02-03 14:48:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (647, '52500', '19', 'Created  attachment 28308   [details] \nx509 java code', 'Michael', '2012-02-13 07:50:05 UTC', 'tomcat_attachment/attachment 28308.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (648, '52500', '20', 'Created  attachment 28309   [details] \nThe document that describe client certificate and its configuration', 'Michael', '2012-02-13 07:51:03 UTC', 'tomcat_attachment/attachment 28309');
INSERT INTO `tomcatbeforefixcomments` VALUES (649, '52500', '21', 'Dear Christopher,\nSorry for the delay!\nPlease find attached patch that provide OOTB UserNameRetriever that retrieve the user name from SubjectDN without any additional dependency.\nI have added the UserNameRetrieverDecorator class that allows to load the user provided UserNameRetriever. In addition, I have added the UserNameRetrieverConfiguration interface that allow to configure the user provided UserNameRetriever\nPlease find the attached html file – I promise to convert it to the simple txt file when the patch fill be finalized.\n Waiting for your comments.\n\nBest regards,\n   Michael', 'Michael', '2012-02-13 07:51:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (650, '52500', '22', '> Please find attached patch that provide OOTB UserNameRetriever that retrieve\n> the user name from SubjectDN without any additional dependency.\n\nThat looks great.\n\n> I have added the UserNameRetrieverDecorator class that allows to load the user\n> provided UserNameRetriever. In addition, I have added the\n> UserNameRetrieverConfiguration interface that allow to configure the user\n> provided UserNameRetriever\n\nI\'m not sure why either of these are necessary. I think that UserNameRetriever (maybe a better name would be X509UserNameRetriever now that I think about it) interface, the SubjectDNRetriever, and minimal changes to RealmBase.\n\nNote that no changes are required to the Realm interface: the selection of a UserNameRetriever is an implementation detail that can safely be left in RealmBase.\n\n> Please find the attached html file – I promise to convert it to the simple txt\n> file when the patch fill be finalized.\n\nThe best thing to do is to have a decent patch against the Tomcat configuration documentation. Look at the file webapps/docs/config/realm.xml for the source to the current \'Realm\' configuration page: that\'s the proper place to document the new configuration attributes and describe how they can be used. Also, the javadocs should contain similar information (although obviously not XML-related because XML isn\'t part of the API itself). Basically, no documentation should be required that isn\'t part of your patch.\n\nI\'m happy to commit your patch with the above changes. If you\'d like to take another crack at an updated patch, that\'s fine, too. If you do submit another one, please don\'t include \'@author\' tags in the source files: it\'s been our policy for some time not to include @author tags, though there certainly are many in the code that have been there for a long time and might not be purged just because nobody cares enough to do so. Don\'t worry, you\'ll get your name into the change log :)', 'Christopher Schultz', '2012-02-13 20:51:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (651, '52500', '23', 'Dear Christopher,\nThank you for the fast reply!\n\n>That looks great.\nThanks!\n\n\n\n>I\'m not sure why either of these are necessary. \n>I think that UserNameRetriever (maybe a better name \n>would be X509UserNameRetriever now that I think about it)\n>interface, the SubjectDNRetriever, and minimal changes to RealmBase.\n\n\nI am confused. According to my understanding, we want to provide the ability to use a user provided X509UserNameRetriever.\n\nThe purpose of UserNameRetrieverDecorator is to return the user name by the default X509UserNameRetriever if the X509UserNameRetriever provided by a user will return the empty user name.\n\nI can move the UserNameRetrieverDecorator code to RealmBase, but I think it is clearer if it is in the different class.\n\nPlease tell me what you think about it.\n\n\nRegarding UserNameRetrieverConfiguration – it allow easy configuration of a user provided X509UserNameRetriever.\n\nI think it is very useful if you create your own X509UserNameRetriever.\nPlease tell me what you think about it.\n\n\n\n\n>Note that no changes are required to the Realm interface: the selection of a\n>UserNameRetriever is an implementation detail that can safely be left in\n>RealmBase.\n\nOk, got it.\n\n> If you do submit another one, please don\'t include \n>\'@author\' tags in the source files:\n\nI will provide another patch upon your comments without the @author tag and with X509UserNameRetriever name.\n\n\n\n\n>Look at the file webapps/docs/config/realm.xml for the source to\n>the current \'Realm\' configuration page:\n> that\'s the proper place to document the new configuration \n> attributes and describe how they can be used.\n\nOk, I will do it. I think to add the new configuration attributes into the Common Attributes section.\n\nPlease tell me what you think about it.\n\n\n\n\n>Basically, no documentation should be required \n>that isn\'t part of your patch.\n\n\nSo, I will not provide the client certificate description. Correct?\nWaiting for your comments.\n\nBest regards,\n   Michael', 'Michael', '2012-02-14 08:00:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (652, '52500', '24', 'Michael,\n> >I\'m not sure why either of these are necessary. \n> >I think that UserNameRetriever (maybe a better name \n> >would be X509UserNameRetriever now that I think about it)\n> >interface, the SubjectDNRetriever, and minimal changes to RealmBase.\n> \n> I am confused. According to my understanding, we want to provide the ability to\n> use a user provided X509UserNameRetriever.\n> \n> The purpose of UserNameRetrieverDecorator is to return the user name by the\n> default X509UserNameRetriever if the X509UserNameRetriever provided by a user\n> will return the empty user name.\n\nI think that any X509UserNameRetriever should be required to provide something that is non-null. There\'s no reason for \'client code\' not to extend SubjectDNRetriever and simply delegate to the superclass if the name isn\'t otherwise found. I don\'t think it\'s necessary to provide that fallback logic in Tomcat itself: it the user is going to provide an implementation of an X509UserNameRetriever, then it should be *the* implementation that is used, not one of several that Tomcat has to manage.\n\n> Regarding UserNameRetrieverConfiguration – it allow easy configuration of a\n> user provided X509UserNameRetriever.\n\nI think all we need is a single method in the RealmBase class that can accept the name of the class. The default is SubjectDNRetriever, but the user can set it to whatever they want.\n\n> I think it is very useful if you create your own X509UserNameRetriever.\n\nI\'m not sure what it adds.\n\n> >Basically, no documentation should be required \n> >that isn\'t part of your patch.\n> \n> So, I will not provide the client certificate description. Correct?\n> Waiting for your comments.\n\nYou don\'t have to introduce the concept of client certificates, no.\n\nI think it\'s obvious to anyone who is reading this type of documentation what is going on: you are making it possible to customize the information used from the client certificate to produce a username that Tomcat uses.', 'Christopher Schultz', '2012-02-14 17:49:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (653, '52500', '25', 'Created  attachment 28348   [details] \nx509 java code\n\nx509 java code\nsvn diff at trunk java', 'Michael', '2012-02-18 08:38:14 UTC', 'tomcat_attachment/attachment 28348.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (654, '52500', '26', 'Created  attachment 28349   [details] \nRealm configuration document\n\nRealm configuration document\nsvn diff at trunk webapps', 'Michael', '2012-02-18 08:39:14 UTC', 'tomcat_attachment/attachment 28349');
INSERT INTO `tomcatbeforefixcomments` VALUES (655, '52500', '27', 'Dear Christopher,\nThank you for your comments!\nPlease find attached patch.\n1)	I have renamed my classes to X509UserNameRetriever and to X509SubjectDnRetriever\n2)	The Realm interface is reverted\n3)	All code is moved to the RealmBase class\nI have updated the realm document – please find attachment.\nBest regards,\n   Michael', 'Michael', '2012-02-18 08:39:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (656, '52500', '28', 'Dear Christopher,\nDid you see my patch?\nDo you have any comments?\nBest regards,\n   Michael', 'Michael', '2012-02-24 19:00:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (657, '52500', '29', 'Created  attachment 28386   [details] \nx509 java code\n\nI have changed x509UserNameRetrieveConfiguration to x509UserNameRetrieverConfiguration\ndiff at trunk java', 'Michael', '2012-02-26 20:38:32 UTC', 'tomcat_attachment/attachment 28386.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (658, '52500', '30', 'Created  attachment 28387   [details] \nRealm configuration\n\nI have changed x509UserNameRetrieveConfiguration to x509UserNameRetrieverConfiguration\ndiff at trunk webapps', 'Michael', '2012-02-26 20:39:48 UTC', 'tomcat_attachment/attachment 28387.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (659, '52500', '31', 'Dear Christopher,\nSometimes it is better to wait :)\nI have updated the patch.\nIt was typo in the name. I have changed x509UserNameRetrieveConfiguration to x509UserNameRetrieve<b>r</b>Configuration\nWill happy for your comments.\nBest regards,\n   Michael', 'Michael', '2012-02-26 20:40:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (660, '52500', '32', 'Dear Christopher,\nDid you see my patch?\nDo you have any comments?\nBest regards,\n   Michael', 'Michael', '2012-02-29 20:05:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (661, '52792', '1', 'Created  attachment 28402   [details] \nIncorrect behaviour', 'Violeta Georgieva', '2012-02-28 20:32:03 UTC', 'tomcat_attachment/attachment 28402.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (662, '52792', '2', 'Created  attachment 28403   [details] \nCorrect behaviour', 'Violeta Georgieva', '2012-02-28 20:32:34 UTC', 'tomcat_attachment/attachment 28403.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (663, '52792', '3', 'Created  attachment 28404   [details] \nsample application', 'Violeta Georgieva', '2012-02-28 20:35:36 UTC', 'tomcat_attachment/attachment 28404.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (664, '52669', '1', 'Created  attachment 28333   [details] \nscreenshot1', 'Violeta Georgieva', '2012-02-14 21:40:29 UTC', 'tomcat_attachment/attachment 28333.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (665, '52669', '2', 'Created  attachment 28334   [details] \nscreenshot2', 'Violeta Georgieva', '2012-02-14 21:41:01 UTC', 'tomcat_attachment/attachment 28334.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (666, '52669', '3', 'Created  attachment 28335   [details] \nscreenshot3', 'Violeta Georgieva', '2012-02-14 21:41:35 UTC', 'tomcat_attachment/attachment 28335.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (667, '52669', '4', 'Created  attachment 28336   [details] \ntest web app', 'Violeta Georgieva', '2012-02-14 21:43:03 UTC', 'tomcat_attachment/attachment 28336.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (668, '52444', '1', 'No functional bug here, moving to enhancement.', 'Mark Thomas', '2012-01-09 19:01:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (669, '52444', '2', '***  Bug 52549  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2012-01-29 12:15:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (670, '52444', '3', 'Bringing across the list of suggestions from the duplicate...\n\n> a. if the class is an annotation, skip it\nFixed in trunk and 7.0.x and will be included in 7.0.26 onwards.\n\n> b. if the class doesn\'t extend/implement any interface skip it\nInteresting. Thinking about this some more, the current isAssignableFrom() test is actually broader than it needs to be since it will return true for X.class.isAssignableFrom(X.class) and there is no need to add X to the initializerClassMap in this case. Apart from that however, isAssignableFrom() is the right test and that makes things a little more complicated to implement solely using byte code due to how the code currently iterates over the JARs (traversing the class hierarchy is the tricky part). Should be doable but likely to require a fair amount of re-factoring.\n\n> c. Look at the class hierarchy - this is actually quite easy (since\n> there\'s only one parent) and don\'t load it unless it implements\n> ServletContextListener\nThis is not correct. HandlesType specify any class or interface.\n\n> d. if there are no Servlet initializers, don\'t load any classes\nThe code already does this.\n\n> e. if the class needs to be loaded use a throwaway classloader\nIf the class must be loaded to examine it yes, but hopefully it will be possible to avoid doing this.\n\nIn summary, b) is the only remaining problem to solve. The solution looks like requiring caching all the javaClass instances and then doing the HandlesTypes processing (and then throwing away the cache).', 'Mark Thomas', '2012-01-29 17:36:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (671, '52444', '4', 'Thanks for looking at this Mark. The more classes can be eliminated from loading, the better.\n\nCheers!', 'Costin Leau', '2012-01-29 21:37:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (672, '52444', '5', '> In summary, b) is the only remaining problem to solve. The solution looks like\n> requiring caching all the javaClass instances and then doing the HandlesTypes\n> processing (and then throwing away the cache).\n\nI was looking at using the bcel.util.SyntheticRepository when you fixed the\nannotations...', 'Pid', '2012-01-29 21:51:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (673, '52444', '6', '(In reply to  comment #5 )\n> I was looking at using the bcel.util.SyntheticRepository when you fixed the\n> annotations...\n\nThat would work but you\'d need an additional cache to save you parsing the interface hierarchy every time. I\'m currently working on a custom cache. Should have something for tomorrow.', 'Mark Thomas', '2012-01-29 22:05:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (674, '52444', '7', 'I think I have a patch for this. The unit tests pass but I want to run the TCK as well before I commit anything. That\'ll be tomorrow at the earliest now.', 'Mark Thomas', '2012-01-29 23:23:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (675, '52444', '8', 'Unit tests and Servlet TCK pass so the fix has been committed to trunk and 7.0.x. It will be in 7.0.26 onwards.', 'Mark Thomas', '2012-01-30 11:34:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (676, '52444', '9', 'Thanks, Mark.  I\'ve updated  https://jira.springsource.org/browse/SPR-8894  and  https://jira.springsource.org/browse/SPR-8945  to let affected users know that 7.0.26 should take care of this issue.', 'Chris Beams', '2012-01-30 11:46:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (677, '52444', '10', 'Hi Mark,\n\nAs we also had this problem with our application, we have built a Tomcat from svn tip and when starting the application, we had the following stacktrace:\nCaused by: java.lang.NullPointerException\n	at org.apache.tomcat.util.bcel.classfile.ClassParser.<init>(ClassParser.java:72)\n	at org.apache.catalina.startup.ContextConfig.populateJavaClassCache(ContextConfig.java:2132)\n	at org.apache.catalina.startup.ContextConfig.populateJavaClassCache(ContextConfig.java:2123)\n	at org.apache.catalina.startup.ContextConfig.checkHandlesTypes(ContextConfig.java:2058)\n	at org.apache.catalina.startup.ContextConfig.processAnnotationsStream(ContextConfig.java:2015)\n	at org.apache.catalina.startup.ContextConfig.processAnnotationsJar(ContextConfig.java:1904)\n	at org.apache.catalina.startup.ContextConfig.processAnnotationsUrl(ContextConfig.java:1872)\n	at org.apache.catalina.startup.ContextConfig.processAnnotations(ContextConfig.java:1858)\n\nThis is due to the fact that classes present in the jar files may implement interfaces not present in the classpath (in our case, it\'s the optional commonj support in Spring\'s scheduling classes which rises this problem).\n\nWe solved this problem by checking that the inputStream \'is\' is different from null in populateJavaClassCache(String className).\n\nWith this fix, our application starts and the initialization is faster than with 7.0.25.\n\nHTH.\n\n-- \nGuillaume', 'Guillaume Smet', '2012-01-31 23:05:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (678, '52444', '11', 'Can you add a patch as an attachment (in diff -u format) for your change?', 'Pid', '2012-01-31 23:57:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (679, '52444', '12', 'Created  attachment 28245   [details] \nFixes a NPE on startup if classes reference class or interface which aren\'t in the classpath\n\nAs requested, here is the trivial patch we applied to fix the NPE we had on startup.', 'Guillaume Smet', '2012-02-01 00:18:32 UTC', 'tomcat_attachment/attachment 28245.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (680, '52543', '1', 'Bugzilla is not a support forum. Please join the Tomcat Users mailing list and ask your question there.', 'Pid', '2012-01-27 13:38:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (681, '52543', '2', 'i found \nwhen cookie value size > 8192\nbad that exception contains no useful information', 'Evgeny', '2012-01-27 15:59:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (682, '52543', '3', 'my be need add exception which contains information that HEADERS > 8192 byte', 'Evgeny', '2012-01-27 16:08:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (683, '52511', '1', 'This appears to be due to a change in ContextConfig from:\n\n                        webinfClasses = context.getServletContext().getResource(\n                                \'/WEB-INF/classes\');\n                        processAnnotationsUrl(webinfClasses, webXml);\n\nto\n\n                        NamingEnumeration<Binding>  listBindings =\n                            context.getResources().listBindings(\'/WEB-INF/classes\');\n                        while (listBindings.hasMoreElements()) {\n                            Binding binding = listBindings.nextElement();\n                            if (binding.getObject() instanceof FileDirContext) {\n                                File webInfCLassDir =\n                                    new File(\n                                        ((FileDirContext) binding.getObject()).getDocBase());\n                                processAnnotationsFile(webInfCLassDir, webXml);\n                            }\n                        }\n\nwhich is all well and good except for the differences in behavior when /WEB-INF/classes is not found.  The old code did not consider this an error and just moved on.  The new code considers this an error to be logged including an exception trace.\n\nI\'d patch this myself, but I\'m not familiar with the code.  This leaves open questions like: should listBindings() throw an exception upon finding no bindings -- or should it really just return an empty enumeration?  What other side-effects will this have?  Or should this ContextConfig code be changed.\n\nOverall this makes any perfectly fine web app without /WEB-INF/classes look suspect/unreliable, which is not appropriate.', 'Jess Holle', '2012-01-23 21:06:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (684, '52511', '2', 'I\'m seeing this, too.', 'David Rees', '2012-01-23 22:45:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (685, '52511', '3', 'Several notes.\n\nFirst, this exception would not happen if either of the following two is true:\n\n1. The web.xml specifies earlier version of servlet specification than 3.0\n2. The web.xml has metadata-complete=\'true\'\n\nNote that using metadata-complete=\'true\' is generally recommended to speed up web application startup. That is if you do not need features disabled by that option. All applications in default Tomcat distributive have metadata-complete=\'true\'.\n\n\nSecond, this exception is harmless.\n\nScanning of WEB-INF/classes is skipped, as it should be.\n\nThe exception is caught and logged. It does not impede further annotation scanning. Execution in ContextConfig#webConfig() continues.\n\n\n\nThis issue was introduced in  r1209686 \n\n> 1210 	log.error(sm.getString(\n> 1211 	\'contextConfig.webinfClassesUrl\'), e);\n\nBTW, the exception handling was changed in  r1209686  ,but the log message template above has not been updated.', 'Konstantin Kolinko', '2012-01-24 08:48:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (686, '52511', '4', 'Clearly the exception is harmless -- except that it causes unnecessary confusion, consternation, and loss of trust from those administering, maintaining, and troubleshooting applications on Tomcat 7.0.25 that produce this error.\n\nI\'m trying to understand the best fix here so I can patch this onto my 7.0.25 -- as I want other fixes in 7.0.25, but don\'t want all the downsides of inappropriate error/exception messages, nor do I want to accidentally hide any real errors.', 'Jess Holle', '2012-01-24 12:54:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (687, '52474', '1', 'Comment on  attachment 28163   [details] \ndebugging tomcat source\n\nImage eclipse debugging attached.', 'Helio Frota', '2012-01-17 05:43:30 UTC', 'tomcat_attachment/attachment 28163.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (688, '52474', '2', 'The error is in the TLD file, not how Tomcat handles it.', 'Mark Thomas', '2012-01-18 09:32:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (689, '52474', '3', 'Hello Mark Thomas,\n\nServlet specification 2.5:\n\n\'SRV.13.2\n\nRules for Processing the Deployment Descriptor\n\nThis section lists some general rules that Web containers and developers must note concerning the processing of the deployment descriptor for a Web application.\n\n• Web containers must remove all leading and trailing whitespace, which is de-\nfined as “S(white space)” in XML 1.0 ( http://www.w3.org/TR/2000/WD-xml -\n2e-20000814), for the element content of the text nodes of a deployment de-\nscriptor.\'\n\nJSP Specification:\n\nJSP.7.1.9\nEvent Listeners\nA tag library may include classes that are event listeners (see the Servlet 2.5\nspecification). The listeners classes are listed in the tag library descriptor and the JSP container automatically instantiates them and registers them. A Container is required to locate all TLD files (see Section JSP.7.3.1 for details on how they are identified), read their listener elements, and treat the event listeners as extensions of those listed in web.xml.\nThe order in which the listeners are registered is undefined, but they are\nregistered before application start.\n\nSo if the TLD file should be treated as an extension of the web.xml file, so the container should deal with the removal of any blank space right ?', 'Helio Frota', '2012-01-18 10:26:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (690, '52474', '4', 'The text of the JSP specification doesn\'t include any details on how TLDs should be parsed. I can see where you are coming from with that chain of references but the meaning of those is that listeners defined in TLDs are equivalent to listeners defined in web.xml.\n\nThere is, however, a definitive answer if one looks at the Java EE XSDs.\nListeners in TLDs are of type javaee:listenerType\njavaee:listenerType contains a listener-class of type javaee:fully-qualified-classType\njavaee:fully-qualified-classType has a base type of javaee:string\nThe definition of javaee:string requires that leading and trailing white space is removed.\n\nTherefore, the correct behaviour is to remove the leading and trailing white space. It looks like this may affect many more elements than just the listeners.', 'Mark Thomas', '2012-01-20 11:38:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (691, '52474', '5', 'On org.apache.catalina.core.StandardContext class line 4701 what is the impact of adding a call to trim() ?\n\n\ntry {\n    results[i] = instanceManager.newInstance(listeners[i]);\n}\n...\n\n\ntry {\n    results[i] = instanceManager.newInstance(listeners[i].trim());\n}\n...', 'Helio Frota', '2012-01-20 12:25:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (692, '51408', '1', 'It has been like this for many years with zero issues reported by users.', 'Mark Thomas', '2011-06-21 15:52:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (693, '51408', '2', 'I object to marking this bug as INVALID, since I think it\'s something that should be fixed.\n\nHow about marking it \'minor\' and fixing it lazily. Just being explicit about the character set (ISO-8859-1? UTF-8?) should be easy to do and is unlikely to affect anyone.', 'Christopher Schultz', '2011-06-21 16:28:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (694, '51408', '3', 'What exactly needs fixing? I don\'t see a report from a user reporting an error. Neither do I see any analysis that demonstrates how an error may occur.\n\nGiven that the code has remained unchanged for many years without any reports of errors from a world-wide user base, I find it unlikely there is actually anything here to fix.\n\nThere is a greater risk, in my view, of a change introducing a regression. \'If it isn\'t broken, don\'t fix it.\'\n\nI have changed this to enhancement. If there has been no activity when I next come back to this, it is likely to get re-closed.', 'Mark Thomas', '2011-06-21 16:48:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (695, '51408', '4', '(In reply to  comment #0 )\n> There seem to be rather a lot of instances where Strings and bytes are\n> cconverted using the default charset.\n\nPlease be specific!\n\nSearching through the TC7 source code I found\n\n=====================================\n1) 0 wrong calls to String.getBytes()\n\nThat is\n1. Disregarding the test classes - have not looked through them at all,\n2. Disregarding some never called test code in o.a.c.tribes.membership.Constants.main()\n3. Disregading legit calls to this method, when encoding is configurable and the default encoding is used as fallback.\n\nNothing to do there.\n\n=====================================\n2) 2 places where new String(byte[]) calls might be fixed:\n\n2.1. In SSIFilter#doFilter(), the following line:\n\n   res.getWriter().write(new String(bytes));\n\nIt is some fallback code, when there is no OutputStream available, but only a writer. Is it possible to get encoding of the writer there, e.g. from content-type header?\n\nPatches are welcome. It is an odd and rare use case though.\n\n2.2. In JNDIRealm#getAttributeValue(String,Attributes)\n\n  valueString = new String((byte[]) value);\n\nI do not know JNDI API enough to comment here.\n\nThe rest are fallbacks, debug code etc.\n\n=====================================\n3) new String(byte[],int,int):\n\n3.1. WebappClassLoader#findResourceInternal()\n\n  String str = new String(binaryContent,0,pos);\n\nThat is the correct code and should stay as is. See  r303915 .\n\nThe rest are fallbacks, debug code etc.\n\n=====================================\n4) new FileWriter(String) or new FileWriter(String,[boolean]) instead of OutputStreamWriter + FileOutputStream\n\nIs used in one place only:\n\n4.1. in AccessLogValve.open()\n\nThis can be fixed - to add \'encoding\' configuration option for the valve. I think there was an enhancement request for that.\n\n=====================================\n\nThat is all.', 'Konstantin Kolinko', '2011-06-21 23:57:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (696, '51408', '5', 'Sorry, I see now that the subject was misleading.\n\nI was actually referring to the calls to getBytes(Charset.defaultCharset()) which were added recently in  r1138019 .\n\nThere are lots more of those, for example:\n\nDigestAuthenticator.generateNonce\nJNDIRealm.compareCredentials\n\netc.', 'Sebb', '2011-06-22 00:19:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (697, '38216', '1', 'Got a specific patch in mind, or just a general \'this would be good\' feeling? ;)', 'Yoav Shapira', '2006-12-24 17:52:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (698, '38216', '2', 'It was definitely more than a feeling :)\n\nI\'ll attach a patch showing my modifications.\n', 'Christopher Hlubek', '2007-01-02 04:25:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (699, '38216', '3', 'Created  attachment 19340   [details] \nThe patch introduces an invoke operation to the proxy\n\nThe operation is specified by the \'op\' parameter and the parameters of the JMX\noperation are specified (as a comma seperated list) by the \'ps\' parameter.', 'Christopher Hlubek', '2007-01-02 06:59:48 UTC', 'tomcat_attachment/attachment 19340.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (700, '38216', '4', 'This Tomcat 5 enhancement request has been moved to Tomcat 7 (the latest version) since Tomcat 5 development is limited and focussed on bugs and security issues whereas Tomcat 7 is still seeing new feature development.', 'Mark Thomas', '2011-12-20 20:32:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (701, '38216', '5', 'After rather too long a variation of this patch has been applied to trunk and 7.0.x and will be included in 7.0.24 onwards.\n\nThe main changes I made to the proposed patch were:\n- fixing a potential NPE when a method required zero parameters\n- improving the output when an array was returned (as is often the case with Tomcat MBeans)', 'Mark Thomas', '2012-01-15 21:42:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (702, '38216', '6', 'Very useful feature and i\'m just putting it onto our tomcat 6 boxes. However it doesn\'t account for the invocation of the mbean returning null when outputting the result. I propose that the invokeOperation becomes\n\n    public void invokeOperation(PrintWriter writer, String onameStr, String op, String[] valuesStr){\n        try {\n            ObjectName oname=new ObjectName( onameStr );\n            MBeanOperationInfo methodInfo = registry.getMethodInfo(oname,op);\n            MBeanParameterInfo[] signature = methodInfo.getSignature();\n            String[] signatureTypes = new String[signature.length];\n            Object[] values = new Object[signature.length];\n            for (int i = 0; i < signature.length; i++) {\n               MBeanParameterInfo pi = signature[i];\n               signatureTypes[i] = pi.getType();\n               values[i] = registry.convertValue(pi.getType(), valuesStr[i] );\n           }\n\n            Object retVal = mBeanServer.invoke(oname,op,values,signatureTypes);\n            if(retVal != null){\n                writer.println(\'OK - Operation \' + op + \' returned:\');\n                output(\'\', writer, retVal);\n            }else{\n                writer.println(\'OK - Operation \' + op + \' without return value\');\n            }\n        } catch( Exception ex ) {\n            writer.println(\'Error - \' + ex.toString());\n            ex.printStackTrace(writer);\n        }\n    }', 'Chris O\'Connor', '2012-01-17 14:49:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (703, '38216', '7', 'Created  attachment 28173   [details] \n2012-01-19_tc8_JMXProxyServlet.patch\n\nYours covers most common use case of method returning void/null.\nI think null values inside arrays should be handled as well.\nI am attaching patch that I am thinking about that covers null values in getAttribute() operation as well.', 'Konstantin Kolinko', '2012-01-19 07:19:33 UTC', 'tomcat_attachment/attachment 28173.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (704, '52245', '1', 'Can you explain what do you mean by this?\nWhat is the actual behaviour and what is expected?', 'Konstantin Kolinko', '2011-11-25 16:02:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (705, '52245', '2', '(In reply to  comment #1 )\n> Can you explain what do you mean by this?\n\n(Sorry, I wanted to put an initial report in so I wouldn\'t forget.)\n\nWebappClassLoader detects classes in certain packages/JARs (e.g. java.servlet.*) that are supplied by the container and won\'t load them, as per SRV.9.7.2.\n\n> What is the actual behaviour and what is expected?\n\nA simple application is attached. It will start, (my mistake earlier), but throws an exception when a JSP is accessed. The application contains el-api.jar in WEB-INF/lib.\n\nThe exception is:\n\njavax.servlet.ServletException: java.lang.LinkageError: loader constraint violation: when resolving interface method \'javax.servlet.jsp.JspApplicationContext.getExpressionFactory()Ljavax/el/ExpressionFactory;\' the class loader (instance of org/apache/jasper/servlet/JasperLoader) of the current class, org/apache/jsp/index_jsp, and the class loader (instance of org/apache/catalina/loader/StandardClassLoader) for resolved class, javax/servlet/jsp/JspApplicationContext, have different Class objects for the type javax/el/ExpressionFactory used in the signature\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:342)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n\nroot cause:\n\njava.lang.LinkageError: loader constraint violation: when resolving interface method \'javax.servlet.jsp.JspApplicationContext.getExpressionFactory()Ljavax/el/ExpressionFactory;\' the class loader (instance of org/apache/jasper/servlet/JasperLoader) of the current class, org/apache/jsp/index_jsp, and the class loader (instance of org/apache/catalina/loader/StandardClassLoader) for resolved class, javax/servlet/jsp/JspApplicationContext, have different Class objects for the type javax/el/ExpressionFactory used in the signature\n	org.apache.jsp.index_jsp._jspInit(index_jsp.java:31)\n	org.apache.jasper.runtime.HttpJspBase.init(HttpJspBase.java:49)\n	org.apache.jasper.servlet.JspServletWrapper.getServlet(JspServletWrapper.java:181)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:370)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n\n\nThe javax.el package is not detected by WebappClassLoader, unlike the javax.servlet package - which causes JARs to be ignored by the class loader.\n\nSRV 9.7.2 suggests that classes discovered in the application classpath, but from the javax.el * packages should not be loaded by the WebappClassLoader as they are provided by the container.\n\n\n* and possibly javax.annotation and javax.persistence, if the annotation-api.jar contains all of the classes, as opposed to a subset.', 'Pid', '2011-11-25 17:58:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (706, '52245', '3', 'Created  attachment 27986   [details] \nSimple EL API test case', 'Pid', '2011-11-25 18:00:13 UTC', 'tomcat_attachment/attachment 27986');
INSERT INTO `tomcatbeforefixcomments` VALUES (707, '52245', '4', 'Created  attachment 27987   [details] \nPatch to detect classes in javax.el and avoid loading repository/class', 'Pid', '2011-11-25 18:37:27 UTC', 'tomcat_attachment/attachment 27987.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (708, '52440', '1', 'Can you provide small simple web application that demonstrates the problem?\n\nThat SimpleNode that you operate on - what is its exact className? (Which one of subclasses of SimpleNode that is?)', 'Konstantin Kolinko', '2012-01-09 18:09:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (709, '52440', '2', 'Created  attachment 28130   [details] \nTest case for ValueReference returning null\n\nI use SystemEventListener event javax.faces.event.PreRenderComponentEvent to intercept component render process ant try to get component ValueExpression and ValueReference from it (class TestSystemEventListener).\n\nI use Facelets custom components with taglib file (not composite component).\n\nReturned ValueReference is always null.\n\nNull is returned from node AstIdentifier (super class SimpleNode)\n\nI print returned ValueReference value to console.', 'JustasR', '2012-01-10 09:39:08 UTC', 'tomcat_attachment/attachment 28130.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (710, '52440', '3', 'I think I have this fixed but I\'d like to confirm this with the test case. Please provide some details (the URL being the most important) of how this test case is meant to be used.', 'Mark Thomas', '2012-01-12 18:41:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (711, '52328', '1', 'Some more information why we did what we did to work around this, and possibly hint how this can be resolved inside Tomcat: the documentation at \n http://docs.oracle.com/javase/6/docs/api/java/io/OutputStreamWriter.html \nstates there to wrap in a buffered writer in order to \'to avoid frequent converter invocations\', which have a cost. In this case, the observed garbage.', 'Nikolay Diakov', '2011-12-14 15:24:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (712, '52328', '2', ' r411577  looks to be the commit the triggered this issue', 'Mark Thomas', '2011-12-23 21:48:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (713, '52328', '3', 'Looking at this some more, I think we\'ll need to be careful around recycling, resetting and flushing but the most efficient way to fix this is to remove the calls to conv.flush() after every write. The C2BConvertor already has a buffer, so lets use it.\n\nI\'ll start looking at a patch along these lines and doing some testing.', 'Mark Thomas', '2012-01-10 10:38:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (714, '52328', '4', '(In reply to  comment #3 )\n> the most efficient way to fix this is to remove the\n> calls to conv.flush() after every write. The C2BConvertor already has a buffer,\n> so lets use it.\n\nInteresting, but maybe cut 7.0.24 first? The change sounds risky so it will need some time to review.\n\nI do not see what flush() calls you are talking about. Maybe that will be more clear from the patch.', 'Konstantin Kolinko', '2012-01-10 11:21:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (715, '52328', '5', 'Created  attachment 28132   [details] \nInitial ideas\n\nMy initial idea (attached) was quite simple. There isn\'t the buffering I thought there was in the Converter so there is scope to add some buffering and further improve performance.', 'Mark Thomas', '2012-01-10 16:16:22 UTC', 'tomcat_attachment/attachment 28132.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (716, '52328', '6', 'Forgot to add the performance numbers for adding 100,000 single characters through a Writer.\nBefore\n129ms without wrapping the Writer in a BufferedWriter\n 37ms with wrapping the Writer in a BufferedWriter\n\nAfter\n77ms without wrapping\n28ms with wrapping\n\nI\'m still looking at the best place to insert a Buffer before the conversion.', 'Mark Thomas', '2012-01-10 16:19:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (717, '52328', '7', 'If I insert a Buffer before the converter then the figures drop to:\n20ms without wrapping\n7ms with wrapping\n\nClearly the CoyoteWriter has some in-built overhead that adding a Buffer helps with. I don\'t want to provide a Buffer inside CoyoteWriter as that adds more complexity that I want to deal with right now.', 'Mark Thomas', '2012-01-10 18:00:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (718, '52328', '8', 'That initial patch is no good. It triggers a bunch of unit test failures. I am working on an improved patch now.', 'Mark Thomas', '2012-01-10 19:30:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (719, '52328', '9', 'Unit tests now work on trunk. I\'m just running the TCK before I look at back-porting it.', 'Mark Thomas', '2012-01-10 21:05:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (720, '52328', '10', 'JSP and Servlet TCK pass for trunk (apart from the Servlet signature tests that are expected to fail since some changes have already been made for Servlet 3.1).\n\nI\'ll look at back-porting these tomorrow.\n\nNikolay,\nWhat are the chances of you being able to test your app with these changes? I can provide a snapshot release build if necessary.', 'Mark Thomas', '2012-01-10 22:11:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (721, '52328', '11', 'Yes, Mark, we can test it pretty quick. If you would provide us with a patched distribution package, we will test:\n- Query response in our application (having removed our buffering wrapper) deployed in the patched Tomcat.\n- Memory consumption (whether we get too many transient objects of the originally observed type).\n\nCheers,\n  Nikolay', 'Nikolay Diakov', '2012-01-11 09:06:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (722, '52328', '12', 'Excellent. I\'ll put a dev build up on my people.apache.org space and provide a link when it is available.\n\nFor reference, both the flushing changes and adding an internal buffer a[ppear to help performance in all cases. Here are some figures from the latest version of the test case which I\'ll commit shortly:\n\nTrunk without internal buffer but with flushing patch\nWrite length:      1, Buffered: n, Time: 86143369ns\nWrite length:      1, Buffered: y, Time: 18922557ns\nWrite length:     10, Buffered: n, Time:  4281841ns\nWrite length:     10, Buffered: y, Time:  1817266ns\nWrite length:    100, Buffered: n, Time:  1687881ns\nWrite length:    100, Buffered: y, Time:  1185908ns\nWrite length:   1000, Buffered: n, Time:  1243862ns\nWrite length:   1000, Buffered: y, Time:  1160367ns\nWrite length:  10000, Buffered: n, Time:  1147934ns\nWrite length:  10000, Buffered: y, Time:  1281448ns\nWrite length: 100000, Buffered: n, Time:  1204381ns\nWrite length: 100000, Buffered: y, Time:  1218129ns\n\n\nTrunk with internal buffer and flushing patch\nWrite length:      1, Buffered: n, Time: 27663008ns\nWrite length:      1, Buffered: y, Time: 15468331ns\nWrite length:     10, Buffered: n, Time:  1718582ns\nWrite length:     10, Buffered: y, Time:  1938994ns\nWrite length:    100, Buffered: n, Time:  1110883ns\nWrite length:    100, Buffered: y, Time:  1233152ns\nWrite length:   1000, Buffered: n, Time:   933836ns\nWrite length:   1000, Buffered: y, Time:  1259017ns\nWrite length:  10000, Buffered: n, Time:  1024246ns\nWrite length:  10000, Buffered: y, Time:  1168732ns\nWrite length: 100000, Buffered: n, Time:  1015159ns\nWrite length: 100000, Buffered: y, Time:  1074527ns\n\n7.0,x with no patches\nWrite length:      1, Buffered: n, Time: 137147272ns\nWrite length:      1, Buffered: y, Time:  18676195ns\nWrite length:     10, Buffered: n, Time:  10390213ns\nWrite length:     10, Buffered: y, Time:   2038188ns\nWrite length:    100, Buffered: n, Time:   2008351ns\nWrite length:    100, Buffered: y, Time:   1200196ns\nWrite length:   1000, Buffered: n, Time:   1261317ns\nWrite length:   1000, Buffered: y, Time:   1217747ns\nWrite length:  10000, Buffered: n, Time:   1117065ns\nWrite length:  10000, Buffered: y, Time:   1081037ns\nWrite length: 100000, Buffered: n, Time:   1471004ns\nWrite length: 100000, Buffered: y, Time:   1134857ns', 'Mark Thomas', '2012-01-11 13:10:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (723, '52328', '13', 'Numbers look great! Can\'t wait to try it out. \n\nIf all well, we would appreciate information about planning/estimation when to expect a 7.0.x release with the patch inside.', 'Nikolay Diakov', '2012-01-11 13:20:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (724, '52293', '1', 'Comment on  attachment 28034   [details] \nContextConfig.java\n\npatch changes antiLocking method to convert \'/\' to \'#\' in docBase.', 'Justin Miller', '2011-12-06 18:58:27 UTC', 'tomcat_attachment/attachment 28034.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (725, '52293', '2', 'Created  attachment 28037   [details] \nContextConfig.java\n\nforgot to include patch for the actual bug.  Line 974 now checks the originalDocBase for the \'.war\' extension and behaves appropriately.  The changing of \'/\' to \'#\' is secondary but also required to handle sub-pathed contexts', 'Justin Miller', '2011-12-06 19:08:01 UTC', 'tomcat_attachment/attachment 28037.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (726, '52293', '3', 'This bug presents when antiResourceLocking = \'true\' and unpackWARs = \'false\'.  Additionally, regardless of the unpackWARs setting, sub-pathed contexts will not be copied correctly to the temp directory because no check exists in the antiLocking method for the sub-path', 'Justin Miller', '2011-12-06 19:13:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (727, '52293', '4', '(In reply to  comment #1 )\n> patch changes antiLocking method to convert \'/\' to \'#\' in docBase.\n\nIt is much easier to handle an issue when you submit a diff against previous version of a file, instead of attaching new file version as a whole.\n\nThe diff is several lines, a file is hundreds of lines. See the following pages:\n\n http://tomcat.apache.org/bugreport.html#Patches_and_enhancement_requests \n\n http://www.apache.org/dev/contributors.html#patches ', 'Konstantin Kolinko', '2011-12-06 19:21:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (728, '52293', '5', 'Created  attachment 28038   [details] \ndifferences\n\ndiff of patched antiLocking method with 6.0.35 version', 'Justin Miller', '2011-12-06 19:36:54 UTC', 'tomcat_attachment/attachment 28038.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (729, '52293', '6', 'Fixed in trunk and will be included in 7.0.24 onwards.', 'Mark Thomas', '2011-12-21 19:29:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (730, '52293', '7', 'Proposed for 6.0.x', 'Mark Thomas', '2011-12-21 19:31:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (731, '52293', '8', 'Created  attachment 28097   [details] \n2011-12-22_tc6_ContextConfig.java.patch (the same as above, but in unified diff format)\n\nThe same as Justin Miller\'s patch, but now in Unified diff format.\nIt is against tc6.0.x.', 'Konstantin Kolinko', '2011-12-22 09:42:04 UTC', 'tomcat_attachment/attachment 28097.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (732, '52225', '1', 'Fixed in trunk and 7.0 with  r1204856  and  r1204860  and will be in 7.0.24.\nProposed for 6.0 and 5.5.', 'Konstantin Kolinko', '2011-11-22 08:59:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (733, '52225', '2', 'Moving to 6.0.x', 'Mark Thomas', '2011-11-22 19:25:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (734, '52225', '3', 'Fixed in 5.5.x and will be in 5.5.35 onwards.', 'Mark Thomas', '2011-12-20 20:17:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (735, '50570', '1', 'It might make more sense to put this into the AprLifecycleListener, as it appears that FIPS mode for OpenSSL is not done on a per-context basis, but per-process.\n\nIt would be nice to enable this for JSSE as well, so where would that go?', 'Christopher Schultz', '2011-01-11 12:34:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (736, '50570', '2', 'Unless its changed since I last looked at it, a FIPS JSSE solution requires a new security provider and all the configuration happens in the JRE. Tomcat configuration does not change.', 'Mark Thomas', '2011-01-11 17:04:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (737, '50570', '3', 'Changing description to reflect new requirements: NIO/BIO connectors need no such explicit configuration.\n\nIt looks like this can be done by adding a member, accessor, and mutator to AprEndpoint and then in AprEndpoint.bind, call (a new method) SSLContext.setFIPSMode which calls FIPS_mode_set.\n\nOne thing I\'m unclear on is how to get the configuration from server.xml\'s <Connector> all the way down to the AprEndpoint object. What object has setXXX() called on it when configuring a <Connector>?', 'Christopher Schultz', '2011-01-13 14:49:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (738, '50570', '4', 'Created  attachment 26582   [details] \nSource and properties files to add FIPS initialization call to OpenSSL\n\nThe attached zip file contains source to allow FIPS mode initialization of OpenSSL.', 'Chris Beckey', '2011-01-31 16:59:41 UTC', 'tomcat_attachment/attachment 26582.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (739, '50570', '5', 'A patch (like diff against the existing code) would be more easy to look to,', 'jfclere', '2011-02-01 03:38:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (740, '50570', '6', '(In reply to  comment #5 )\n> A patch (like diff against the existing code) would be more easy to look to,\n\nThe code is built from a base of Version 6.0.20.  I had assumed that a diff against the (current) 7.x codebase would be nearly worthless.  If a diff from 6.0.20 would be useful I can generate that.', 'Chris Beckey', '2011-02-01 12:44:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (741, '50570', '7', '(In reply to  comment #6 )\n> The code is built from a base of Version 6.0.20.  I had assumed that a diff\n> against the (current) 7.x codebase would be nearly worthless.  If a diff from\n> 6.0.20 would be useful I can generate that.\n\nA diff against 6.0.20 would be better than just a big ZIP file: we\'d have to do our own diffs and figure it all out, anyway, so you\'d be saving us a big step.\n\nIt might be best to give us two patches: one for the Java code and another for the C code.', 'Christopher Schultz', '2011-02-01 17:51:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (742, '50570', '8', '(From private email from CHris Beckey):\n\n> I just zip\'d together the source and attached it to the bug report.  The changes are in:\n> \n> org.apache.tomcat.core.AprLifecycleListener.java\n> org.apache.tomcat.core.LocalStrings.properties\n> org.apache.tomcat.jni.SSL.java\n> org.apache.tomcat.jni.Library.java\n> \n> and in tomcat native\n> ssl.c\n> \n> I modified the code in Library.java to load each of the (3) required libraries (APR, libtcnative and libeay) explicitly rather than depending on references within the libs.  This was for my debugging and is not required but it does make it explicit if one of them is missing.\n> \n> The listener declaration in server.xml looks like this:\n>   <Listener className=\'org.apache.catalina.core.AprLifecycleListener\' SSLEngine=\'on\' FIPSMode=\'on\' />\n> \n> I was unsure whether to abort startup if FIPS was requested but did not initialize. I think it is valid to refuse to continue in that case but didn\'t implement it that way.', 'Christopher Schultz', '2011-02-01 17:53:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (743, '50570', '9', 'Updating bug description to match reality: FIPS mode should be set in the APR listener, and not in an individual Connector.', 'Christopher Schultz', '2011-02-01 17:54:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (744, '50570', '10', 'Created  attachment 26775   [details] \nPatch to implement FIPS mode setting in Tomcat 7 trunk\n\nRequires TC native patch, which has also been attached to  bug #50570 ', 'Chris Beckey', '2011-03-15 16:16:28 UTC', 'tomcat_attachment/attachment 26775.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (745, '50570', '11', 'Created  attachment 26776   [details] \npatch to implement FIPS mode setting in tc native \n\nRequires patch to Tomcat, which is attached to bug #05070', 'Chris Beckey', '2011-03-15 16:17:55 UTC', 'tomcat_attachment/attachment 26776.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (746, '50570', '12', '(In reply to  comment #9 )\n> Updating bug description to match reality: FIPS mode should be set in the APR\n> listener, and not in an individual Connector.', 'Chris Beckey', '2011-03-15 16:54:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (747, '50570', '13', 'The first attachment (named \'Source and properties files to add FIPS ...\') contains source code and properties using TC 6.0.20 as the base.\nThe next two attached files (named \'patch to implement ...\') are patches against the trunk as of the 14th of March 2011, i.e. after version 7.0.11.\nThese were tested against OpenSSL V 0.9.8q with the OpenSSL FIPS module 1.2.2 built and linked in using the directions at \n http://www.openssl.org/docs/fips/UserGuide-1.2.pdf ', 'Chris Beckey', '2011-03-15 17:13:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (748, '50570', '14', 'Just a quick update: I\'m taking a vacation from $work next week and I hope to work on this feature. Chris, if there are any updates to your patch please post them. Otherwise, I\'ll use the existing one.', 'Christopher Schultz', '2011-06-24 14:47:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (749, '50570', '15', 'Created  attachment 27224   [details] \nSomewhat simpler patch for FIPS mode (against TC7 trunk)\n\nI\'m not quite done with my adaptation, but I figured I would get some feedback on this one in the meantime.', 'Christopher Schultz', '2011-06-28 20:40:40 UTC', 'tomcat_attachment/attachment 27224.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (750, '50570', '16', 'Created  attachment 27225   [details] \nA fipsModeSet implementation that is more robust than the original patch\n\n* Provide a fipsModeSet function when OPENSSL is not available.\n* Provide a fipsModeSet implementation that fails gracefully when FIPS is not available.\n* Provide a human-readable error message when failing to enter FIPS mode.', 'Christopher Schultz', '2011-06-28 21:37:31 UTC', 'tomcat_attachment/attachment 27225.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (751, '50570', '17', 'Comment on  attachment 26582   [details] \nSource and properties files to add FIPS initialization call to OpenSSL\n\nReplaced with non-zipped patches.', 'Christopher Schultz', '2011-06-28 21:44:38 UTC', 'tomcat_attachment/attachment 26582.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (752, '50570', '18', '(In reply to  comment #16 )\n\nRegarding  attachment 27225   [details]  (Java patch) I have two comments:\n\n1) Code formatting.\nWe usually have \'{\' on the same line as previous statement (like in Java coding style).\n\n2) I go not get why there are two methods in SSL.java:\nfipsModeSet(Integer mode) and fipsModeSet(int mode).\n\nIf you need class object of \'int\' to do lookup of the method, it is available as Integer.TYPE.', 'Konstantin Kolinko', '2011-07-05 21:57:06 UTC', 'tomcat_attachment/attachment 27225.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (753, '50570', '19', 'Thanks for the comments. Very helpful!\n\n(In reply to  comment #18 )\n> (In reply to  comment #16 )\n> \n> Regarding  attachment 27225   [details]  (Java patch) I have two comments:\n> \n> 1) Code formatting.\n> We usually have \'{\' on the same line as previous statement (like in Java coding\n> style).\n\nI\'m happy to change the use of whitespace, but \'usually\' is somewhat subjective in the TC code base :)\n\n> 2) I go not get why there are two methods in SSL.java:\n> fipsModeSet(Integer mode) and fipsModeSet(int mode).\n> \n> If you need class object of \'int\' to do lookup of the method, it is available\n> as Integer.TYPE.\n\nI mostly reduced the patch provided by (the other) Chris and I remember thinking about the overloaded methods but can\'t remember why I decided to leave them there. Certainly the rest of the code does not require both methods.\n\nCome to think of it, I\'m not sure why the method call needs to be done using reflection at all... both AprLifecycleListener.java and SSL.java are in the Tomcat project (as opposed to tcnative) and thus should never be out of sync.\n\nThe only potential problem is if the native call fails because of a mismatched tcnative library, but that would fail in a way that reflection wouldn\'t solve, anyway.\n\nI\'ll update the patch.', 'Christopher Schultz', '2011-07-05 22:54:15 UTC', 'tomcat_attachment/attachment 27225.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (754, '50570', '20', 'Chris, did you put together an updated patch for this?', 'Mark Thomas', '2011-10-26 09:33:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (755, '50570', '21', '(In reply to  comment #20 )\n> Chris, did you put together an updated patch for this?\n\nI have a patch sitting in my local svn working copy of TC 8 trunk: I haven\'t gotten a chance to test it, yet (building openssl-FIPS+apr proved to be a pain in the past, but I think I\'ve got it working). I haven\'t yet made the changes suggested by Konstantin.\n\nI was a little concerned about the dependency on tcnative 1.1.23 which isn\'t yet released: 1.1.23 will have the native FIPS code required to make this Java patch work.\n\nShall I do tcnative-version-sniffing and bail if the version isn\'t high enough, or just let a native-method-not-found exception be thrown?', 'Christopher Schultz', '2011-10-26 18:44:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (756, '50570', '22', 'Since this is security related, requesting FIPS and the native library not supporting it should prevent Tomcat from starting. You probably want to trap the exception and throw a new one with a nicer error message. I haven\'t looked at the code to see if anything else would be required.', 'Mark Thomas', '2011-10-26 19:09:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (757, '52009', '1', '(In reply to  comment #0 )\n> You can also get these file from attached zip\n> 4. Put sample files QuoteStreamerApp.war as attached in webapp folder\n\n1) You forgot to attach the files.\n\n> \n> 2011-10-11 15:53:01 org.apache.catalina.startup.HostConfig checkResources\n> INFO: Undeploying context [/QuoteStreamerApp]\n\n2) What happened before the above line?  Undeploying/redeploying the webapp is not mentioned in your reproduction scenario.\n\nIt would better to see the full logs. You may attach them to the issue - no need to paste them into the text field.\n\n3) What pages should I access in web browser to reproduce the issue? It is not mentioned. (The logs say that CoyoteAdapter processes a request. What a request that is?)', 'Konstantin Kolinko', '2011-10-12 02:57:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (758, '52009', '2', 'Created  attachment 27764   [details] \ntomcat configuration\n\ntomcat configuration', 'viola.lu', '2011-10-12 03:07:05 UTC', 'tomcat_attachment/attachment 27764');
INSERT INTO `tomcatbeforefixcomments` VALUES (759, '52009', '3', 'Hi, Konstantin:\n\n Errors were generated when tomcat start. I just directly put it before tomcat start, so it failed when start tomcat. You can start tomcat, and then put it in webapp folder to recreate it. \n\nI already sent you the application in gmail, which is so large to attache here.\n\nI tried to debug it, but failed to get request.\n\nMay i can add a println to get request in this tomcat code.\n\nFull log, but i can\'t get any hints from this log, is there log level option i can change, so ii can get more details?\n2011-10-11 15:52:19 org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive QuoteStreamerApp.war\n2011-10-11 15:52:20 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory docs\n2011-10-11 15:52:20 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory examples\n2011-10-11 15:52:20 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory host-manager\n2011-10-11 15:52:20 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory manager\n2011-10-11 15:52:20 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory ROOT\n2011-10-11 15:52:20 org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\'http-bio-8080\']\n2011-10-11 15:52:20 org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\'ajp-bio-8009\']\n2011-10-11 15:52:20 org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\'http-nio-8888\']\n2011-10-11 15:52:20 org.apache.catalina.startup.Catalina start\nINFO: Server startup in 3328 ms\n2011-10-11 15:53:01 org.apache.catalina.startup.HostConfig checkResources\nINFO: Undeploying context [/QuoteStreamerApp]\n2011-10-11 15:53:11 org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive QuoteStreamerApp.war\n2011-10-11 15:53:52 com.ibm.websphere.webmsg.quotestreamer.AppInit init\nINFO: DataSimulator successfully created and set and started.\n2011-10-11 15:54:01 com.ibm.webmsg.example.StockServlet setProperties\nINFO: Configured properties for quote streamer requests.\n2011-10-11 15:54:02 com.ibm.webmsg.example.StockServlet registerURL\nINFO: Registered the URL for comet requests.\n2011-10-11 15:54:02 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n2011-10-11 15:54:02 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n2011-10-11 15:54:04 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n2011-10-11 15:54:04 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n2011-10-11 15:54:07 org.apache.coyote.AbstractProtocol pause\nINFO: Pausing ProtocolHandler [\'http-bio-8080\']\n2011-10-11 15:54:08 org.apache.coyote.AbstractProtocol pause\nINFO: Pausing ProtocolHandler [\'ajp-bio-8009\']\n2011-10-11 15:54:08 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n2011-10-11 15:54:09 org.apache.coyote.AbstractProtocol pause\nINFO: Pausing ProtocolHandler [\'http-nio-8888\']\n2011-10-11 15:54:10 org.apache.catalina.core.StandardService stopInternal\nINFO: Stopping service Catalina\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [ActiveMQConnection[ID:IBM-R86F1CF-2194-1318319631890-0:1] Scheduler] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [ActiveMQ Transport: tcp://localhost/127.0.0.1:61616] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [InactivityMonitor ReadCheck] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [InactivityMonitor WriteCheck] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [Timer-0] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [ActiveMQConnection[ID:IBM-R86F1CF-2194-1318319631890-0:2] Scheduler] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [ActiveMQ Transport: tcp://localhost/127.0.0.1:61616] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [Thread-18] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [ActiveMQ Session Task] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [/QuoteStreamerApp] appears to have started a thread named [ActiveMQ Session Task] but has failed to stop it. This is very likely to create a memory leak.\n2011-10-11 15:54:10 org.apache.coyote.AbstractProtocol stop\nINFO: Stopping ProtocolHandler [\'http-bio-8080\']\n2011-10-11 15:54:10 org.apache.coyote.AbstractProtocol stop\nINFO: Stopping ProtocolHandler [\'ajp-bio-8009\']\n2011-10-11 15:54:10 org.apache.coyote.AbstractProtocol stop\nINFO: Stopping ProtocolHandler [\'http-nio-8888\']\n2011-10-11 15:54:10 org.apache.coyote.AbstractProtocol destroy\nINFO: Destroying ProtocolHandler [\'http-bio-8080\']\n2011-10-11 15:54:10 org.apache.coyote.AbstractProtocol destroy\nINFO: Destroying ProtocolHandler [\'ajp-bio-8009\']\n2011-10-11 15:54:10 org.apache.coyote.AbstractProtocol destroy\nINFO: Destroying ProtocolHandler [\'http-nio-8888\']', 'viola.lu', '2011-10-12 03:18:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (760, '52009', '4', '> I already sent you the application in gmail, which is so large to attache here.\n\n1) I bet that you do not need all 25 Mb of dojox components of dojotoolkit.\n\nThe NPE issue is still reproducible if I delete the dojox folder from the webapp and that shrinks its size significantly.\n\n2) Source code for StockServlet is there - thank you, but sources of its parent class BayeuxServlet is not available.\n\n3) To reproduce the issue, open  http://localhost:8888/QuoteStreamerApp/ \n\nJust open the page in browser and leave it open.\n\nThe page sends a flow of POST requests to\n/QuoteStreamerApp/stockServlet HTTP/1.1\n\n4) I am running with the following line added to catalina.properties file:\norg.apache.coyote.http11.InternalNioInputBuffer.level = FINE\n\nand it shows that there are problems in BayeuxServlet that it calls setHeader() on a response that has already been recycled.\nIt is an application error. This is unacceptable and can lead to updating a response that is being delivered to a different client.\n\nStacktrace in localhost.2011-10-12.log:\n\n12-окт-2011 08:04:02.078 SEVERE [http-nio-8888-exec-8] org.apache.catalina.core.StandardWrapperValve.event Servlet.service() for servlet [StockServlet] in context with path [/QuoteStreamerApp] threw exception\n java.lang.IllegalStateException: The response object has been recycled and is no longer associated with this facade\n	at org.apache.catalina.connector.ResponseFacade.isCommitted(ResponseFacade.java:325)\n	at org.apache.catalina.connector.ResponseFacade.setHeader(ResponseFacade.java:518)\n	at com.ibm.ws.webmsg.servlet.adapter.ServletResponse.setHeader(ServletResponse.java:147)\n	at com.ibm.ws.webmsg.client.bayeux.protocol.vone.JSONTransport.endResponse(JSONTransport.java:191)\n	at com.ibm.ws.webmsg.client.bayeux.protocol.vone.processor.EventDeliveryProcessor.close(EventDeliveryProcessor.java:139)\n	at com.ibm.ws.webmsg.client.bayeux.protocol.vone.WASCEClientImpl.shutdown(WASCEClientImpl.java:117)\n	at com.ibm.ws.webmsg.client.bayeux.protocol.vone.processor.DisconnectProcessor.processMessage(DisconnectProcessor.java:63)\n	at com.ibm.ws.webmsg.client.bayeux.protocol.vone.ClientImpl.processRequest(ClientImpl.java:332)\n	at com.ibm.webmsg.servlet.BayeuxServlet.handleRead(BayeuxServlet.java:233)\n	at com.ibm.webmsg.servlet.BayeuxServlet.event(BayeuxServlet.java:210)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilterEvent(ApplicationFilterChain.java:482)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilterEvent(ApplicationFilterChain.java:376)\n	at org.apache.catalina.core.StandardWrapperValve.event(StandardWrapperValve.java:414)\n	at org.apache.catalina.core.StandardContextValve.event(StandardContextValve.java:192)\n	at org.apache.catalina.valves.ValveBase.event(ValveBase.java:226)\n	at org.apache.catalina.core.StandardHostValve.event(StandardHostValve.java:245)\n	at org.apache.catalina.valves.ValveBase.event(ValveBase.java:226)\n	at org.apache.catalina.valves.ValveBase.event(ValveBase.java:226)\n	at org.apache.catalina.core.StandardEngineValve.event(StandardEngineValve.java:138)\n	at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:211)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:411)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n\n\n5) There are a lot of exceptions like\njavax.jms.JMSException: Could not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: Connection refused: connect\n\nbut the NullPointerException at CoyoteAdapter.java:436 is reproducible.\n\n6) The NPE is reproducible both in 7.0.22 and in trunk.\n\n\nThe requests to of them fail with error 500, but response sizes in different requests are different.\n\nI noted the following while debugging trunk:\n\n1. In access log all requests are POST to /QuoteStreamerApp/stockServlet.\nThey all fail with error 500, but response sizes are different.\n\n2. After the call to getPipeline().getFirst().invoke(request, response) the value of request.isComet() is true.\n\n3. The cause for NPE at CoyoteAdapter.java:436 is that at that point the request is already recycled and request.getMappingData().context  is null.\n\n4. The recycling happens in the finally block in CoyoteAdapter#event(..),\nlines 252-254:\n            if (error || response.isClosed() || !request.isComet()) {\n                request.recycle();\n                request.setFilterChain(null);\n                response.recycle();\n            }\n\nI do not know much about request that is being recycled. It is not the first request that was received.\n\n5. If I put breakpoint on the request.recycle() call above, the call stack is:\n\nCoyoteAdapter.event(Request, Response, SocketStatus) line: 252	\nCoyoteAdapter.service(Request, Response) line: 411	\nHttp11NioProcessor(AbstractHttp11Processor<S>).process(SocketWrapper<S>) line: 970	\nHttp11NioProtocol$Http11ConnectionHandler(AbstractProtocol$AbstractConnectionHandler<S,P>).process(SocketWrapper<S>, SocketStatus) line: 515	\nNioEndpoint$SocketProcessor.run() line: 1550	\n\nAfter returning from event() call on CoyoteAdapter:411 (the call returns false) the lines 431..440 are executed:\n            } else if (!comet) {\n                request.finishRequest();\n                response.finishResponse();\n                if (postParseSuccess) {\n                    // Log only if processing was invoked.\n                    // If postParseRequest() failed, it has already logged it.\n                    ((Context) request.getMappingData().context).logAccess(\n                            request, response,\n                            System.currentTimeMillis() - req.getStartTime(),\n                            false);\n                }\n\nThe comet variable is false and postParseSuccess is true.\nThe request is already recycled and request.getMappingData().context is null, leading to an NPE.', 'Konstantin Kolinko', '2011-10-12 04:31:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (761, '52009', '5', 'You should start an activemq server, then javax.jms.JMSException will be gone.\n\nI already sent you source of project, pls check your gmail.\n\nThanks in advance!', 'viola.lu', '2011-10-12 13:01:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (762, '52009', '6', '(In reply to  comment #4 )\n> 4) I am running with the following line added to catalina.properties file:\n> org.apache.coyote.http11.InternalNioInputBuffer.level = FINE\n\nOps. I meant the following line:\norg.apache.catalina.connector.RECYCLE_FACADES=true\n\n> \n> and it shows that there are problems in BayeuxServlet that it calls setHeader()\n> on a response that has already been recycled. (...)', 'Konstantin Kolinko', '2011-10-13 07:11:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (763, '52009', '7', 'Adding users to the cc list without their explicit permission is extremely rude. You MUST NOT do this. Repeated abuse of Bugzilla in this or any other way will result in your access to Bugzilla being blocked.\n\nAll changes to any Bugzilla issues is automatically routed to the appropriate dev list where all the Apache committers for a project will see it.', 'Mark Thomas', '2011-10-14 11:11:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (764, '52009', '8', '(In reply to  comment #4 )\n> 4) I am running with the following line added to catalina.properties file:\n> org.apache.catalina.connector.RECYCLE_FACADES=true\n> \n> and it shows that there are problems in BayeuxServlet that it calls setHeader()\n> on a response that has already been recycled.\n> It is an application error. This is unacceptable and can lead to updating a\n> response that is being delivered to a different client.\n\nYep. That makes this an application / Bayeux library error rather than a Tomcat bug.', 'Mark Thomas', '2011-10-14 12:58:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (765, '52009', '9', '(In reply to  comment #8 )\n> (In reply to  comment #4 )\n> > 4) I am running with the following line added to catalina.properties file:\n> > org.apache.catalina.connector.RECYCLE_FACADES=true\n> Yep. That makes this an application / Bayeux library error rather than a Tomcat\n> bug.\n\nSee in  comment #4 :\n> 6) The NPE is reproducible both in 7.0.22 and in trunk.\n> (..) \n> \n> 3. The cause for NPE at CoyoteAdapter.java:436 is that at that point the\n> request is already recycled and request.getMappingData().context  is null.\n> \n> 4. The recycling happens in the finally block in CoyoteAdapter#event(..),\n> lines 252-254:\n>             if (error || response.isClosed() || !request.isComet()) {\n>                 request.recycle();\n>                 request.setFilterChain(null);\n>                 response.recycle();\n>             }\n> \n> I do not know much about request that is being recycled. It is not the first\n> request that was received.\n> \n> 5. If I put breakpoint on the request.recycle() call above, the call stack is:\n> \n> CoyoteAdapter.event(Request, Response, SocketStatus) line: 252    \n> CoyoteAdapter.service(Request, Response) line: 411    \n> Http11NioProcessor(AbstractHttp11Processor<S>).process(SocketWrapper<S>) line:\n> 970    \n> Http11NioProtocol$Http11ConnectionHandler(AbstractProtocol$AbstractConnectionHandler<S,P>).process(SocketWrapper<S>,\n> SocketStatus) line: 515    \n> NioEndpoint$SocketProcessor.run() line: 1550    \n> \n> After returning from event() call on CoyoteAdapter:411 (the call returns false)\n> the lines 431..440 are executed:\n>             } else if (!comet) {\n>                 request.finishRequest();\n>                 response.finishResponse();\n>                 if (postParseSuccess) {\n>                     // Log only if processing was invoked.\n>                     // If postParseRequest() failed, it has already logged it.\n>                     ((Context) request.getMappingData().context).logAccess(\n>                             request, response,\n>                             System.currentTimeMillis() - req.getStartTime(),\n>                             false);\n>                 }\n> \n> The comet variable is false and postParseSuccess is true.\n> The request is already recycled and request.getMappingData().context is null,\n> leading to an NPE.\n\nThe above is a legitimate bug. Recycling in event() -> returning to service() -> NPE when trying to log it.', 'Konstantin Kolinko', '2011-10-14 13:05:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (766, '52009', '10', 'Hi, Mark:\n\n Sorry to add you to the cc list without notification in advance. I tried to send email to  markt@apache.org , but rejected, and you are the NIO connector code owner, so i did it. Thanks for your understanding.\n\n This application can work on tomcat 6.0.19, but failed in trunk and 7.0.9/22, so i think it\'s tomcat nio connector problem. If i don\'t add NIO connector to server.xml, there is no exception.', 'viola.lu', '2011-10-14 13:25:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (767, '52009', '11', '(In reply to  comment #9 )\n> > 5. If I put breakpoint on the request.recycle() call above, the call stack is:\n> > \n> > CoyoteAdapter.event(Request, Response, SocketStatus) line: 252    \n> > CoyoteAdapter.service(Request, Response) line: 411    \n> > Http11NioProcessor(AbstractHttp11Processor<S>).process(SocketWrapper<S>) line:\n> > 970    \n> > Http11NioProtocol$Http11ConnectionHandler(AbstractProtocol$AbstractConnectionHandler<S,P>).process(SocketWrapper<S>,\n> > SocketStatus) line: 515    \n> > NioEndpoint$SocketProcessor.run() line: 1550    \n> > \n> > After returning from event() call on CoyoteAdapter:411 (the call returns false)\n> > the lines 431..440 are executed:\n> >             } else if (!comet) {\n> >                 request.finishRequest();\n> >                 response.finishResponse();\n> >                 if (postParseSuccess) {\n> >                     // Log only if processing was invoked.\n> >                     // If postParseRequest() failed, it has already logged it.\n> >                     ((Context) request.getMappingData().context).logAccess(\n> >                             request, response,\n> >                             System.currentTimeMillis() - req.getStartTime(),\n> >                             false);\n> >                 }\n> > \n> > The comet variable is false and postParseSuccess is true.\n> > The request is already recycled and request.getMappingData().context is null,\n> > leading to an NPE.\n> \n> The above is a legitimate bug. Recycling in event() -> returning to service()\n> -> NPE when trying to log it.\n\nSorry. Missed that. I\'ll take a look.\n\n(In reply to  comment #10 )\n> Hi, Mark:\n> \n> Sorry to add you to the cc list without notification in advance. I tried to\n> send email to  markt@apache.org , but rejected, and you are the NIO connector\n> code owner, so i did it. Thanks for your understanding.\n\n1. I am not the maintainer of the NIO code. All of the committers work on all of the code base. There are no project or component leads at the ASF.\n\n2. Sending private mails to individual committers is also frowned upon and most committers (me included) reject or ignore them. The only place to discuss change to the Tomcat code base is the  dev@tomcat.a.o  mailing list.\n\n>  This application can work on tomcat 6.0.19, but failed in trunk and 7.0.9/22,\n> so i think it\'s tomcat nio connector problem. If i don\'t add NIO connector to\n> server.xml, there is no exception.\n\nSee above.', 'Mark Thomas', '2011-10-14 15:03:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (768, '52009', '12', 'The NPE has been fixed in trunk and 7.0.x and will be included in 7.0.23 onwards.', 'Mark Thomas', '2011-10-14 20:59:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (769, '52009', '13', 'Thanks for your quick response. I run the test app against, no exception now. Thanks again.\nIf i offended you , pls forgive. THanks.', 'viola.lu', '2011-10-17 03:35:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (770, '52009', '14', 'I think this issue is reintroduced in tomcat 7.0.68.\nI see in  http://svn.apache.org/repos/asf/tomcat/tc7.0.x/tags/TOMCAT_7_0_67/java/org/apache/catalina/connector/CoyoteAdapter.java :\n{code}\nif (postParseSuccess &&\n                        request.getMappingData().context != null) {\n                    // Log only if processing was invoked.\n                    // If postParseRequest() failed, it has already logged it.\n                    // If context is null this was the start of a comet request\n                    // that failed and has already been logged.\n                    ((Context) request.getMappingData().context).logAccess(\n{code}\nWhile in  http://svn.apache.org/repos/asf/tomcat/tc7.0.x/tags/TOMCAT_7_0_68/java/org/apache/catalina/connector/CoyoteAdapter.java :\n{code}\n   if (postParseSuccess) {\n                        // Log only if processing was invoked.\n                        // If postParseRequest() failed, it has already logged it.\n                        // If context is null this was the start of a comet request\n                        // that failed and has already been logged.\n                        ((Context) request.getMappingData().context).logAccess(\n{code}\nI can not find out where this has been changed from svn logs :-(\nDo you want me to log a new ticket for this?', 'Donald', '2017-07-31 14:07:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (771, '52009', '15', ' http://svn.apache.org/viewvc?view=revision&revision=1720757 ', 'Stefan Bodewig', '2017-07-31 14:20:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (772, '51972', '1', 'The JavaDoc for sendRedirect requires that anything that starts with \'/\' is treated as server relative. I\'m not sure if that is what was intended but it is certainly what the spec currently requires. I don\'t see any reason not to allow protocol relative URLs. I\'ll see if I can get some clarification from the Servlet EG.', 'Mark Thomas', '2011-10-05 22:12:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (773, '51972', '2', 'Discussion on this topic within the Servlet EG can be followed here:\n http://java.net/jira/browse/SERVLET_SPEC-27 \n\nGiven that I am in favour of supporting protocol relative URLs, I will look at adding this support to Tomcat 7 ready for the next release.', 'Mark Thomas', '2011-10-07 22:31:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (774, '51972', '3', 'I would also suggest using the java.net.URI to resolve things in place of any home-brewn code.\n\nprivate String toAbsolute(String href) {\n  URI base = URI.create(requestURI); // original request URI, including protocol\n  return base.resolve(URI.create(href)).toASCIIString();\n}\n\nAnd not just in this case, but all over tomcat where URIs are handled.', 'Heikki Vesalainen', '2011-10-08 08:57:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (775, '51972', '4', 'The home-brew code is used for a good reason - performance. It is currently ~2x faster than the alternative proposed.', 'Mark Thomas', '2011-10-10 11:56:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (776, '51972', '5', '100% difference sounds dramatic, but how many percent of the total response time is spent in this code? How bad would it make things if the slower (but more reliable) version was used? Is it like the home-brewn code is 0,1% of total time and the URI takes 0,2% of total time? That would sound trivial and not worth the optimization.', 'Heikki Vesalainen', '2011-10-10 12:13:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (777, '51972', '6', 'The amount of time spend in the sendRedirect code is likely to be only a small proportion of the overall request time but there are lots of places where URIs are manipulated in the Tomcat codebase. Switching all of them to URI is very likely to impact performance.\n\nIf you want to argue for this change then you\'ll need to present some hard numbers to the dev list (that cover both request processing time and GC) that show that there is no noticeable impact in making this change.', 'Mark Thomas', '2011-10-10 12:22:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (778, '51952', '1', 'I find this a bit funny as I had exactly the same issue with my own CompressionFilter.  The issue is that 7.0.21 produces a response body *inside* sendRedirect().  This entails it obtaining a response writer therein, which your filter can\'t know has occurred as it\'s doing this at a level of the filter chain your filter can\'t see.\n\nThis issue seemed easy enough to address -- for the test cases I initially saw.  Unfortunately for your test case things are not so simple.  I\'m not at all sure how one can do a CompressionFilter with this Tomcat change in place -- as filters can no longer tell when it is safe to call getOutputStream().\n\nI\'m half inclined to remove the Tomcat \'fix\' that caused this from my Tomcat binary.', 'Jess Holle', '2011-10-04 15:57:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (779, '51952', '2', 'How about a new configuration attribute on the context that allows this behaviour to be enabled / disabled per context?\n\nSee  https://issues.apache.org/bugzilla/show_bug.cgi?id=41718  for why this behaviour was introduced.', 'Mark Thomas', '2011-10-05 02:41:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (780, '51952', '3', 'Overall the RFC cited and the existing servlet API do not combine well when one considers things like compression Filters.\n\nI ended up figuring out a way to work around this in my own compression filter (with targeted catching of IllegalStateExceptions and appropriate fallback actions), but I will have to say that it wasn\'t pretty.', 'Jess Holle', '2011-10-05 04:13:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (781, '51952', '4', 'If I had to choose between a new context attribute or mucking with my CompressionFilter with something \'that isn\'t pretty\', well, I\'m going to go with the attribute. :-) \n\nWas the original issue of not including the hypertext note/link in the response body for sendRedirects actually causing trouble or was it just added to conform to the RFC?', 'Kari Scott', '2011-10-05 13:57:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (782, '51952', '5', 'FWIW, the javadoc for javax.servlet.Filter specifically mentions \'compression\' as a type of Filter one might want to build. Though not exactly part of the spec, Tomcat should try it\'s best not to get in the way of building such Filters.\n\nPerhaps one way would be to re-write the patch for  r1156533  to use OutputStream instead of Writer.\n\nSomething I\'m not getting is this:\n\nWhy is your code (say, org.apache.jsp.test_jsp._jspService(test_jsp.java:74)) running after a call to sendRedirect? Also, if *your* code calls sendRedirect(), why isn\'t the request *already* wrapped in your compression wrapper, so that calling sendRedirect which calls getWriter ends up calling your wrapped-getWriter method?', 'Christopher Schultz', '2011-10-05 14:33:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (783, '51952', '6', 'If you look at the JSP source in question, it simply calls sendRedirect() in a scriptlet.  The issue here is that the auto-generated JSP source, whitespace, etc, will try to write more stuff after that call.\n\nIt would probably be more correct to do:\n  response.sendRedirect(...);\n  return;\nin the scriptlet -- which may avoid the issue.\n\nIn any case this sort of attention to detail wasn\'t necessary prior to this change, though, so there are bound to be existing JSP pages, servlets, etc, where this sort of sloppiness exists.  Thus I believe we should endeavor to be forgiving to such cases.\n\nAlso using an output stream rather than a writer won\'t solve the issue as I believe the JSP page in question would then produce an exception *without* a compression filter in place.', 'Jess Holle', '2011-10-05 14:41:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (784, '51952', '7', 'I\'d think the ideal case might be to hide the sendRedirect() response body generation from getOutputStream() and getWriter() entirely.  getOutputStream() and getWriter() could really return no-op output streams and writers after sendRedirect() has been called [as the servlet spec says nothing should be written to the response after this point] and throw IllegalStateExceptions only when things *outside* sendRedirect() have tried to obtain both an output stream and a writer.', 'Jess Holle', '2011-10-05 14:46:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (785, '51952', '8', 'It\'s exactly what Jess said, it\'s the auto-generated JSP code that\'s the\nproblem. And, we do have returns after all of our sendRedirects but in this\nsimple test it wouldn\'t compile because it\'s unreachable so I removed it since\nit didn\'t seem pertinent to the test. The IllegalException occurs both with and\nwithout it.', 'Kari Scott', '2011-10-05 14:51:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (786, '51952', '9', 'If making this behavior transparent to callers is seen as too much overhead/mess/whatever, then I\'d vote to revert the sendRedirect() RFC fix.  I actually prefer that sendRedirect() does not generate a body as I\'m a fan of waste-not-want-not when it comes to IO, CPU, etc, usage.  I don\'t know of any use case I care about that would make use of the response body of a redirect response, so including such a response body seems like a waste.', 'Jess Holle', '2011-10-05 16:39:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (787, '51952', '10', '1. Making the behaviour optional, as suggested in  Comment 2 , should not hurt.\n\n2. I think that CompressionServletResponseWrapper in this example could overwrite the sendRedirect() method and recycle its writer and outputstream.\nThough 1) sendRedirect() may throw an IllegalStateException,\n2) o.a.c.connector.Response#sendRedirect() silently ignores the call if it is performed from within an included call.\n\n3. I wonder whether it is possible to optimize PageContextImpl.release() so that it does not flush the buffer if response has been suspended.', 'Konstantin Kolinko', '2011-10-05 17:03:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (788, '51952', '11', '(In reply to  comment #6 )\n> If you look at the JSP source in question, it simply calls sendRedirect() in a\n> scriptlet.  The issue here is that the auto-generated JSP source, whitespace,\n> etc, will try to write more stuff after that call.\n> \n> It would probably be more correct to do:\n>   response.sendRedirect(...);\n>   return;\n> in the scriptlet -- which may avoid the issue.\n> \n> In any case this sort of attention to detail wasn\'t necessary prior to this\n> change, though, so there are bound to be existing JSP pages, servlets, etc,\n> where this sort of sloppiness exists.  Thus I believe we should endeavor to be\n> forgiving to such cases.\n\nThe same could be true for a JSP that calls sendRedirect and then continues to produce (lots of?) output.\n\nIt seems reasonable for Tomcat to allow webapps to provide their own \'redirect\' response bodies, too. I\'m starting to lean towards Mark\'s suggestion of having this be an application-wide setting (though being able to enable/disable it on a per-request basis might also be nice).\n\n> Also using an output stream rather than a writer won\'t solve the issue as I\n> believe the JSP page in question would then produce an exception *without* a\n> compression filter in place.\n\nI think I wasn\'t thinking clearly when I asked my original question about the wrapper being in place: the root cause is that the compression filter hasn\'t called response.getOutputStream before delegating the call down the filter chain. When sendRedirect() is called, getWriter is called which (IMHO) cause the opposite exception to be thrown: IllegalStateException: getOutputStream has already been called.\n\nThere are places in (Tomcat\'s?) code where IllegalStateException is caught when calling getWriter (or getOutputStream) and then the code switches-over to use the other strategy to accommodate the current situation. Maybe Tomcat\'s sendRedirect code should be augmented to do such error recovery.\n\nFinally, I just have to say it: JSP can be abused in /so many/ ways, and performing a redirect from a JSP is one such example.', 'Christopher Schultz', '2011-10-05 21:36:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (789, '51630', '1', 'I see no such exception running the latest 7.0.x code.', 'Mark Thomas', '2011-08-07 10:32:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (790, '51630', '2', '(In reply to  comment #1 )\n> I see no such exception running the latest 7.0.x code.\n\nI using the 7.0.19 code.\n\nThe IllegalStateException not showed in the browser, \nbut in the Tomcat/logs/localhost.2011-08-07.log', 'zhh', '2011-08-08 00:33:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (791, '51630', '3', 'Observing this as well with current trunk@ r1178371  (7.0.22) using Nio connector.\nWinXP 32-bit, JDK 6u26.\n\nSteps to reproduce:\n1. Configure Tomcat with org.apache.coyote.http11.Http11NioProtocol\nI also have logging configured with OneLineFormatter, but that should not matter.\n\n2. Start it and open in web browser the following page:\n http://localhost:8080/examples/async/async0 \n\n3. The following exception is in localhost.<date>.log: (not in catalina*.log !)\n\n03-окт-2011 14:35:15.218 SEVERE [http-nio-8080-exec-2] org.apache.catalina.core.StandardWrapperValve.invoke Servlet.service() for servlet [async0] in context with path [/examples] threw exception [java.lang.RuntimeException: java.lang.IllegalStateException: Calling [asyncComplete()] is not valid for a request with Async state [DISPATCHED]] with root cause\n java.lang.IllegalStateException: Calling [asyncComplete()] is not valid for a request with Async state [DISPATCHED]\n	at org.apache.coyote.AsyncStateMachine.asyncComplete(AsyncStateMachine.java:221)\n	at org.apache.coyote.http11.Http11NioProcessor.actionInternal(Http11NioProcessor.java:476)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:807)\n	at org.apache.coyote.Request.action(Request.java:344)\n	at org.apache.catalina.core.AsyncContextImpl.complete(AsyncContextImpl.java:89)\n	at async.Async0.service(Async0.java:42)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:593)\n	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:530)\n	at org.apache.catalina.core.AsyncContextImpl$1.run(AsyncContextImpl.java:173)\n	at org.apache.catalina.core.AsyncContextImpl.doInternalDispatch(AsyncContextImpl.java:314)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:296)\n	at org.apache.coyote.http11.AbstractHttp11Processor.asyncDispatch(AbstractHttp11Processor.java:1486)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:511)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1554)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n\nIn catalina.<date>.log one can see debug messages from Async0 servlet:\n03-окт-2011 14:35:15.218 INFO [http-nio-8080-exec-2] async.Async0.service Received dispatch, completing on the worker thread.\n03-окт-2011 14:35:15.218 INFO [http-nio-8080-exec-2] async.Async0.service After complete called started:false\n\nWhat bothers me is that Async0 servlet is not annotated with @WebServlet(asyncSupported=true) as required by ch.2.3.3.3 of servlet-3_0-final-spec.pdf.  Page #12 (34/230) there: \'It is illegal to call startAsync if the request is within the scope of a servlet or filter that does not support asynchronous operations\'\n\nThe same chapter describes \'isAsyncStarted()\' saying that it should return false after a dispatch call. That is what we are observing here.\n\nFrom description of \'complete()\' in the same chapter, it is container\'s responsibility to call complete() after service() method exits: \'The complete method can be invoked by the container if\nthe request is dispatched to a servlet that does not support async processing, or\nthe target servlet called by AsyncContext.dispatch does not do a\nsubsequent call to startAsync. In this case, it is the container\'s responsibility\nto call complete() as soon as that servlet\'s service method is exited.\'\n\n\nSo I think the IllegalStateException is valid here, but the Async0 example should be fixed by removing the complete() call and annotating the servlet with @WebServlet(asyncSupported=true).', 'Konstantin Kolinko', '2011-10-03 11:10:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (792, '51630', '4', '(In reply to  comment #3 )\n> What bothers me is that Async0 servlet is not annotated with\n> @WebServlet(asyncSupported=true) as required by ch.2.3.3.3 of\n> servlet-3_0-final-spec.pdf.  Page #12 (34/230) there: \'It is illegal to call\n> startAsync if the request is within the scope of a servlet or filter that does\n> not support asynchronous operations\'\n\nYou can also set async support in web.xml and this is what is done for the examples.', 'Mark Thomas', '2011-10-03 17:14:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (793, '51872', '1', 'Is it with HTTP connector or AJP connector?\nIs it standalone Tomcat, or fronted by some other HTTP server?\n\nWhat connector implementations are you observing this with (BIO/NIO/APR)? It is shown in the logs when Tomcat starts up.\n\nDo you have RemoteIpValve configured?\n\nIs it reproducible with a simple web application?', 'Konstantin Kolinko', '2011-09-22 18:17:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (794, '51872', '2', 'I\'ve double checked the Tomcat 7 code and remote host and remote address are recycled at exactly the same point. If one failed to recycle, so would the other and both would be wrong. I am therefore doubtful that this is a Tomcat bug. To add to Konstantin\'s questions, how confident are you that the IP address in the auth header is correct?', 'Mark Thomas', '2011-09-22 18:22:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (795, '51872', '3', 'It\'s standalone.  No mod_jk. We have ran various packet captures to verify that the IP address in the auth header is correct.  Since the IP address in the header and the IP address from the getRemoteHost match, we believe that that getRemoteAddr is wrong.  Difficult part of this is that we can not reproduce this in our test environments.\n\nConnector:\n    <Connector allowTrace=\'true\' asyncTimeout=\'10000\' enableLookups=\'true\' maxPostSize=\'2097152\' maxSavePostSize=\'4096\' parseBodyMethods=\'POST\' redirectPort=\'-1\' scheme=\'http\' secure=\'false\' URIEncoding=\'UTF-8\' xpoweredBy=\'false\' acceptCount=\'100\' acceptorThreadCount=\'1\' address=\'0.0.0.0\' bindOnInit=\'true\' socketBuffer=\'9000\' compressableMimeType=\'text/html,text/xml,text/plain\' compression=\'off\' compressionMinSize=\'2048\' connectionLinger=\'-1\' connectionTimeout=\'60000\' connectionUploadTimeout=\'60000\' disableUploadTimeout=\'true\' executor=\'\' keepAliveTimeout=\'20000\' maxConnections=\'200\' maxHttpHeaderSize=\'8192\' maxKeepAliveRequests=\'1\' maxThreads=\'200\' maxTrailerSize=\'8192\' minSpareThreads=\'10\' noCompressionUserAgents=\'\' processorCache=\'200\' port=\'4080\' restrictedUserAgents=\'\' server=\'Apache\' SSLEnabled=\'false\' tcpNoDelay=\'true\' sslImplemenationName=\'org.apache.tomcat.util.net.jsse.JSSEImplementation\' clientCertProvider=\'\' keyPass=\'changeit\' sslEnabledProtocols=\'\' trustManagerClassName=\'\' trustMaxCertLength=\'5\' truststoreAlgorithm=\'\'/>\n \nValves:\n\n <Valve className=\'yjava.tomcat.valves.YahooConnectionValve\'/>\n\n     <Valve className=\'com.yahoo.yjava.YahooLogValve\' directory=\'/home/y/logs/yjava_tomcat/\' yahooOpts=\'gmrswZX\' prefix=\'access.\' resolveHosts=\'false\' suffix=\'.log\' rotatable=\'true\' buffered=\'false\' fileDateFormat=\'yyyy-MM-dd.HH\'/>\n \n\n\n\nMore debugs.\n\n2011-09-22 18:12:53,576 INFO  [org.apache.coyote.http11.Http11Protocol] Starting ProtocolHandler [\'http-bio-/0.0.0.0-4080\']\n2011-09-22 18:12:53,586 DEBUG [org.apache.catalina.connector.MapperListener] Register Wrapper [default] in Context [] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:12:53,586 DEBUG [org.apache.catalina.connector.MapperListener] Register Wrapper [jsp] in Context [] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:12:53,586 DEBUG [org.apache.catalina.connector.MapperListener] Register Context [] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:12:53,586 DEBUG [org.apache.catalina.connector.MapperListener] Register Wrapper [default] in Context [/yjava_ws_examples_filters] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:12:53,587 DEBUG [org.apache.catalina.connector.MapperListener] Register Wrapper [jsp] in Context [/yjava_ws_examples_filters] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:12:53,587 DEBUG [org.apache.catalina.connector.MapperListener] Register Wrapper [jersey] in Context [/yjava_ws_examples_filters] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:12:53,587 DEBUG [org.apache.catalina.connector.MapperListener] Register Wrapper [noop] in Context [/yjava_ws_examples_filters] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:12:53,587 DEBUG [org.apache.catalina.connector.MapperListener] Register Wrapper [requestparams] in Context [/yjava_ws_examples_filters] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:12:53,587 DEBUG [org.apache.catalina.connector.MapperListener] Register Context [/yjava_ws_examples_filters] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:12:53,587 DEBUG [org.apache.catalina.connector.MapperListener] Register host [localhost] at domain [null] for connector [Connector[HTTP/1.1-4080]]\n2011-09-22 18:15:06,149 DEBUG [org.apache.coyote.http11.Http11Protocol] Register Catalina:type=RequestProcessor,worker=\'http-bio-/0.0.0.0-4080\',name=HttpRequest1\n2011-09-22 18:15:06,226 DEBUG [org.apache.catalina.connector.CoyoteAdapter] The variable [uriBC] has value [/yjava_ws_examples_filters/v1/yiv/hello]\n2011-09-22 18:15:06,226 DEBUG [org.apache.catalina.connector.CoyoteAdapter] The variable [semicolon] has value [-1]\n2011-09-22 18:15:06,226 DEBUG [org.apache.catalina.connector.CoyoteAdapter] The variable [enc] has value [UTF-8]', 'charlie', '2011-09-22 18:36:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (796, '51872', '4', 'I don\'t see remoteAddrMB being recycled.\n\nprivate MessageBytes remoteAddrMB = MessageBytes.newInstance();\n\n\n   // -------------------- Recycling -------------------- \n\n\n    public void recycle() {\n        bytesRead=0;\n\n        contentLength = -1;\n        contentTypeMB = null;\n        charEncoding = null;\n        headers.recycle();\n        serverNameMB.recycle();\n        serverPort=-1;\n        localPort = -1;\n        remotePort = -1;\n        available = 0;\n\n        cookies.recycle();\n        parameters.recycle();\n\n        unparsedURIMB.recycle();\n        uriMB.recycle(); \n        decodedUriMB.recycle();\n        queryMB.recycle();\n        methodMB.recycle();\n        protoMB.recycle();\n\n        schemeMB.recycle();\n\n        instanceId.recycle();\n        remoteUser.recycle();\n        authType.recycle();\n        attributes.clear();\n    }', 'charlie', '2011-09-22 19:35:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (797, '51872', '5', 'Where in Tomcat 6, its being recycled. \n\n http://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/java/org/apache/tomcat/util/http/BaseRequest.java \n\nMessageBytes remoteAddr = MessageBytes.newInstance();\n\n\n/**\n     * Recycles this object and readies it further use.\n     */\n    public void recycle() {\n        method.recycle();\n        protocol.recycle();\n        requestURI.recycle();\n        remoteAddr.recycle();\n        remoteHost.recycle();\n        serverName.recycle();\n        serverPort = 80;\n        remoteUser.recycle();\n        authType.recycle();\n        queryString.recycle();\n        authorization.recycle();\n        scheme = SCHEME_HTTP;\n        secure = false;\n        contentLength = 0;\n        contentType.recycle();\n        headers.recycle();\n        cookies.recycle();\n        attributes.clear();\n        tomcatInstanceId.recycle();\n    }', 'charlie', '2011-09-22 19:53:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (798, '51872', '6', 'I don\'t think that is it.\n\nThe remoteHost MessageBytes aren\'t recycled either in Tomcat 7 and that doesn\'t have the same issue. Also, I don\'t see how the remoteAddr MessageBytes could be accessed without first having been set.\n\nI am extremely reluctant to start changing code without a clear explanation of why making the change will fix the observed problem. I don\'t mind if I can\'t reproduce the problem but there does need to be a logical explanation of why the change fixes the observed issue.', 'Mark Thomas', '2011-09-22 20:28:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (799, '51872', '7', 'If the application is retaining a reference to the request object there is a possible race condition that could lead to the behaviour you see here.\n\nIf during the call to AbstractHttp11Processor.recycle() - triggered at the end of request processing - if there is a call to Request.getRemoteAddr() after AbstractHttp11Processor.remoteAddr has been set to null but before recycleInternal() is called then remoteAddr will end up being populated with the IP address of the previous connection.\n\nThe way to test this is to set set the following system property:\norg.apache.catalina.connector.RECYCLE_FACADES=true\n\nPlease let us know how you get on with testing using this setting.', 'Mark Thomas', '2011-09-22 21:55:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (800, '51872', '8', 'Looking at this again this morning, if the problem is in a Valve RECYCLE_FACADES won\'t help since Valves have direct access to the Request object rather than using the Facade.\n\nThe patch below can be used to see if a Valve (or similar) is accessing the request after it has been recycled. In addition to logging an error, it can either return null or throw an exception if this happens. Just comment out the one you don\'t want.\n\n\nIndex: java/org/apache/catalina/connector/Request.java\n===================================================================\n--- java/org/apache/catalina/connector/Request.java	( revision 1174344 )\n+++ java/org/apache/catalina/connector/Request.java	(working copy)\n@@ -508,7 +508,8 @@\n         }\n \n         mappingData.recycle();\n-\n+        remoteAddr = null;\n+        \n         if (Globals.IS_SECURITY_ENABLED || Connector.RECYCLE_FACADES) {\n             if (facade != null) {\n                 facade.clear();\n@@ -1263,6 +1264,12 @@\n      */\n     @Override\n     public String getRemoteAddr() {\n+        if (mappingData.host == null) {\n+            String msg = \'Access to Request at invalid point in lifecycle\';\n+            log.error(msg);\n+            // throw new IllegalStateException(msg);\n+            return null;\n+        }\n         if (remoteAddr == null) {\n             coyoteRequest.action\n                 (ActionCode.REQ_HOST_ADDR_ATTRIBUTE, coyoteRequest);', 'Mark Thomas', '2011-09-23 08:09:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (801, '51872', '9', 'Yes, RECYCLE_FACADES=true didn\'t work for us.\nWe will try the patch from the  comment 8  and let you know.\nThanks.', 'charlie', '2011-09-23 15:14:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (802, '51872', '10', 'Mark,\nAfter applying the patch from  comment 8 , we get these in our logs (quite a alot).  But we no longer have our problem of getting the previous IP address.\n\n03:17:04,436 ERROR [Request] THREADID:292###PATCH###: Access to Request at invalid point in lifecycle.  Returning null\nfor getRemoteAddr().', 'charlie', '2011-09-24 03:44:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (803, '51872', '11', 'Fixed in trunk and 7.0.x and will be included in 7.0.22 onwards.\n\nI also fixed a related issue discovered during testing that meant requests with multiple errors could trigger multiple entries in the access log.', 'Mark Thomas', '2011-09-27 20:19:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (804, '51872', '12', 'Fixed in 6.0 with  r1185998  and will be in 6.0.34 onwards.', 'Konstantin Kolinko', '2011-10-19 07:18:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (805, '51872', '13', 'We are seeing the same issue when Tomcat 7.0.22 is under heavier load (in our case servicing >30 incoming POST requests per second). \n\nrequest.getRemoteAddr() is periodically (though not consistently) returning an IP address from the previous request.', 'Bart Hanlon', '2011-11-03 22:38:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (806, '51872', '14', 'This issue has been fixed. There are multiple possible causes of the symptom described here and the vast majority of them are application bugs. Please follow-up on the users-mailing list.', 'Mark Thomas', '2011-11-03 22:41:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (807, '51872', '15', 'Mark,\n\nwe upgraded from 6.0.29 to 7.0.23 and have exactly the same problem. I can certainly exclude an application bug. This method is fundamental!', 'Michael Hauck', '2012-03-15 15:08:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (808, '51580', '1', 'I\'ve just find out that the problem was in a specific file within the WAR:\n\n\'Cliente-TextExtractRules-Açoreana.properties\'\n\nThe file name has Portuguese accented char \'ç\'.\n\nAfter replace the char by \'c\' in that file, the deployment was done ok.', 'Cleon', '2011-07-28 23:18:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (809, '51580', '2', 'Your WAR file is not valid. I suspect it was created with a zip utility rather than with jar. The default character sets are different. You need to use jar if you have file names that are use non-ASCII characters.', 'Mark Thomas', '2011-07-29 21:25:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (810, '51580', '3', 'Actually was using the zip\'s Ant task to produce the war file and I didn\'t realized that because it\'s a automatically generated build.xml from Google GWT.', 'Cleon', '2011-07-30 00:21:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (811, '51580', '4', 'Zip uses platform default encoding to encode file names.\nJAR uses UTF-8.\n\n\njava.lang.NullPointerException\n        at org.apache.catalina.startup.ExpandWar.expand(ExpandWar.java:407)\n        at org.apache.catalina.startup.ExpandWar.expand(ExpandWar.java:138)\n\nIt looks as if InputStream reference in ExpandWar#expand(InputStream, File) was null. That is an earlier call to jarFile.getInputStream(jarEntry) on ExpandWar.java:135 returned null.\n\nThe Javadoc for JarFile#getInputStream(ZipEntry) does not say that it can return null. I would have expected a ZipException here.', 'Konstantin Kolinko', '2011-07-30 14:32:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (812, '51580', '5', 'It seems like adding a null check here would be good, since NPE in Tomcat looks like a bug in Tomcat instead of an error in the WAR file. I\'m re-opening for that reason.\n\nPlease re-close INVALID if you are adamant about not having a null check.', 'Christopher Schultz', '2011-08-01 18:35:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (813, '51580', '6', 'I\'m not overly concerned about this. If you want to patch it, go ahead. If you don\'t I\'ll eventually close this as WONTFIX.', 'Mark Thomas', '2011-08-01 21:23:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (814, '51580', '7', 'Cleon, can you attach a minimal WAR file that reproduces this issue? Also, if there are any environmental settings necessary, such as expandWars=\'false\', please let me know.', 'Christopher Schultz', '2011-08-12 19:02:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (815, '51580', '8', 'Created  attachment 27385   [details] \nMinimal war to reproduce the problem\n\nHere\'s the file. There\'s no special env settings, just import the file.\n\nRegards,\n   Cléon', 'Cleon', '2011-08-13 20:17:31 UTC', 'tomcat_attachment/attachment 27385');
INSERT INTO `tomcatbeforefixcomments` VALUES (816, '51580', '9', 'Changing back to an enhancement. There is no Tomcat bug here.', 'Mark Thomas', '2011-08-15 10:55:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (817, '51580', '10', '(In reply to  comment #4 )\n> Zip uses platform default encoding to encode file names.\n> JAR uses UTF-8.\n\nI\'m not so sure that\'s true:\n\n$ echo $LC_CTYPE\nen_US.UTF-8\n\n$ jar tvf 51580.war \n     0 Sat Aug 13 21:06:34 EDT 2011 text_extraction_rules/\n   594 Sat Aug 13 21:06:34 EDT 2011 text_extraction_rules/Cliente-TextExtractRules-Açoreana.properties\n   570 Sat Aug 13 21:06:34 EDT 2011 text_extraction_rules/Cliente-TextExtractRules-Liberty.properties\n\n$ LC_CTYPE=en_US.ISO-8851-1 jar tvf 51580.war \n     0 Sat Aug 13 21:06:34 EDT 2011 text_extraction_rules/\n   594 Sat Aug 13 21:06:34 EDT 2011 text_extraction_rules/Cliente-TextExtractRules-A?oreana.properties\n   570 Sat Aug 13 21:06:34 EDT 2011 text_extraction_rules/Cliente-TextExtractRules-Liberty.properties\n\n$ unzip -v 51580.war \nArchive:  51580.war\n Length   Method    Size  Cmpr    Date    Time   CRC-32   Name\n--------  ------  ------- ---- ---------- ----- --------  ----\n       0  Stored        0   0% 2011-08-13 21:06 00000000  text_extraction_rules/\n     594  Stored      594   0% 2011-08-13 21:06 3271f2b8  text_extraction_rules/Cliente-TextExtractRules-A?oreana.properties\n     570  Stored      570   0% 2011-08-13 21:06 a00a7a2c  text_extraction_rules/Cliente-TextExtractRules-Liberty.properties\n--------          -------  ---                            -------\n    1164             1164   0%                            3 files\n\n\nWhen my file.encoding ends up being ISO-8859-1, jar acts just as stupidly as zip.', 'Christopher Schultz', '2011-08-25 13:55:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (818, '51580', '11', 'Interestingly enough, Apache Ant\'s \'zip\' and \'jar\' tasks both have an \'encoding\' attribute to control the charset used for filenames, but they have a subtle difference in their default configurations.\n\nThe <zip> task defaults to the platform\'s default encoding while the <jar> task defaults to UTF-8 with a *strong* warning not to change the default <jar> encoding unless you know what you\'re doing.\n\n http://ant.apache.org/manual/Tasks/zip.html#encoding \n\nSo it looks like Cleon must have used <zip> instead of the much more appropriate <war> task to create his WAR file.\n\nStill, I think it\'s a good idea to throw a different kind of exception. NPEs make it look like there is an actual bug in Tomcat which is certainly not the case.', 'Christopher Schultz', '2011-08-25 15:18:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (819, '51687', '1', 'Which daemon thread?\n\nIs this the same as  bug #51688 ?', 'Christopher Schultz', '2011-08-19 16:51:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (820, '51687', '2', 'I do not think so. It is a thread named \'Java2D Disposer\', created in the static initializer of the sun.java2d.Disposer class.', 'Michał Politowski', '2011-08-22 08:44:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (821, '51687', '3', 'Can you post minimal code to cause this thread to be created?\n\nI\'ve just added a fix for that other, somewhat related, bug and I\'d be happy to add this as well.', 'Christopher Schultz', '2011-08-22 13:50:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (822, '51687', '4', 'The exact code that causes it in the webapp at hand is a\nsun.java2d.Disposer.getQueue() call\nsomewhere in the standard JRE library,\nbut actually just anything that loads the class, even Class.forName(\'sun.java2d.Disposer\'), is enough.', 'Michał Politowski', '2011-08-22 14:12:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (823, '51739', '1', 'No information provided.', 'Mark Thomas', '2011-08-29 13:48:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (824, '51739', '2', '	<Valve className=\'org.apache.catalina.authenticator.FormAuthenticator\'\n		landingPage=\'/restrito/principal.xhtml\' />\n\nA workaround is the use of a jsp page that redirect to the xhtml page (JSF page).\n\njava.lang.NullPointerException: Name is null\n	at java.lang.Enum.valueOf(Unknown Source)\n	at javax.faces.webapp.FacesServlet$HttpMethod.valueOf(FacesServlet.java:172)\n	at javax.faces.webapp.FacesServlet.isHttpMethodValid(FacesServlet.java:627)\n	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:549)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:582)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:279)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n	at java.lang.Thread.run(Unknown Source)\n29/08/2011 10:42:35 org.apache.catalina.core.ApplicationDispatcher invoke\nGRAVE: Servlet.service() for servlet Faces Servlet threw exception\njava.lang.NullPointerException: Name is null\n	at java.lang.Enum.valueOf(Unknown Source)\n	at javax.faces.webapp.FacesServlet$HttpMethod.valueOf(FacesServlet.java:172)\n	at javax.faces.webapp.FacesServlet.isHttpMethodValid(FacesServlet.java:627)\n	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:549)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:473)\n	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)\n	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)\n	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:466)\n	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:315)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:179)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:279)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n	at java.lang.Thread.run(Unknown Source)\n29/08/2011 10:42:35 org.apache.catalina.core.StandardHostValve custom\nGRAVE: Exception Processing ErrorPage[exceptionType=java.lang.Exception, location=/erro_servidor.xhtml]\njava.lang.NullPointerException: Name is null\n	at java.lang.Enum.valueOf(Unknown Source)\n	at javax.faces.webapp.FacesServlet$HttpMethod.valueOf(FacesServlet.java:172)\n	at javax.faces.webapp.FacesServlet.isHttpMethodValid(FacesServlet.java:627)\n	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:549)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:473)\n	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)\n	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)\n	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:466)\n	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:315)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:179)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:279)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n	at java.lang.Thread.run(Unknown Source)', 'Flávio Henrique', '2011-08-29 13:52:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (825, '51739', '3', '(In reply to  comment #1 )\n> No information provided.\n\nSorry, save the information before entering futher information.', 'Flávio Henrique', '2011-08-29 13:55:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (826, '51739', '4', 'That is not a Tomcat problem.', 'Mark Thomas', '2011-08-29 14:23:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (827, '51739', '5', 'To elaborate in order to avoid a REOPEN:\n\nFlávio, you must have an enumerated type that is broken.', 'Christopher Schultz', '2011-08-29 17:10:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (828, '51739', '6', '(In reply to  comment #5 )\n> To elaborate in order to avoid a REOPEN:\n> \n> Flávio, you must have an enumerated type that is broken.\n\nFrom stacktrace and message it seems that valueOf(null) was called with null as a value of HTTP method.\n\nLooking at o.a.c.authenticator.FormAuthenticator class, there are three places where \'new SavedRequest()\' constructor is called:\n one is in #saveRequest(),\n two are in #authenticate().\n\nWhen in #saveRequest() the created SavedRequest object is filled with data, but in #authenticate() only requestURI is set and thus SavedRequest#method remains null.', 'Konstantin Kolinko', '2011-08-29 18:07:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (829, '51558', '1', 'Use addContext()', 'Mark Thomas', '2011-07-26 10:24:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (830, '51558', '2', '(In reply to  comment #1 )\n> Use addContext()\n\nbecause i need to deploy a WAR-File, that includes a web.xml file, it would be  more complicated to use addContext(), because i cant find any examples in the web that use addContext() in combination with web.xml...\n\nbut your right, this should be a missing feature, not a bug. I hope some official documentation for tomcat-embedded will be available soon.', 'bhuber', '2011-07-26 11:13:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (831, '51558', '3', 'ah sorry, its ok nevermind .. i know now how to do it: ;-)\nlike you said, i will now just create a standardcontext instead, \nand just dont add a defaultwebxmllistener ...\n\n  Context ctx = new StandardContext();\n  ctx.setName(name);\n  ctx.setPath(url);\n  ctx.setDocBase(path);\n  if (defaultRealm == null) {\n      initSimpleAuth();\n  }\n  ctx.setRealm(defaultRealm);\n        \n  ContextConfig ctxCfg = new ContextConfig();\n  ctx.addLifecycleListener(ctxCfg);\n        \n  // prevent it from looking ( if it finds one - it\'ll have dup error )\n  ctxCfg.setDefaultWebXml(\'org/apache/catalin/startup/NO_DEFAULT_XML\');\n        \n  if (host == null) {\n     getHost().addChild(ctx);\n  } else {\n      host.addChild(ctx);\n  }', 'bhuber', '2011-07-26 11:20:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (832, '51558', '4', 'A user of memcached-session-manager also ran into this issue and it took me some time that when using addWebapp the manager is just overwritten.\n\nI\'d suggest to set the StandardManager only if there\'s no manager set on the context.\n\nAre there any problems why this should not be done?', 'Martin Grotzke', '2011-08-24 22:47:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (833, '51558', '5', 'Created  attachment 27432   [details] \nAttached patch that only sets StandardManager if the manager is not already set', 'Martin Grotzke', '2011-08-24 22:56:36 UTC', 'tomcat_attachment/attachment 27432.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (834, '49683', '1', 'Currently async timeouts are ignored as well. That makes this issue more serious.', 'Mark Thomas', '2010-09-23 17:07:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (835, '49683', '2', 'More refactoring resulting in not using the APR poller for async timeouts so this is no longer an issue for async.', 'Mark Thomas', '2010-09-27 08:02:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (836, '49683', '3', 'Move to enhancement request since no-one is complaining / has complained about this apart from me.', 'Mark Thomas', '2011-05-23 09:28:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (837, '49683', '4', 'This has been fixed in trunk (no native code changes required) but not yet back-ported to 7.0.x. See  r1158436 .', 'Mark Thomas', '2011-08-16 19:28:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (838, '51588', '1', 'Are those new fields specific for your environment? Maybe you can propose them to be added to AccessLogValve?', 'Konstantin Kolinko', '2011-07-30 12:18:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (839, '51588', '2', 'I want to add a %f and %F as possible options in the custom log pattern to log IP address and name safely extracted from the X-Forwarded-For header with a fallback to HttpServletRequest.getRemoteAddr().\n\nJust to back up and clarify my original bug report in case it wasn\'t clear (now that I re-read it I think I could have been clearer):\n\nAt the bottom of org.apache.catalina.valves.AccessLogValve, the last two private methods are:\n\nprivate AccessLogElement createAccessLogElement(char pattern)\n\nand\n\nprivate AccessLogElement createAccessLogElement(String header, char pattern)\n\nIf you want to add another \'field\' to the custom log format pattern by subclassing AccessLogValve then you have to go up to the 3rd last method:\n\nprotected AccessLogElement[] createLogElements()\n\nbut unfortunately it contains a lot of good logic that would have to be either completely copied or duplicated in some way. Overriding one or both of the two private methods lets you simply plug in your addition and not replace any of the functionality of the original AccessLogValve.\n\nThis is the same for both the version 6 and 7 sources.\n\nSo my suggestions is simply to replace \'private\' with \'protected\' in the last 2 methods in AccessLogValve.\n\nOf course I\'d love the new options to be added to the Catalina core but I suspected that they may be slightly peripheral? Perhaps not. I\'ve just finished writing up the details for anyone else that may have a use for this functionality at:  http://rod.vagg.org/2011/07/handling-x-forwarded-for-in-java-and-tomcat/ \n\nIf you think this would be useful to integrate into Catalina then I\'d be more than happy to refactor it all into AccessLogValve (it uses an additional utility class as it is now) and post a patch here; please let me know what you think about that option.\n\nI think changing those access modifiers would be useful in either case by the way.', 'Rod', '2011-07-30 12:49:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (840, '51588', '3', 'Note, that\n\n1. Parsing of X-Forwarded-For is already implemented in Tomcat 7 in RemoteIpValve and RemoteIpFilter.  RemoteIpValve was backported to Tomcat 6, though maybe not all features of it.\n\n2. AccessLogValve in Tomcat 7 can use request attributes that are set by RemoteIpValve if you set AccessLogValve.requestAttributesEnabled property to true.\n\n3. You can set any attribute on the request object (even in the Valve itself) and reference it later as %{xxx}r', 'Konstantin Kolinko', '2011-07-30 13:41:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (841, '51588', '4', 'Methods changed in 7.0.x and will be included in 7.0.20 onwards.\n\nSame change proposed for 6.0.x.\n\nEven if Tomcat does support this particular use case, the general one of extensibility is a valid one.', 'Mark Thomas', '2011-07-31 17:41:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (842, '51056', '1', 'Created  attachment 26883   [details] \nDrop SSLv2 support.', 'Damien Raude-Morvan', '2011-04-13 14:13:28 UTC', 'tomcat_attachment/attachment 26883.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (843, '51056', '2', 'Could you attached a diff -u.', 'jfclere', '2011-07-19 10:12:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (844, '51056', '3', 'I\'m not so sure, that the library should drop support, but I would be +1 to support only SSLv3 and TLSv1 by default in Tomcat if not explicitely configured for something else (e.g. with +SSLv2).\n\nThe change will be an incompatible though, but probably OK because of security concerns.\n\nRegards,\n\nRainer', 'Rainer Jung', '2011-07-19 11:09:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (845, '51056', '4', 'Hi,\n\n@jfclere: Could you explain a little bit more your issue with format of current patch attached to this Bugzilla ? AFAIK, it\'s in udiff format and I\'m able to apply it with a \'patch -p1 < drop_sslv2_support.diff\'.\n\n@Rainer Jung: SSLv2 is disabled in IE7, Opera and Firefox since 2006. So one day or another you\'ll have to drop support for it :)\n\nBest regards,\n-- \nDamien Raude-Morvan', 'Damien Raude-Morvan', '2011-07-19 20:18:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (846, '51056', '5', 'Created  attachment 27300   [details] \nDrop SSLv2 support in native examples\n\nTo apply the patch one has to remove those \'a/jni\' and \'b/jni\' prefixes that do not match the svn source layout. There were changes in sslcontext.c recently, so the patch does not apply cleanly anymore.\n\nAnyway,\n1) tc-native is still used on old systems, like Tomcat 5.5, and thus I don\'t feel comfortable removing this feature.\n\nMaybe consider this for trunk of tc-native or postpone until native 1.2 is more near?\n\nMaybe make this code conditional using some #define, e.g. OpenSSL version?\n\n2) +1 to disable it by default in java code in Tomcat\n\n\nThe patch also updates tc-native examples. I am attaching a part of Damien Raude-Morvan\'s patch that modifies the examples, against 1.1.x branch of tomcat/native.\n\n\nRegarding the examples:\n* examples/org/apache/tomcat/jni/SSLServer.java:\n OK for the change\n* examples/org/apache/tomcat/jni/SSL.properties:\n -1:\n First, if I understand the old value correctly, it enables \'ALL\' ciphers, then shifts SSLv2 to the end of the list by priority. Removing SSLv2 moves it to the front of the list and that is wrong. To disable it, one can write !SSLv2\n\n Second, the old value matches whatever default is in Apache HTTPD 2.2, see\n\n http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslciphersuite \n\nApache HTTPD 2.3 docs say that default depends on OpenSSL version, without providing further specifics. I do not see the value in the code - I think it comes from OpenSSL.\n\nOpenSSL docs say that the default value is DEFAULT and it is determined at compile time.\n\n  http://www.openssl.org/docs/apps/ciphers.html#CIPHER_STRINGS \n\nApparently for OpenSSL 1.0.0 the correct value to be used as default will be literally \'DEFAULT\'.\n\nThe above mentioned OpenSSL docs say that for 1.0.0 the default value is normally \'ALL:!aNULL:!eNULL\'. This is not true for the copy of OpenSSL 1.0.0d that I have. The command to list ciphers, \'openssl ciphers -v <cipherslist>\' does not list SSLv2 ciphers for DEFAULT, but does mention one SSLv2 cipher for  \'ALL:!aNULL:!eNULL\'.', 'Konstantin Kolinko', '2011-07-19 23:43:25 UTC', 'tomcat_attachment/attachment 27300.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (847, '49595', '1', 'Using Java version 1.6.0_20', 'Anil Saraswathy', '2010-07-15 06:36:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (848, '49595', '2', 'Configuration: IIS with SSL as front-end and Tomcat via ISAPI.', 'Anil Saraswathy', '2010-07-15 06:40:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (849, '49595', '3', 'TCNATIVE-1.DLL version is 1.1.20', 'Anil Saraswathy', '2010-07-15 07:05:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (850, '49595', '4', 'This crash is observed in the following scenario:\nTwo user requests arrive at the server simultaneously. One is busy reading application data and returning the same to the browser. The second encounters a \'busy\' application state (due to first) and hence without returning any data, simply closes the output stream and returns. In our application log, I see that the second thread completes the transaction successfully (START, END with code=busy) whereas the first thread (one which is actively returning data) shows only START, which means the crash occurred while the first thread was returning data.', 'Anil Saraswathy', '2010-07-16 02:35:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (851, '51503', '1', 'This has already been fixed in trunk and will be included in 7.0.19 onwards.', 'Mark Thomas', '2011-07-13 12:43:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (852, '51503', '2', 'I got the same issue with 7.0.19; please also note that my HTTP connector is disabled in server.xml.', 'Etienne Massip', '2011-07-18 08:50:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (853, '51503', '3', 'This report makes no sense. If the http connector is disabled then there won\'t be any http acceptor threads.', 'Mark Thomas', '2011-07-18 09:26:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (854, '51503', '4', 'Got it : It happens when I remove the 8080 HTTP port value at installation time.\n\nI thought that the installer then would comment the HTTP connector part in the server.xml, but actually, it just wrote port=\'\'.\n\nI guess you should consider adding a check that the port number value should not be empty to prevent the user to be misled as I was.', 'Etienne Massip', '2011-07-18 09:33:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (855, '51503', '5', 'BTW, there is no error logged at server startup, is the port=\'\' syntax legal ?', 'Etienne Massip', '2011-07-18 09:36:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (856, '51503', '6', 'OK, that makes a lot more sense. Looks like some', 'Mark Thomas', '2011-07-18 15:15:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (857, '51503', '7', '... additional checks are required.', 'Mark Thomas', '2011-07-18 15:15:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (858, '51477', '1', 'Set Tomcat version to 7.0.16.', 'Marvin Addison', '2011-07-05 16:53:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (859, '51477', '2', 'Bugzilla is not a support form.\n\nPlease subscribe to the Tomcat users list and post your question there.\n\nSome hints: if you want the server to speak SSLv3 and TLSv1, you need to set the SSLProtocol to \'all\'. To ensure secure communication you also need to set SSLCipherSuite to something sensible, like e.g.\n\nRC4-SHA:AES128-SHA:ALL:!aNULL:!EXP:!LOW:!MD5:!SSLV2:!NULL\n\nPlease don\'t proceed the discussion here. If the discussion on the users list gives reason to believe you really hit a bug, you can reopen this issue.\n\nRegards,\n\nRainer', 'Rainer Jung', '2011-07-05 17:39:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (860, '51477', '3', 'According to the source code, before  bug 51073  was fixed ( r1094089  or  r1124211 ), the \'SSLv3+TLSv1\' value just worked as a synonym to \'all\'.\n\nWhat happens with ssl2 connections if you configure SSLProtocol=\'all\'\n- in 7.0.16\n- in 7.0.8\n\ndoes it accept ssl2 connections or rejects them?\n\n\n--\nAnyway, I do not mind to add \'SSLv3+TLSv1\' as an allowed value, if it is actually supported by the library.\n\nLooking at implementation of SSLContext.make in sslcontext.c of tc-native 1.1.x, there is code for this combination of flags.\n\n http://svn.apache.org/viewvc/tomcat/native/branches/1.1.x/native/src/sslcontext.c?view=markup#l85 ', 'Konstantin Kolinko', '2011-07-05 17:55:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (861, '51477', '4', 'But I *think* OpenSSL does not support it:\n\n http://www.openssl.org/docs/ssl/SSL_CTX_new.html \n\nIt looks like you have to do what I already posted here: choose \'all\' for the protocol and disable any SSLV2 ciphers.\n\nRainer', 'Rainer Jung', '2011-07-05 18:15:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (862, '51477', '5', '\'SSLv3+TLSv1\' value just worked as a synonym to \'all\'\n\nAppears this is correct based on my testing.  Setting SSLProtocol=\'all\' in both 7.0.8 and 7.0.16 produced exactly the same results: TLSv1 and SSLv3 are supported but not SSLv2.  It appears that our SSLCipherSuite parameter is actually providing the desired behavior:\n\nSSLCipherSuite=\'HIGH:MEDIUM:-SSLv2\'\n\nSo we\'ll be able to preserve the desired functionality with SSLProtocol=\'all\' in versions 7.0.16 and later.\n\nI think there\'s merit in supporting other protocol combinations that make sense if for no other reason to maintain consistency with mod_ssl directives of the same name, which are eerily similar to APR connector attributes.  (I\'ve assumed that similarity is intentional.)', 'Marvin Addison', '2011-07-05 18:19:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (863, '51477', '6', 'I verified the following mod_ssl directives provide equivalent behavior (no SSLv2):\n\nSSLProtocol +SSLv3 +TLSv1\nSSLCipherSuite HIGH:MEDIUM', 'Marvin Addison', '2011-07-05 18:31:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (864, '51477', '7', 'I checked the code of tcnative and of mod_ssl. Both have provisions for arbitrary combinations in SSLProtocol.\n\nThe way it works is there\'s a basic protocol selection in OpenSSL and then you can remove parts by adding an option.\n\nThe possible basic settings are SSLv2, SSLv3, TLSv1 and SSLv23. All except for the last one *only* understand that specific protocol, the last one understand SSLv2, SSLv3 *and* TLSv1, so this is \'all\'.\n\nFor arbitrary combinations one chooses SSLv23 and then removes the protocols one doesn\'t want via SSL_CTX_set_options() using the options SSL_OP_NO_SSLv2, SSL_OP_NO_SSLv3 and/or SSL_OP_NO_TLSv1.\n\nIn tcnative in sslcontext.c there seems to be a bug in choosing SSLv2 if the configured protocol is SSLv2+TLSv1 and choosing SSLv3 if it is SSLv3+TLSv1. I\'d say in both cases it should be SSLv23, because neither SSLV2 not SSLV3 support TLSv1. The additional protocol in SSLv23 is later removed via the options.\n\nFortunately those combinations do not yet get passed down by AprEndpoint.java. But yes, it\'d be easy to support any combination.', 'Rainer Jung', '2011-07-05 18:50:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (865, '51477', '8', 'Created  attachment 27260   [details] \nSupport for arbitrary protocol combinations\n\nThe combinations SSLv2+TLSv1 and SSLv3+TLSv1 will only work, if tcnative is patched as well.\n\nPatch is untested.', 'Rainer Jung', '2011-07-05 19:29:12 UTC', 'tomcat_attachment/attachment 27260.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (866, '51477', '9', 'I\'ve reviewed the patch and it appears that it doesn\'t do the work of removing protocols via SSL_CTX_set_options() as you mentioned.  At this point it appears all supported strings will end up supporting SSLv2+SSLv3+TLSv1 due to the use of SSLv23_client_method(), which is not the equivalent behavior of similar mod_ssl directives.', 'Marvin Addison', '2011-07-05 19:49:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (867, '51477', '10', 'I dug a little further and found that the requisite SSL_CTX_set_options() calls are already in sslcontext.c.  I\'ll test the patch and report back.', 'Marvin Addison', '2011-07-05 19:58:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (868, '51477', '11', 'I tested the patch and verified that SSLv3+TLSv1 works as expected, allowing SSLv3 and TLSv1, but denying SSLv2 connections.  However, the setting SSLv2+TLSv1 only allows TLSv1 connections:\n\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -tls1\nCONNECTED(00000003)\n...\nSSL handshake has read 6158 bytes and written 293 bytes\n---\nNew, TLSv1/SSLv3, Cipher is DHE-RSA-AES256-SHA\nServer public key is 2048 bit\nSecure Renegotiation IS supported\nCompression: zlib compression\nExpansion: zlib compression\nSSL-Session:\n    Protocol  : TLSv1\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -ssl2\n25335:error:140A90C4:SSL routines:SSL_CTX_new:null ssl method passed:ssl_lib.c:1453:\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -ssl3\nCONNECTED(00000003)\n25338:error:14094410:SSL routines:SSL3_READ_BYTES:sslv3 alert handshake failure:s3_pkt.c:1102:SSL alert number 40\n25338:error:1409E0E5:SSL routines:SSL3_WRITE_BYTES:ssl handshake failure:s3_pkt.c:539:', 'Marvin Addison', '2011-07-07 16:00:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (869, '51477', '12', 'Which SSLCipher did you use?', 'Rainer Jung', '2011-07-07 16:49:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (870, '51477', '13', 'While OpenSSL\'s s_client can certainly get the job done, you might make things easier on yourself by using sslscan ( http://sourceforge.net/projects/sslscan/ ). Most Linux distros have packages for it, too.', 'Christopher Schultz', '2011-07-07 19:00:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (871, '51477', '14', 'There is no SSLCipherSuite attribute defined for the SSL connector.  See attached server.xml file.', 'Marvin Addison', '2011-07-08 12:29:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (872, '51477', '15', 'Created  attachment 27274   [details] \nTest server.xml', 'Marvin Addison', '2011-07-08 12:30:24 UTC', 'tomcat_attachment/attachment 27274');
INSERT INTO `tomcatbeforefixcomments` VALUES (873, '51477', '16', 'I tested it now myself and it *does* work for me with all 8 possible combinations, each only allowing the configured protocol set.\n\nMaybe your OpenSSL client doesn\'t allow SSLv2? What happens if you set the SSLProtocol in the connector to SSLv2?', 'Rainer Jung', '2011-07-10 15:04:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (874, '51477', '17', 'I applied a slightly revised version of the patch in  r1145209 .\n\nThe new support for arbitrary protocol combinations will need a release of tcnative. For existing releases there will be only support for the documented combinations, because other combinations will give unexpected results.\n\nI\'ll keep this issue open and reassign to tcnative.', 'Rainer Jung', '2011-07-11 15:46:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (875, '46252', '1', 'I am curious as to which elements you are trying to log that require UTF-8. Most will be ISO-8859-1. The only exceptions I can think of are user name and session attribute values.\n\nI am concerned that whilst an access log is typically configured at the host level the user name encoding can vary from request to request (if you are using FORM) and session attributes are under no obligation to use a single consistent encoding. Therefore, it would be rather difficult to ensure the correct logging of each of these elements.\n\nGiven the above I am not in favour of using UTF-8 by default.\n\nHowever, I can see the potential of making the encoding configurable with the default being the current behaviour. Therefore, I am marking this as an enhancement.\n\nPatches are always very welcome and if you are interested in writing such a patch and need any assistance feel free to ask on the dev list.', 'Mark Thomas', '2009-04-16 14:38:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (876, '46252', '2', 'Implemented in 7.0 with  r11145200  and will be in 7.0.19.', 'Konstantin Kolinko', '2011-07-11 15:16:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (877, '46252', '3', 'Created  attachment 27278   [details] \n2011-07-11_tc6_bug46252.patch\n\nCorrection: that revision number above was  r1145200 \n\nHere is patch that will be proposed for Tomcat 6.\nBackport to Tomcat 5.5 is unlikely.', 'Konstantin Kolinko', '2011-07-11 16:01:05 UTC', 'tomcat_attachment/attachment 27278.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (878, '46252', '4', 'Created  attachment 27279   [details] \n2011-07-11_tc6_bug46252_v2.patch\n\nUpdated patch: added  r1145237 \n\nThis adds\nin AccessLogValve:\n- i18n for messages\n- Log a failure if access log file cannot be opened.\n- Autocreate directory if it is specified as a part of the file name\nin FileHandler:\n- Autocreate directory if it is specified as a part of the file name', 'Konstantin Kolinko', '2011-07-11 17:03:05 UTC', 'tomcat_attachment/attachment 27279.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (879, '46252', '5', 'Created  attachment 27280   [details] \n2011-07-11_tc6_bug46252_JMX.patch\n\nAdditional patch:\nExpose the new \'encoding\' option through JMX.\nI also fixed wrong mapping for \'getEnabled()\'.', 'Konstantin Kolinko', '2011-07-11 18:17:32 UTC', 'tomcat_attachment/attachment 27280.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (880, '51475', '1', 'There are a number of issues with the patch as currently proposed.\n- It uses tabs rather than spaces\n- In includes whitespace changes that add noise\n- Tests should be provided as JUnit tests in the separate tests directory in the source tree', 'Mark Thomas', '2011-07-05 10:29:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (881, '51475', '2', 'Created  attachment 27256   [details] \nPatch file for GzipInterceptor, TestGzipInterceptor and TribesTestSuite\n\nOkay. I\'ve checked out Tomcat 6.0.x from subversion in my ecplise and created a new patch through eclipse. For me the patch looks better now.\nI\'ve also removed the test code from GzipInterceptor and have written a small JUnit test case.', 'Christian Stöber', '2011-07-05 12:08:55 UTC', 'tomcat_attachment/attachment 27256.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (882, '51475', '3', 'Thanks for the updated patch. There are still some unnecessary changes in that patch that distract from the changes that fix the problem. Also, new files need to include a license header.\n\nI have fixed 7.0.x based on your patch and the fix will be included in 7.0.18 onwards.\n\nI have also proposed the fix for 6.0.x.', 'Mark Thomas', '2011-07-05 16:48:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (883, '51475', '4', 'Mark,\n\nbecause it\'s not desirable and efficient to compress small packages, I\'ve modified the code that it compress only packages with a size greater than 2048 bytes.\n\nShould I file a new bug? Or should I send you an new patch?', 'Christian Stöber', '2011-07-15 09:55:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (884, '51475', '5', 'New bug please. This should be user configurable. I\'d suggest an attribute name of minCompressionSize', 'Mark Thomas', '2011-07-15 10:16:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (885, '51475', '6', 'Ok, I\'ll will file a bug.\n\nIt is user configurable. Based on the compression option in org.apache.coyote.http11.Http11Protocoll I called it compressionMinSize. ;)', 'Christian Stöber', '2011-07-15 10:25:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (886, '51473', '1', 'Created  attachment 27252   [details] \neclipse debug 2', 'zhh', '2011-07-05 05:39:50 UTC', 'tomcat_attachment/attachment 27252.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (887, '51473', '2', 'Fixed in Tomcat 7 - will be in 7.0.18.\nProposed for 6.0 and 5.5.', 'Konstantin Kolinko', '2011-07-05 07:14:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (888, '51473', '3', 'Fixed in 6.0.x and included in 6.0.33 onwards.', 'Mark Thomas', '2011-07-21 16:18:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (889, '51467', '1', 'Created  attachment 27245   [details] \nuse start instead of run to start a thread', 'Felix Schumacher', '2011-07-03 10:20:20 UTC', 'tomcat_attachment/attachment 27245.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (890, '51467', '2', 'I\'m wondering why the whole process is run in a Thread in the first place. If the thread is start()ed, when immediately join()ed, and all exceptions are documented not to be expected, it seems like the use of a thread is wasteful.\n\nYour patch, while slightly more clear than the original code, does not appear to actually any behavior: the parent thread will still block, except this time the thread is actually launched.', 'Christopher Schultz', '2011-07-03 16:43:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (891, '51467', '3', 'Re  Comment #2 :  http://svn.apache.org/viewvc?view=revision&revision=1044145 \n\nLog says:\n\n bug 49159 : Improve ThreadLocal memory leak clean-up \n https://issues.apache.org/bugzilla/show_bug.cgi?id=49159 \n\nUse a dedicated thread when calling web application code when it is started and stopped (calls to Listeners, Filters, Servlets).\n\nCode comment says:\n\n// we do it in a dedicated thread for memory leak protection, in\n// case some webapp code registers some ThreadLocals that they\n// forget to cleanup\n\nRegards,\n\nRainer', 'Rainer Jung', '2011-07-03 17:45:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (892, '51467', '4', 'Rainer,\n\nAah, I didn\'t look far enough up in the code to see that comment: thanks for clarifying.\n\nWithout running Thread.start(), I believe any ThreadLocals registered will be registered to the calling thread, so Felix is right: changing Thread.run to Thread.start is appropriate in this case.', 'Christopher Schultz', '2011-07-03 18:41:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (893, '51088', '1', 'Without the ability to reproduce the error, this issue is likely to be eventually resolved as WONTFIX. Any further information (such as the expression that was being parsed) would be very helpful.\n\nThe code where this error occurs is in auto-generated code from JJTree/JavaCC. Tomcat is using the latest version. I don\'t see any way that this could be a concurrency issue since none of the objects involved are shared (they are all created in the current thread).\n\nThe bug may be in Tomcat\'s parser definition (e.g. not handling invalid correctly), JJTree, JavaCC or Tomcat\'s (less likely in my view) use of the resulting code.', 'Mark Thomas', '2011-05-05 09:13:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (894, '51088', '2', 'Mark, I can\'t provide more information unfortunately. I don\'t know which expression caused the error and I did not see it anymore in any app log.\n\nI\'ll update this ticket as soon as I see it again', 'Michael Heinen', '2011-05-12 08:11:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (895, '51088', '3', '> Unfortunately it is not reproducible at all.\n\na) Some rarely executed if-branch in [/facelets/myview.xhtml]?\n\nRare things are not that rare. I do not see any other reports of such an issue with JJTELParserState.\n\nb) Concurrency? As Mark noted in  Comment 1  this is unlikely.\n\nExpressionBuilder.java:115 is creating a new ELParser for a String and parsing it. That parsing should be thread safe.\n\n>                n = (new ELParser(new StringReader(expr)))\n>                        .CompositeExpression();\n\nc) Unexpected JVM Error? E.g. OutOfMemoryError.\n\nThe ELParser.java:74 is inside a finally{} block, so if this happened during exception processing the original error might be lost. I think the following cascade of errors is possible, where original error is masked by two others:\n\n1. Exception at ELParser.java:74 (jjtree.closeNodeScope(jjtn000, true);) is possible only if jjtc000 is true.\n2. I think that before it at ELParser.java:60 (jjtree.clearNodeScope(jjtn000);) call failed with a RuntimeException e.g. for the same wrong index reasons as 1. and failed to set jjtc000 to false.\n3. The 2. is inside a catch(Throwable) block and it might be triggered by an OutOfMemoryError,  (or by another RuntimeException at the lower layer, because the same catch(Throwable)+finally handling is everywhere in that generated code).\n\nI think c) is feasible.', 'Konstantin Kolinko', '2011-05-13 22:46:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (896, '51088', '4', 'a) can be excluded (no rarely executed if-branch)\nc) could be possible indeed (although an OOM did not occur, but maybe another RuntimeException)', 'Michael Heinen', '2011-05-16 09:32:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (897, '51088', '5', 'I think Konstantin is along the right lines here.\n\nThe more I look at the generated code, the more there is I don\'t like (like the exception handling) but I like the idea of writing it myself from scratch even less.\n\nSince this issue can\'t be reproduced, the best we can do is include the expression that triggered the issue in the exception message. I have made this change to 7.0.x and will propose the same change for 6.0.x.', 'Mark Thomas', '2011-06-29 13:57:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (898, '50353', '1', 'Same behavior with getRequest() : it returns null. \nThis leads to a NPE if asyncContext.dispatch() is called after the timeout :\n\n\njava.lang.NullPointerException\n	at org.apache.catalina.core.AsyncContextImpl.dispatch(AsyncContextImpl.java:127)\n	at test.MyServlet$1.run(MyServlet.java:42)\n	at org.apache.catalina.core.AsyncContextImpl$RunnableWrapper.run(AsyncContextImpl.java:439)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:680)\n\n(with a variation of the above example)', 'Sylvain Laurent', '2010-11-27 18:04:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (899, '50353', '2', 'Hmm. This is further complicated by the fact that Tomcat recycles Request and Response objects so they can\'t be kept around forever. I have added this to me list of things to nag the Servlet EG about.\n\nI\'m currently neutral on whether or not the current behaviour should change.\n\nSwitching to an enhancement since I don\'t see an actual bug (as in non-spec compliant behaviour) here.', 'Mark Thomas', '2010-11-29 12:22:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (900, '50353', '3', '***  Bug 51432  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2011-06-28 17:23:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (901, '51396', '1', 'Look at the test cases for examples of how to do this.', 'Mark Thomas', '2011-06-20 17:04:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (902, '51396', '2', ' It stuns me that you would close this without apparently taking 2 minutes to read the one Java class, which I wrote by reading the available doc and examples. Further, I spend several hours debugging into tomcat here, and there were a number of suspicious aspects that led me to think that a bugzilla was appropriate.\n\nFurther, this is code that worked with tomcat 6 embedded and only failed when I moved to tomcat 7.\n\nMy code was written from the available examples, it works fine for a webapp that jsp pages but not jsp servlets, and the webapp with jsp servlets works fine with unembedded tomcat.', 'bmargulies', '2011-06-20 17:10:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (903, '51396', '3', 'Since bz won\'t let me edit, I will improve on my description down here.\n\n1) I\'ve written a class that uses the embedded API:\n\n  org.apache.catalina.startup.Tomcat\n\n2) My class calls Tomcat.addWebapp.\n\n3) My class works fine on a webapp that contains JSP pages.\n\n4) My class does NOT work for webapps that have <servlet> declarations that name jsp pages.\n\n5) The reason, which I have diagnosed, is the lack of the following servlet declaration from the default web.xml:\n\n <servlet>\n        <servlet-name>jsp</servlet-name>\n        <servlet-class>org.apache.jasper.servlet.JspServlet</servlet-class>\n        <init-param>\n            <param-name>fork</param-name>\n            <param-value>false</param-value>\n        </init-param>\n        <init-param>\n            <param-name>xpoweredBy</param-name>\n            <param-value>false</param-value>\n        </init-param>\n        <load-on-startup>3</load-on-startup>\n    </servlet>\n\n6) Tomcat.addWebapp does extra work to prevent the use of the default web.xml.\n\n7) I can\'t find any test case in the tomcat hierarchy that looks like this overall model, and in particular which supplies default web.xml content when using the embedded Tomcat class. Though I may of course be missing something.', 'bmargulies', '2011-06-20 19:36:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (904, '51396', '4', 'In short, if there is a defect here, it is that:\n\norg.apache.catalina.startup.Tomcat.initWebappDefaults(Context)\n\ndoes not set up the servlet named \'jsp\' which is set up in the default web.xml, and that the modularity of the Tomcat class does not offer a straightforward way to change that, since the function is static and so cannot be trivially @overridden.', 'bmargulies', '2011-06-20 19:51:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (905, '51396', '5', 'Created  attachment 27182   [details] \ntest case in a patch\n\nHere is a minimal test case as a patch. Proposed fix to follow.', 'bmargulies', '2011-06-20 22:09:07 UTC', 'tomcat_attachment/attachment 27182.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (906, '51396', '6', 'Bugs opened shortly after almost identical reports on the users list and containing statements that are clearly wrong (the jsp servlet is defined) do tend to get closed as invalid quickly to keep the noise down.\n\nThere is a bug here but a simpler test case would have made tracking it down a lot easier.\n\norg.apache.catalina.startup.Tomcat.initWebappDefaults(Context) is a red herring. That code is fine. The problem is around where the NPE occurs. Because the JSP has been set up programmatically, the definition of the init parameters isn\'t where it would be if read from the default web.xml and that triggers the NPE.\n\nI have a fix and the test case gets to the point where the app starts but I get 500 errors and the message java.lang.RuntimeException: Can\'t find resource \'solrconfig.xml\' in classpath or \'D: solr_webapp . conf/. I don\'t see a file with that name in testcase.\n\nI\'ll commit that fix shortly and I\'m going to assume that the 500 error is a problem with the webapp rather than another bug.', 'Mark Thomas', '2011-06-20 22:11:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (907, '49165', '1', 'Created  attachment 25778   [details] \n#49165 fix (added %t{TIME_FORMAT} support)\n\nIntroduced new format for %t for AccesLogValve.\n- new format %{TIME_FORMAT}t available. \n- if custom pattern contains milliseconds field, then optimizations, which performs new current date time object creation only once per 1000 millis, will be turned off.\n- unit tests for added/changed functionality\n- performance tests\n\nResults of perfomance testing (tested on MacOS X 10.6.4):\nAccessLogValve: 5 threads and 1000000 iterations using oldValve           took 8381ms\nAccessLogValve: 5 threads and 1000000 iterations using newValve           took 7742ms\nAccessLogValve: 5 threads and 1000000 iterations using newValveWithMillis took 8651ms\nAccessLogValve: 5 threads and 2000000 iterations using oldValve           took 16864ms\nAccessLogValve: 5 threads and 2000000 iterations using newValve           took 15945ms\nAccessLogValve: 5 threads and 2000000 iterations using newValveWithMillis took 16806ms\nAccessLogValve: 5 threads and 3000000 iterations using oldValve           took 25010ms\nAccessLogValve: 5 threads and 3000000 iterations using newValve           took 24575ms\nAccessLogValve: 5 threads and 3000000 iterations using newValveWithMillis took 26674ms\nAccessLogValve: 5 threads and 4000000 iterations using oldValve           took 33775ms\nAccessLogValve: 5 threads and 4000000 iterations using newValve           took 33043ms\nAccessLogValve: 5 threads and 4000000 iterations using newValveWithMillis took 33796ms', 'Alexander Shirkov', '2010-07-16 23:26:31 UTC', 'tomcat_attachment/attachment 25778.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (908, '49165', '2', 'Introduced new format for %t for AccesLogValve.\n- new format %{TIME_FORMAT}t available. \n- if custom pattern contains milliseconds field, then optimizations, which performs new current date time object creation only once per 1000 millis, will be turned off.\n- unit tests for added/changed functionality\n- performance tests\n\nResults of perfomance testing (tested on MacOS X 10.6.4):\nAccessLogValve: 5 threads and 1000000 iterations using oldValve           took 8381ms\nAccessLogValve: 5 threads and 1000000 iterations using newValve           took 7742ms\nAccessLogValve: 5 threads and 1000000 iterations using newValveWithMillis took 8651ms\nAccessLogValve: 5 threads and 2000000 iterations using oldValve           took 16864ms\nAccessLogValve: 5 threads and 2000000 iterations using newValve           took 15945ms\nAccessLogValve: 5 threads and 2000000 iterations using newValveWithMillis took 16806ms\nAccessLogValve: 5 threads and 3000000 iterations using oldValve           took 25010ms\nAccessLogValve: 5 threads and 3000000 iterations using newValve           took 24575ms\nAccessLogValve: 5 threads and 3000000 iterations using newValveWithMillis took 26674ms\nAccessLogValve: 5 threads and 4000000 iterations using oldValve           took 33775ms\nAccessLogValve: 5 threads and 4000000 iterations using newValve           took 33043ms\nAccessLogValve: 5 threads and 4000000 iterations using newValveWithMillis took 33796ms', 'Alexander Shirkov', '2010-07-16 23:27:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (909, '49165', '3', 'Created  attachment 25779   [details] \n49615 + unit tests\n\nupdated patch file (unit tests added to version control)', 'Alexander Shirkov', '2010-07-16 23:51:26 UTC', 'tomcat_attachment/attachment 25779');
INSERT INTO `tomcatbeforefixcomments` VALUES (910, '49165', '4', 'done', 'Alexander Shirkov', '2010-07-19 13:22:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (911, '49165', '5', '(In reply to  comment #4 )\n\nThanks for the patch. I have reviewed it and have the following comments:\n1. It uses a mix of tabs and spaces for indenting. Only spaces should be used.\n2. Log messages should use the StringManager to provide i18n support.\n3. Setting currentDate in the AccessDateStruct serves no purpose\n4. Same for currentDateString\n5. DateAndTimeElementVolumeTest can probably be added to the existing Benchmarks test.\n\nOut of curiosity, if you remove the code that manages the only creating the date once a second entirely and use a date format that does not include millis, what is the performance like? I\'m wondering if we can just remove that code entirely.\n\nIf you can update the patch, I\'ll take another look. With the issues above fixed it should be ready to apply.', 'Mark Thomas', '2010-07-21 13:47:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (912, '49165', '6', '(In reply to  comment #5 )\n> 1. It uses a mix of tabs and spaces for indenting. Only spaces should be used.\nDone.\n\n> 2. Log messages should use the StringManager to provide i18n support.\nDone (only English string was added).\nBTW there are others Strings in class used in exception. I haven\'t touched them, because they\'re not related to this bug. Please let me know if this should be done.\n\n> 3. Setting currentDate in the AccessDateStruct serves no purpose\nRemoved initialization in variable declaration. Leaved as is in constructor: otherwise NPE will be thrown on first AccessDateStruct access in startInternal().\n\n> 4. Same for currentDateString\nRemoved\n\n> 5. DateAndTimeElementVolumeTest can probably be added to the existing\n> Benchmarks test.\nDone.\n\n> Out of curiosity, if you remove the code that manages the only creating the\n> date once a second entirely and use a date format that does not include millis,\n> what is the performance like? I\'m wondering if we can just remove that code\n> entirely.\nWithout millis chunks we have small performance drop on same %t pattern:\n5 thr x 1000000 iter. newValve           7772ms\n5 thr x 1000000 iter. newValveNoChunks   8483ms\n5 thr x 1000000 iter. newValveWithMillis 8630ms\n5 thr x 2000000 iter. newValve           14857ms\n5 thr x 2000000 iter. newValveNoChunks   15633ms\n5 thr x 2000000 iter. newValveWithMillis 19687ms\n5 thr x 3000000 iter. newValve           22171ms\n5 thr x 3000000 iter. newValveNoChunks   23433ms\n5 thr x 3000000 iter. newValveWithMillis 26765ms\n5 thr x 4000000 iter. newValve           29615ms\n5 thr x 4000000 iter. newValveNoChunks   31525ms\n5 thr x 4000000 iter. newValveWithMillis 35067ms\n5 thr x 5000000 iter. newValve           36889ms\n5 thr x 5000000 iter. newValveNoChunks   39176ms\n5 thr x 5000000 iter. newValveWithMillis 43527ms\nLooks like performance graphs are linear for all cases. I think if we remove chunks, this could possible cause slight load increase on GC under heavy load (new Date instances will keep creating). Test was done under MacOS X 10.6.\nPlease let me know your decision: are we going to go with this or leave it as is.\nBTW there will be error up to 1000 mills in output, because we\'re creating date once in 1000 millis.\nNote: volume benchmark is writing output in real file to $CATALINA_HOME/logs and shouldn\'t be included in automatic test pack (it\'s slow and it\'s it\'s generating REALLY big output file, so CI server will quickly run out of disk space).\n\n> If you can update the patch, I\'ll take another look. With the issues above\n> fixed it should be ready to apply.\nWill provide patch file after your decision.', 'Alexander Shirkov', '2010-07-22 22:38:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (913, '49165', '7', 'Created  attachment 25834   [details] \n#49165 fix with requested changes\n\nPlease let me know if version without 1000 millis chunk is required (in this case some unit test should be removed).', 'Alexander Shirkov', '2010-08-03 18:44:56 UTC', 'tomcat_attachment/attachment 25834');
INSERT INTO `tomcatbeforefixcomments` VALUES (914, '49165', '8', '(In reply to  comment #6 )\n> Note: volume benchmark is writing output in real file to $CATALINA_HOME/logs\n> and shouldn\'t be included in automatic test pack (it\'s slow and it\'s it\'s\n> generating REALLY big output file, so CI server will quickly run out of disk\n> space).\n\nCould you modify the volume benchmark to dump to /dev/null or some kind of null logger? That would give you a better benchmark since you aren\'t at the mercy of disk I/O to skew your results.', 'Christopher Schultz', '2010-12-14 14:58:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (915, '48956', '1', 'Patches for enhancement requests are always welcome', 'Mark Thomas', '2010-03-22 17:11:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (916, '48956', '2', 'Fixed in 7.0.x and will be included in 7.0.17 onwards.\n\nI don\'t see this being back-ported to 6.0.x or 5.5.x.', 'Mark Thomas', '2011-06-15 22:43:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (917, '48956', '3', 'Hi, I found a bug working with Tomcat, SSI and regular expression that is still unresolved and my work is essential for proper operation:\n\nFor example:\n<!--#set var=\'aux\' value=\'aa12\' -->\n<!--#if expr=\'$aux=/^aa([a-zA-Z0-9 -_]*)/\' -->\n        <!--#set var=\'aux2\' value=\'$1\' -->\n<!--#endif -->\n\nResulting value:<!--#echo var=\'aux2\' -->\n\n\nIn a html file works correctly, but when working on Tomcat, a complex regular expression fails, and the page returns nothing from it.\n\nRegards and await your response.', 'Maribel B.', '2012-04-27 18:54:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (918, '48956', '4', '(In reply to  comment #3 )\n> Hi, I found a bug working with Tomcat, SSI and regular expression that is\n> still unresolved and my work is essential for proper operation:\n\nI do not understand your description. What do you mean by \'fails\' and what do you mean by \'returns nothing\'?\n\nPlease provide:\n\n1. What are the steps to reproduce your problem\n\n2. What is the actual behaviour that you are observing.\n\n3. What do you expect the correct behaviour to be.\n\n=======================================\nBy the way:\n\n1. The actual implementation Regexp matching is in\n org/apache/catalina/ssi/ExpressionParseTree.java,\n in method compareBranches()\n\n2. The feature was implemented by  r1136231  and  r1136399 \n3.  r1136399  was result of discussion in \'Re: r1136231\' thread on dev@. In archives:\n http://markmail.org/message/g6ba77x7abkhibnn \n http://marc.info/?t=130817798400003&r=1&w=2 \n\n4. If you can provide a patch for ExpressionParseTree#compareBranches(), it would be faster.', 'Konstantin Kolinko', '2012-06-07 18:24:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (919, '43538', '1', 'Created  attachment 20908   [details] \nPatch tha implements this functionality\n\nThis patch implements the functionality described in this issue. It was created\nagainst the current trunk of /repos/asf/tomcat/container/tc5.5.x\n\nThe patch does not add the new properties in the non-English resource bundles.\nI was not sure if I should add them or not.', 'Dennis Lundberg', '2007-10-02 14:50:14 UTC', 'tomcat_attachment/attachment 20908.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (920, '43538', '2', 'The version for this issue should be 5.5.25, but that version is not yet\navailable here in Bugzilla.', 'Dennis Lundberg', '2007-10-02 14:51:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (921, '43538', '3', 'I would have thought you would want some control over which manager instance you\nhit in most cases. We usually make the manager app directly accessible to admins\nvia an alternative port.', 'Mark Thomas', '2007-10-04 18:34:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (922, '43538', '4', 'Yes, for actually managing the web applications (starting and stopping etc.),\nyou want to be sure which server you are using. For such tasks we use dedicated\nports.\n\nHowever, for the server status information it is interesting to see which\nmachine is answering the current request.', 'Dennis Lundberg', '2007-10-05 09:04:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (923, '43538', '5', 'Set the correct \'Version\'.', 'Dennis Lundberg', '2008-01-04 03:49:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (924, '51306', '1', ' http://svn.apache.org/viewvc?view=revision&revision=818062  explains why this code is here.\n\nIt looks like a race condition to me at the moment but more research is required.\n\nJust for background, how many nodes are there in your cluster?', 'Mark Thomas', '2011-06-02 17:37:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (925, '51306', '2', 'Our clusters vary in size from 2 to 11 Tomcats, these problems happen in all configurations.', 'Dmitry Mikhaylov', '2011-06-07 07:46:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (926, '51306', '3', 'I\'m not sure  http://svn.apache.org/viewvc?view=revision&revision=818062  explains what is happening. While what the comment says is totally true, the stack trace I pasted shows that the problem happens on *secondary nodes*: while handling received remove session expiration event, for some reasons DeltaManager tries to broadcast it to the whole cluster again.', 'Dmitry Mikhaylov', '2011-06-07 07:46:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (927, '51306', '4', 'There seem to be two problems in this stack trace.\n\nThe first problem is  DeltaRequest#getSize() > 1 in non-primary node . \nUsually, DeltaRequest#getSize() must be 0 in non-primary node. and,  r818062  works correctly. \nHowever,  r818062  doesn\'t work correctly because DeltaRequest#getSize() is more than 1 in this case. \nThis is a potential bug. \n\nThe second problem is  DeltaRequest#sessionId() is null in non-primary node .\nWhen handleSESSION_CREATED is completed, DeltaRequest#sessionId is always non-null. \nWhen setMaxInactiveInterval is called in handleSESSION_CREATED, the action is added to DeltaRequest. \nAs a result, it becomes DeltaRequest#getSize() >1. \nThis is probably bug.\nFor instance, when handleSESSION_EXPIRED is processed while processing handleSESSION_CREATED, \nsessionId of DeltaRequest will become null and DeltaRequest#getSize() > 1. \nAnd, NPE will be thrown out. \n\nThe workaround is..\nCorrect these bugs or Synchronize between handleSESSION_CREATED and handleSESSION_EXPIRED.\n\nI will correct not to add action to DeltaRequest when setMaxInactiveInterval is called in handleSESSION_CREATED. \nAdditionally, I will correct the potential bug of  r818062 .', 'Keiichi Fujino', '2011-06-13 08:57:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (928, '51306', '5', 'Fixed in 7.0.x and will be included in 7.0.17 onwards.\n\nProposed for 6.0.x', 'Keiichi Fujino', '2011-06-13 09:52:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (929, '51306', '6', 'Is there a workaround for this issue? What should I not do in my code to prevent this?\nThe cause  r818062  is from 2009, so I must go back very far to get a Tomcat version which doesn\'t have this bug, with the risk, that I get back old bugs.', 'Ronald Klop', '2011-06-14 10:37:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (930, '51306', '7', 'It\'s a bug in Tomcat, some funky cyclic implementation that I still fully don\'t understand. Invoking listeners on expiring sessions....maybe valid...maybe not needed....\n\nHowever, does this bug really cause a problem in your app? The session is going to expire no matter what, even if this error message is printed. \n\nBesides the error message in the log, is your app actually experiencing any symptoms from this?\n\nbest\nFilip', 'Filip Hanik', '2011-06-15 01:50:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (931, '51306', '8', 'I have customers who are \'logged out\' in their words and that correlates with the times of these errors in the logs. No hard evidence though.\nAnd the weirdest thing is that it only happens since two or three weeks.', 'Ronald Klop', '2011-06-15 08:59:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (932, '51340', '1', 'Created  attachment 27131   [details] \nZipped full log', 'Glyn Normington', '2011-06-08 13:39:04 UTC', 'tomcat_attachment/attachment 27131');
INSERT INTO `tomcatbeforefixcomments` VALUES (933, '51340', '2', 'A more readable version of the stack trace:\n\njava.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n	at org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n	at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n	at org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n	at org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n	at org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n	at org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n	at org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n	at org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n	at java.lang.Thread.run(Thread.java:619)', 'Glyn Normington', '2011-06-08 13:42:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (934, '51340', '3', 'I got some more details from Glyn off-list.\n\nVirgo may use multiple threads for deployment depending on circumstances.\n\nLooking at the xml parsing code, there are 4 digesters each using the same ruleset. Neither object is threadsafe but we sync on the digester so there could be multiple threads using the same webruleset which is a possible explanation for this issue.\n\nI\'ll proceed on the basis that this is the root cause. We can always re-open if this re-occurs.', 'Mark Thomas', '2011-06-08 15:47:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (935, '51276', '1', 'I\'ve debugged the problem and found the issue. This is the incriminated commit:\n\n===\nWhile scanning JARs for TLDs and fragments, avoid using JarFile and use JarInputStream as in most circumstances where JARs are scanned, JarFile will create a temporary copy of the JAR rather than using the resource directly. This change significantly improves startup performance for applications with lots of JARs to be scanned. (markt)\n===\n\nThe last sentence is clearly false, since JarFile is optimized for random access, while JarInputStream has to read the entire file.\n\nI\'m attaching a very simple test case, showing the issue. This is a sample output:\n\n%java TomcatSlowTest webservices-rt.jar\nTime elapsed with JarFile (Tomcat 7.0.12): 1 ms\nTime elapsed with JarInputStream (Tomcat 7.0.14): 458 ms', 'Alex Dupre', '2011-05-27 14:49:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (936, '51276', '2', 'Created  attachment 27076   [details] \nTest case showing the issue.', 'Alex Dupre', '2011-05-27 14:51:01 UTC', 'tomcat_attachment/attachment 27076.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (937, '51276', '3', 'Other notes:\n- the issue is reproducible on all platforms (tested configurations: OpenJDK6 on FreeBSD and Oracle JDK 1.6 on Windows)\n- even modifying the test case to look for an existing file (and in the first bytes of the jar), the JarInputStream is slower than JarFile\n- JarFile has most parts in native code, while JarInputStream is 100% Java code', 'Alex Dupre', '2011-05-27 15:14:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (938, '51276', '4', 'The attached test case isn\'t representative of how Tomcat handles JARs. The references to the JARs are passed as URLs. The temporary copy that JarFile creates in this case has a much more significant impact on performance than using JarInputStream.\n\nThat said, the increase in start time isn\'t good and is worth investigating further. If (as is likely) it is related to the switch to JarInputStream, then it may be possible to determine if the URL points to a file and switch to JarFile in that case.', 'Mark Thomas', '2011-05-27 15:43:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (939, '51276', '5', '(In reply to  comment #3 )\n> - JarFile has most parts in native code, while JarInputStream is 100% Java code\n\nSorry, that\'s completely untrue.  All I/O is done by native code in the JRE, and all ZIP-format handling is done by native code in the standard zlib library.', 'Chuck Caldarale', '2011-05-27 16:06:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (940, '51276', '6', 'I wanted to create the most simple test case to show up the *enormous and unjustified* performance difference of JarFile vs JarInputStream on local files. Passing a URL pointing to a local file doesn\'t change anything (yes, I tried), probably you can see a speedup if the url is pointing to a very slow location (when does it happen?). So I agree with you to use JarFile if the file is local and JarInputStream for other cases.', 'Alex Dupre', '2011-05-27 16:58:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (941, '51276', '7', 'Your test cases are not representative of the typical jar handling within Tomcat.\n\nAs is explained in the code commentary in the patch, Jars in web applications are referenced via JNDI URLs. Using JarFile with these URLs (or any non-file URL) triggers the creation of a full copy of the jar file in the temp directory. This is significantly slower than accessing the jar with JarInputStream.\n\nThe issue you are seeing is as a result of using shared jars. While supported, such an approach is not recommended due to the complications it can create both when upgrading and with memory leaks on reload with some libraries. The shared jars are referenced via file URLs so the switch to JarInputStream will result in a slow down in that case.\n\nAs per  comment #4 , I\'ll see if there is an easy way to switch to JarFile for jars referenced via file URLs rather than JNDI URLs', 'Mark Thomas', '2011-05-30 08:55:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (942, '51240', '1', 'I\'d strongly recommend to default acceptorThreadCount=1 and possible deprecating the attribute all together.\nAcceptor thread count larger than 1 has really zero impact on performance, while degrading system resources.\nThe operating system holds a shared lock underneath to accept new connections, so having multiple threads calling ServerSocket.accept is doing nothing except queuing up for that lock.', 'Filip Hanik', '2011-05-23 19:09:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (943, '51240', '2', 'I agree with Filip\'s comment re forcing acceptorThreadCount to 1 but I\'d still like to get to the bottom of why the maxConnections limit isn\'t being enforced. I\'ll try and look at this today.', 'Mark Thomas', '2011-05-25 07:30:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (944, '51240', '3', 'It looks like there\'s a race condition between the acceptor thread being permitted to accept a connection and updating the connection counter.\n\nTwo acceptor threads can pass the awaitConnection() condition, accept a connection, and then both call countUp(). The connection count then goes above the signal level and awaitConnection() blocking condition will never be met as long as the connections stays above max (since CounterLatch appears to be designed to count both up and down, it compares the signal level exactly).\n\nThe fix could be to remove countUp()/countDown(), change CounterLatch.await() to an CounterLatch.awaitAndIncrement()/CounterLatch.awaitAndDecrement() pair and have the connection count atomically updated in Sync.tryAcquireShared() using AtomicLong.compareAndSet() with the +1/-1 delta passed in as the argument.\n\ne.g:\n\n        protected int tryAcquireShared(int delta) {\n            while (true) {\n                final long current = count.get();\n                if (!released && (current == signal)) {\n                    return -1;\n                }\n                if (count.compareAndSet(current, current + delta)) {\n                    return 1;\n                }\n            }\n        }', 'Tim Whittington', '2011-05-25 10:37:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (945, '51226', '1', 'Created  attachment 27029   [details] \nfindleaks ant task\n\nI made patch for adding FindLeaks ant task.\n\nRegards.', 'Eiji Takahashi', '2011-05-19 06:36:46 UTC', 'tomcat_attachment/attachment 27029.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (946, '51226', '2', 'Thanks for the report and the patch. There were a couple of minor issues with the patch and one slightly more serious issue.\n\nFirst the minor issues:\n- no license header in FindLeaksTask.java\n- a couple of unused imports in FindLeaksTask.java\n\nTomcat includes a checkstyle configuration in /res/checkstyle that you can use with your IDE. Alternatively, you can set execute.validate=true in your build.properties and ant will run the checkstyle checks.\n\nThe bigger issue is that the patch changes the output format of find leaks for the manager application. The output is intended to be a plain text list of leaking contexts that can be parsed easily by the client. Adding the additional text from the HTML Manager to the Manager will make it much more difficult for a client to parse the output.\n\nIf you submit an updated patch, it should get applied pretty quickly. If not, one of the committers will probably make the necessary changes to this patch and apply it but that is likely to take a little longer.', 'Mark Thomas', '2011-05-19 09:10:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (947, '51226', '3', 'Thanks for comments.\n\n(In reply to  comment #2 )\n> Thanks for the report and the patch. There were a couple of minor issues with\n> the patch and one slightly more serious issue.\n> \n> First the minor issues:\n> - no license header in FindLeaksTask.java\nadded license header\n\n> - a couple of unused imports in FindLeaksTask.java\nremoved two unused imports\n\n> \n> Tomcat includes a checkstyle configuration in /res/checkstyle that you can use\n> with your IDE. Alternatively, you can set execute.validate=true in your\n> build.properties and ant will run the checkstyle checks.\nI ran ant with execute.validate=true, and I got no error.\n \n> The bigger issue is that the patch changes the output format of find leaks for\n> the manager application. The output is intended to be a plain text list of\n> leaking contexts that can be parsed easily by the client. Adding the additional\n> text from the HTML Manager to the Manager will make it much more difficult for\n> a client to parse the output.\n\nI added the new request parameter \'status\'. If set this parameter to true, ManagerServlet returns the message that starts with \'OK -\'.\nThis parameter is used only by the Ant task.\nIf set this parameter to false or not set, ManagerServlet and HTMLManagerServlet return the same message as before.\n\n> \n> If you submit an updated patch, it should get applied pretty quickly. If not,\n> one of the committers will probably make the necessary changes to this patch\n> and apply it but that is likely to take a little longer.\nI\'ll attach the new patch.\n\nBest regards.', 'Eiji Takahashi', '2011-05-23 01:41:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (948, '51226', '4', 'Created  attachment 27045   [details] \nfindleaks ant task', 'Eiji Takahashi', '2011-05-23 01:45:21 UTC', 'tomcat_attachment/attachment 27045.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (949, '27122', '1', 'How about trying with a telnet ? Either the content is sent or it is not.\nThere\'s nothing to investigate here, as there is nothing in Tomcat which is\nrelated to the content-type, so I urge posting on tomcat-user instead.', 'Remy Maucherat', '2004-02-20 21:14:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (950, '27122', '2', 'Of course I haven\'t tried telnet, it\'s only happening over SSL.  I\'m not very\ngood at doing 128-bit encryption in my head and I doubt anyone else is either. \nIf I could find something that would do SSL and dump the actual HTTP transaction\nI would do that - I haven\'t yet (especially because form security is in place on\nthe webapp).\n\nHowever, considering that it *only* failed with the latest Tomcat 5 and works\njust fine in Tomcat 4 I find it hard to believe that there isn\'t something wrong\nwith Tomcat 5.  If it failed when back-revving the version, I might blame\nsomething else.  But this is 100% reproducable among multiple clients and only\nwhen connecting to the Tomcat 5 server using SSL.\n\nThis *only* fails when using SSL through Tomcat 5.  It works with Tomcat 4,\nusing the same JDK and the same configuration.  It also works in Tomcat 5 if I\nuse the standard HTTP connector.  I can\'t figure out how to begin to debug this,\nbut if anyone can offer any suggestions on utilities to debug SSL connections\nI\'ll take a stab at it next week.', 'Daniel Potter', '2004-02-20 21:24:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (951, '27122', '3', 'Try \'openssl s_client\'.  It\'s my first stop when debugging SSL problems.', 'william.barker', '2004-02-20 21:40:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (952, '27122', '4', 'Well, I understand, but the behavior you describe would be extremely strange. I\ndon\'t see how it can be a Jasper or container issue, and I don\'t see how it can\nbe a connector issue either (the connector doesn\'t have content-type specific at\nall either, except when HTTP compression is used). Tomcat 4.1.29 uses the same\nconnectors as 5.0.14, and similarly 4.1.30 uses the same as 5.0.18, so again I\ndon\'t understand a difference in behavior between the two \'branches\'.', 'Remy Maucherat', '2004-02-20 23:33:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (953, '27122', '5', 'OK, I finally got a chance to use \'openssl\' to try and manually run a couple of\nHTTP transactions.  I found one header I thought may be a problem that\'s\nincluded in Tomcat 5 but not Tomcat 4: \'Expires: Wed, 31 Dec 1969 19:00:00 EST\'.\n Unfortunately, updating it to a more realistic \'expires\' date didn\'t allow IE\nto work.\n\nI\'m as stumped as everyone else is as to what might be causing this.  I think I\nneed to actually find a way to sniff out what IE is doing, but this definitely\nisn\'t working with IE 6 SP1 and Tomcat 5.0.18 on this one SVG page.  (I\'m\nwondering if it has to do with the form authentication - when I created a test\nJSP with no security constraints it worked through IE 6.)\n\nAs far as I can tell, though, Tomcat is generating the headers correctly... \nAlthough I can\'t figure out why IE would only not work with this page and work\nfine on all the others and why back-revving to Tomcat 4 would solve the problem.\n\nAnd now it appears that Opera 7.23 is working just fine on the page, as well as\nMozilla.  This is probably an Internet Explorer issue, not a Tomcat 5 issue, but\nit still is *weird*.  Anyone who has any ideas to help debug what Internet\nExplorer is doing would be appreciated - it always indicates that the \'Action\nwas canceled\' and says that the site was unavailable.\n\nFor reference:\n\nTOMCAT 4.1.29 HEADERS:\n\nHTTP/1.1 200 OK\nContent-Type: image/svg+xml;charset=ISO-8859-1\nDate: Wed, 25 Feb 2004 21:28:16 GMT\nServer: Apache-Coyote/1.1\nConnection: close\n\nTOMCAT 5.0.18 HEADERS:\n\nHTTP/1.1 200 OK\nPragma: No-cache\nCache-Control: no-cache\nExpires: Wed, 31 Dec 1969 19:00:00 EST\nContent-Type: image/svg+xml\nDate: Wed, 25 Feb 2004 21:21:46 GMT\nServer: Apache-Coyote/1.1\nConnection: close', 'Daniel Potter', '2004-02-25 21:50:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (954, '27122', '6', 'And we have finally found the problem.  In an attempt to try and work around \nsome broken client (I can\'t be bothered to go back and see which one), Tomcat5 \nstarted adding adding the \'don\'t cache\' headers even for SSL requests.  I\'m in \na very small minority of disliking this \'feature\', so it is unlikely to change.\n\nThe work-around is to configure the Authenticator yourself:\n<Context path=\'/myapp\' docBase=\'myapp\'>\n  <Valve className=\'org.apache.catalina.authenticator.FormAuthenticator\'\n          disableProxyCaching=\'false\' />\n</Context>\n\nOf course, if you\'re not using Form auth, then substitute the correct class in \nthe example above.', 'william.barker', '2004-02-25 22:07:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (955, '27122', '7', 'Yep - that solved it.  Thanks!\n\n(Also, I see that Tomcat 5.0.19 was released, so I tested it against that\nversion and got the same problem on Solaris.)\n\nThis is a bug with the way Internet Explorer handles plugins, then.  My guess is\nthat the file isn\'t cached so that when the plugin attempts to access it, it\ndoesn\'t receive anything causing it to silently fail.\n\nI just tried uploading the Badgers-Badgers SWF and seeing if it would fail in\nthe same way, and it does.  So this happens with any IE plugin.\n\nMind you, the way Internet Explorer fails with this is weird.  It just indicates\nthat the resource is not available, despite all other indications being that it\nis.  It also happens when you attempt to directly access the resource through\nIE, it asks you to download the file and then tells you that it isn\'t available.\n It might be worth re-openning this bug and removing the \'no-cache\' behavior if\n\'MSIE\' appears in the User-agent header.', 'Daniel Potter', '2004-02-25 22:40:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (956, '27122', '8', '***  Bug 28662  has been marked as a duplicate of this bug. ***', 'william.barker', '2004-04-28 23:21:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (957, '27122', '9', '***  Bug 29336  has been marked as a duplicate of this bug. ***', 'william.barker', '2004-06-02 16:06:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (958, '27122', '10', '***  Bug 29975  has been marked as a duplicate of this bug. ***', 'william.barker', '2004-07-08 19:42:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (959, '27122', '11', 'Microsoft describes the exact behaviour of their bug on this webpage:\n\n http://support.microsoft.com/?id=316431 \n\nMicrosoft says that this bug is \'by design\' and that they will not ifx it. This \nis just SOOO arrogant!!\n\n--\n\nTomcat adds the respective caching headers to the HTTP header automatically if \nand only if a resource of a webapp is being accessed for which a user data \nconstraint of CONFIDENTIAL has been set.\n\nI PROPOSE TO HAVE A SPECIAL ATTRIBUTE WITHIN THE CONNECTOR CONFIGURATION BY \nWHICH TOMCAT CAN BE FORCED NOT TO SET CACHING HEADERS ITSELF.\n\n*** PLUS ***\n\nI DON\'T LIKE THAT THIS BUG HAS BEEN MARKED AS INVALID!\nSEVERAL PEOPLE HAVE REPORTED THIS BEHAVIOUR AND a FIX IS POSSIBLE AND \nSTRAIGHTFORWARD TO APPLY.\n(Search for \'no-cache\' within the connector codebase and put an if(doCaching) \nbracket around it. That\'s all there is to it.)\n\nI leave it to the tomcat developers to reopen this bug as I regard it as \nsomehow impolite to do this myself. However, I strongly recommend you people to \ndo so. This bug is reproducible on every InternetExplorer. A lot of people will \nget headaches and spend days on investigation unless you add the proposed \nattribute to the connector configuration or at least place a comment on the \nwebpage which informs developers of the effect in question.', 'Sascha C.', '2004-07-12 11:58:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (960, '27122', '12', '***  Bug 30618  has been marked as a duplicate of this bug. ***', 'william.barker', '2004-08-12 15:13:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (961, '27122', '13', '***  Bug 30618  has been marked as a duplicate of this bug. ***', 'Tim Funk', '2004-09-06 12:09:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (962, '27122', '14', '***  Bug 36735  has been marked as a duplicate of this bug. ***', 'william.barker', '2005-09-20 19:13:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (963, '27122', '15', 'I would like to add my support for the previous request to make the caching\nheaders (Pragma and Cache-Control) configurable in Tomcat 5.0.x.  \n\nBrief history: I use Tomcat 5.0.28 for a small webapp.  It sits behind Apache,\nwhich does SSL and forwards requests to Tomcat via mod_jk.  Users access the\nwebapp stricly with SSL.  The webapp\'s doc area has a few static power-point\nfiles, and that\'s where this problem bit me: IE users could not get power-point\nfiles.\n\nTo figure out what headers Tomcat sets in responses, I turned on the\nRequestDumperValve in the server.xml file.  Then I saw that every single request\n-- whether .gif, .html, .css, .ppt, or .jsp -- gets \'Cache-Control: no-cache\'\nand \'Pragma: no cache\' in the response headers.\n\nWhile these headers are absolutely appropriate for JSP pages, they are wholly\nunnecessary for static content.  I want my users\' browsers to cache static\ncontent like CSS sheets, images, etc. and thereby make fewer requests to my\nserver.  Everybody wins.\n\nThis thread helped me understand the problem:\n http://forum.java.sun.com/thread.jspa?threadID=233446&start=0&tstart=0  \n\nI finally used the solution from here, with one modification:\n http://www.jspinsider.com/content/dev/afessh/another-filter-every-site-should-have.html \nJayson Falkner explains servlet filters that set response headers; this means \nweb browsers will cache items like pictures and other static content.  Note that\nhis code does \'addHeader\' but that does NOT work; you have to do \'setHeader\' to\noverrride the cache-control that Tomcat adds.\n\nI am of the strong opinion that Tomcat needs some configuration setting so users\nlike me can tell the container what caching policy to apply by default.  Maybe\nsomething along the lines of a mime-types file would allow the caching policy to\nbe set based on file suffixes or file-name patterns. \n\nPlease consider this request seriously.  I am not a Tomcat dev and don\'t want to\nreopen this bug myself.  Thanks.\n', 'Chris Lott', '2006-02-27 15:24:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (964, '27122', '16', 'Reopening this bug - even though strictly speaking Tomcat\'s behaviour is not\nincorrect - because it seems to be a significant and common source of problems,\nand is not that easy for the user to diagnose. It occurs with or without SSL,\nand in a wider set of circumstances than invoking IE plugins. (My own variation\nis that download to a file in IE fails if a content-disposition header is set\nand the resource is subject to a security constraint).\n\nThe workaround given by Bill Barker is to configure each context:\n\n<Context path=\'/myapp\' docBase=\'myapp\'>\n  <Valve className=\'org.apache.catalina.authenticator.FormAuthenticator\'\n          disableProxyCaching=\'false\' />\n</Context>\n\nThis works but reduces security more than is necessary, as it causes no cache\ncontrol headers to be issued at all.\n\nAn alternative workaround\n\n<Context path=\'/myapp\' docBase=\'myapp\'>\n  <Valve className=\'org.apache.catalina.authenticator.FormAuthenticator\'\n          securePagesWithPragma=\'false\' />\n</Context>\n\nis better. It causes a header Cache-Control: private to be issued in place of\nthe default Cache-Control: none and Pragma: no-cache headers. This tells shared\ncaches not to cache the response, which I think is all that is necessary, while\nstill allowing downloads to work in IE.\n\nHowever, neither workaround is a good solution because it makes configuration\nmore difficult and because it duplicates knowledge of which authenticator is\nrequired between the web.xml and context.xml files.\n\nTherefore I suggest that AuthenticatorBase be changed to put out the\nCache-Control: private header by default. I think this is simply a matter of\nchanging the securePagesWithPragma field from true to false:\n\n    /**\n     * Flag to determine if we disable proxy caching with headers incompatible\n     * with IE \n     */\n    protected boolean securePagesWithPragma = true;\n    \nOther comments in this source file suggest that IE-incompatible headers are\nbeing issued because there is some unspecified problem with Mozilla when\ncache-control: private is used. However I can find no such problem at least with\ncurrent versions of Firefox. Since the choice therefore seems to be between\nworking around a known bug in all versions of IE, and working around a possible\nbug in some previous versions of Mozilla that does not affect current Firefox\nusers, I\'d argue that the former is the better thing to do. \n', 'John Holman', '2007-05-12 09:51:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (965, '27122', '17', 'The current behaviour is unlikely to change. I am marking this as an enhancement\nrather than WONTFIX in case someone cares enough to come up with a proposed patch.', 'Mark Thomas', '2007-06-01 18:09:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (966, '27122', '18', 'We just found that adding:\n\n<security-constraint>\n  <web-resource-collection>\n    <web-resource-name>Automatic SLL Forwarding</web-resource-name>\n    <url-pattern>/*</url-pattern>\n  </web-resource-collection>\n  <user-data-constraint>\n    <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n  </user-data-constraint>\n</security-constraint>\n\nalso adds the headers that creates this issue.  Any ideas?  Using tomcat 5.5.25', 'Dave', '2008-07-02 14:41:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (967, '27122', '19', '<transport-guarantee>CONFIDENTIAL</transport-guarantee> means SSL will be used so yes, you will hit this bug in IE. Workarounds as described above.', 'Mark Thomas', '2008-07-02 23:34:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (968, '27122', '20', 'We\'ve added the following to context.xml as a work-around:\n\n<Valve className=\'org.apache.catalina.authenticator.NonLoginAuthenticator\' disableProxyCaching=\'true\' securePagesWithPragma=\'false\' />\n\n', 'Dave', '2008-07-03 12:04:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (969, '27122', '21', 'For reference, the original Mozilla issue described in  bug 23887 . I have confirmed that this bug no longer exists in the latest version of Firefox. I suspect it was fixed some time ago although I couldn\'t find it when I tried searching the Mozilla bug database.', 'Mark Thomas', '2011-05-22 22:49:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (970, '51185', '1', 'Fix product / component', 'Mark Thomas', '2011-05-11 10:32:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (971, '51185', '2', 'Created  attachment 26984   [details] \nPatch that changes synchronization', 'Philippe Mouawad', '2011-05-11 19:39:42 UTC', 'tomcat_attachment/attachment 26984.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (972, '51185', '3', 'Created  attachment 27023   [details] \nFix to synchro issue\n\nThis patch cancels the previous one which was bugged.\nPhilippe', 'Philippe Mouawad', '2011-05-18 16:22:27 UTC', 'tomcat_attachment/attachment 27023.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (973, '51185', '4', 'Created  attachment 27025   [details] \nReal fix\n\nSorry I messed up with another bug.\n\nPhilippe Mouawad\n http://www.ubik-ingenierie.com ', 'Philippe Mouawad', '2011-05-18 16:34:19 UTC', 'tomcat_attachment/attachment 27025.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (974, '51185', '5', 'Hello,\nIs there something missing in the patch ?\nDo you think it is wrong  ?\n\nThank you\nRegards\nPhilippe', 'Philippe Mouawad', '2011-05-20 21:06:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (975, '35054', '1', 'Created  attachment 15162   [details] \nHostConfig.java.patch\n\na little bit more user-friendly', 'Ralf Hauser', '2005-05-25 10:04:42 UTC', 'tomcat_attachment/attachment 15162.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (976, '35054', '2', 'Created  attachment 15163   [details] \nHostConfig.java.patch2\n\nyet more user-friendliness (and an error less)', 'Ralf Hauser', '2005-05-25 11:30:45 UTC', 'tomcat_attachment/attachment 15163.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (977, '35054', '3', 'I don\'t understand: your patches actually remove logging statements, yet the\ntitle of this issue asks to add a warning, no?', 'Yoav Shapira', '2005-07-21 23:45:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (978, '35054', '4', 'Created  attachment 15742   [details] \nHostConfig.java.patch3\n\ncorrected - now using\n\ndiff -u HostConfig.java.orig HostConfig.java', 'Ralf Hauser', '2005-07-22 06:45:29 UTC', 'tomcat_attachment/attachment 15742.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (979, '50950', '1', 'I can\'t reproduce this issue. Additionally:\n- GenericPrincipal should always be converted to SerializablePrincipal by Tomcat (I can;t see anywhere it isn\'t)\n- The stack trace provided below is incomplete\n\nIf you re-open this issue you will need to provide information necessary to reproduce this issue from a clean install of the latest Tomcat 6.0.x release.', 'Mark Thomas', '2011-03-21 17:27:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (980, '50950', '2', 'Created  attachment 26798   [details] \nserver.xml and context to reproduce the issue\n\nIf you set up a cluster and ask for /index.jsp than it is ok.\nIf you ask for /intern/index.jsp (behind a password) than you get serialization exceptions.\nAs far as I see, there is no other Realm type which is serializable.\nWhy is this object on the session anyway?\n\nMar 25, 2011 5:35:17 PM org.apache.catalina.ha.session.DeltaManager requestCompleted\nSEVERE: Unable to serialize delta request for sessionid [F9D61003F2344ED314504FDE3BDF9FDA]\njava.io.NotSerializableException: org.apache.catalina.realm.GenericPrincipal\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1180)\n        at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:346)\n        at java.util.LinkedList.writeObject(LinkedList.java:960)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)', 'Ronald Klop', '2011-03-25 12:51:55 UTC', 'tomcat_attachment/attachment 26798');
INSERT INTO `tomcatbeforefixcomments` VALUES (981, '50950', '3', 'You asked for the complete stack.\nMar 25, 2011 5:35:17 PM org.apache.catalina.ha.session.DeltaManager requestCompleted\nSEVERE: Unable to serialize delta request for sessionid [F9D61003F2344ED314504FDE3BDF9FDA]\njava.io.NotSerializableException: org.apache.catalina.realm.GenericPrincipal\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1180)\n        at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:346)\n        at java.util.LinkedList.writeObject(LinkedList.java:960)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:616)\n        at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:962)\n        at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1480)\n        at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1416)\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1174)\n        at java.io.ObjectOutputStream.access$300(ObjectOutputStream.java:161)\n        at java.io.ObjectOutputStream$PutFieldImpl.writeFields(ObjectOutputStream.java:1687)\n        at java.io.ObjectOutputStream.writeFields(ObjectOutputStream.java:478)\n        at javax.security.auth.Subject$SecureSet.writeObject(Subject.java:1300)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:616)\n        at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:962)\n        at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1480)\n        at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1416)\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1174)\n        at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1528)\n        at java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:438)', 'Ronald Klop', '2011-03-25 12:53:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (982, '50950', '4', '(In reply to  comment #3 )\n> You asked for the complete stack.\n\nThe stack trace is still incomplete. What calls the last line in your comment (below)? - where the ObjectOutputStream is called from?\n\n>(...)\n> java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:438)\n\nNote, that is is not necessary to paste the stacktrace as a comment:\nyou can attach it as a file.', 'Konstantin Kolinko', '2011-03-25 18:45:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (983, '50950', '5', 'Created  attachment 26803   [details] \nfull stacktrace\n\nMmm, my (new) terminal doesn\'t copy what is outside the viewport. Now you have a complete stack.', 'Ronald Klop', '2011-03-28 03:09:58 UTC', 'tomcat_attachment/attachment 26803.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (984, '50950', '6', 'The attached test case is just an empty zip. Not helpful.\n\nFailing to mention that this only occurs when running a security manager and that the stack trace appears on session expiration was also not helpful. \n\nFortunately, there were enough clues in the stacktrace to figure out what was going on and I can now reproduce this. I\'m currently working on a fix.', 'Mark Thomas', '2011-05-05 10:31:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (985, '50950', '7', 'This is fixed in 7.0.x and will be included in 7.0.13 onwards.\n\nIt looks like back-porting the 7.0.x will be insufficient to address all the issues in 6.0.x. I\'m working on a 6.0.x patch.', 'Mark Thomas', '2011-05-05 12:46:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (986, '50950', '8', 'Hmm. The reproduction steps that worked on Tomcat 7, don\'t on Tomcat 6.\n\nPlease provide the steps and configuration necessary to reproduce this on the latest Tomcat 6 source. Without steps to reproduce, this will eventually get resolved as WORKSFORME.', 'Mark Thomas', '2011-05-05 13:23:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (987, '50950', '9', 'Created  attachment 26979   [details] \nzip with content (logs/web dir/conf)\n\nHi, in the attachment more content hopefully. I must be a dumb-ass to upload an empty zip.\nIndeed I use the security manager, because my app uses rmi. Didn\'t mention it, because I run it for years already and didn\'t think about it.\n\nIn the zip is a context. I use \'pen -fr 8080 localhost:8081 localhost:8082\' as a loadbalancer and \'connection: close\' for this test, so requests go round robin.\nIf you go to / (or /index.jsp) you get a session and all is well. If you than go to /intern/ you get an exception as is seen in catalina.out.node-b.\n\nThis is on 6.0.32 as you can see in the logs.\n\nI hope I have provided better info this time. Thanks for looking into this.', 'Ronald Klop', '2011-05-09 16:04:45 UTC', 'tomcat_attachment/attachment 26979');
INSERT INTO `tomcatbeforefixcomments` VALUES (988, '50950', '10', 'Thanks. That did it. The fix is the same in 6 as it was in 7. I have proposed the patch.', 'Mark Thomas', '2011-05-09 17:15:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (989, '51119', '1', 'Enhancement requests with proposed patches tend to get addressed more quickly than those without.', 'Mark Thomas', '2011-04-26 05:31:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (990, '51119', '2', 'Created  attachment 26934   [details] \nDiff from trunk - changes JmxRemoteLifecycleListener only', 'Neil laurance', '2011-04-26 05:32:51 UTC', 'tomcat_attachment/attachment 26934.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (991, '51119', '3', '(In reply to  comment #1 )\n> Enhancement requests with proposed patches tend to get addressed more quickly\n> than those without.\n\nApologies, didn\'t have time to add my patch before your reply ;-)', 'Neil laurance', '2011-04-26 05:36:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (992, '51119', '4', 'Properties to verify this is working:\n\n-Dcom.sun.management.jmxremote.authenticate=true\n-Dcom.sun.management.jmxremote.ssl=false\n-Dcom.sun.management.jmxremote.login.config=TomcatJaas  (the module name)\n-Djava.security.auth.login.config=/path/to/jaas.config           \n-Dcom.sun.management.jmxremote.access.file=/path/to/jmxremote.access', 'Neil laurance', '2011-04-26 05:40:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (993, '51124', '1', 'Created  attachment 26956   [details] \npatch for BodyContentImpl class of trunk\n\nWe are reproducing this problem after getting an OutOfMemoryError on BodyContentImpl.reAllocBuff.\n\njava.lang.OutOfMemoryError: Java heap space\n        at org.apache.jasper.runtime.BodyContentImpl.reAllocBuff(BodyContentImpl.java:595)\n        at org.apache.jasper.runtime.BodyContentImpl.write(BodyContentImpl.java:109)\n        at java.io.PrintWriter.write(PrintWriter.java:382)\n\n\nWe are on version 6.0.29, but the cause is still in trunk.\n\nWhen the buffer needs to increase the size and an OOM error is thrown the bufferSize member variable is increased before the buffer is reallocated. But the BodyContentImpl is accessible for later requests (from the PageContext pool) with a bufferSize greater than the real buffer size, causing the ArrayIndexOutOfBoundsException to be thrown when trying to use the buffer space above the real size.\n\nTo solve the problem the bufferSize member variable should be updated only after the buffer array is properly created.\n\nThe patch fixes this issue.', 'Ramiro', '2011-05-04 09:39:28 UTC', 'tomcat_attachment/attachment 26956.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (994, '51124', '2', 'Once the JVM issues an OutOfMemoryError (especially for heap), there are no more guarantees that anything works correctly. After such an OOME you must restart the JVM. Relying on things to work just because it seems to is dangerous.', 'Rainer Jung', '2011-05-04 13:04:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (995, '51124', '3', 'In our case there was no Out-Of-Memory that forced this bug to show. The application still ran fine but the Array-Index out of bounds exception were thrown anyway.', 'Juergen', '2011-05-04 13:15:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (996, '51124', '4', 'Hmm. Looking at case 2 above, I don\'t see any way for that to happen unless bufferSize > cb.length. As far as I can see, these are always changed in sync. That leads me to think that there is an OOME that is being missed for some reason.\n\nWhile I agree 100% with Rainer that once an OOME occurs, all bets are off, I think that having this patch in 7.0.x will at least allow us to determine if the root cause is an OOME or something else.\n\nI have applied a variation of the patch suggested in  comment 2  to Tomcat 7.0.x which will be included in 7.0.13 onwards. The patch won\'t get back-ported to 6.0.x until there is some evidence that it useful. Please test your application with 7.0.13 once released. and let us know how you get on.\n\nIf an upgrade to 7.0.13 is not possible, we could provide a binary patch for 6.0.32 *purely for testing purposes*. Let us know if you want to go that route.', 'Mark Thomas', '2011-05-04 19:53:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (997, '51124', '5', 'No plans for us to upgrade to 7.0 in the near future. We are already testing 6.0.32 with the patch in #2, so no binary patch needed for us, thanks. We will apply Mark patch in trunk to our build to test with the same code.\n\nAlthough with an OOME we almost always need to restart a JVM in some applications I think this is not always the case with Tomcat (or other server applications) if the lack of memory is due to a server traffic peak and servlets in the applications use many tags with big buffered content. Of course it depends on which point the OOME is thrown.\n\nWhen this happens the affected request is aborted and all local resources are freed, including huge buffers allocated by tags (which are the cause of the problem for us), so it is not strange that the server can recover in some cases without needing to restart the JVM. \n\nIf this happens (that JVM can free memory after the first OOME to handle following requests) Tomcat is still unusable because of BodyContentImpl instances with an invalid buffer are pooled in PageContext instances at JspFactoryImpl. \n\nAlthough the invalid BodyContentImpl instances should be recycled by PageContextImpl.release, in our experience the instances with the invalid buffer are used after the OOME.\n\nLast time we saw this problem, our server seemed to recover from the error after some time (several minutes) throwing the ArrayIndexOutOfBoundsException (AIOOBE) in certain requests very often. After some time working fine (more than 30 minutes) AIOOBE started again in some requests (without any other OOME), we supose because pooled PageContextImpl instances with invalid BodyContextImpl instances were used again needing a big buffer.\n\nSo, and always with our experience, we think that in certain circumstances Tomcat can recover from an OOME in BodyContentImp.reAllocBuff, but these pooled invalid BodyContentImpl instances will force to restart JVM to clean them.\n\nOf course, we would like the patch in trunk applied also to 6.0.x ;)', 'Ramiro', '2011-05-05 07:42:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (998, '51124', '6', 'We also used the code in the tomcat repository to patch our current tomcat 6.0.32 and will get back to you after it has been in production for some time. Thanks again for you help!', 'Juergen', '2011-05-06 06:44:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (999, '51124', '7', 'We have the modified code in production now for about one and half weeks, and the ArrayIndexOutOfBounds exceptions didn\'t occur anymore.\n\nIt seems like the fix works accordingly. We would be glad if this fix could be backported to tomcat 6.0.x\n\nPlease leave a comment here, to indicate whether this will be done or whether it won\'t.\n\nThank you again for your great help!', 'Juergen', '2011-05-23 05:09:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1000, '51124', '8', 'Thanks for the feedback. I have proposed the patch for 6.0.x.', 'Mark Thomas', '2011-05-24 17:18:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1001, '51124', '9', 'Fixed in 6.0.x and will be included in 6.0.33 onwards.', 'Mark Thomas', '2011-06-20 13:27:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1002, '51124', '10', '167:                                             &nbsp;</td>\n168:                                         <td class=\'msgtext\' align=\'right\'>&nbsp;\n169:                                             <html:select property=\'pageIndex\' styleClass=\'simpletext\' onchange=\'javascript:goToSelectedPage();\'>\n170:                                                 <c:forEach var=\'pages\' items=\'${smsAdminReportForm.pageList}\'>\n171:                                                     <html:option value=\'${pages.pageIndex}\'>${pages.pagination}</html:option>\n172:                                                 </c:forEach>       \n173:                                             </html:select>\n\n\nStacktrace:] with root cause\njava.lang.OutOfMemoryError: Java heap space\n	at org.apache.jasper.runtime.BodyContentImpl.reAllocBuff(BodyContentImpl.java:647)\n	at org.apache.jasper.runtime.BodyContentImpl.write(BodyContentImpl.java:145)\n	at org.apache.jasper.runtime.BodyContentImpl.write(BodyContentImpl.java:161)\n	at org.apache.jsp.smsAdminReportDetails_jsp._jspx_meth_c_005fforEach_005f1(smsAdminReportDetails_jsp.java:1217)\n	at org.apache.jsp.smsAdminReportDetails_jsp._jspx_meth_html_005fselect_005f0(smsAdminReportDetails_jsp.java:1179)\n	at org.apache.jsp.smsAdminReportDetails_jsp._jspx_meth_c_005fotherwise_005f1(smsAdminReportDetails_jsp.java:1037)\n	at org.apache.jsp.smsAdminReportDetails_jsp._jspx_meth_c_005fchoose_005f1(smsAdminReportDetails_jsp.java:931)\n	at org.apache.jsp.smsAdminReportDetails_jsp._jspService(smsAdminReportDetails_jsp.java:361)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:749)\n	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:487)\n	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:412)\n	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:339)\n	at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n	at org.apache.struts.tiles.TilesRequestProcessor.doForward(TilesRequestProcessor.java:263)\n	at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n	at org.apache.struts.tiles.TilesRequestProcessor.processForwardConfig(TilesRequestProcessor.java:318)\n	at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n	at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)', 'Vijay Ghadage', '2015-08-10 09:12:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1003, '51042', '1', 'By the way, the change that introduced this issue was the fix for  bug #47774 .', 'Joachim Sauer', '2011-04-08 05:56:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1004, '51042', '2', '(In reply to  comment #1 )\n> By the way, the change that introduced this issue was the fix for  bug #47774 .\n\nOops, wrong bug number: #45255 is the correct one!', 'Joachim Sauer', '2011-04-08 05:57:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1005, '51042', '3', 'Fixed in 7.0.x for 7.0.13.\n\nProposed for 6.0.x and 5.5.x', 'Mark Thomas', '2011-04-16 18:36:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1006, '51042', '4', 'Fixed in 6.0.x and will be included in 6.0.33 onwards.', 'Mark Thomas', '2011-06-14 11:41:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1007, '50887', '1', 'Mark Thomas has commented by email:\n\n>The patch raises a couple of questions for me.\n> - Security providers are normally configured at the JVM level.\n> - Patches that change one of 5 connectors usually mean the other\n>connectors need changing too\n> - There are other places where CertificateFactory is used that may\n>conflict with this patch.\n\n\nI will not define the provider in the JVM. For that I have to insert e.g. bouncycastle at the first position to not get sun security-provider for X.509 CertificateFactory. With that definition bouncycastle is used anywhere within the JVM first. This could lead to some other effects I cannot estimate.\n\n\nI\'m not able to see if the changes are necessary for other connectors. \nFor Http11AprProcessor and AjpProcessor it is nearly the same as for AjpArProcessor. \nHttp11NioProcessor and Http11Processor are not using CertificateFactory. \n\nThe last remark is unclear for me. With my proposed patch all other places are unchanged. So there will be no conflict.', 'pknopp', '2011-03-08 05:19:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1008, '50887', '2', 'I\'ve had a chance to look at this further. With regard to the three points I raised previously:\n\n> - Security providers are normally configured at the JVM level\n\nI can see why you don\'t like this and your reasoning is consistent with the design of the Tomcat SSL connector implementation. It is meant to be possible to configure each connector independently of any JVM configuration.\n\n> - Patches that change one of 5 connectors usually mean the other\n>connectors need changing too\n\nAll of the connectors use CertifcateFactory. HTTP BIO & NIO use it via JSSESupport so all five connectors will need changes.\n\n> - There are other places where CertificateFactory is used that may\n>conflict with this patch.\n\nMy point is that it isn\'t just the connectors that create client certificates from SSL data. The SSL Valve also does this and will also need a configuration option for this.\n\nI\'ll work on a patch for 7.0.x which will then be back-ported to 6.0.x.', 'Mark Thomas', '2011-03-12 04:57:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1009, '50887', '3', 'Fixed in 7.0.x and will be in 7.0.12 onwards.', 'Mark Thomas', '2011-03-13 10:01:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1010, '50887', '4', 'Created  attachment 26765   [details] \nProposed patch for Tomcat 6', 'Mark Thomas', '2011-03-13 14:08:46 UTC', 'tomcat_attachment/attachment 26765.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1011, '50887', '5', '(In reply to  comment #4 )\n> Created an attachment (id=26765) [details]\n> Proposed patch for Tomcat 6\n\nI have tested the proposed patch within Tomcat 6.0.32, it works fine. \nThe client-certificate with a ECDSA-key is converted correctly within tomcat. \n\n\nOne remark to your patch: You use different logging within the class SSLValve, but not within the Connectors. It would be nice for debbuging if the messages differ between a CertificateException and a NoSuchProviderException.', 'pknopp', '2011-03-14 12:58:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1012, '50895', '1', 'Initialisation has to happen at some point. If it doesn\'t happen at compilation it will happen at first use very shortly afterwards. Failing early is actually better. Therefore I am closing this as INVALID.\n\nIf you have a test case that currently fails that changing initialize to false will allow to work then please re-open this issue and attach the test case.', 'Mark Thomas', '2011-03-08 17:30:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1013, '50895', '2', 'We have a tag that contructs a class that has runtime dependencies in it\'s constructor.\n\nWhen using the Jspc ant task to compile, these runtime dependencies don\'t exist.  However, when the class is actually called during runtime (i.e. within a running tomcat instance) the runtime requirements exist and are fine.\n\nI can\'t provide you our usecase because it\'s dependent on many many layers of our code, but I can easily provide you with a contrived usecase of a jsp file that will compile and load fine when tomcat is running but will not when using the out of band Jspc ant task to perform a precompile if you wish.\n\nI think this is a valid scenario.', 'Andy Wang', '2011-03-08 17:42:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1014, '50895', '3', 'I haven\'t coded this up, here\'s a simple example:\n\nmy.jsp page that contians the following\n\nMyClass class = new MyClass();\n\nMyClass contains the following code\n\n static {\n     File file = new File(\'/path/to/file/that/only/exists/at/runtime\');\n     if (!file.exists()) {\n        throw new Exception();\n     }\n }\n\n\nmy.jsp is perfectly valid to precompile in this case, but precompilation using the Jspc ant task will fail because the instantiation of MyClass will fail due to the file that doesn\'t exist.\n\nWhile this is a horrible example and I won\'t argue the coding pattern isn\'t ideal, we have a couple of cases where a jsp page relies on a class that has a static constructor that has runtime dependencies.  As a result, we are unable to precompile the jsps without patching tomcat and making the initialize flag false.\n\nThe other thing.  All of our JSPs takes 96 minutes to pre-compile with 6.0.32.\nTook about an hour with 6.0.28.  With the initialize set to false it\'s somewhere in between.  The initialization step of some of our classes with  complicated static initializers can be time consuming.', 'Andy Wang', '2011-03-08 18:05:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1015, '50895', '4', 'Yep, that is a really ugly example but I take the point.\n\nFixed in 7.0.x and will be included in 7.0.11 onwards.', 'Mark Thomas', '2011-03-09 08:52:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1016, '50895', '5', 'Thanks.  Any plans to put this into 6.0?  We\'re patching 6.0.32 to deal with this, so not a huge deal.  Just want to know if we should expect to continue maintaining this change ourselves for 6.0.', 'Andy Wang', '2011-03-09 14:53:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1017, '50895', '6', 'It will go into 6. I have my hands full with 7 at the moment but someone (maybe me, maybe someone else) will propose this for backport.', 'Mark Thomas', '2011-03-09 15:18:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1018, '50895', '7', 'Proposed for 6.0.x', 'Mark Thomas', '2011-03-10 08:21:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1019, '25060', '1', 'I have verified your bug report.  If this is happening with a\nJNDI Named DataSource it might also be happening with other JNDI\nresources created.  And be a source of a memory leak.\n\nGreat bug report.  I don\'t have a solution yet, but will be\nresearching this.\n\nThanks Wayne', 'Glenn Nielsen', '2003-12-06 16:38:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1020, '25060', '2', 'I think the only clean way to \'fix\' this is to define the data source as global,\nand use links. There\'s no API in JNDI for releasing resources, so ... (and I\ndon\'t want to introduce any proprietary APIs either).\nMaybe waiting for GC would be the solution, and maybe there\'s a memory leak\nassociated with the JNDI context.', 'Remy Maucherat', '2003-12-06 16:47:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1021, '25060', '3', 'Yes, it may be that when the JNDI resource is defined within\na Context and the context is reloaded or stopped, the previous\nJNDI objects may still consume their resources including db\nconnections until they are GC\'d.\n\nAt a minimum we need to verify whether the already existing resources\nbecome eligible for GC after a reload/stop of a Context and there\nis no memory/resource leak.\n\nEven if there is no memory leak and the previous JNDI DataSource becomes\neligible for GC it might be nice to explicitly close the db connections.\n\nIf the DBCP DataSource is being used a possible solution to free up\nresources would be a Context LifeCycle Listener that does a close\non the DBCP DataSource during a Context reload/stop.\n', 'Glenn Nielsen', '2003-12-07 17:34:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1022, '25060', '4', 'I have confirmed that with the latest code for 4.1.x that the orphaned\nconnections are eligible for garbage collection.\n\nIt is possible, but I have not confirmed it, that as a result of  bug 20758  these\nconnections were not eligible for gc in 4.1.30 and earlier but this is only\nspeculation on my part.\n\nI agree with Glenn that it is possible that some explicit clean-up could be\nperformed using a Context LifeCycle Listener but this is a \'nice to have\'.\nTherefore, since there is no memory leak here, I am changing this issue to an\nenhancement.', 'Mark Thomas', '2005-06-08 01:20:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1023, '25060', '5', 'Hey Mark!\nI respectfully disagree with you about this being a enhancement.\nIf the datasources are left to be garbage collected, their connections with the\ndatabase remain opened (as i just experienced on Tomcat 5.0.28). Since most\ndatabase installations rely on a maximum number of connections, the new\ndatasource resulting of the context\'s reload might not be able to connect to the\ndatabase, right? If these affirmations are right, IMHO this issue is a bug.\nWhat do you think?\nThank you for your time! :)', 'Rafael Leite', '2007-04-11 07:57:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1024, '25060', '6', 'Hi, I wanted to open a bug report but finally found this old one.\n\n(In reply to  comment #4 )\n> I agree with Glenn that it is possible that some explicit clean-up could be\n> performed using a Context LifeCycle Listener but this is a \'nice to have\'.\n> Therefore, since there is no memory leak here, I am changing this issue to an\n> enhancement.\n\nI don\'t totally agree because some pool configurations can cause a memory leak (due to a thread leak). For example, when DBCP is configured with timeBetweenEvictionRunsMillis > 0, the thread won\'t stop at reload. After several reloads, PermGen becomes full. This is still true with Tomcat 7.', 'Cyril Bonté', '2011-02-05 16:32:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1025, '27988', '1', 'Here\'s my stack trace that left me baffled at first:\n\njavax.servlet.ServletException: Exception processing JAR at resource path\n/WEB-INF/lib/log4j-1.2.8.jar\n	at org.apache.catalina.startup.ContextConfig.tldScanJar(ContextConfig.java:930)\n	at org.apache.catalina.startup.ContextConfig.tldScan(ContextConfig.java:868)\n	at org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:647)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:243)\n	at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:166)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:3582)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1188)\n	at org.apache.catalina.core.StandardHost.start(StandardHost.java:754)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1188)\n	at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:363)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:497)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:2190)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:512)\n	at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n	at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:324)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\n----- Root Cause -----\njava.io.FileNotFoundException\n	at\norg.apache.naming.resources.DirContextURLConnection.getInputStream(DirContextURLConnection.java:344)\n	at sun.net.www.protocol.jar.URLJarFile.retrieve(URLJarFile.java:161)\n	at sun.net.www.protocol.jar.URLJarFile.getJarFile(URLJarFile.java:42)\n	at sun.net.www.protocol.jar.JarFileFactory.get(JarFileFactory.java:78)\n	at sun.net.www.protocol.jar.JarURLConnection.connect(JarURLConnection.java:85)\n	at sun.net.www.protocol.jar.JarURLConnection.getJarFile(JarURLConnection.java:69)\n	at org.apache.catalina.startup.ContextConfig.tldScanJar(ContextConfig.java:906)\n	at org.apache.catalina.startup.ContextConfig.tldScan(ContextConfig.java:868)\n	at org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:647)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:243)\n	at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:166)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:3582)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1188)\n	at org.apache.catalina.core.StandardHost.start(StandardHost.java:754)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1188)\n	at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:363)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:497)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:2190)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:512)\n	at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n	at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:324)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\n', 'richard.beton', '2004-03-26 17:04:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1026, '27988', '2', 'The TLD scanning was completely re-written for Tomcat 7 so the error messages there should be a lot better.\n\nI have added the URL (where it isn\'t null) to the Exception message so it is available for any other code paths that may trigger it. This change has been made to 7.0.x and will be included in 7.0.9 onwards.\n\nI have also proposed the same change for 6.0.x and 5.5.x.\n\nSince 5.5.x is the oldest currently supported version, I am moving this bug to that version.', 'Mark Thomas', '2011-03-02 08:30:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1027, '27988', '3', 'Fixed in 6.0.x and will be included in 6.0.33 onwards.', 'Mark Thomas', '2011-04-01 11:12:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1028, '28852', '1', 'Created  attachment 11484   [details] \nfailonerror attribute', 'Stephane Bailliez', '2004-05-10 11:53:49 UTC', 'tomcat_attachment/attachment 11484.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1029, '28852', '2', 'The patch also includes a small refactoring of the validation inside a validate\n() method, read/display response correctly (previous CRs problems) and add url \nencoding where it was not existing.', 'Stephane Bailliez', '2004-05-10 11:56:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1030, '28852', '3', '***  Bug 10225  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2010-12-14 19:37:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1031, '28852', '4', 'failonerror support and the CR issue had already been fixed.\nI have added the URL encoding where it was missing.\n\nThis has been fixed in 7.0.x for 7.0.10 onwards and has been proposed for 6.0.x and 5.5.x.\n\nChanging the version to 5.5.x since that is the earliest supported version affected by this issue.', 'Mark Thomas', '2011-02-28 13:21:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1032, '28852', '5', 'Fixed in 6.0.x and will be included in 6.0.33 onwards.', 'Mark Thomas', '2011-03-10 08:58:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1033, '31027', '1', 'This is really an enhancememt request. The TC4.1.x branch is in a mainteance \nmode now, but if you have a patch I would be happy to consider it.', 'Mark Thomas', '2004-09-05 22:44:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1034, '31027', '2', 'Our real question is whether this has been fixed in version 5+.  It came up in\nversion 4.1.30, so that\'s where we reported it. But if stray whitespace in a\nproperties is still causing entries not to be recognized, it would help to fix\nthat as early as possible.  Could you mark this as Tomcat 5, if it has not been\nfixed?\n\nThanks.\n  ', 'Jim Eng', '2004-09-06 00:49:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1035, '31027', '3', 'Later versions of Tomcat have better error messages that should help but it makes sense to fix this.\n\nI have fixed this in 7.0.x and it will be included in 7.0.9 onwards. I have also proposed it for back-port to 6.0.x and 5.5.x\n\nSince Tomcat 4 is no longer supported, I am moving this issue to Tomcat 5.', 'Mark Thomas', '2011-02-27 08:23:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1036, '50836', '1', 'Agree with MUST_DESTROY.\n\nNeed to review the others.', 'Mark Thomas', '2011-02-26 14:22:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1037, '50836', '2', 'isAvailable() is aligned with when the public methods are available for use by other components. On that basis isAvailable() should return true for states STOPPING_PREP and STARTING. I\'m sure there is scope to improve the documentation and MBean method descriptions to that effect.', 'Mark Thomas', '2011-02-26 14:31:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1038, '50836', '3', '(In reply to  comment #2 )\n> are available for use by other components.\n\nThe \'public\' methods: I think those are methods that perform some work, like AccessLog#log(), not just any public methods.  Or you are talking about JMX here?\n\nRegarding STARTING:\n\nI think that in STARTING it is too early to call those methods:  the component has not completed its start up.\n\nE.g, if AccessLogValve#startInternal() is overriden in some child class, STARTING state will be set by AccessLogValve#startInternal(), before the child class method completes.\n\n\nRegarding STOPPING_PREP: \n\nMy only concern is that the previous state might be FAILED. When transitioning FAILED -> STOPPING_PREP the availability flag suddenly becomes \'true\'.', 'Konstantin Kolinko', '2011-02-26 14:54:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1039, '50836', '4', '(In reply to  comment #3 )\n> The \'public\' methods: I think those are methods that perform some work, like\n> AccessLog#log(), not just any public methods.  Or you are talking about JMX\n> here?\n\nI was quoting from the Lifecycle Javadoc. What is meant by public methods is not defined but I take it to mean \'any public method that isn\'t a property setter/getter or a lifecycle methods\'. That could be better defined in the Lifecycle Javadoc.\n \n> Regarding STARTING:\n> \n> I think that in STARTING it is too early to call those methods:  the component\n> has not completed its start up.\n\nIt should be OK. Do you have an example of where it isn\'t?\n\n> E.g, if AccessLogValve#startInternal() is overriden in some child class,\n> STARTING state will be set by AccessLogValve#startInternal(), before the child\n> class method completes.\n\nProviding the class follows the guidelines in the Javadoc for Lifecycle and LifecycleBase that should be fine.\n\n> Regarding STOPPING_PREP: \n> \n> My only concern is that the previous state might be FAILED. When transitioning\n> FAILED -> STOPPING_PREP the availability flag suddenly becomes \'true\'.\n\nI think we could safely move from FAILED to STOPPING in that case. It means changing the permitted Lifecycle transitions slightly but from a quick look at the code it should be ok.', 'Mark Thomas', '2011-02-26 15:34:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1040, '50836', '5', '(In reply to  comment #4 )\n> > Regarding STARTING:\n> > \n> > I think that in STARTING it is too early to call those methods:  the component\n> > has not completed its start up.\n> \n> It should be OK. Do you have an example of where it isn\'t?\n> \n\nI do not have one. I was thinking about AccessLog in context of  bug 50835  (AccessLog#log() being called on uninitialized valve in unclear circumstances in some broken configuration), but I do not have any custom implementation.\n\nI am also concerned with StandardContext#getAvailable() delegating to LifecycleState#isAvailable().\n\n\nIf Child extends AccessLogValve, implementing Child#startInternal() to do not make the component available too soon essentially means that super.startInternal() should be called at the end of child\'s method, not sooner.\n\nTransition to STARTING means that Lifecycle.START_EVENT will be fired after the transition, but we are not waiting for the listeners to complete before declaring the component \'available\'.\n\nTransition to STARTED is performed automatically in LifecycleBase#start(). All startup procedures for the component are completed in that state, and I think the STARTED state is better place to mark it as \'available\'.\n\n> > Regarding STOPPING_PREP: \n> > \n> > My only concern is that the previous state might be FAILED. When transitioning\n> > FAILED -> STOPPING_PREP the availability flag suddenly becomes \'true\'.\n> \n> I think we could safely move from FAILED to STOPPING in that case. It means\n> changing the permitted Lifecycle transitions slightly but from a quick look at\n> the code it should be ok.\n\nI like the idea. It means that we are not firing Lifecycle.BEFORE_STOP_EVENT, but that is not much to lose.', 'Konstantin Kolinko', '2011-02-26 19:15:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1041, '50836', '6', '(In reply to  comment #5 )\n> I do not have one. I was thinking about AccessLog in context of  bug 50835 \n> (AccessLog#log() being called on uninitialized valve in unclear circumstances\n> in some broken configuration), but I do not have any custom implementation.\n\nIf the Javadoc is followed, I don\'t see how that bug happened. I\'d be happy to revist this with a reproducible test case.\n\n> I am also concerned with StandardContext#getAvailable() delegating to\n> LifecycleState#isAvailable().\n\nIt is always possible to change the implementation of StandardContext#getAvailable() to check for a more limited set of states.\n\nI count 46 references to isAvailable(). I can see at least one place where changing that will break something (ContainerBase.addChildInternal()) and I am concerned that there will be places that are missed if we make this change.\n\n> If Child extends AccessLogValve, implementing Child#startInternal() to do not\n> make the component available too soon essentially means that\n> super.startInternal() should be called at the end of child\'s method, not\n> sooner.\n\nIt depends. That exact requirements are defined in the Javadoc and I am in the process of making that Javadoc even more explicit.\n\n> Transition to STARTING means that Lifecycle.START_EVENT will be fired after the\n> transition, but we are not waiting for the listeners to complete before\n> declaring the component \'available\'.\n\nI\'m happy with that. The listeners should be fired after the state change. Again, I\'ll clarify this in the Javadoc.\n\n> Transition to STARTED is performed automatically in LifecycleBase#start(). All\n> startup procedures for the component are completed in that state, and I think\n> the STARTED state is better place to mark it as \'available\'.\n\n\'available\' means whatever we define it to mean. I\'m happy with the way the current code works but can see lots of places where the Javadoc can be improved.\n\n> > I think we could safely move from FAILED to STOPPING in that case. It means\n> > changing the permitted Lifecycle transitions slightly but from a quick look at\n> > the code it should be ok.\n> \n> I like the idea. It means that we are not firing Lifecycle.BEFORE_STOP_EVENT,\n> but that is not much to lose.\n\nThat event can still be fired.\n\nI have a patch for most of the above, I just need to finish some of the Javadoc improvements.', 'Mark Thomas', '2011-02-27 05:49:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1042, '19444', '1', 'Created  attachment 6087   [details] \nModified JNDIRealm to use authenticated connection for roles.', 'art_w', '2003-04-29 22:00:28 UTC', 'tomcat_attachment/attachment 6087.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1043, '19444', '2', 'Created  attachment 6088   [details] \nDiff from version 4.1.24.', 'art_w', '2003-04-29 22:01:42 UTC', 'tomcat_attachment/attachment 6088.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1044, '19444', '3', 'I forgot to mention that using connectionName and connectionPassword is also \nnot an option for us.\n\nArt', 'art_w', '2003-04-29 22:11:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1045, '19444', '4', 'Here is the relevant thread from tomact-user\n\n http://marc.theaimsgroup.com/?l=tomcat-user&m=103158720132648&w=2 \n\nI am going to mark this as an enhancement request for now.', 'Mark Thomas', '2004-04-14 21:33:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1046, '19444', '5', '***  Bug 22948  has been marked as a duplicate of this bug. ***', 'seth.leger', '2008-03-20 07:01:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1047, '50189', '1', 'Thanks for the report. Which version of mod_jk and which config are you using?', 'Rainer Jung', '2010-11-01 07:42:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1048, '50189', '2', 'The version of mod_jk is 1.2.28 on CentOS 5.4.\n\nIf you are unable to reproduce this issue, let me know and I\'ll do more investigations to reproduce it on my side, I\'ll see if I can reproduce it on later versions of Tomcat and I\'ll attach tcpdump logs etc.  I haven\'t done that yet because the only logs and environment that I have handy are a production environment, and the logs contain sensitive information, but I\'m hoping my description so far is adequate.', 'James Roper', '2010-11-01 20:18:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1049, '50189', '3', 'I\'ve also hit this issue in tomcat 6.0.26 and 7.0.4. This has been using an in-house version of the AJP client (webserver-side).\n\nOur symptoms were the same, and we had been working around by disabling connection sharing across requests.\n\nFollowing James\' advice, I\'ve removed the possibility for a servlet-side read from the request after the response has been closed. This has resolved the issue of us.', 'Clint Morgan', '2010-11-10 14:22:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1050, '50189', '4', 'Fixed in 7.0.x and will be included in 7.0.9.\n\nAn attempt to read from the request once the response has been will trigger an exception.\n\nI\'ll also propose back-ports for 6.0.x and 5.5.x', 'Mark Thomas', '2011-02-18 11:25:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1051, '50189', '5', 'Fixed in 6.0.x and will be included in 6.0.33 onwards.', 'Mark Thomas', '2011-02-21 07:53:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1052, '50780', '1', 'This is Tomcat 7 specific Java code, not part of the APR native code.', 'Mark Thomas', '2011-02-15 12:17:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1053, '50780', '2', 'There was some clean-up in this area for 7.0.8. It is worth testing with the latest version to see if this has already been fixed.', 'Mark Thomas', '2011-02-15 12:39:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1054, '50780', '3', 'Yes it does still happen with 7.0.8 and is specific to the APR implementation of the AJP connector. Testing a fix now...', 'Mark Thomas', '2011-02-17 09:18:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1055, '50713', '1', 'The more I consider this issue, the more I am inclinded to remove the roles command from the manager in Tomcat 7. My reasoning is follows:\n- The manager can be used with any realm\n- Most realms do not expose a role list\n- It is not practical to list all roles for some realms (e.g. JNDI)\n- I don\'t see what the use case is for this feature', 'Mark Thomas', '2011-02-10 14:06:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1056, '50713', '2', 'The \'Cannot resolve user database reference\' message and the necessity to create a <ResourceLink> are already documented, [1]\n\n[1]  http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html#List_Available_Security_Roles \n\n\nI see nothing to fix here. Though the doc can be improved a bit:\n\n1) This is \'Cannot resolve user database reference\' message, though the solution for it is listed with the \'No user database is available\' message.\n\n2) IIRC, there is no \'<ResourceParams>\' element in modern Tomcat versions.\n\n\nRegardless of that, I agree with Mark that I do not see much reason in keeping this command around. Especially I miss a plausible use case. Maybe it was used for some demos?\n\nNote, that besides this command being present inside manager webapp, there is also RolesTask ANT task.', 'Konstantin Kolinko', '2011-02-14 14:12:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1057, '50713', '3', 'Thanks for comments.\n\nI encountered this issue when I used the Tomcat maven plugin\'s \'tomcat:roles\' command that uses the \'roles\' command of the Manager app.\nThe \'tomcat:roles\' command can display the available security roles. But I can\'t think of a case where it\'s necessary.\n\nAnd I have no objection to remove the \'roles\' command.\n\nBest regards.', 'Eiji Takahashi', '2011-02-14 20:13:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1058, '50700', '1', 'I can reproduce the problem (Tomcat 6.0.30 on JDK6u23, Windows XP, 32bit, *.zip distribution).', 'apache', '2011-02-04 13:52:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1059, '50700', '2', 'can reproduce using apache-tomcat-7.0.8-windows-x86.zip, jdk1.6.0_23, windows 7', 'chris', '2011-02-07 11:22:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1060, '50700', '3', 'Sergey\'s explanation is good, but just in case any more detail is required in how to reproduce it, here\'s the steps I take. Expand a tomcat distribution. Edit the <tomcat_home> webapps root WEB-INF web.xml file to become\n\n<web-app xmlns=\' http://java.sun.com/xml/ns/javaee \'\n   xmlns:xsi=\' http://www.w3.org/2001/XMLSchema-instance \'\n   xsi:schemaLocation=\' http://java.sun.com/xml/ns/javaee   http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd \'\n   version=\'2.5\'>\n  <display-name>Welcome to Tomcat</display-name>\n  <description>\n     Welcome to Tomcat\n  </description>\n  <context-param>\n    <param-name>initialDbPath</param-name>\n	<param-value>a</param-value>\n  </context-param>\n</web-app>\n\nthen edit <tomcat_home> conf context.xml to become\n\n<Context>\n	<Parameter name=\'initialDbPath\' value=\'xyz\' override=\'false\'/>\n</Context>\n\nthen add a new file <tomcat_home> webapps ROOT test.jsp which contains\n\n<%@ page contentType=\'text/html; charset=UTF-8\' %>\n<html>\n<body>\n<br>initialDbPath is : ${initParam.initialDbPath}\n</body>\n</html>   \n\nThe context.xml setting should override the web.xml setting, but this is not happening', 'chris', '2011-02-08 04:12:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1061, '50700', '4', 'This has been fixed in 7.0.x and will be included in 7.0.9 onwards.', 'Mark Thomas', '2011-02-14 14:06:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1062, '50700', '5', 'The Tomcat 7 patch has been proposed for backport to 6.0.x.', 'Mark Thomas', '2011-02-14 14:09:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1063, '50700', '6', 'Some comments on the fix for this issue ( r1070609 ), for better understanding:\n\n1) This bug was caused by the fix for  bug 49987  ( r1022117 ), Tomcat 6.0.30-32 are affected.\n2) The cause of this, which went unnoticed when the patch for  Bug 49987  was reviewed, is that ApplicationContext#setInitParameter(name, value) is effective only once.\n\nSubsequent calls to #setInitParameter(name, value) with the same name are ignored. That is why init-param overriding with override=\'false\' stopped working.', 'Konstantin Kolinko', '2011-02-15 02:48:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1064, '50771', '1', 'Fixed in 7.0.x and will be in 7.0.9 onwards.\n\nProposed for 6.0.x and 5.5.x', 'Keiichi Fujino', '2011-02-14 03:54:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1065, '50771', '2', 'Created  attachment 26649   [details] \npatch against tc60.', 'Keiichi Fujino', '2011-02-14 04:54:31 UTC', 'tomcat_attachment/attachment 26649');
INSERT INTO `tomcatbeforefixcomments` VALUES (1066, '50771', '3', 'Created  attachment 26650   [details] \npatch against tc55.', 'Keiichi Fujino', '2011-02-14 04:55:07 UTC', 'tomcat_attachment/attachment 26650');
INSERT INTO `tomcatbeforefixcomments` VALUES (1067, '50771', '4', 'Fixed in 6.0.x and will be in 6.0.33 onwards.', 'Keiichi Fujino', '2011-08-03 01:36:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1068, '50726', '1', 'The genStringAsCharArray option affects the o.a.jasper.compiler.Generator.GenerateVisitor#visit(Node.TemplateText) method.\n\nIt generates char array fields in the JSP page class initialized as\nfield = \'string\'.toCharArray();\n\nThe \'string\' constants have 64K limit on string length. It is not run-time limitation, but a limitation of the Java Class File format, see [1]. Apparently it is what is being hit here.\n\n[1]  http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#88659 ', 'Konstantin Kolinko', '2011-02-08 03:17:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1069, '50726', '2', '(In reply to  comment #1 )\n> The genStringAsCharArray option affects the\n> o.a.jasper.compiler.Generator.GenerateVisitor#visit(Node.TemplateText) method.\n> \n> It generates char array fields in the JSP page class initialized as\n> field = \'string\'.toCharArray();\n> \n> The \'string\' constants have 64K limit on string length. It is not run-time\n> limitation, but a limitation of the Java Class File format, see [1]. Apparently\n> it is what is being hit here.\n> \n> [1]\n>  http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#88659 \n\nThank you, it\'s clear for me now. Is it be possible to provide an official workaround like this?\n field = (new String(\'longstring_part1\') + \n    new String(\'longstring_part2\') +\n    ...\n    new String(\'longstring_partn\')).toCharArray();', 'Róbert István', '2011-02-08 03:55:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1070, '50726', '3', '>  field = (new String(\'longstring_part1\') + \n>     new String(\'longstring_part2\') +\n>     ...\n>     new String(\'longstring_partn\')).toCharArray();\n\nI think that wouldn\'t work. What will work is to generate several arrays and call out.write() with each one in turn.\n\nNote that the 64K limit is not the char count aka str.length(), but the count of bytes in UTF-8 encoding.  So, either that count should be calculated (better without String.toBytes() call) or the threshold should be like (64K / (max count of bytes in char in UTF-8)).\n\nI wonder also whether initializing the array as = {\'s\', \'t\', \'r\', \'i\', \'n\', \'g\'} performs worse or better than the existing code.\n\nAnyway, a test case is needed.\n\n\nBTW, using mappedFile=false will probably hit the same limit.\n(That is when the \'breakAtLF\' variable is false in that visit(Node.TemplateText) method).', 'Konstantin Kolinko', '2011-02-08 04:15:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1071, '50726', '4', 'For info, it appears the the Eclipse compiler does not enforce this limit. Dynamic compilation works whereas pre-compilation fails.', 'Mark Thomas', '2011-02-11 13:03:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1072, '50726', '5', 'I have fixed this in 7.0.x and it will be included in 7.0.9 onwards.\n\nI have also proposed the fix for 6.0.x', 'Mark Thomas', '2011-02-12 14:37:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1073, '50726', '6', '(In reply to  comment #4 )\n> For info, it appears the the Eclipse compiler does not enforce this limit.\n> Dynamic compilation works whereas pre-compilation fails.\n\nThat would be strange. It is class format limitation: the text will be broken if the length counter overflows.\n\nThere is caveat with this setting: the init-param is named \'genStrAsCharArray\' (see comment in web.xml), not genStringAsCharArray as the property in the Options interface, or as said in the title of this bug report. The mapping between names is done inside the EmbeddedServletOptions class constructor.', 'Konstantin Kolinko', '2011-02-14 11:12:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1074, '50726', '7', 'Answering my own questions\n\n(In reply to  comment #3 )\n> I wonder also whether initializing the array as = {\'s\', \'t\', \'r\', \'i\', \'n\',\n> \'g\'} performs worse or better than the existing code.\n\nIt works, but generates a lot of code, like the following (for an array of 11 chars):\n   0:	bipush	11\n   2:	newarray char\n   4:	dup\n   5:	iconst_0\n   6:	bipush	72\n   8:	castore\n   9:	dup\n   10:	iconst_1\n   11:	bipush	101\n   13:	castore\n   14:	dup\n(...)\n   59:	bipush	10\n   61:	bipush	100\n   63:	castore\n   64:	putstatic\n   67:	return\n\nI have not measured whether it works considerably slow or not.\n\n> BTW, using mappedFile=false will probably hit the same limit.\n> (That is when the \'breakAtLF\' variable is false in that\n> visit(Node.TemplateText) method).\n\nThe mappedFile=false will not experience this issue under usual circumstances.\n \nThere is a constant JspUtil.CHUNKSIZE and thus strings longer than 1024 will be split at LF regardless of breakAtLF flag. If the JSP has lines of 64K bytes without any LF in them, this issue will be observed regardless of mappedFile setting. But such JSPs are very unlikely.', 'Konstantin Kolinko', '2011-02-26 11:28:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1075, '50673', '1', 'Confirming. (Win XP SP3, Tomcat 7.0.6)\n\nThe following command\n\'net start Tomcat7\' executes successfully\n\n\'net stop Tomcat7\' apparently fails, printing localized version of error message like the one reported by OP.  Repeating \'net stop Tomcat7\' prints message that the service has not been started.\n\n1. This an issue with Commons Daemon service wrapper (procrun). The issue should be reported there. Tomcat 7.0.6 and 6.0.30 use Commons Daemon 1.0.5.\n https://issues.apache.org/jira/browse/DAEMON \n\n2. Apparently it is just cosmetics. It does not break operation. Though some external scripts might be affected.', 'Konstantin Kolinko', '2011-01-27 11:15:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1076, '50673', '2', 'I created  https://issues.apache.org/jira/browse/DAEMON-195 \nI am closing this issue as INVALID - it is not ours.', 'Konstantin Kolinko', '2011-01-27 12:48:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1077, '50673', '3', 'I changed Catalina shutdown sequence to do not call System.exit(). - in trunk. Will be in 7.0.7.', 'Konstantin Kolinko', '2011-02-01 22:57:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1078, '50673', '4', 'Created  attachment 26591   [details] \n2011-02-02_tc6_50673.patch\n\nPatch for TC 6.0.x', 'Konstantin Kolinko', '2011-02-01 22:58:32 UTC', 'tomcat_attachment/attachment 26591.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1079, '50642', '1', 'Could this be something that is done speculatively?\n\nI\'m not sure HttpClient can be rigged to definitely launch it\'s thread during Tomcat startup, which is where the JreMemoryLeakPreventionListener does most of it\'s work. There is no URL to which we can guarantee a connection to succeed, unless we fire-up an HTTP connector just for this purpose. That could fail for ay number of reasons and just seems like confusion waiting to happen.\n\nThe patch as it stands is somewhat fragile (no error checking, blindly using a Sun-specific class, etc.) but very understandable and could be implemented easily using something similar to the ThreadLocalLeakPreventionListener.', 'Christopher Schultz', '2011-01-24 14:46:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1080, '50642', '2', 'Looking at the KeepAliveCache more closely, the currently solution is the wrong approach. Because the thread only exists for as long as it is needed and is re-created as necessary it has to be dealt with on web application stop.', 'Mark Thomas', '2011-01-27 08:41:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1081, '50642', '3', 'I believe I have a working patch but I have been unable to trigger the creation of the keep-alive thread to test it. A simple test case that triggers this thread creation is needed to resolve this issue.', 'Mark Thomas', '2011-01-27 11:42:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1082, '50642', '4', 'Created  attachment 26564   [details] \nServlet that should trigger this thread to be created\n\nIt\'s ugly, but it gets the job done. Stay away from SecurityManager :)\n\nYou can run it from CLI, too.', 'Christopher Schultz', '2011-01-27 12:43:04 UTC', 'tomcat_attachment/attachment 26564.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1083, '50642', '5', 'Created  attachment 26566   [details] \nAlternative implementation of the servlet\n\nAlternative implementation of the servlet, now using only official API to trigger the issue. Reflection is used only to inspect the state afterwards.\n\nTo map the servlet:\n    <servlet>\n      <servlet-name>issue50642</servlet-name>\n      <servlet-class>issue50642.HttpClientServlet</servlet-class>\n    </servlet>\n    <servlet-mapping>\n      <servlet-name>issue50642</servlet-name>\n      <url-pattern>/issue50642</url-pattern>\n    </servlet-mapping>\n\nWhen being run as a servlet in TC 7.0.x it prints:\n\nKeepAliveThread: null, cl=null\nKeepAliveThread: Thread[Keep-Alive-Timer,8,system], cl=WebappClassLoader\n  context: /examples\n  delegate: false\n  repositories:\n    /WEB-INF/classes/\n----------> Parent Classloader:\norg.apache.catalina.loader.StandardClassLoader@19f953d', 'Konstantin Kolinko', '2011-01-27 13:22:23 UTC', 'tomcat_attachment/attachment 26566.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1084, '50642', '6', 'Grr. Eclipse hides system threads by default - hence my failure to re-create this.\n\nAnyway....\n\nFixed in 7.0.x and will be included in 7.0.7 onwards.\n\nProposed for 6.0.x', 'Mark Thomas', '2011-01-28 08:06:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1085, '50646', '1', 'Created  attachment 26544   [details] \nsvn diff', 'Olivier Costet', '2011-01-25 07:09:27 UTC', 'tomcat_attachment/attachment 26544.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1086, '50646', '2', 'Thanks for the patch. It has been applied to 7.0.x and will be included in 7.0.7 onwards.', 'Mark Thomas', '2011-01-26 13:28:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1087, '50646', '3', 'Oliver, Mark,\nIs it possible that this is an issue on Tomcat 6 also?\n\nThis is suggested in this mail:\n http://marc.info/?l=tomcat-user&m=130924994205157&w=2 ', 'Ronald Klop', '2011-06-29 10:53:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1088, '50646', '4', 'Quite possibly.', 'Mark Thomas', '2011-06-29 10:56:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1089, '50646', '5', 'Patch proposed for 6.0.x', 'Mark Thomas', '2011-06-29 13:33:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1090, '50613', '1', 'There\'s no attachment ...', 'Sebb', '2011-01-18 21:30:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1091, '50613', '2', 'Created  attachment 26513   [details] \nJUnit test case\n\nDiff is against trunk,  http://svn.apache.org/repos/asf/tomcat/trunk , 20110118', 'Jeremy Norris', '2011-01-18 22:49:17 UTC', 'tomcat_attachment/attachment 26513.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1092, '50613', '3', 'Thanks for the test case. Looking at it now.', 'Filip Hanik', '2011-01-19 15:12:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1093, '50582', '1', 'What exactly is the issue here? That is HTTP spec compliant behaviour.', 'Mark Thomas', '2011-01-14 03:13:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1094, '50582', '2', 'The issue is that Content-Length header is no more sent in the response for JSP pages that produce less than 8k of output. (HTTP/1.0 responses will just omit that header, HTTP/1.1 response will use chunked encoding).\n\nI would agree that the response is valid, so we are not violating protocols here.\n\nIt is just a feature/enhancement that worked before, (and is also working if AccessLogValve is removed).\n\nIs it possible to implement #50496 without breaking this one? E.g. call Response.finishResponse() instead of just flushing? Sounds risky, though.', 'Konstantin Kolinko', '2011-01-14 03:45:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1095, '50582', '3', '***  Bug 50583  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2011-01-15 14:35:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1096, '18462', '1', 'Created  attachment 5946   [details] \n[PATCH] Remove SystemLogHandler in start()', 'Andy Chapman', '2003-04-22 13:08:05 UTC', 'tomcat_attachment/attachment 5946.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1097, '18462', '2', 'Redirection of System.out and System.err in \norg.apache.catalina.startup.Catalina.start() prevents any other application \n(for instance an IDE) from redirecting System.out and System.err. It also \nredirects them to the same output (the standard system output stream) \npreventing any differentiation of the two streams.\n\nI cannot see any value in creating a custom SystemLogHandler in this instance \nthe attached patch removes the following code.\n\n>> SystemLogHandler log = new SystemLogHandler(System.out);\n>> System.setOut(log);\n>> System.setErr(log);\n\n', 'Andy Chapman', '2003-04-22 13:09:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1098, '18462', '3', 'Tomcat as a container is used in a number of different ways.\nSome use it with an IDE as you do, but there are many others who use\nit as a production web application server.\n\nThe redirection of System.out and System.err is there to support those\nwho run Tomcat as a production application server.  It does this so that\napplication code which generates output to stdout or stderr gets placed in\nthe appropriate tomcat log for the application.  This makes it easier to\ntrack down problems for a production application because all output generated\nby the application will be in the same log.\n\nYour patch is not acceptable because it would break this behaviour for\nthose who need it on a production server.\n\nYou might consider researching this further and submitting a patch\nthat will work for both cases.  Perhaps a test to not execute the code\nif Tomcat is running embedded.  Or a new attribute to disable this.\n\n', 'Glenn Nielsen', '2003-04-22 15:26:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1099, '18462', '4', 'Personally I consider redirection of System.out/System.err in code a bad thing\nfor other reasons. The point is that when you use e.g. System.out, you\ndo so because you want it to appear on System.out/stdout/console or whatever\nterminology you favour. Thus, the application should never redirekt. Any\nand all redirektion should occur outside the application, e.g in a shell script\nor a bat file. (Yes, I realize that a lot of people confuse \'System.out\'\nand \'logging framework\', but that is really their problem.)', 'Michael Eriksson', '2003-04-22 15:55:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1100, '18462', '5', 'Users redirected System.out via the startup scripts in previous versions of \nTomcat and this seemed acceptable to all parties. You could leave the output \ngoing to the console or redirect it to a log file in the standalone \n(production) case, and additionally allow redirection when used within a \ncontainer app such as an IDE. This seemed to be the most comprehensive \nsolution, I personally think redirecting System.out from within the app is less \nflexible.\n\nI believe I understand the function of the SystemLogHandler, but think there is \na difference to the logging requirement and the System.out requirement.', 'Andy Chapman', '2003-04-23 12:48:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1101, '18462', '6', 'Without the SysteLogHandler and the way it redirects System.out and System.err\nto the appropriate tomcat log debugging web application problems on a \nproduction server where you have 20-30 different web applications with\nmultiple virtual hosts is a nightmare.  There are too many supporting API\'s\nbeing used in web applicaitons which don\'t know they are running in a container\nand will print stack traces, etc. to System.out or System.err.  Having output\nfrom the same applicaiton in different logs, or output from multiple applications\nin the same log because they are printing to System.out or System.err is a pain.\n\nI will not make the change recommended by the patch.\n\nAs I said earlier\n\n\'You might consider researching this further and submitting a patch\nthat will work for both cases.  Perhaps a test to not execute the code\nif Tomcat is running embedded.  Or a new attribute to disable this.\'\n', 'Glenn Nielsen', '2003-04-23 15:22:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1102, '18462', '7', 'Okay points taken and understood.\n\nAlternatively what I would like to propose is adding an optional attribute to \nthe <Server> tag in server.xml. The attribute will be named \'noRedirect\' and \nwill take a boolean value. So the whole tag would look like:\n\nserver.xml\n...\n<Server port=\'8005\' shutdown=\'SHUTDOWN\' debug=\'0\' noRedirect=\'true\'>\n...\n\nIf no attribute is set then the default is false (current behaviour). Setting \nthe attribute to \'true\' (as above) will mean that System.out and System.err are \nNOT redirected.\n\nSummary of changes:\n\norg.apache.catalina.Server\n--------------------------\nADD public void setNoRedirect(boolean noRedirect);\nADD public boolean getNoRedirect();\n\norg.apache.catalina.core.StandardServer\n---------------------------------------\nADD private boolean noRedirect = false;\nADD public void setNoRedirect(boolean noRedirect) {...}\nADD public boolean getNoRedirect() {...}\n\norg.apache.catalina.startup.Catalina\n------------------------------------\nCHANGE protected void start() {...\n\n<<        // Replace System.out and System.err with a custom PrintStream\n<<        SystemLogHandler log = new SystemLogHandler(System.out);\n<<        System.setOut(log);\n<<        System.setErr(log);\n\n>>        // Replace System.out and System.err with a custom PrintStream if the\n>>        // noRedirect switch is false (default)\n>>        if (server.getNoRedirect() == false) {\n>>          SystemLogHandler log = new SystemLogHandler(System.out);\n>>          System.setOut(log);\n>>          System.setErr(log);\n>>        }\n\n...}\n\nThis involves changing the Server interface however, which is not to be taken \nlightly. An alternative may be to leave the interface and just add the \nnoRedirect to StandardServer (as debug is currently), then check the server \nclass as follows:\n\n>>        // Replace System.out and System.err with a custom PrintStream if the\n>>        // using StandardServer and noRedirect switch is false (default)\n>>        if (server instanceof StandardServer) {\n>>          if (server.getNoRedirect() == false) {\n>>            SystemLogHandler log = new SystemLogHandler(System.out);\n>>            System.setOut(log);\n>>            System.setErr(log);\n>>          }\n>>        } else {\n>>          SystemLogHandler log = new SystemLogHandler(System.out);\n>>          System.setOut(log);\n>>          System.setErr(log);\n>>        }\n\nI think the change to Server is the most contentious aspect of this proposal. I \nhave a patch for the former implementation (with changes to Server). This is \nneater in some respects adding this functionality to all Server \nimplementations, but obviously \'breaking\' any existing implementations other \nthan StandardServer.\n\nI\'ll await comment and if acceptable I\'ll submit a patch.', 'Andy Chapman', '2003-04-24 11:22:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1103, '18462', '8', 'Calling the attribute \'noRedirect\' will cause a lot of confusion because it may \nbe interpreted as all kinds of redirection such as HTTP redirection. A better \nname might be \'errorStreamRedirect\'', 'Nikolay Metchev', '2003-04-24 12:00:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1104, '18462', '9', 'Yes you have a valid point. I don\'t particularly like the double negative \nnoRedirect=false either.\n\nI\'ll change the patch to use outputRedirect which by default will be true. So \nyou would use the following in server.xml to prevent the redirection:\n\nserver.xml\n...\n<Server port=\'8005\' shutdown=\'SHUTDOWN\' debug=\'0\' outputRedirect=\'false\'>\n...\n', 'Andy Chapman', '2003-04-25 10:05:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1105, '18462', '10', 'Created  attachment 6008   [details] \n[PATCH] Add support for attribute in <server> tag of server.xml to allow switching of output redirect behaviour', 'Andy Chapman', '2003-04-25 10:10:08 UTC', 'tomcat_attachment/attachment 6008.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1106, '18462', '11', 'Marking this an an enhancement.\n\nNot sure how much interest there is in the user community for this patch. A \nquick scan of the last 12 months of tomcat-user didn\'t highlight this as a \nrequirement although I might have missed something.', 'Mark Thomas', '2004-04-14 21:09:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1107, '18462', '12', 'Moving from Tomcat 4/4.1.24 to Tomcat 7.\n\nMy concern is when Tomcat is installed on Windows: it is by default configured to log err and out to separate files.\n\nSteps to reproduce:\n1. Install apache-tomcat-6.0.30.exe with the Examples webapp.\n2. Launch Tomcat and navigate to\n http://localhost:8080/examples/jsp/simpletag/foo.jsp \n3. Look into logs/tomcat6-stdout.2011-01-10.log\nActual result: The file contains the following:\n===============================\n2011-01-10 23:33:27 Commons Daemon procrun stdout initialized\nDid you see me on the stderr window?\n\n\nDid you see me on the browser window as well?\n===============================\nExpected result: The \'Did you see me on the stderr window?\' message should have been printed into *stderr* log, not in *stdout* log.\n\nAt the same time the tomcat6-stderr.2011-01-10.log file contains a lot of text, printed by the logging subsystem. It is java.util.logging.ConsoleHandler that prints there.\n\nAs was noticed earlier, the culprit is Embedded#initStreams() (TC5.5,6,7) and Catalina#initStreams() (TC7).\n>>  // Replace System.out and System.err with a custom PrintStream\n>>  SystemLogHandler systemlog = new SystemLogHandler(System.out);\n>>  System.setOut(systemlog);\n>>  System.setErr(systemlog);\n\nInitialization of JULI happens before this redirection, and thus java.util.logging.ConsoleHandler prints to the original System.err.\n\nMy thoughts of this:\n1) SystemLogHandler can be enhanced to support separate out and err streams.\n2) If we do not fix this, then maybe configure commons-daemon to log both streams to the same file by default.\nIt is done by setting Stderr name in its configuration to be an empty string. -- See method redirectStdStreams() in prunsrv.c.\n3) It is worth being mentioned in the FAQ.\n4) This feature is not needed at all if no Context is configured with \'swallowOutput=true\'. So maybe make it configurable and turn it off by default. The name for the configuration property might be \'redirectStreams\', like it is already used as the field name Embedded#redirectStreams.', 'Konstantin Kolinko', '2011-01-10 18:39:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1108, '18462', '13', '***  Bug 33606  has been marked as a duplicate of this bug. ***', 'Konstantin Kolinko', '2011-01-10 18:58:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1109, '15688', '1', 'There are several obvious workarounds if you experience problems of this type:\n- use fully-qualified domain names rather than imports yourself;\n- write the servlet directly.\n\nI am changing this to an enhancement request although I doubt that there will \nbe much enthusiasm to make the proposed changes.', 'Mark Thomas', '2004-02-28 13:38:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1110, '15688', '2', 'It would be cleverer to avoid problems, so think about it.', 'Sven', '2004-02-28 14:01:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1111, '15688', '3', 'The spec requires certain packages to be imported. It also reserves the name space used by the local variables.', 'Mark Thomas', '2011-01-11 17:51:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1112, '15688', '4', '(In reply to  comment #3 )\n> The spec requires certain packages to be imported. It also reserves the name\n> space used by the local variables.\n\nI\'m reopening, because your response fails to answer the questions that have been raised: It\'s obvious, that the spec says that certain packages are to be imported. However, does the spec say, what happens if another import \'shadows\' the import of those packages?\n\nI guess, nothing in the spec prevents you from using the fully qualified classnames. (I\'m not asking your to remove the imports - that would clearly violate the spec.)', 'Sven', '2011-01-11 18:10:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1113, '15688', '5', 'The original issue description requested that Jasper \'use full-qualified names instead of imports\'. The key phrase being \'instead of\' which is what prompted me to close this as invalid.\n\nThe spec isn\'t as explicit as I would like but there are hints (e.g. the method signature in table JSP.9-1) that Tomcat\'s current implementation is what spec authors were intending.\n\nThat said, and as you point out, there is no harm in using fully qualified class names. My biggest concern (before I read the spec in more detail) was if the imports were removed and a class name was over-looked that a bug would be introduced. With the imports still in place, that won\'t be an issue.\n\nI\'ll look at adding the explicit class names to Tomcat 7 later today. I don\'t intend proposing this for back-port.', 'Mark Thomas', '2011-01-12 04:16:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1114, '49953', '1', 'For now the goal was to still be able to compile the core with 1.5, until that changes,we can defer this issue', 'Filip Hanik', '2011-01-06 16:50:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1115, '49953', '2', 'The @override annotation was introduced in 1.5, so this shouldn\'t be a problem. Did you mean 1.4?', 'Christopher Schultz', '2011-01-06 17:03:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1116, '49953', '3', 'Note that jdbc does not currently compile with Java 1.5, because several files use @Override annotations for implementations of interface methods.\nSuch overrides require Java 1.6.\n\nBoth Java 1.5 and Java 1.6 support @Override annotations for \'true\' method overrides.\n\nSo I don\'t see why the proposed patch cannot be applied, as it will work with both Java 1.5 and 1.6.', 'Sebb', '2011-01-06 18:36:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1117, '49953', '4', 'Not true\n\npublic interface Itest {\n public void foo();\n}\n\npublic class test implements Itest {\n @Override\n public void foo() {\n }\n}\n\nwill not compile in Java 5', 'Filip Hanik', '2011-01-06 18:59:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1118, '49953', '5', '(In reply to  comment #4 )\n> Not true\n> \n> public interface Itest {\n>  public void foo();\n> }\n> \n> public class test implements Itest {\n>  @Override\n>  public void foo() {\n>  }\n> }\n> \n> will not compile in Java 5\n\nExactly, overrides of interface methods require Java 1.6.\nThis is the case for many of the existing @Overrides in DataSourceProxy, PoolProperties and ConnectionPool and others, which is one of the reasons jdbc pool won\'t compile currently with Java 5.\n\nDoes this mean that those @Overrides should be removed?\n\nHowever, AFAICT the patch only adds overrides for methods which override superclass methods, so will compile with Java 1.5.', 'Sebb', '2011-01-06 20:06:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1119, '49953', '6', 'svn r 1057267', 'Filip Hanik', '2011-01-10 11:38:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1120, '49953', '7', 'Created  attachment 26467   [details] \nMissed from  r1057267 ', 'Sebb', '2011-01-10 13:47:39 UTC', 'tomcat_attachment/attachment 26467.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1121, '49953', '8', 'Created  attachment 26468   [details] \nAdd missing annotations', 'Sebb', '2011-01-10 13:48:34 UTC', 'tomcat_attachment/attachment 26468.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1122, '49953', '9', 'Created  attachment 26469   [details] \nAdd missing annotations', 'Sebb', '2011-01-10 13:49:10 UTC', 'tomcat_attachment/attachment 26469.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1123, '49953', '10', 'Comment on  attachment 26045   [details] \nAdd missing annotations\n\nParially applied', 'Sebb', '2011-01-10 13:49:38 UTC', 'tomcat_attachment/attachment 26045.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1124, '49953', '11', 'Part of the original patch was omitted; there are two other methods that are missing the @Override annotations.', 'Sebb', '2011-01-10 13:50:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1125, '21157', '1', 'Well, I disagree. The buffer default size is specified in the spec (it\'s 2K I\nthink). Hence, if you write a small amount of data, the response will not be\ncommitted and the cookies can be set reliably. You can also set the buffer size\nmanually, BTW.\nSo this will not be addressed; please do not reopen the report.', 'Remy Maucherat', '2003-06-28 17:06:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1126, '21157', '2', 'Here are some facts that may lead you to reconsider.\n\n- The servlet spec itself does not mandate a default size for the buffer. The \nuser can call response.setBufferSize to set the buffer to any size. \n\n- The user can tweak the bufferSize attribute of coyote or the legacy \nconnector in server.xml. There is nothing preventing user to set it to 0 in \nwhich case the cookie example immediately breaks. \n\n- Users tend to use these examples as base for something that they like to \nachieve. So it is a good idea to provide users with an example that is more \nrobust and does not break depending on how much data they write or what \nsettings they have in server.xml. \n', 'Vishy Kasar', '2003-06-30 17:25:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1127, '21157', '3', 'Well, I wasn\'t too happy with Remy\'s decision to mark this bug as invalid, \neither. Having thought about this for a while, I ended up with a list of facts \nalmost identical to the one posted by Vichy. For an example refered to as a \nstarting point for servlet developers and used as a source for copy&paste best \neffort should be made to use good coding practises.\n\nTherefore, I decided to reopen this bug. I am currently working on a patch \nwhich I will soon propose for discussion.', 'Stefan Radzom', '2003-07-01 00:06:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1128, '21157', '4', 'Created  attachment 7033   [details] \nProposed patch moving call to response.addCookie() before response.getWriter()', 'Stefan Radzom', '2003-07-01 00:28:28 UTC', 'tomcat_attachment/attachment 7033.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1129, '50552', '1', 'Confirmed in Tomcat 7 trunk:\n\n  <target name=\' bug50552 test\'>\n    <taskdef name=\'tomcat-list\' classname=\'org.apache.catalina.ant.ListTask\'/>\n    <tomcat-list url=\'broken\' username=\'username\' password=\'password\' outputproperty=\'foo\' />\n  </target>\n\nResults in the following output:\n\n bug50552 test:\n\nBUILD FAILED\n/home/cschultz/projects/diagnosis/build.xml:1434: java.lang.NullPointerException\n        at org.apache.tools.ant.taskdefs.Redirector.complete(Redirector.java:906)\n        at org.apache.catalina.ant.BaseRedirectorHelperTask.closeRedirector(BaseRedirectorHelperTask.java:267)\n        at org.apache.catalina.ant.AbstractCatalinaTask.execute(AbstractCatalinaTask.java:272)\n        at org.apache.catalina.ant.AbstractCatalinaTask.execute(AbstractCatalinaTask.java:149)\n        at org.apache.catalina.ant.ListTask.execute(ListTask.java:51)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)\n        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n        at org.apache.tools.ant.Task.perform(Task.java:348)\n        at org.apache.tools.ant.Target.execute(Target.java:390)\n        at org.apache.tools.ant.Target.performTasks(Target.java:411)\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1397)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1366)\n        at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1249)\n        at org.apache.tools.ant.Main.runBuild(Main.java:801)\n        at org.apache.tools.ant.Main.startAnt(Main.java:218)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)', 'Christopher Schultz', '2011-01-06 14:09:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1130, '50552', '2', 'A couple of comments:\n\n1. This patch looks like it will fix the problem, though there are other options (see below)\n2. Isn\'t this a bug in ant because it doesn\'t do NULL checking?\n3. Does output redirection /ever/ work?\n\nAbstractCatalinaTask.execute /never/ opens the redirector (BaseRedirectorHelperTask.openRedirector), yet calls BaseRedirectorHelperTask.closeRedirector in the finally block, unconditionally.\n\nI think this can be fixed in one of several ways:\n\n1. Use Chris Rimmer\'s patch\n2. Modify BaseRedirectorHelperTask.closeRedirector to ensure that the streams have been opened before calling Redirector.complete\n3. Have ant add null checking to Redirector.complete\n\nFinally, it probably makes sense for AbstractCatalinaTask.execute to open these redirection streams at some point, which it does not appear to be doing, hence my question #3 above.', 'Christopher Schultz', '2011-01-06 16:39:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1131, '50552', '3', 'FYI I can confirm that when outputProperty is set and there are no errors, the output property /does/ get the contents of the manager task\'s reply.', 'Christopher Schultz', '2011-01-06 16:41:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1132, '50552', '4', 'It looks like this works properly in the sunny-day scenario because BaseRedirectorHelperTask.handleOutput is typically called, which properly opens the redirector:\n\n    protected void handleOutput(String output) {\n        if (redirectOutput) {\n            if (redirectOutPrintStream == null) {\n                openRedirector();\n            }\n            redirectOutPrintStream.println(output);\n            if (alwaysLog) {\n                log(output, Project.MSG_INFO);\n            }\n\nIn the error case, AbstractCatalinaTask.execute does this:\n\n            if (isFailOnError()) {\n                throw new BuildException(e);\n            } else {\n                handleErrorOutput(e.getMessage());\n            }\n\nThe BuildException doesn\'t get caught by the currently-running exception handler (for java.lang.Exception) and then the finally block is called, which attempts to close the redirector, ultimately resulting in this NPE.\n\nI believe this bug might be better solved by modifying BaseRedirectorHelperTask.closeRedirector in this way:\n\n        try {\n-            if (redirectOutput) {\n+            if (redirectOutput && redirectOutPrintStream != null) {\n\n                redirector.complete();\n            }\n\nThis makes BaseRedirectorHelperTask.closeRedirector safer internally and doesn\'t rely on the client (AbstractCatalinaTask, in this case) to be extra careful about state.\n\nAnother option would be:\n\n        try {\n            if (redirectOutput) {\n+              if (redirectOutPrintStream == null) {\n+                openRedirector();\n+              }\n\n                redirector.complete();\n            }\n\nI\'m open to suggestions, since I don\'t really know how all this stuff should work. I\'m in favor of a solution where a class manages it\'s state as much as possible rather than relying on client code (even a subclass) to be careful about such things.', 'Christopher Schultz', '2011-01-06 16:58:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1133, '50552', '5', 'Btw I would have written a test or tests to show that my patch fixes the problem, but there don\'t seem to be any tests for these ant tasks. Unless I\'m looking in the wrong place?', 'chris.rimmer', '2011-01-07 04:40:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1134, '50552', '6', 'Fixed in 7.0.x for 7.0.6 using Chris S\'s first proposal.\n\nChris R - You are correct. There are no tests for this code.\n\nI also proposed the fix for 6.0.x', 'Mark Thomas', '2011-01-07 06:28:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1135, '50552', '7', '(In reply to  comment #6 )\n> Fixed in 7.0.x for 7.0.6 using Chris S\'s first proposal.\n\nI hadn\'t taken enough time to determine if that fix (adding the null check, right?) would be appropriate, since other streams in the redirector may have been open, and a call to complete() might be in order. If you\'ve checked them out, then I\'m happy.', 'Christopher Schultz', '2011-01-07 10:35:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1136, '49543', '1', 'Fix properties', 'Mark Thomas', '2010-07-02 16:55:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1137, '49543', '2', 'Marking as an enhancement.\n\nSince the original developer of this module is not available at the moment, there is unlikely to be any progress on this for several months. A patch would certainly help progress things.\n\nI would also note that keeping jdbc-pool simple and not to fully implement every feature in DBCP was a deliberate design decision. Any patch should bear this in mind and should ideally provide this feature as an optional extra that does not add any overhead for users that do not wish to use it.', 'Mark Thomas', '2010-07-04 16:43:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1138, '49543', '3', 'Jason, this ability does exist with the fix of \n https://issues.apache.org/bugzilla/show_bug.cgi?id=50025 \n\nI\'m working on a simple enhancement to Tomcat 7 that will allow this for any configured data source.', 'Filip Hanik', '2011-01-04 17:09:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1139, '50547', '1', 'Created  attachment 26461   [details] \nI made a patch.', 'Keiichi Fujino', '2011-01-06 03:49:24 UTC', 'tomcat_attachment/attachment 26461.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1140, '50547', '2', 'Fixed in 7.0.x and will be in 7.0.6 onwards.\nProposed for 6.0.x and 5.5.x', 'Keiichi Fujino', '2011-01-06 04:22:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1141, '50547', '3', 'Fixed in 6.0.x and will be in 6.0.30 onwards.', 'Keiichi Fujino', '2011-01-07 03:11:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1142, '50547', '4', 'Created  attachment 26482   [details] \nPatch against tc5.5\n\nPatch against tc5.5', 'Keiichi Fujino', '2011-01-12 00:30:16 UTC', 'tomcat_attachment/attachment 26482');
INSERT INTO `tomcatbeforefixcomments` VALUES (1143, '50453', '1', 'This is due to RemoteIpValve\'s use of request.getHeader() rather than the enumeration from request.getHeaders().  I\'ll try to whip up a patch...', 'Jim Riggs', '2010-12-10 09:39:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1144, '50453', '2', 'I think there is no given standard concerning whether the first or the last header is the \'right\' one (coming from the closest proxy). The same for a comma-separated multi-valued header.\n\nmod_remoteip for the Apache Web Server claims:\n\nWhen multiple, comma delimited remote IP addresses are listed in the header value, they are processed in Right-to-Left order. Processing halts when a given remote IP address is not trusted to present the preceeding IP address. The header field is updated to this remaining list of unconfirmed IP addresses, or if all IP addresses were trusted, this header is removed from the request altogether.\n\nIn replacing the remote_ip, the module stores the list of intermediate hosts in a remoteip-proxy-ip-list note, which mod_log_config can record using the %{remoteip-proxy-ip-list}n format token. If the administrator needs to store this as an additional header, this same value can also be recording as a header using the directive RemoteIPProxiesHeader.\n\n\nSo it might be a good idea to handle the IPs from right to left resp. later headers before earlier ones, as long as the previous IP is trusted.', 'Rainer Jung', '2010-12-10 10:19:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1145, '50453', '3', 'RFC2616 is clear on how headers should be combined so order is retained. In short\n...\nX-Forwarded-For : A, B\n...\nX-Forwarded-For : C\n...\nX-Forwarded-For : D, E\n\nmust be treated exactly the same way as:\nX-Forwarded-For: A, B, C, D, E\n\nTomcat will return values for a header in the correct order although it may return the above as \'A, B\', \'C\', \'D, E\' - I haven\'t checked.', 'Mark Thomas', '2010-12-10 10:46:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1146, '50453', '4', 'So, should the RemoteIPValve/Filter should be looking at the first X-Forwarded-For (A) or the last X-Forwarded-For (E) address?\n\nIt sounds like the reporter was expecting \'E\' but the spec seems to imply that \'A\' should be returned.', 'Christopher Schultz', '2010-12-10 14:40:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1147, '50453', '5', 'Rainer, the spec is absolutely clear about precidence, the last (rightmost) value is added by the nearest adjacent proxy to the server agent.  Ergo, the first (leftmost) value was added by the proxy closest to the user agent.\n\nmod_remoteip uses this in combination of proxy trust metrics to determine how far back to unwind that from the rightmost value.  Perhaps only the proxies under the control of the server administrator will be trusted, in which case only the last or near-last value will be used, or perhaps all servers are trusted and any arbitrary value presented by any proxy will be accepted, in which case the first value is used.\n\nIt entirely depends on what the administrator wants, either trusted values of X-Forwarded-For presented by known proxy agents, or any arbitrary/potentially spammed values.', 'William A. Rowe Jr.', '2010-12-10 15:24:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1148, '50453', '6', '(In reply to  comment #4 )\n> So, should the RemoteIPValve/Filter should be looking at the first\n> X-Forwarded-For (A) or the last X-Forwarded-For (E) address?\n\nChris -\n\nIt should be looking at them as if they were combined in a single comma-separated list and evaluating them from right-to-left.  As Mark said, regardless of how the header(s) are received, it should be treated as \'X-Forwarded-For: A, B, C, D, E\' and RemoteIP should \'trust\' them in the order E - D - C - B - A.  I will make sure that the switch to getHeaders() in my patch does this.', 'Jim Riggs', '2010-12-10 16:48:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1149, '50453', '7', '> \'X-Forwarded-For: A, B, C, D, E\' and RemoteIP should \'trust\' them in the order\n> E - D - C - B - A.\n\nI\'m not convinced that order matters, here, since all addresses will be checked and if one of them matches, the request will be allowed. Am I missing something?', 'Christopher Schultz', '2010-12-13 11:08:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1150, '50453', '8', 'Yes. Order is critical in this use case since a) proxy order matters b) not all proxies are trusted. Jim is heading in the right direction.', 'Mark Thomas', '2010-12-13 11:17:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1151, '50453', '9', 'Created  attachment 26428   [details] \nv1\n\nHere is a first pass at this.  I have done rudimentary testing of both the valve and filter.  Both appear to be working correctly, but it would be good if someone with a real-life test/dev setup could run it through the gauntlet.\n\nI tried to make as few changes as possible.  Effectively, all this patch does is concatenate multiple headers into a single comma-delimited string before passing it off to commaDelimitedListToStringArray().  Then processing continues as it did before.\n\nNote that this only addresses the remoteIpHeader (e.g. X-Forwarded-For).  It does not do anything with proxiesHeader or protocolHeader.', 'Jim Riggs', '2010-12-20 14:50:27 UTC', 'tomcat_attachment/attachment 26428.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1152, '50453', '10', 'Don\'t forget RemoteIPFilter in trunk.', 'Christopher Schultz', '2010-12-20 16:13:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1153, '50453', '11', 'The attachment patches both the valve and the filter, and my comment says that I tested both.', 'Jim Riggs', '2010-12-20 16:23:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1154, '50453', '12', 'D\'oh. This head cold is killing my ability to concentrate on even reading 5 or 6 sentences. Apologies for the noise.', 'Christopher Schultz', '2010-12-20 16:56:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1155, '50453', '13', 'Fixed in trunk for 7.0.x and will be included in 7.0.6 onwards. I also updated the test cases.\n\nThe Valve fix has been proposed for 6.0.x.', 'Mark Thomas', '2011-01-05 10:08:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1156, '50467', '1', 'Steven, would it be possible for you to upgrade to the latest (6.0.29) Tomcat version? I seem to recall a recent fix to the NIO connector that fixes some threading issues, though I can\'t seem to find a reference for it at the moment.', 'Christopher Schultz', '2010-12-14 14:05:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1157, '50467', '2', 'Ooh, sorry. I misread your version number. Duh.', 'Christopher Schultz', '2010-12-14 14:06:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1158, '50467', '3', 'I haven\'t reproduced it, but I would imagine that inserting a Thread.sleep() after the call to key.attach(null) in cancelledKey() might do it.\n\nFor now I have just put a null check in the above loop like so:\n\n                        if (attachment != null)\n                        {\n                            attachment.access();\n                            iterator.remove();\n                            processKey(sk, attachment);\n                        } else {\n                            log.warn(\'NioEndpoint: Attachment was null\');\n                            iterator.remove();\n                        }\n\nNot sure if that is correct, but better than the alternative ;)', 'Steven Hugg', '2010-12-16 17:06:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1159, '50467', '4', 'The null check seems reasonable to me.\n\nI have fixed this in 7.0.x and it will be included in 7.0.6 onwards.\n\nI have also proposed the fix for 6.0.x.', 'Mark Thomas', '2011-01-05 08:53:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1160, '50500', '1', 'Created  attachment 26429   [details] \nPatch to check for a BigInteger parameter before coercing to a double\n\nThis patch will correctly handle cases where a string, double, or float is added, subtracted, or multiplied by a BigInteger. It does this by checking to see if one of the parameters of a method call is a BigInteger if it knows the other is a float, double, or string containing \'.\', \'e\' or \'E\'', 'brian.weisleder', '2010-12-20 21:12:37 UTC', 'tomcat_attachment/attachment 26429.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1161, '50500', '2', 'Created  attachment 26430   [details] \nELArithmetic test case', 'brian.weisleder', '2010-12-20 21:13:55 UTC', 'tomcat_attachment/attachment 26430.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1162, '50500', '3', 'Thanks for the patches. I applied them (with some minor alterations after reviewing the spec) to 7.0.x and they will be included in 7.0.6 onwards. I also proposed back-porting the changes to 6.0.x.\n\nSince this is now fixed in 7.0.x, I\'m moving this issue to 6.0.x', 'Mark Thomas', '2011-01-04 09:25:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1163, '50025', '1', 'Here\'s the description that I copy/pasted from the Spring forums: \n\nIn Websphere I was able to wire an interceptor around all of my controllers and set thread-bound DB credentials based on the path of the current request. In my tcServer Developer edition (2.3.3 M1) this no longer works. My datasource is wired as a\n\norg.springframework.jdbc.datasource.UserCredential sDataSourceAdapter\n\nI\'ve verified that I\'m calling the getConnection(String username, String password) method with the correct credentials. However, the connection that is returned is of type\n\nProxyConnection[PooledConnection[oracle.jdbc.driver.T4CConnection@6ab4a7]]\n\nwith the same default credentials as those defined in server.xml. Is there another way to set the database credentials at runtime?', 'bsnyder', '2010-10-22 09:57:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1164, '50025', '2', 'Do you have a code example to show how you receive this error? Or perhaps even a JUnit test?', 'bsnyder', '2010-10-22 10:25:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1165, '50025', '3', '(In reply to  comment #2 )\n> Do you have a code example to show how you receive this error? Or perhaps even\n> a JUnit test?\n\nTake a look at the source code for getConnection.  It was included in a reply to my original post in the forums (reproduced below).\n\n---\nThis is an issue with the new jdbc-pool implementation, it internally always uses the default configured username/password. I suggest raising a bug on the tomcat(jdbc-pool) issue tracker.\n\nThe actual code.\nCode:\npublic class DataSourceProxy implements PoolConfiguration {\n\n...\n   /**\n     * {@link javax.sql.DataSource#getConnection()}\n     */\n    public Connection getConnection(String username, String password) throws SQLException {\n        return getConnection();\n    }\n....\n\n}', 'Tim', '2010-10-22 10:29:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1166, '50025', '4', 'hi Tim, this isn\'t really a bug, but how the pool operates.\nThis is a pool, meaning it caches connections with a predefined set of credentials as defined in the configuration.\n\nIf we allowed the username/password to be passed, the cache would have to be way more sophisticated, since it could mean that we would have to close a connection, and open a new one with the provided credentials. \n\nSo in the worst case scenario, you\'d really not have a pool.\n\nI started working on a simple patch, that would simply reuse the existing cache, and see if the connection had the requested credentials already.\nThis way, the speed is not compromised on the cache, but could lead to unnecessary disconnect/reconnects.\n\nI can show you the patch, attached. (just needs some additional calls to complete it)\n\nBut my gut feel, is that this isn\'t really a bug. If implemented as a feature, it would need some serious though to not compromise the performance of the existing implementation.', 'Filip Hanik', '2010-12-01 15:10:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1167, '50025', '5', 'Created  attachment 26363   [details] \nBeginning of a patch to handle DataSource.getConnection(username,password) for a pool', 'Filip Hanik', '2010-12-01 15:11:13 UTC', 'tomcat_attachment/attachment 26363.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1168, '50025', '6', 'Created  attachment 26455   [details] \nPatch to allow the call DataSource.getConnection(username,password)\n\nHere is the patch for allowing DataSource.getConnection(username, password) to be used. In the case of a connection that is connected, is used with a different username, password it is reconnected.\nI\'m hesitant to apply this patch at this time as it does slow down the pool doing the passwords checks every time a connection is requested.\n\nI will experiment with a flag to enable/disable the check', 'Filip Hanik', '2011-01-03 15:12:51 UTC', 'tomcat_attachment/attachment 26455.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1169, '49125', '1', 'The first issue only affects debug messages.\n\nThe second issue doesn\'t match the code and is therefore invalid.', 'Mark Thomas', '2010-04-14 19:01:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1170, '49125', '2', 'Looks like AjpMessage.java:417 in trunk does concatenate \'buf\' with other strings and /will/ emit an ugly [B@abcd. :(', 'Christopher Schultz', '2010-11-05 14:39:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1171, '49125', '3', 'Created  attachment 26261   [details] \nPatch to show byte arrays as hex strings', 'Christopher Schultz', '2010-11-05 15:09:07 UTC', 'tomcat_attachment/attachment 26261.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1172, '50460', '1', 'Waw, that\'s a nice bug in the JVM !\n\nTo avoid it in tomcat, I vote for 2) Do not cache the Exception. Create a new instance each time.', 'Sylvain Laurent', '2010-12-12 16:31:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1173, '50460', '2', '2 gets my vote', 'Mark Thomas', '2010-12-12 16:38:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1174, '50460', '3', 'I found another place where the same type of leak might occur : in ProxyDirContext (in tc7, I dod not check with tc6), there is \n\n    protected static final NameNotFoundException NOT_FOUND_EXCEPTION =\n        new ImmutableNameNotFoundException();\n\nIn this case the stack does not contain webapp code, so there\'s no leak of webapp classloader.\nBut there can be a leak of tomcat\'s classloader if it is embedded...', 'Sylvain Laurent', '2010-12-12 16:55:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1175, '50460', '4', 'Fixed in trunk in  r1044987  and will be in 7.0.6.\nI will propose it for 6.0 and 5.5.\n\nI should note, that 3) fixes the issue in my environment.\n\nFor the JspDocumentParser$EnableDTDValidationException class I am using 2) as the fix and 3) for sake of performance.\n\nFor the ImmutableNameNotFoundException class I am using 3), as 2) would be too much of a change for me.\n\n(In reply to  comment #3 )\n> But there can be a leak of tomcat\'s classloader if it is embedded...\n\nProxyDirContext is loaded by the Tomcat\'s classloader as well, and thus it static field should be GC\'able at the same time as the Tomcat classes that might appear in the stacktrace there. So I do not think that there will be an observable leak with ProxyDirContext.', 'Konstantin Kolinko', '2010-12-12 20:20:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1176, '50460', '5', 'FWIW, I still vote #2. I\'m pretty sure that actually throwing the exception is more costly than creating the Exception object.', 'Christopher Schultz', '2010-12-14 14:25:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1177, '48692', '1', '***  Bug 49964  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2010-09-20 16:31:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1178, '48692', '2', 'I\'ll copy my comments from the duplicate  bug #49964  just so they\'re more likely to be read:\n\nMy proposal is this (and I\'m prepared to write the patches myself):\n\n1. A new configuration attribute on the <Connector> element:\n\'parseBodyRequestParametersMethods\' (suggestions for a better name are\nwelcome). The default value for this setting is \'POST\' which retains strict\nservlet spec compliance.\n\n2. Change catalina.connector.Request.parseParameters method to allow any method\nmentioned in the above configuration attribute to undergo request body\nconversion into request parameters. All other existing requirements remain in\nplace: the request body must be application/x-www-form-urlencoded, must fit\ninto maxPostSize, etc.\n\nOne question I have about this implementation: how should it behave under\norg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true? I believe that\norg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true should take precedence over\nthis setting, disable it\'s use, and issue a warning/error during startup when\nthey conflict.', 'Christopher Schultz', '2010-09-20 16:40:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1179, '48692', '3', 'How about parsePutBodyParams (since POST will always be parsed) with values false (default) or true?\n\nThe logic for STRICT_SERVLET_COMPLIANCE in 7.0.x has been made more consistent. It now only changes the defaults for other options and explicitly setting an option always overrides STRICT_SERVLET_COMPLIANCE.\n\nTherefore, assuming PUT parsing is off by default, it should be independent of STRICT_SERVLET_COMPLIANCE.', 'Mark Thomas', '2010-09-20 16:45:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1180, '48692', '4', 'In one of the discussions on the tomcat-user list, the OP had complained that he couldn\'t pass \'parameters\' using methods such as DELETE, etc. I figured I\'d let the configuration specify any HTTP method(s) that should be parsed, and not just PUT.\n\nThat\'s why I chose that stupidly-long name.\n\nGood news about the STRICT_SERVLET_COMPLIANCE: since this is a new configuration parameter, it will simply default to adhere strictly to the servlet spec (that is, only POST gets it\'s body parsed) and any user-defined configuration will override it. Thanks.', 'Christopher Schultz', '2010-09-20 16:50:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1181, '48692', '5', 'OK. A comma separated list of method names would make sense in that case. Although methods that are not allowed to have bodies should not be permitted.', 'Mark Thomas', '2010-09-20 16:54:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1182, '48692', '6', 'Hmm. I was trying to avoid an exhaustive or partial list of HTTP methods specifically in the code: I wanted to let this code grow to work with any crazy non-standard methods a user might want to use, too (like \'MYPUT\'). Such non-standard HTTP methods might actually then allow, say, a REST-based service work without breaking other webapps that depend on spec-compliant handling of PUT bodies :)\n\nI\'ll read-through the HTTP spec to look for methods for which bodies are actually forbidden, and we can reject those with a warning.', 'Christopher Schultz', '2010-09-20 17:02:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1183, '48692', '7', 'Okay, I\'ve got my patch working in TC 7, and I\'ve renamed the configuration setting to the less unwieldy \'parseBodyMethods\'.', 'Christopher Schultz', '2010-09-20 18:15:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1184, '48692', '8', 'Mark, I\'ve just glanced-over RFC 2616 and I can\'t find any HTTP methods (defined in section 9) that specifically prohibit a request body.\n\nOn the other hand, section 4.3 says:\n\n\'\nThe presence of a message-body in a request is signaled by the inclusion of a Content-Length or Transfer-Encoding header field in the request\'s message-headers. A message-body MUST NOT be included in a request if the specification of the request method (section 5.1.1) does not allow sending an entity-body in requests.\n\'\n\nThere\'s a short discussion that can be found here:\n http://lists.w3.org/Archives/Public/ietf-http-wg/2006AprJun/0103.html \n\nI tend to agree with one of the contributor\'s assertion that the principle of robustness applies, here: we shouldn\'t actively prohibit a request body from being sent, here.', 'Christopher Schultz', '2010-09-21 10:56:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1185, '48692', '9', '(In reply to  comment #8 )\n> Mark, I\'ve just glanced-over RFC 2616 and I can\'t find any HTTP methods\n> (defined in section 9) that specifically prohibit a request body.\n\nTRACE does. No others I could see.', 'Mark Thomas', '2010-09-21 15:36:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1186, '48692', '10', 'Created  attachment 26252   [details] \nPatch to provide request-entity parsing for arbitrary HTTP methods\n\nThis patch adds a new configuration setting \'parseBodyMethods\' to all connectors. Simply specify the list of HTTP methods that should be parsed as a comma-separated list (e.g. \'POST, PUT\') to enable this parsing on those methods.\n\nRequesting the TRACE method will result in an IllegalArgumentException and no changes to the Connector\'s configuration, to avoid an HTTP spec violation.', 'Christopher Schultz', '2010-11-03 20:22:40 UTC', 'tomcat_attachment/attachment 26252');
INSERT INTO `tomcatbeforefixcomments` VALUES (1187, '48692', '11', 'I ought to provide a documentation patch as well. One will be forthcoming.\n\nAlso: should I bother to log a WARN (or other level) message when this setting is used to alter the servlet-spec-compliant setting of simply \'POST\'?', 'Christopher Schultz', '2010-11-03 20:24:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1188, '48692', '12', 'No need for a log message. We don\'t do it elsewhere in similar circumstances.', 'Mark Thomas', '2010-11-03 20:41:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1189, '48692', '13', 'Created  attachment 26259   [details] \nPatch to docs describing the previous patch\n\n...and the doc patch.', 'Christopher Schultz', '2010-11-05 13:17:46 UTC', 'tomcat_attachment/attachment 26259.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1190, '48692', '14', 'Fixed in trunk. Will be included in Tomcat 7.0.6.', 'Christopher Schultz', '2010-12-03 11:11:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1191, '48692', '15', '***  Bug 53409  has been marked as a duplicate of this bug. ***', 'Christopher Schultz', '2012-08-09 16:44:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1192, '48692', '16', 'Proposed for 6.0.x.', 'Christopher Schultz', '2012-08-09 16:48:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1193, '48692', '17', 'Created  attachment 29222   [details] \nPatch for Tomcat 6.0\n\nThis patch is an amalgamation of the following patches:\n http://svn.apache.org/viewvc?view=revision&revision=1041892  (initial patch)\n http://svn.apache.org/viewvc?view=revision&revision=1043983  (fixes formatting; improved documentation)\n http://svn.apache.org/viewvc?view=revision&revision=1049264  (improved javadoc)\n\nPlus a modification of the original patch because Tomcat 6.0.x\'s Connector does not have an \'initInternal\' method.', 'Christopher Schultz', '2012-08-14 00:54:10 UTC', 'tomcat_attachment/attachment 29222.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1194, '48692', '18', 'The patch has been applied to 6.0.x and will be included in 6.0.36 onwards.', 'Mark Thomas', '2012-10-04 14:56:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1195, '49142', '1', 'The above list is far from complete.', 'Mark Thomas', '2010-04-23 10:26:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1196, '49142', '2', 'Indeed, but it\'s probably easier to use the Eclipse warnings to fix the problems directly.\n\nBut if you want me to create patches, let me know.', 'Sebb', '2010-04-23 10:30:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1197, '49142', '3', 'Created  attachment 25730   [details] \nA patch which add a serial version UID to all the classes where it is needed\n\nI have added the serial version UID in all classes that are listed by eclipse in the proposed patch serialVersionUID.patch.', 'dbz', '2010-07-07 15:56:41 UTC', 'tomcat_attachment/attachment 25730.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1198, '48837', '1', 'Created  attachment 25116   [details] \nPatch to enhance classloader leaks because of uncleared ThreadLocal\n\nProposing a patch to better detect leaks. Before the patch, the leak caused by an uncleared ThreadLocal is detected only if the ThreadLocal key or value is loaded by the WebAppClassLoader.\nThe patch proposes to also detect cases where the key or value object class was loaded by a child classloader (or any level of descendant).\n\nThe leak of the example foo.jsp is detected (and cleared) with this patch.\n\nNote that there\'s still a leak if the key or value is a JDK class like an ArrayList which itself contains an instance of a class loaded by the WebAppClassLoader (or a child classloader).\n\nSylvain', 'Sylvain Laurent', '2010-03-11 21:46:46 UTC', 'tomcat_attachment/attachment 25116.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1199, '48837', '2', 'Fixed in 7.0.x and will be included in 7.0.6 onwards. I also proposed your patch for 6.0.x', 'Mark Thomas', '2010-11-24 16:34:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1200, '48837', '3', 'Thanks Mark.\nJust to clarify things : the patch just improves the detection of such leaks.\nTo cure them (besides fixing the webapp code), you\'ll have to enable the (unsafe) clearReferencesThreadLocals option on the StandardContext or wait for  bug 49159  to be fixed.', 'Sylvain Laurent', '2010-11-25 16:31:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1201, '50192', '1', 'The reasoning for this change is in the archives:\n http://svn.apache.org/viewvc/tomcat/tc6.0.x/trunk/STATUS.txt?r1=729825&r2=729824&pathrev=729825 ', 'Mark Thomas', '2010-11-09 10:13:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1202, '50192', '2', 'Created  attachment 26282   [details] \nshared defaultResolver for each ELResolverImpl instance and reverts ELContextImpl', 'Robert Goff', '2010-11-11 10:43:05 UTC', 'tomcat_attachment/attachment 26282.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1203, '50192', '3', 'The NullFunctionMapper in ELContextImpl is a final object.  Therefore, it can not be overridden and the only method that it has is resolveFunction which will return null.  There is nothing about this object that could present a security issue.\n\nAs far as the ELResolverImpl is concerned, I can see how the static ELResolver could be accessed and it is possible that it would be altered by a malicious user.  However, I think that there could still be a performance gain here by not having each method withing the ELResolverImpl call getDefaultResolver().  Instead, you could create one defaultResolver for this particular instance (in the constructor) allowing all the methods for this instance to use that object, and you could still provide the static getDefaultResolver() method to return a new object each time.  This would at least save a few new constructions of the ELResolver when you\'re reusing the same ELResolverImpl object.\n\nPlease look at the patch to see the recommended change.', 'Robert Goff', '2010-11-11 10:45:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1204, '50168', '1', 'When StandardContext is destroyed is destroys assets is manages which also have their own lifecycle. So you might be seeing those log messages. (Most likely StandardManager)\n\nPlease reopen with more proof if this diagnosis is wrong.', 'Tim Funk', '2010-11-01 18:08:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1205, '50168', '2', '(In reply to  comment #1 )\n> When StandardContext is destroyed is destroys assets is manages which also have\n> their own lifecycle. So you might be seeing those log messages. (Most likely\n> StandardManager)\n> \n> Please reopen with more proof if this diagnosis is wrong.\n\nI\'m also seeing this on undeploying any app via the Manager application.', 'Pid', '2010-11-01 20:42:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1206, '50168', '3', '(In reply to  comment #1 )\n> When StandardContext is destroyed is destroys assets is manages which also have\n> their own lifecycle. So you might be seeing those log messages. (Most likely\n> StandardManager)\n> \n> Please reopen with more proof if this diagnosis is wrong.\n\nNot sure I understand your comments clearly. From the stack trace, while destorying the standcontext directly, it will check check whether its parent is null, if not, it will call the parent.removeChild() method, but removeChild method also try to destory the child. (As it does not known who calls the method).\nI will reopen the it, and try to attach a patch file.\nthanks.', 'Ivan', '2010-11-01 22:08:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1207, '50168', '4', 'Created  attachment 26248   [details] \nSimple patch\n\nTry to provide a patch for it. Might not be proper, but it should be helpful to find what happens.\nException for the issue about double destory invocation, also, seems that Mapper.unregister action occurs before its  internal destory (e.g. remove welcome resources).', 'Ivan', '2010-11-01 22:11:16 UTC', 'tomcat_attachment/attachment 26248.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1208, '50168', '5', 'I don\'t think the patch works.\n\nWhat I (think I) notice is StandardWrapperValve being destroyed for each servlet in the webapp.\n\nBy default there is the default servlet and jsp servlet. If you enable ssi and cgi, I think you will see the call being done 4 times.\n\nWhy? TBD.', 'Tim Funk', '2010-11-02 15:17:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1209, '50168', '6', '(In reply to  comment #5 )\n> I don\'t think the patch works.\n> \n> What I (think I) notice is StandardWrapperValve being destroyed for each\n> servlet in the webapp.\n> \n> By default there is the default servlet and jsp servlet. If you enable ssi and\n> cgi, I think you will see the call being done 4 times.\n> \n> Why? TBD.\n\nHmmm, the problem is not how many times the call is been done, currently, what I found is that the call is done on the same Context for more than more time. \nthanks.', 'Ivan', '2010-11-03 22:19:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1210, '49426', '1', 'Created  attachment 25583   [details] \nRight patch (with unit test) fixing the problem for the ManagerServlet   (\n\nOops previous patch contained changes for HTMLManagerServlet that are not ready yet. Attached the right version of the patch.', 'Marc Guillemot', '2010-06-11 03:31:50 UTC', 'tomcat_attachment/attachment 25583.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1211, '49426', '2', '-1 to the patch as currently written. It isn\'t thread safe.', 'Mark Thomas', '2010-06-13 16:52:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1212, '49426', '3', 'OK, you\'re right. What about holding the ResourceBundle in a ThreadLocal?', 'Marc Guillemot', '2010-06-14 03:13:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1213, '49426', '4', '(In reply to  comment #3 )\n> OK, you\'re right. What about holding the ResourceBundle in a ThreadLocal?\n\nGiven all the issues we have seen with memory leaks and ThreadLocals I\'d rather not.\n\nSome additional thoughts:\n- we could just pass the Locale around with the writer\n- I wonder how hard it would be to extend StringManager (efficiently - which may be the slightly tricky bit) to support multiple Locales\n- in determining which Locale to use we need to call request.getLocales() and check each in turn until we find a suitable match.', 'Mark Thomas', '2010-06-14 17:48:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1214, '49426', '5', '(In reply to  comment #4 )\n> (In reply to  comment #3 )\n> > OK, you\'re right. What about holding the ResourceBundle in a ThreadLocal?\n> \n> Given all the issues we have seen with memory leaks and ThreadLocals I\'d\n> rather not.\n> \n> Some additional thoughts:\n> - we could just pass the Locale around with the writer\n\nthis would be the only solution when ThreadLocal is not wanted. I didn\'t want to choose this way as it means more changes but I can do it.\nRather than passing writer and Locale (or ResourceBundle) everywhere along the way, I could imagine having a wrapper for both.\n\n> - I wonder how hard it would be to extend StringManager (efficiently - which\n> may be the slightly tricky bit) to support multiple Locales\n\nthis wouldn\'t solve previous point: you have to be able to access the Locale each time you need to get a String.\nAdditionally StringManager is quite useless. StringManager\'s cache doesn\'t make sense as java.util.ResourceBundle has already one. This means that the only value of StringManager is the facility method getString(final String key, final Object... args).\n\n> - in determining which Locale to use we need to call request.getLocales() and\n> check each in turn until we find a suitable match.\n\nthis is correct. I didn\'t do it to keep the patch smaller in a first time but I can adapt patch (including unit test) for that now if you want.', 'Marc Guillemot', '2010-06-15 03:11:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1215, '50066', '1', 'Created  attachment 26148   [details] \npatch for trunk (tc7)\n\nThe issue occurs both in tomcat 6 and 7', 'Sylvain Laurent', '2010-10-09 09:52:48 UTC', 'tomcat_attachment/attachment 26148.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1216, '50066', '2', 'Created  attachment 26149   [details] \npatch for tomcat 6', 'Sylvain Laurent', '2010-10-09 09:53:21 UTC', 'tomcat_attachment/attachment 26149.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1217, '50066', '3', 'Thanks for the patches.\n\nPatch applied to trunk and will be included in 7.0.4 onwards.\n\nPatch proposed for 6.0.x.', 'Mark Thomas', '2010-10-10 14:18:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1218, '50027', '1', 'I Solved the problem (but I still thing that this is a bug in tomcat), let me explain with more detail, because I was to anxious do report the bug.\n\nThe problem happens when you have context <Resource> tag in SERVER.XML. The problem doesn´t happens with you have a new <Realm> inside SERVER.XML.\n\nHow I solved the problem:\n\n1 - instead of inserting context information in SERVER.XML, I created myApplication.xml in conf Catalina localhost myApplication.xml.\n\nThe first approach work on tomcat 6, but not in tomcat 7.\nBy the way, I solved the problem, I am afraid that the presence of additional context information in SERVER.XML crashes tomcat 7.\n\nCan anyone confirm if it´s a bug?', 'Flávio Henrique', '2010-10-03 08:42:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1219, '50027', '2', 'Can you attach a server.xml that actually breaks - it\'s not clear from your report what you\'re actually having problems with.', 'Tim Whittington', '2010-10-08 04:22:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1220, '50027', '3', 'Created  attachment 26143   [details] \nserver.xml that crashes tomcat 7.0.2\n\nServer.xml that crash tomcat 7.02. Only added <Context> information inside <Host>.', 'Flávio Henrique', '2010-10-08 11:27:39 UTC', 'tomcat_attachment/attachment 26143.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (1221, '50027', '4', 'Here is the server.xml (zipped).\nI only added to the default server.xml <Context> inside <Host>\n\nThanks', 'Flávio Henrique', '2010-10-08 11:29:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1222, '49986', '1', 'Looks like a problem to me if the class can be called from multiple threads.\nIf not, then why have any synch. blocks at all?\n\nCould perhaps be fixed by making reload volatile, but the reload variable can be set false elsewhere without synch.\n\nThe servletClassLastModifiedTime also looks to be used in a similar way; that is a long so could potentially an invalid value could be read.', 'Sebb', '2010-09-23 10:18:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1223, '49986', '2', '(In reply to  comment #1 )\n> Looks like a problem to me if the class can be called from multiple threads.\n> If not, then why have any synch. blocks at all?\n\nIt\'s called from multiple threads.\nStack trace:\n    Thread 28\n    #0  org/apache/jasper/servlet/JspServletWrapper.getServlet JspServletWrapper.java:166\n    #1  org/apache/jasper/servlet/JspServletWrapper.service JspServletWrapper.java:329\n    #2  org/apache/jasper/servlet/JspServlet.serviceJspFile JspServlet.java:313\n    #3  org/apache/jasper/servlet/JspServlet.service JspServlet.java:260\n    #4  javax/servlet/http/HttpServlet.service HttpServlet.java:717\n    #5  org/apache/catalina/core/ApplicationFilterChain.internalDoFilter ApplicationFilterChain.java:290\n    #6  org/apache/catalina/core/ApplicationFilterChain.doFilter ApplicationFilterChain.java:206\n    #7  org/apache/catalina/core/StandardWrapperValve.invoke StandardWrapperValve.java:233\n    #8  org/apache/catalina/core/StandardContextValve.invoke StandardContextValve.java:191\n    #9  org/apache/catalina/authenticator/AuthenticatorBase.invoke AuthenticatorBase.java:470\n    #10 org/apache/catalina/core/StandardHostValve.invoke StandardHostValve.java:127\n    #11 org/apache/catalina/valves/ErrorReportValve.invoke ErrorReportValve.java:102\n \n   Thread 25\n    #0  org/apache/jasper/servlet/JspServletWrapper.getServlet JspServletWrapper.java:133\n    #1  org/apache/jasper/servlet/JspServletWrapper.service JspServletWrapper.java:329\n    #2  org/apache/jasper/servlet/JspServlet.serviceJspFile JspServlet.java:313\n    #3  org/apache/jasper/servlet/JspServlet.service JspServlet.java:260\n    #4  javax/servlet/http/HttpServlet.service HttpServlet.java:717\n    #5  org/apache/catalina/core/ApplicationFilterChain.internalDoFilter ApplicationFilterChain.java:290\n    #6  org/apache/catalina/core/ApplicationFilterChain.doFilter ApplicationFilterChain.java:206\n    #7  org/apache/catalina/core/StandardWrapperValve.invoke StandardWrapperValve.java:233\n    #8  org/apache/catalina/core/StandardContextValve.invoke StandardContextValve.java:191\n    #9  org/apache/catalina/authenticator/AuthenticatorBase.invoke AuthenticatorBase.java:470\n\n> The servletClassLastModifiedTime also looks to be used in a similar way; that\n> is a long so could potentially an invalid value could be read.\n\nExactly! Thank you for point    \n\n     public void setServletClassLastModifiedTime(long lastModified) {\n        if (this.servletClassLastModifiedTime < lastModified) {\n            synchronized (this) {\n                if (this.servletClassLastModifiedTime < lastModified) {\n                    this.servletClassLastModifiedTime = lastModified;\n                    reload = true;\n                }\n            }\n        }\n    }', 'Sergey Vorobyev', '2010-09-23 10:29:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1224, '49986', '3', 'This is actually one of the rare cases that DCL is a decent solution, but the current implementation is broken.\n\nThe fix for getServlet (now Java 5 has come along) is a volatile reload flag.\nThis forces an in order write of the new servlet object and the \'theServlet\' reference (as long as the write to reload is the last step in the update), as well as forcing a read barrier (and thus a consistent read of \'theServlet\' and the new servlet object) for any thread entering getServlet after a reload is done.\n\nsetServletClassLastModifiedTime can be fixed by making servletClassLastModifiedTime volatile (again since Java 5).\n(This could be done with an AtomicLong and a busy loop compareAndSet, but the volatile DCL is a more minor change and the performance diff is probably negligible).\ne.g.:\n        final AtomicLong lastModifiedTime = new AtomicLong();\n\n        while (true) {\n            long current = lastModifiedTime.get();\n            if (current < lastModified) {\n                if (lastModifiedTime.compareAndSet(current, lastModified)) {\n                    reload = true;\n                    break;\n                }\n            } else {\n                break;\n            }\n        }\n\nI\'ll move this to Tomcat 7 and look at a fix there - depending on the confidence we have it may find it\'s way back to 6.x (although I\'ve been running Tomcat in production for a decade and have never seen a practical failure from this).', 'Tim Whittington', '2010-09-30 01:27:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1225, '49986', '4', 'Created  attachment 26102   [details] \nPatch broken DCL', 'Tim Whittington', '2010-09-30 01:30:16 UTC', 'tomcat_attachment/attachment 26102.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1226, '49986', '5', 'Fixed in trunk and will be in 7.0.4 onwards.\n\nProposed for 6.0.x.', 'Mark Thomas', '2010-10-07 10:37:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1227, '49972', '1', 'The currentDateGenerated field is read outside the synch. block, and is not volatile.\n\nSo if one thread calls getCurrentDate() and updates the field, another thread calling getCurrentDate() may see a stale value. \n\nNow a stale value will be smaller than the proper value, so the worst that can happen is that the synch. block is invoked unnecessarily. The synch. block will pick up the true value, and skip the format call if necessary.\n\nHowever, this assumes that the field is only updated by the getCurrentDate() method. As the field is not private, that is not guranteed.\n\nSeems to me that the field should be made private, and a comment added to explain why the double-check is OK in this case.\n\nIf read-only access is needed, a getter could be added for the binary field.', 'Sebb', '2010-09-22 06:53:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1228, '49972', '2', 'It looks scarier than that. \nIn short, see  http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html \n\nCase1: \n\nThread1 executes: \n        long now = System.currentTimeMillis();\n        if ((now - currentDateGenerated) > 1000) {\n            synchronized (format) {\n                if ((now - currentDateGenerated) > 1000) {\n                    currentDateGenerated = now;\nThread2 executes: \n        long now = System.currentTimeMillis();\n        if ((now - currentDateGenerated) > 1000) {\nThread2 skips the \'if\' part.\n\nIf these were the first calls to this function the return value in Thread2 will be null. \n\n-----\nCase2: \n\nThread1 executes: \n                  currentDate = format.format(new Date(now));\nThread2 goes through fast path and executes         \n    return currentDate;\n\nThe object currentDate was not properly published and according to the Java memory model (if I understand it correctly) may be incomplete. \n\n\nOf course, in practice you will not see any problem in 99.9% of the cases.', 'Kostya Serebryany', '2010-09-22 09:56:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1229, '49972', '3', '(In reply to  comment #2 )\n> It looks scarier than that. \n> In short, see\n>  http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html \n\nNot all double-checked locking is evil.\n\nThe simple fix is to just reverse these two lines:\n\n                    currentDateGenerated = now;\n                    currentDate = format.format(new Date(now));\n\nBy setting currentDate prior to currentDateGenerated, the potential of returning null is eliminated, and unnecessary locking is still avoided.  (This is in addition to making the field private, as Sebb noted.)\n\nCase 2 is not a problem; the Java language spec requires operations to be visible to other threads in program order, so the all operations for building the new formatted String must be complete before the reference to it is stored in the field.\n\n - Chuck', 'Chuck Caldarale', '2010-09-22 10:20:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1230, '49972', '4', '>> The simple fix is to just reverse these two lines:\nI afraid, it won\'t work. \nThe compiler is free to reverse these lines back. \n(maybe not in this particular case, but certainly in general). \n\n>> the Java language spec requires operations to be visible to other threads in program order\nDoes it? \n(I am a C++ guy, could you point me to the place in Java docs where this is stated?)\nFrom what I can see, the order is guaranteed only in the presence of happens-before relation (volatile write followed by volatile read or a mutex unlock followed by a mutex lock).', 'Kostya Serebryany', '2010-09-22 10:53:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1231, '49972', '5', 'Also, there are problem with 64 bit variable currentDateGenerated\n\n http://java.sun.com/docs/books/jls/third_edition/html/memory.html \nquote:\nFor the purposes of the Java programming language memory model, a single write to a non-volatile long or double value is treated as two separate writes: one to each 32-bit half. This can result in a situation where a thread sees the first 32 bits of a 64 bit value from one write, and the second 32 bits from another write. Writes and reads of volatile long and double values are always atomic. Writes to and reads of references are always atomic, regardless of whether they are implemented as 32 or 64 bit values.\n\nSo in first (lock-free) check\nif ((now - currentDateGenerated) > 1000)\nWe can read inconsistante state', 'Sergey Vorobyev', '2010-09-22 11:46:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1232, '49972', '6', '(In reply to  comment #4 )\n> > The simple fix is to just reverse these two lines:\n> I afraid, it won\'t work. \n> The compiler is free to reverse these lines back.\n\nNot in this case, due to the possibility of the new operator throwing an exception and the constraint specified in section 11.3.1:\n\n\'Exceptions are precise: when the transfer of control takes place, all effects of the statements executed and expressions evaluated before the point from which the exception is thrown must appear to have taken place. No expressions, statements, or parts thereof that occur after the point from which the exception is thrown may appear to have been evaluated.\'\n\nIf there were no possibility of an exception, your statement would be true.\n\n> > the Java language spec requires operations to be \n> > visible to other threads in program order\n> Does it? \n\nThat\'s my interpretation of this statement in section 17.4:\n\n\'Each time the evaluation of thread t generates an inter-thread action, it must match the inter-thread action a of t that comes next in program order.\'\n\nAll reads and writes of shared variables are inter-thread actions.\n\n - Chuck', 'Chuck Caldarale', '2010-09-22 12:53:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1233, '49972', '7', '(In reply to  comment #5 )\n> Also, there are problem with 64 bit variable currentDateGenerated\n\nThis is a problem (albeit a fairly minor one); technically, the field should be marked volatile to insure all 64 bits are read and written together.  Not sure what that does to code generation on a 32-bit machine, but I suspect it\'s not pretty.  Another reason we should all be running 64-bit boxes...\n\n - Chuck', 'Chuck Caldarale', '2010-09-22 12:58:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1234, '49972', '8', '>> If there were no possibility of an exception, your statement would be true.\nI am not sure about this particular case, but in general a compiler (JIT) may statically figure out that an exception will never be thrown and eliminate the exception handling code completely -- and then shuffle the code in arbitrary way. \nI don\'t think that \'this code may throw exception\' may be used as synchronization.', 'Kostya Serebryany', '2010-09-23 04:03:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1235, '49972', '9', 'Fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2010-10-07 10:07:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1236, '49985', '1', 'I don\'t see any way this could cause a problem.\n\nIf you have a scenario where this could lead to unexpected behaviour, feel free to re-open this issue and add an explanation.', 'Mark Thomas', '2010-09-30 18:27:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1237, '49985', '2', 'First and most obviously, two or more Long/BigInteger objects could be allocated. It\'s not dangerous, but not good.\n\nSecond consider following:\n\nThread1:\nprotected Number getInteger() {\n        if (this.number == null) {\n            try {\n->              this.number = new Long(this.image); // this.number isn\'t null, but not fully complete.\n\nThread2:\nprotected Number getInteger() {\n        if (this.number == null) { // break, because this.number isn\'t null already.\n            ...\n        }\n->      return number; // publish not fully complete object link.\n    }\n\nFor more reasons see  http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html \n(It\'s about dcl, but about lazy initialization generally two. First example become to this code exactly)', 'Sergey Vorobyev', '2010-10-01 04:06:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1238, '49985', '3', 'AIUI making \'number\' volatile would prevent the re-ordering that can result in the object reference being set up before construction is complete. Yes?', 'Sebb', '2010-10-01 07:56:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1239, '49985', '4', '(In reply to  comment #3 )\n> AIUI making \'number\' volatile would prevent the re-ordering that can result in\n> the object reference being set up before construction is complete. Yes?\n\nYes, the reason is object reference being set up before construction is complete. One of possible solutions is making \'number\' volatile.', 'Sergey Vorobyev', '2010-10-01 08:07:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1240, '49985', '5', 'I\'ve yet to be convinced that there is an real issue here. I don\'t see any multi-threaded code paths into instances of those classes.\n\nIf we change anything (on the basis there might be a way for multiple threads to use one of these objects at the same time) then using volatile should prevent misbehaviour with minimal impact. I\'m not concerned about possible additional object creation.', 'Mark Thomas', '2010-10-01 08:15:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1241, '49985', '6', 'Lock at this stack-traces to see how this method can be on invoked from a number of threads:\n(I\'m using dacapo tomcat benchmark)\n\nAstInteger:\n\n   Thread 22\n    #0  org/apache/el/parser/AstInteger.getInteger AstInteger.java:42\n    #1  org/apache/el/parser/AstInteger.getValue AstInteger.java:57\n    #2  org/apache/el/parser/AstDiv.getValue AstDiv.java:39\n    #3  org/apache/el/parser/AstGreaterThan.getValue AstGreaterThan.java:41\n    #4  org/apache/el/ValueExpressionImpl.getValue ValueExpressionImpl.java:186\n    #5  org/apache/jasper/runtime/PageContextImpl.proprietaryEvaluate PageContextImpl.java:935\n    #6  org/apache/jsp/jsp/jsp2/el/basic_002dcomparisons_jsp._jspService basic_002dcomparisons_jsp.java:115\n    #7  org/apache/jasper/runtime/HttpJspBase.service HttpJspBase.java:70\n    #8  javax/servlet/http/HttpServlet.service HttpServlet.java:717\n    #9  org/apache/jasper/servlet/JspServletWrapper.service JspServletWrapper.java:377\n    #10 org/apache/jasper/servlet/JspServlet.serviceJspFile JspServlet.java:313\n    #11 org/apache/jasper/servlet/JspServlet.service JspServlet.java:260\n  \n Thread 28\n    #0  org/apache/el/parser/AstInteger.getInteger AstInteger.java:40\n    #1  org/apache/el/parser/AstInteger.getValue AstInteger.java:57\n    #2  org/apache/el/parser/AstDiv.getValue AstDiv.java:39\n    #3  org/apache/el/parser/AstGreaterThan.getValue AstGreaterThan.java:41\n    #4  org/apache/el/ValueExpressionImpl.getValue ValueExpressionImpl.java:186\n    #5  org/apache/jasper/runtime/PageContextImpl.proprietaryEvaluate PageContextImpl.java:935\n    #6  org/apache/jsp/jsp/jsp2/el/basic_002dcomparisons_jsp._jspService basic_002dcomparisons_jsp.java:115\n    #7  org/apache/jasper/runtime/HttpJspBase.service HttpJspBase.java:70\n    #8  javax/servlet/http/HttpServlet.service HttpServlet.java:717\n    #9  org/apache/jasper/servlet/JspServletWrapper.service JspServletWrapper.java:377\n  \n\nAstFloatingPoint:\n\n   Thread 22\n    #0  org/apache/el/parser/AstFloatingPoint.getFloatingPoint AstFloatingPoint.java:40\n    #1  org/apache/el/parser/AstFloatingPoint.getValue AstFloatingPoint.java:52\n    #2  org/apache/el/parser/AstGreaterThanEqual.getValue AstGreaterThanEqual.java:37\n    #3  org/apache/el/ValueExpressionImpl.getValue ValueExpressionImpl.java:186\n    #4  org/apache/jasper/runtime/PageContextImpl.proprietaryEvaluate PageContextImpl.java:935\n    #5  org/apache/jsp/jsp/jsp2/el/basic_002dcomparisons_jsp._jspService basic_002dcomparisons_jsp.java:121\n    #6  org/apache/jasper/runtime/HttpJspBase.service HttpJspBase.java:70\n    #7  javax/servlet/http/HttpServlet.service HttpServlet.java:717\n    #8  org/apache/jasper/servlet/JspServletWrapper.service JspServletWrapper.java:377\n    #9  org/apache/jasper/servlet/JspServlet.serviceJspFile JspServlet.java:313\n    #10 org/apache/jasper/servlet/JspServlet.service JspServlet.java:260\n    #11 javax/servlet/http/HttpServlet.service HttpServlet.java:717\n  \n Thread 28\n    #0  org/apache/el/parser/AstFloatingPoint.getFloatingPoint AstFloatingPoint.java:42\n    #1  org/apache/el/parser/AstFloatingPoint.getValue AstFloatingPoint.java:52\n    #2  org/apache/el/parser/AstGreaterThanEqual.getValue AstGreaterThanEqual.java:37\n    #3  org/apache/el/ValueExpressionImpl.getValue ValueExpressionImpl.java:186\n    #4  org/apache/jasper/runtime/PageContextImpl.proprietaryEvaluate PageContextImpl.java:935\n    #5  org/apache/jsp/jsp/jsp2/el/basic_002dcomparisons_jsp._jspService basic_002dcomparisons_jsp.java:121\n    #6  org/apache/jasper/runtime/HttpJspBase.service HttpJspBase.java:70\n    #7  javax/servlet/http/HttpServlet.service HttpServlet.java:717\n    #8  org/apache/jasper/servlet/JspServletWrapper.service JspServletWrapper.java:377\n    #9  org/apache/jasper/servlet/JspServlet.serviceJspFile JspServlet.java:313\n \nAstString:\n   Thread 22\n    #0  org/apache/el/parser/AstString.getString AstString.java:38\n    #1  org/apache/el/parser/AstString.getValue AstString.java:51\n    #2  org/apache/el/parser/AstLessThan.getValue AstLessThan.java:37\n    #3  org/apache/el/ValueExpressionImpl.getValue ValueExpressionImpl.java:186\n    #4  org/apache/jasper/runtime/PageContextImpl.proprietaryEvaluate PageContextImpl.java:935\n    #5  org/apache/jsp/jsp/jsp2/el/basic_002dcomparisons_jsp._jspService basic_002dcomparisons_jsp.java:179\n    #6  org/apache/jasper/runtime/HttpJspBase.service HttpJspBase.java:70\n    #7  javax/servlet/http/HttpServlet.service HttpServlet.java:717\n    #8  org/apache/jasper/servlet/JspServletWrapper.service JspServletWrapper.java:377\n    #9  org/apache/jasper/servlet/JspServlet.serviceJspFile JspServlet.java:313\n    #10 org/apache/jasper/servlet/JspServlet.service JspServlet.java:260\n    #11 javax/servlet/http/HttpServlet.service HttpServlet.java:717\n \n  Thread 28\n    #0  org/apache/el/parser/AstString.getString AstString.java:39\n    #1  org/apache/el/parser/AstString.getValue AstString.java:51\n    #2  org/apache/el/parser/AstLessThan.getValue AstLessThan.java:37\n    #3  org/apache/el/ValueExpressionImpl.getValue ValueExpressionImpl.java:186\n    #4  org/apache/jasper/runtime/PageContextImpl.proprietaryEvaluate PageContextImpl.java:935\n    #5  org/apache/jsp/jsp/jsp2/el/basic_002dcomparisons_jsp._jspService basic_002dcomparisons_jsp.java:179\n    #6  org/apache/jasper/runtime/HttpJspBase.service HttpJspBase.java:70\n    #7  javax/servlet/http/HttpServlet.service HttpServlet.java:717\n    #8  org/apache/jasper/servlet/JspServletWrapper.service JspServletWrapper.java:377\n    #9  org/apache/jasper/servlet/JspServlet.serviceJspFile JspServlet.java:313', 'Sergey Vorobyev', '2010-10-01 08:28:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1242, '49985', '7', '(In reply to  comment #6 )\n> Lock at this stack-traces to see how this method can be on invoked from a\n> number of threads:\n\nBut is each thread in the pair using the same instance?  There\'s no evidence of that in the published trace.', 'Chuck Caldarale', '2010-10-01 09:25:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1243, '49985', '8', '(In reply to  comment #7 )\n> (In reply to  comment #6 )\n> > Lock at this stack-traces to see how this method can be on invoked from a\n> > number of threads:\n> \n> But is each thread in the pair using the same instance?  There\'s no evidence of\n> that in the published trace.\n\nI omit first line of race report, sorry.\n\nWARNING: Possible data race during write of size 1 at 0x76a1569c: {{{\n ...\n\nWhere 0x76a1569c is hashCode of object and field.\n\nAlso I always add something like this in critical sections:\n\nint hash = System.identityHashCode(this);\nlong tid = Thread.currentThread().getId();\nSystem.out.println(\'>>VER>> START WRITE/READ \' + tid + \' \' + hash);\ntry {\n	Thread.sleep(10);\n} catch (InterruptedException e) {\nthrow new RuntimeException(e);\n}\n\nSystem.out.println(\'>>VER>> END WRITE/READ \' + tid + \' \' + hash);    \n\nAnd analise stdout. \nThis race was verified.', 'Sergey Vorobyev', '2010-10-01 09:34:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1244, '49985', '9', 'Really a pity some attention has been paid to the drones during Tomcat 7 development, I knew it would just attract more of them :)', 'Remy Maucherat', '2010-10-01 09:51:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1245, '49985', '10', 'Fixed in trunk (will be in 7.0.3 onwards) and proposed for 6.0.x.\n\nThere are many places were static analysis incorrectly reports thread safety issues in the Tomcat code base. Bug reports that look like copy and pasted output from these tools tends to get ignored / resolved as invalid. In this case it took a close inspection of the EL parser to spot the place where these objects were cached to confirm this as a potential issue.\n\nIf you have done the analysis that demonstrates that there really is an issue it saves a lot of time all round if you include that in the initial bug report.', 'Mark Thomas', '2010-10-02 14:56:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1246, '49985', '11', '(In reply to  comment #10 )\n> Fixed in trunk (will be in 7.0.3 onwards) and proposed for 6.0.x.\n> \n> There are many places were static analysis \nThis is why we use dynamic analysis :) \nWe are experimenting with ThreadSanitizer for Java (search for it if curious). \nNot something we can offer to users yet, but already \'sort of works for us\'. \n\n> incorrectly reports thread safety\n> issues in the Tomcat code base. Bug reports that look like copy and pasted\n> output from these tools tends to get ignored / resolved as invalid. In this\n> case it took a close inspection of the EL parser to spot the place where these\n> objects were cached to confirm this as a potential issue.\n> \n> If you have done the analysis that demonstrates that there really is an issue\n> it saves a lot of time all round if you include that in the initial bug report.\nAgree.', 'Kostya Serebryany', '2010-10-02 16:10:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1247, '49985', '12', '(In reply to  comment #10 )\n> (...) In this\n> case it took a close inspection of the EL parser to spot the place where these\n> objects were cached to confirm this as a potential issue.\n> \nFor reference: the caching of EL nodes is performed by\no.a.el.lang.ExpressionBuilder#createNodeInternal(String)\n(using o.a.el.lang.ExpressionBuilder#cache)', 'Konstantin Kolinko', '2010-10-03 14:48:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1248, '49915', '1', 'Patch? What patch? :)\n\nFixed in trunk and will be included in 7.0.3 onwards.\n\nAlso proposed for 6.0.x', 'Mark Thomas', '2010-10-01 12:50:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1249, '49915', '2', 'Oops. Well I assume you don\'t need the file now. Shouldn\'t this be marked as fixed?', 'Wesley', '2010-10-01 18:26:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1250, '49915', '3', 'Not yet. The standard approach is to mark it as fixed once the patch has been applied to the earliest Tomcat version the bug was reported against.', 'Mark Thomas', '2010-10-02 06:51:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1251, '49667', '1', 'Before making a memory dump, you must wait an hour.', 'Arjen Knibbe', '2010-07-29 10:08:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1252, '49667', '2', 'I don\'t see this error with the latest 7.0.x code. Please test with 7.0.2 and if you still see the issue please provide sample web applications and the exact steps to reproduce from a clean 7.0.2 install.', 'Mark Thomas', '2010-08-24 16:51:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1253, '49667', '3', 'Created  attachment 25935   [details] \nDemo for  bug 49667 \n\nThis tar/zip contains a minimal implementation of the A application as mentioned in the bug Overview. Application B will follow. Both applications contain the MySQL JdbC jar file. A pplication A loads the Driver on startup, B doesn\' t.\n\nStarting with a clean Tomcat (no entries in webapps), the bug can be reproduces as follows:\n* copy A.war into webapps, wait until catalina.out shows application A deployed.\n* copy B.war into webapps, wait until catalina.out shows application B deployed.\n* Remove B.war from webapps, wait until catalina.out shows context /B undeployed. Verify that no warning is issued about a Driver being forcilbly unloaded.\n* Optionally, wait an hour.\n* Trigger a memory dump using jmap, inspect the dump using jhat.\n* in the All Classes excluding plathform screen, verify that class com.snt.connect.demo.B.servlet.Servlet is still there.\n* Click on the class, then click on its class loader.\n* Click on Other Queries/Exclude weak refs, verify that class java.sql.DriverManager is in the System class references, and that class com.mysql.jdbc.Driver is in that reference chain.', 'Arjen Knibbe', '2010-08-25 07:37:16 UTC', 'tomcat_attachment/attachment 25935.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (1254, '49667', '4', 'Created  attachment 25936   [details] \nDemo for  bug 49667  - Application B\n\nAnd here is application B. It had to be uploaded separately, since Bugzilla accepts only 1000Kb as attachment :-(', 'Arjen Knibbe', '2010-08-25 07:39:02 UTC', 'tomcat_attachment/attachment 25936.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (1255, '49667', '5', 'I added attachments and a description how to repoduce the bugs as requested by Mark Thomas ( comment 2 ). See comments 3 and 4. Tested with Tomcat 7.0.2 and jdk 6.0.21 on a Solaris machine.', 'Arjen Knibbe', '2010-10-01 05:19:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1256, '49667', '6', 'Thanks for the sample apps. I can now reproduce this. Looking at a fix now...', 'Mark Thomas', '2010-10-01 06:47:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1257, '49667', '7', 'Fixed in trunk and will be included in 7.0.3 onwards.\n\nProposed for 6.0.x', 'Mark Thomas', '2010-10-01 07:13:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1258, '49667', '8', 'That was a quick fix Thomas! Thanks a lot.', 'Arjen Knibbe', '2010-10-01 07:16:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1259, '49730', '1', 'Created  attachment 25865   [details] \nPatch for Tomcat 6', 'Sylvain Laurent', '2010-08-09 16:38:11 UTC', 'tomcat_attachment/attachment 25865.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1260, '49730', '2', 'Created  attachment 25866   [details] \nPatch for tomcat 7', 'Sylvain Laurent', '2010-08-09 16:38:47 UTC', 'tomcat_attachment/attachment 25866.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1261, '49730', '3', 'the proposed patch for tc6 tries to modify as few things as possible.\nIt would be cleaner to backport some stuff from tc7, but I don\'t know if we have to keep tc6 \'interface\' compatible with previous releases. Example : in tc7 TaskQueue is now a public class where it was an inner class of StandardThreadExecutor in tc6...', 'Sylvain Laurent', '2010-08-09 16:43:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1262, '49730', '4', 'Thanks for the analysis and the patch.\n\nPatch applied to 7.0.x and will be in 7.0.3 onwards.\n\nPatch proposed for 6.0.x\n\nIn terms of compatibility, we try and aim for binary compatibility between point releases although we do sometimes break that rule.', 'Mark Thomas', '2010-09-30 14:05:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1263, '49730', '5', 'Regarding TC7:\n1) Why StandardThreadExecutor in TC7 was not patched? Can it be removed, or should it be patched by applying TC6 patch to TC7?\n\n2) (unrelated issue) Apparently there is a bug in catch (InterruptedException x) block in ThreadPoolExecutor.execute(..) in TC7:\n      s/Thread.interrupted()/Thread.currentThread().interrupt()\nFor reference:\n http://www.ibm.com/developerworks/java/library/j-jtp05236.html \n\nRegarding TC6 and TC7 patches:\n2) I would prefer using a finally block to decrement the counter on errors.', 'Konstantin Kolinko', '2010-10-02 15:24:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1264, '49730', '6', '(In reply to  comment #5 )\n> Regarding TC7:\n> 1) Why StandardThreadExecutor in TC7 was not patched? Can it be removed, or\n> should it be patched by applying TC6 patch to TC7?\n\nStandardThreadExecutor actually delegates to a org.apache.tomcat.util.threads.ThreadPoolExecutor which is the one that has been patched. \nBut then your question leads to this next : why the catch (RejectedExecutionException rx) in StandardThreadExecutor.execute ? it\'s already handled in org.apache.tomcat.util.threads.ThreadPoolExecutor.execute\n\nSome javadoc comments would also be useful to explain why we have 2 classes whereas there was only one in tc6 (I guess it\'s because of the Lifecycle refactoring and JMX things?)\n\n> Regarding TC6 and TC7 patches:\n> 2) I would prefer using a finally block to decrement the counter on errors.\n\nagreed, but it should not be decremented if the task can be forced into the queue after a RejectedExecutionException.\n\nDo you want a new patch to the current trunk ? for the interrupt() and the decrement in finally ?', 'Sylvain Laurent', '2010-10-02 17:36:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1265, '49665', '1', 'The previously uploaded patch was made off of svn \'tc6.0.x 966937\'', 'Ted Leung', '2010-07-29 05:10:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1266, '49665', '2', 'Created  attachment 25815   [details] \npatch to file not found reports the file that caused the error.\n\nprevious patch attachment was missing a file, this should work better', 'Ted Leung', '2010-07-29 05:59:10 UTC', 'tomcat_attachment/attachment 25815.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1267, '49665', '3', 'Created  attachment 25816   [details] \npatch to show jsp filename and location causing error\n\nThis patch file has a fix to show the filename and location for the taglib file not found as well as \'Name was not previously introduced as per JSP.5.3\' errors.\n\nThis is a cumulative patch so the previous patches are now obsolete.', 'Ted Leung', '2010-07-29 17:53:37 UTC', 'tomcat_attachment/attachment 25816.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1268, '49665', '4', 'Thanks for the patch. I have applied it to 7.0.x and it will be included in 7.0.3 onwards.\n\nI have also proposed it for 6.0.x.', 'Mark Thomas', '2010-09-28 13:24:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1269, '49209', '1', 'Please provide the full stacktrace. The JdbcLeakPrevention class should already have the necessary permissions, so there must be something odd in the call chain.\n\nIs this issue reproducible? What steps are needed to reproduce it?', 'Konstantin Kolinko', '2010-04-28 07:55:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1270, '49209', '2', 'Here is the full stack trace.\n\nMay 5, 2010 5:15:16 AM org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc\nWARNING: JDBC driver de-registration failed\njava.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.loader.WebappClassLoader.clearReferencesJdbc(WebappClassLoader.java:1820)\n        at org.apache.catalina.loader.WebappClassLoader.clearReferences(WebappClassLoader.java:1740)\n        at org.apache.catalina.loader.WebappClassLoader.stop(WebappClassLoader.java:1658)\n        at org.apache.catalina.loader.WebappLoader.stop(WebappLoader.java:710)\n        at org.apache.catalina.core.StandardContext.stop(StandardContext.java:4649)\n        at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:924)\n        at org.apache.catalina.startup.HostConfig.undeployApps(HostConfig.java:1319)\n        at org.apache.catalina.startup.HostConfig.stop(HostConfig.java:1290)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:323)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1086)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1098)\n        at org.apache.catalina.core.StandardEngine.stop(StandardEngine.java:448)\n        at org.apache.catalina.core.StandardService.stop(StandardService.java:587)\n        at org.apache.catalina.core.StandardServer.stop(StandardServer.java:744)\n        at org.apache.catalina.startup.Catalina.stop(Catalina.java:648)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:615)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\nCaused by: java.security.AccessControlException: access denied (java.lang.RuntimePermission getClassLoader)\n        at java.security.AccessControlContext.checkPermission(AccessControlContext.java:323)\n        at java.security.AccessController.checkPermission(AccessController.java:546)\n        at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\n        at java.lang.Class.getClassLoader(Class.java:594)\n        at org.apache.catalina.loader.JdbcLeakPrevention.clearJdbcDriverRegistrations(JdbcLeakPrevention.java:49)\n        ... 27 more\n\nI see an AllPermission grant in the default catalina.policy that I would have expected to prevent this problem, but haven\'t given much thought as to why it doesn\'t.\n\nIt is reproducible here, simply by shutting down Tomcat with a still-registered JDBC driver (and with a security manager in place, obviously).  If you\'d like any additional information, just let me know.', 'nc1500', '2010-05-05 11:13:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1271, '49209', '3', 'This works for me with the latest 6.0.x code. I don\'t recall any relevant changes since 6.0.26.\n\nIf you still see this issue, please feel free to re-open but you\'ll need to provide the simplest complete set of steps to reproduce this from a clean 6.0.26 install.', 'Mark Thomas', '2010-06-14 12:55:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1272, '49209', '4', 'The problem still exists on Tomcat 6.0.29\n\nSteps: to reproduce \nRun  MySQL DBCP Example from\n    http://tomcat.apache.org/tomcat-6.0-doc/jndi-datasource-examples-howto.html \non Tomcat with enabled security.\n./catalina.sh run -security\n\nI will  add demo application and Context confiuration as attachment.\nTo reproduce you need copy my-webapp.war to /webapps,my-webapp.xml to Catalina/localhost, also you  need to add JDBC driver to /lib.\nException will occur only if security is enabled.', 'Sergey Kabashnyuk', '2010-09-17 09:03:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1273, '49209', '5', 'Created  attachment 26042   [details] \nMySQL DBCP Example APP', 'Sergey Kabashnyuk', '2010-09-17 09:05:21 UTC', 'tomcat_attachment/attachment 26042');
INSERT INTO `tomcatbeforefixcomments` VALUES (1274, '49209', '6', 'Created  attachment 26043   [details] \nContext configuration', 'Sergey Kabashnyuk', '2010-09-17 09:07:15 UTC', 'tomcat_attachment/attachment 26043.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1275, '49209', '7', 'Created  attachment 26049   [details] \nPatch for tomcat 6.0.29\n\nI managed to reproduce the problem.\nThe thing is that the JdbcLeakPrevention class called by WebappClassLoader.clearReferencesJdbc() is not loaded by the same ClassLoader as the other parts of catalina. It is loaded by the classloader of the webapp, but without any ProtectionDomain defined. \n\nMy patch just calls defineClass passing the current ProtectionDomain of the WebappClassLoader class so that from a security policy point of view, the loaded JdbcLeakPrevention class has the same privileges as the rest of catalina as it would have if it had been loaded normally.\n\nI tested my patch with java 1.6.0_20 on OSX 10.6. I suppose the issue also applies to tomcat 7 but did not check.', 'Sylvain Laurent', '2010-09-18 18:08:06 UTC', 'tomcat_attachment/attachment 26049.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1276, '49209', '8', 'Thanks for the patch. Fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2010-09-27 19:08:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1277, '49234', '1', 'username and password are meant to be read/write, otherwise looks good. Please update your patch and I\'ll apply it.', 'Mark Thomas', '2010-05-01 11:16:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1278, '49234', '2', 'Created  attachment 25389   [details] \nModified patch\n\nUsername and password descriptors are included.', 'chamith buddhika', '2010-05-02 22:09:56 UTC', 'tomcat_attachment/attachment 25389.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1279, '49234', '3', 'Created  attachment 25390   [details] \ncatalina.connector-descriptor\n\nPackage: org.apache.catalina.connector\n\nThis patch adds some attributes missing in mbeans descriptor for CoyoteConnector mbean which are present in the underlying Connector object.\n\nIssues related to the this package\n\nSo far I have identified following issue with regards to the mbean usage in this package.\n\nCurrently mbean method invocation delegation happens as follows.\n\nConnectorMBean --> Connector \n\nNow if the connector object is not having the asked property it delegates to the corresponding ProtocolHandler implementation in order to find whether the property is present in that class. (via get/setProperty methods in Connector). \nCurrently there are two ProtocolHandler implementations as I noticed (Http11Protocol & AjpProtocol). Both these implementations are having different sets of properties. Currently CoyoteConnector mbean tries to describe both scenarios with same set of attributes. So some attributes in the descriptor doesn\'t make sense in one implementation or the other.\n\nThe solution for this issue, as far as I understood is to use separate mbeans for these two implementations. Any suggestions in this regards are highly appreciated.', 'chamith buddhika', '2010-05-03 02:26:58 UTC', 'tomcat_attachment/attachment 25390.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1280, '49234', '4', 'Thanks for the updated patches.\n\nThe o.a.catalina patch still needs a little work. It makes more changes than it needs to. The net effect of the patch is to make Role.rolename and User.groups read-only. Only those changes should be present in the patch file. The changes that change the order of the attributes need to be removed (attributes are currently in alphabetical order and should stay that way).\n\nFor the o.a.c.connector patch, the initialized attribute was removed in  r940008 . As far as possible, patches should be aligned with the code at the point of submission. It is easy to drop a section of a patch so I have applied this patch less that one new attribute.\n\nIn terms of approach for handling the ProtocolHandlers, that is worth a discussion on the dev list. I suggest you write an e-mail that outlines the different options. If you think one option is better than the rest then include that in the e-mail along with why you think it is better.', 'Mark Thomas', '2010-05-05 05:06:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1281, '49234', '5', 'Created  attachment 25404   [details] \no.a.Catalina-Final-patch\n\nAttribute swap reverted.', 'chamith buddhika', '2010-05-05 22:15:36 UTC', 'tomcat_attachment/attachment 25404.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1282, '49234', '6', 'Created  attachment 25405   [details] \no.a.Catalina.Core Descriptor Attributes\n\nPackage: org.apache.Catalina.Core\n\nThis patch deals with attributes of above package descriptor. Changes are mainly\n\n 1. Addition of missing attributes\n 2. Ordering of attributes according to their alphabetical order\n\nRequired changes (if any) to descriptor operations will be attached in a separate patch.', 'chamith buddhika', '2010-05-06 04:25:25 UTC', 'tomcat_attachment/attachment 25405.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1283, '49234', '7', '(In reply to  comment #5 )\n> Created an attachment (id=25404) [details]\n> o.a.Catalina-Final-patch\n\nThere are still a lot of unnecessary white-space changes in that patch. I have applied the patch, less the whitespace changes.', 'Mark Thomas', '2010-05-06 07:58:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1284, '49234', '8', '(In reply to  comment #6 )\n> Created an attachment (id=25405) [details]\n> o.a.Catalina.Core Descriptor Attributes\n\nPatch applied. Many thanks.\n\nFor future reference:\n- The description needs to be on a single line. Line breaks look odd in JConsole.\n- Try and keep the alignment consistent throughout the file', 'Mark Thomas', '2010-05-06 08:14:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1285, '49234', '9', 'Created  attachment 25443   [details] \no.a.Catalina.Connector Second Patch\n\nThis new patch on connector descriptor extracts out common attributes of related ProtocolHandler instances. Common attributes are marked with inline comments.', 'chamith buddhika', '2010-05-15 22:33:46 UTC', 'tomcat_attachment/attachment 25443.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1286, '49234', '10', 'It seems that o.a.Catalina.Core descriptor has got operations containing POJO objects instead of primitive types which make them inaccessible via JConsole. Was this intended or does any one have suggestions for handling POJO object parameters in mbean descriptors in general?', 'chamith buddhika', '2010-05-15 23:21:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1287, '49234', '11', 'Created  attachment 25444   [details] \no.a.Catalina.Deploy Patch\n\nPatch for o.a.Catalina.Deploy package. Adds getter and setter support for the properties of ContextResourceLink additionally.', 'chamith buddhika', '2010-05-15 23:28:41 UTC', 'tomcat_attachment/attachment 25444.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1288, '49234', '12', 'In o.a.Catalina.Deploy descriptor for NamingResources the associated MBean (NamingResourceMBean) only exposes add/remove methods for following properties.\n\n    - Environment\n    - Resource\n    - ResourceLink\n\nIn the NamingResource object following additional properties are present which have corresponding add/remove methods.\n\n    - EJB\n    - LocalEJB\n    - MessageDestinationRef\n    - PropertyChangeListener\n    - ResourceEnvRef\n    - Service\n\nI am not sure about the applicability of these additional properties in the context of remote administrative purposes. Any idea on this matter is appreciated.', 'chamith buddhika', '2010-05-15 23:45:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1289, '49234', '13', '(In reply to  comment #10 )\n> It seems that o.a.Catalina.Core descriptor has got operations containing POJO\n> objects instead of primitive types which make them inaccessible via JConsole.\n> Was this intended or does any one have suggestions for handling POJO object\n> parameters in mbean descriptors in general?\n\nI don\'t think there is a one size fits all solution to this. Options include:\n- provide a reference to the associated MBean\n- add MBean support to the object and then add a reference\n- remove them from the descriptor\n- provide methods that use primitives to achieve the same ends\n- something else\n\nYou may want to ask for feedback on the dev list before you start making too many changes for this.', 'Mark Thomas', '2010-05-19 12:25:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1290, '49234', '14', '(In reply to  comment #12 )\n>     - EJB\n>     - LocalEJB\n>     - MessageDestinationRef\n>     - PropertyChangeListener\n>     - ResourceEnvRef\n>     - Service\nI wouldn\'t worry about these for now although exposing getContainer() could be useful.', 'Mark Thomas', '2010-05-19 12:41:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1291, '49234', '15', 'Created  attachment 25471   [details] \no.a.Catalina.Deploy Second Patch\n\nAdds getContainer() method', 'chamith buddhika', '2010-05-23 00:20:48 UTC', 'tomcat_attachment/attachment 25471.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1292, '49234', '16', 'Created  attachment 25473   [details] \no.a.Catalina.ha Patch\n\nThis patch adds to o.a.Catalina.ha descriptor. In this descriptor I found that it references to a class org.apache.catalina.ha.tcp.SimpleTcpReplicationManager which I cannot seem to find in the code base. Probably the class has been removed. In a future patch this reference can be removed if necessary.', 'chamith buddhika', '2010-05-23 01:21:31 UTC', 'tomcat_attachment/attachment 25473.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1293, '49234', '17', 'Package : o.a.Catalina.ha.authenticator\n\nThis package descriptor references to a non existant class org.apache.catalina.cluster.authenticator.ClusterSingleSignOn.', 'chamith buddhika', '2010-05-23 01:23:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1294, '49234', '18', 'Created  attachment 25474   [details] \no.a.Catalina.ha.deploy Patch\n\nAdds missing attributes to FarmWarDeployer.', 'chamith buddhika', '2010-05-23 01:38:44 UTC', 'tomcat_attachment/attachment 25474.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1295, '49234', '19', ' comment #15  - Patch applied\n            - Doesn\'t add much since container is unavailable\n            - More fuel for the separate MBean vs adding methods that return the\n              oname debate\n\n comment #16  - Patch applied\n            - SimpleTcpReplicationManager is in o.a.c.ha.session package\n            - Looks like a duplicate. I\'m fine with removal.\n\n comment #17  - Huh? That class in in that package. Please re-check.\n\n comment #18  - Applied', 'Mark Thomas', '2010-05-25 19:45:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1296, '49234', '20', 'Created  attachment 25516   [details] \no.a.Catalina.ha.session Patch\n\nAdds missing attributes and reorders the existing attributes.', 'chamith buddhika', '2010-06-03 08:49:21 UTC', 'tomcat_attachment/attachment 25516.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1297, '49234', '21', 'Created  attachment 25517   [details] \no.a.Catalina.ha.tcp Patch\n\nI found references to some classes I cannot seem to find in the code base? Am I missing some thing here? Classes are\n\n - ClusterReceiverBase\n - SocketReplicatonListener\n - AsyncSocketSender\n - FastAsyncSocketSender\n - PooledSocketSender\n - SocketSender', 'chamith buddhika', '2010-06-03 08:52:31 UTC', 'tomcat_attachment/attachment 25517.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1298, '49234', '22', 'Created  attachment 25518   [details] \no.a.Catalina.loader Patch\n\nAdds missing attributes/operations and reorders existing attributes.', 'chamith buddhika', '2010-06-03 08:54:14 UTC', 'tomcat_attachment/attachment 25518.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1299, '49234', '23', '(In reply to  comment #21 )\n> I found references to some classes I cannot seem to find in the code base? Am I\n> missing some thing here? Classes are\n> \n>  - ClusterReceiverBase\n>  - SocketReplicatonListener\n>  - AsyncSocketSender\n>  - FastAsyncSocketSender\n>  - PooledSocketSender\n>  - SocketSender\n\nAt least some of them were part of Tomcat 5.5 ´cluster and have been dropped when the new Tomcat 6 cluster was written.', 'Rainer Jung', '2010-06-03 09:52:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1300, '49234', '24', '(In reply to  comment #23 )\n\n> At least some of them were part of Tomcat 5.5 ´cluster and have been dropped\n> when the new Tomcat 6 cluster was written.\n\nSo their corresponding descriptors can be safely removed?', 'chamith buddhika', '2010-06-09 00:10:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1301, '49234', '25', '(In reply to  comment #24 )\n> (In reply to  comment #23 )\n> \n> > At least some of them were part of Tomcat 5.5 ´cluster and have been dropped\n> > when the new Tomcat 6 cluster was written.\n> \n> So their corresponding descriptors can be safely removed?\n\nYes, but first check\n\n- that those classes exist in the old tc 5.5 cluster (under tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If they are not there, we missed something.\n\n- and that they are no longer present in any cluster related package in TC 7 (which is easy, because since Tomcat 6 all Java classes are in the same directory tree).\n\nRegards,\n\nRainer', 'Rainer Jung', '2010-06-09 03:44:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1302, '49234', '26', 'Created  attachment 25555   [details] \no.a.Catalina.Mbeans Patch\n\nAdds missing methods.', 'chamith buddhika', '2010-06-09 05:02:32 UTC', 'tomcat_attachment/attachment 25555.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1303, '49234', '27', 'Created  attachment 25556   [details] \no.a.Catalina.Realm Patch\n\nUserDatabaseRealm and LockoutRealm contains a method with POJO parameters. \naddRealm(org.apache.catalina.Realm)\nI think an overload having a String would do the trick since there is only one method to be taken care of. So a seperate MBean resource is not necessary. \nThe patch adds missing attributes and methods and does some reordering of attributes as well.', 'chamith buddhika', '2010-06-09 05:45:12 UTC', 'tomcat_attachment/attachment 25556.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1304, '49234', '28', 'Created  attachment 25562   [details] \no.a.Catalina.session Patch\n\nAdds missing attributes/methods and reorders them.', 'chamith buddhika', '2010-06-09 06:08:17 UTC', 'tomcat_attachment/attachment 25562.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1305, '49234', '29', 'Created  attachment 25563   [details] \no.a.Catalina.Startup Patch\n\nAdds missing attributes.', 'chamith buddhika', '2010-06-09 06:10:02 UTC', 'tomcat_attachment/attachment 25563.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1306, '49234', '30', '(In reply to  comment #29 )\n> Created an attachment (id=25563) [details]\n> o.a.Catalina.Startup Patch\n> \n> Adds missing attributes.\n\nIn here also there is a operation having POJO parameters which can be overloaded. Will supply this in a future patch if this is acceptable.', 'chamith buddhika', '2010-06-09 06:12:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1307, '49234', '31', 'o.a.Catalina.tribes package descriptor has got mbeans which are present in other several packages as well. They are\n\nSimpleTcpCluster \n Present in following package descriptors\n       - o.a.Catalina.ha.tcp\n       - o.a.Catalina.ha\n       - o.a.Catalina.tribes\n       - o.a.Catalina.tribes.transport\n \nReplicationValve\n Present in above 4 packages as SimpleTcpCluster\n\nSimpleTcpReplicationManager\n Present in following package descriptors\n       - o.a.Catalina.ha.session\n       - o.a.Catalina.tribes\n\nThese mbeans are present in packages with some differences in attributes and operations. The other difference is being that they are in different groups. Any suggestions for proceeding with this scenario? I am guessing this replication may have been intended? Anyway they can be made consistent across packages with respect to their attributes and methods.', 'chamith buddhika', '2010-06-09 06:20:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1308, '49234', '32', 'Created  attachment 25564   [details] \no.a.Catalina.tribes.membership Patch\n\nRemove mbean descriptor methods using deprecated methods and adds new ones.', 'chamith buddhika', '2010-06-09 06:25:46 UTC', 'tomcat_attachment/attachment 25564.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1309, '49234', '33', ' comment #20  - Patch applied\n comment #21  - Patch *NOT* applied\n              resetStatistics() operation has been removed yet it exists. Why?\n comment #26  - Patch applied\n comment #27  - Patch applied - I\'m fine with an overloaded method\n comment #28  - Patch applied\n comment #29  - Patch applied - I\'m fine with an overloaded method\n comment #31  - Probably duplicates that need to be cleaned up\n comment #32  - Patch *NOT* applied\n              Patch does not handle nulls correctly\n\nThe applied patches will be in Tomcat 7.0.1 onwards.', 'Mark Thomas', '2010-06-13 17:28:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1310, '49234', '34', 'Ping. No update/progress in over a week. I\'m starting to get concerned.', 'Mark Thomas', '2010-06-21 19:12:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1311, '49234', '35', '(In reply to  comment #34 )\n> Ping. No update/progress in over a week. I\'m starting to get concerned.\n\nSorry I was extremely busy last 1 and half weeks with my university work. (Finalization of the final year project). So couldn\'t attend much to Tomcat related work. It will be over in another couple of days and I hope to speed-up my work after that. Sorry for the inconvenience.', 'chamith buddhika', '2010-06-22 00:00:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1312, '49234', '36', 'Created  attachment 25634   [details] \no.a.Catalina.ha Modified Patch\n\nAdds missed incorrectly out resetStatistics() function in earlier patch.', 'chamith buddhika', '2010-06-23 22:06:33 UTC', 'tomcat_attachment/attachment 25634.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1313, '49234', '37', 'Created  attachment 25635   [details] \no.a.Catalina.tribes.membership Modified Patch\n\nAdds correct handling of nulls missing in the previous patch.', 'chamith buddhika', '2010-06-23 22:32:46 UTC', 'tomcat_attachment/attachment 25635.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1314, '49234', '38', '(In reply to  comment #31 )\n> o.a.Catalina.tribes package descriptor has got mbeans which are present in\n> other several packages as well. They are\n> \n> SimpleTcpCluster \n>  Present in following package descriptors\n>        - o.a.Catalina.ha.tcp\n>        - o.a.Catalina.ha\n>        - o.a.Catalina.tribes\n>        - o.a.Catalina.tribes.transport\n> \n> ReplicationValve\n>  Present in above 4 packages as SimpleTcpCluster\n> \n> SimpleTcpReplicationManager\n>  Present in following package descriptors\n>        - o.a.Catalina.ha.session\n>        - o.a.Catalina.tribes\n> \n> These mbeans are present in packages with some differences in attributes and\n> operations. The other difference is being that they are in different groups.\n> Any suggestions for proceeding with this scenario? I am guessing this\n> replication may have been intended? Anyway they can be made consistent across\n> packages with respect to their attributes and methods.\n\nAny suggestions for the localization of these descriptors? I am planning to localize all of these class descriptors to o.a.Catalina.tribes mbeans descriptor.', 'chamith buddhika', '2010-06-25 06:36:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1315, '49234', '39', '(In reply to  comment #38 )\n> (In reply to  comment #31 )\n> > o.a.Catalina.tribes package descriptor has got mbeans which are present in\n> > other several packages as well. They are\n> > \n> > SimpleTcpCluster \n> >  Present in following package descriptors\n> >        - o.a.Catalina.ha.tcp\n> >        - o.a.Catalina.ha\n> >        - o.a.Catalina.tribes\n> >        - o.a.Catalina.tribes.transport\n> > \n> > ReplicationValve\n> >  Present in above 4 packages as SimpleTcpCluster\n> > \n> > SimpleTcpReplicationManager\n> >  Present in following package descriptors\n> >        - o.a.Catalina.ha.session\n> >        - o.a.Catalina.tribes\n> > \n> > These mbeans are present in packages with some differences in attributes and\n> > operations. The other difference is being that they are in different groups.\n> > Any suggestions for proceeding with this scenario? I am guessing this\n> > replication may have been intended? Anyway they can be made consistent across\n> > packages with respect to their attributes and methods.\n> \n> Any suggestions for the localization of these descriptors? I am planning to\n> localize all of these class descriptors to o.a.Catalina.tribes mbeans\n> descriptor.\n\nI have localized them in to the o.a.Catalina.tribes package descriptor. Will be committing the changes soon.', 'chamith buddhika', '2010-06-25 06:55:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1316, '49234', '40', '(In reply to  comment #25 )\n> (In reply to  comment #24 )\n> > (In reply to  comment #23 )\n> > \n> > > At least some of them were part of Tomcat 5.5 ´cluster and have been dropped\n> > > when the new Tomcat 6 cluster was written.\n> > \n> > So their corresponding descriptors can be safely removed?\n> \n> Yes, but first check\n> \n> - that those classes exist in the old tc 5.5 cluster (under\n> tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> they are not there, we missed something.\n> \n> - and that they are no longer present in any cluster related package in TC 7\n> (which is easy, because since Tomcat 6 all Java classes are in the same\n> directory tree).\n> \n> Regards,\n> \n> Rainer\n\nI couldn\'t find the mentioned classes in Tomcat 5.5 and nor they are present in the trunk.', 'chamith buddhika', '2010-06-25 07:09:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1317, '49234', '41', '(In reply to  comment #40 )\n> (In reply to  comment #25 )\n> > (In reply to  comment #24 )\n> > > (In reply to  comment #23 )\n> > > \n> > > > At least some of them were part of Tomcat 5.5 ´cluster and have been dropped\n> > > > when the new Tomcat 6 cluster was written.\n> > > \n> > > So their corresponding descriptors can be safely removed?\n> > \n> > Yes, but first check\n> > \n> > - that those classes exist in the old tc 5.5 cluster (under\n> > tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> > they are not there, we missed something.\n> > \n> > - and that they are no longer present in any cluster related package in TC 7\n> > (which is easy, because since Tomcat 6 all Java classes are in the same\n> > directory tree).\n> > \n> > Regards,\n> > \n> > Rainer\n> \n> I couldn\'t find the mentioned classes in Tomcat 5.5 and nor they are present in\n> the trunk.\n\nI found some of the classes in TC5.0. Namely \n>  - PooledSocketSender\n>  - SocketSender\n>  - AsyncSocketSender\n>  - ReplicationTransmitter\n\nSome of the other classes are missing in TC5.0 as well.\n>  - ClusterReceiverBase\n>  - SocketReplicatonListener\n>  - FastAsyncSocketSender', 'chamith buddhika', '2010-06-25 07:16:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1318, '49234', '42', '(In reply to  comment #41 )\n> (In reply to  comment #40 )\n> > (In reply to  comment #25 )\n> > > (In reply to  comment #24 )\n> > > > (In reply to  comment #23 )\n> > > > \n> > > > > At least some of them were part of Tomcat 5.5 ´cluster and have been dropped\n> > > > > when the new Tomcat 6 cluster was written.\n> > > > \n> > > > So their corresponding descriptors can be safely removed?\n> > > \n> > > Yes, but first check\n> > > \n> > > - that those classes exist in the old tc 5.5 cluster (under\n> > > tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> > > they are not there, we missed something.\n> > > \n> > > - and that they are no longer present in any cluster related package in TC 7\n> > > (which is easy, because since Tomcat 6 all Java classes are in the same\n> > > directory tree).\n> > > \n> > > Regards,\n> > > \n> > > Rainer\n> > \n> > I couldn\'t find the mentioned classes in Tomcat 5.5 and nor they are present in\n> > the trunk.\n> \n> I found some of the classes in TC5.0. Namely \n> >  - PooledSocketSender\n> >  - SocketSender\n> >  - AsyncSocketSender\n> >  - ReplicationTransmitter\n> \n> Some of the other classes are missing in TC5.0 as well.\n> >  - ClusterReceiverBase\n> >  - SocketReplicatonListener\n> >  - FastAsyncSocketSender\n\nSo I will be removing the descriptors of these classes in respective packages.', 'chamith buddhika', '2010-06-25 07:22:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1319, '49234', '43', '(In reply to  comment #40 )\n> (In reply to  comment #25 )\n> > (In reply to  comment #24 )\n> > > (In reply to  comment #23 )\n> > > \n> > > > At least some of them were part of Tomcat 5.5 ´cluster and have been dropped\n> > > > when the new Tomcat 6 cluster was written.\n> > > \n> > > So their corresponding descriptors can be safely removed?\n> > \n> > Yes, but first check\n> > \n> > - that those classes exist in the old tc 5.5 cluster (under\n> > tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> > they are not there, we missed something.\n> > \n> > - and that they are no longer present in any cluster related package in TC 7\n> > (which is easy, because since Tomcat 6 all Java classes are in the same\n> > directory tree).\n> > \n> > Regards,\n> > \n> > Rainer\n> \n> I couldn\'t find the mentioned classes in Tomcat 5.5 and nor they are present in\n> the trunk.\n\nMenioned classes were.\n\n - ClusterReceiverBase\n - SocketReplicatonListener\n - AsyncSocketSender\n - FastAsyncSocketSender\n - PooledSocketSender\n - SocketSender\n\nIn tc5.5.x/trunk/container/modules/cluster/src/share/org/apache/catalina/cluster/tcp you will find all of them. Curious how you missed them.', 'Rainer Jung', '2010-06-25 07:29:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1320, '49234', '44', '(In reply to  comment #43 )\n> (In reply to  comment #40 )\n> > (In reply to  comment #25 )\n> > > (In reply to  comment #24 )\n> > > > (In reply to  comment #23 )\n> > > > \n> > > > > At least some of them were part of Tomcat 5.5 ´cluster and have been dropped\n> > > > > when the new Tomcat 6 cluster was written.\n> > > > \n> > > > So their corresponding descriptors can be safely removed?\n> > > \n> > > Yes, but first check\n> > > \n> > > - that those classes exist in the old tc 5.5 cluster (under\n> > > tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> > > they are not there, we missed something.\n> > > \n> > > - and that they are no longer present in any cluster related package in TC 7\n> > > (which is easy, because since Tomcat 6 all Java classes are in the same\n> > > directory tree).\n> > > \n> > > Regards,\n> > > \n> > > Rainer\n> > \n> > I couldn\'t find the mentioned classes in Tomcat 5.5 and nor they are present in\n> > the trunk.\n> \n> Menioned classes were.\n> \n>  - ClusterReceiverBase\n>  - SocketReplicatonListener\n>  - AsyncSocketSender\n>  - FastAsyncSocketSender\n>  - PooledSocketSender\n>  - SocketSender\n> \n> In\n> tc5.5.x/trunk/container/modules/cluster/src/share/org/apache/catalina/cluster/tcp\n> you will find all of them. Curious how you missed them.\n\nSeems I somehow overlooked this package. Sorry for false alarm. Anyway since these are not present in the trunk I will be removing them. \n\nRegards,', 'chamith buddhika', '2010-06-25 08:10:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1321, '49234', '45', 'Created  attachment 25637   [details] \no.a.Catalina.ha Modified Patch\n\nRemoves references to old TC cluster classes which are non existent in the trunk. Now the descriptor is empty. Can possibly be removed.', 'chamith buddhika', '2010-06-25 08:11:37 UTC', 'tomcat_attachment/attachment 25637.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1322, '49234', '46', 'Created  attachment 25638   [details] \no.a.Catalina.ha.session Modified Patch\n\nRemoves SimpleTcpReplicationManager which has been moved to o.a.Catalina.tribes package descriptor.', 'chamith buddhika', '2010-06-25 08:14:50 UTC', 'tomcat_attachment/attachment 25638.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1323, '49234', '47', 'Created  attachment 25639   [details] \no.a.Catalina.ha.tcp Patch\n\nRemoves old TC5.5 cluster classes. Now the descriptor is empty. Can possibly be removed.', 'chamith buddhika', '2010-06-25 08:16:27 UTC', 'tomcat_attachment/attachment 25639.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1324, '49234', '48', 'Created  attachment 25640   [details] \no.a.Catalina.tribes Patch\n\nNow descriptors for classes SimpleTcpCluster, ReplicationValve and SimpleTcpReplicationManager have been localized to this package descriptor.', 'chamith buddhika', '2010-06-25 08:18:55 UTC', 'tomcat_attachment/attachment 25640.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1325, '49234', '49', 'Created  attachment 25641   [details] \no.a.Catalina.tribes.transport Patch\n\nRemoves duplicated descriptors from this package. (Moved to o.a.Catalina.tribes descriptor). Now the descriptor is empty. Can possibly be removed.', 'chamith buddhika', '2010-06-25 08:20:48 UTC', 'tomcat_attachment/attachment 25641.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1326, '49234', '50', 'Where can I find the class JDBCUserDatabase? It is not in the package org.apache.catalina.users as mentioned in org.apache.catalina.users descriptor.', 'chamith buddhika', '2010-06-26 02:21:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1327, '49234', '51', 'I cannot seem to find classes FastCommonAccessLogValve, RequestDamperValve and RequestListenerValve described in o.a.Catalina.Valves. Have they been removed from the code base? Will it be possible to remove their descriptors?', 'chamith buddhika', '2010-06-27 07:38:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1328, '49234', '52', '(In reply to  comment #51 )\n> I cannot seem to find classes FastCommonAccessLogValve, RequestDamperValve and\n> RequestListenerValve described in o.a.Catalina.Valves. Have they been removed\n> from the code base? Will it be possible to remove their descriptors?\n\nSee:\n\n http://svn.apache.org/viewvc?view=revision&revision=769347 \n\n http://svn.apache.org/viewvc?view=revision&revision=805375 \n\n http://svn.apache.org/viewvc?view=revision&revision=302036 \n\nRegards,\n\nRainer', 'Rainer Jung', '2010-06-27 13:15:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1329, '49234', '53', ' comment #36  - Patch applied\n comment #37  - Patch applied\n comment #45  - Patch applied\n\n comment #46  - Patch NOT applied\n comment #47  - Patch NOT applied\n comment #48  - Patch NOT applied\n comment #49  - Patch NOT applied\n\nNone of the last four patches were applied since they appear to define MBeans in different packages to where class. The simple rule is that the descriptor for a package should include descriptions for classes in that package and that package only.\n\nMaintenance will be a nightmare if the descriptor is in a different package.', 'Mark Thomas', '2010-07-02 14:28:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1330, '49234', '54', 'Created  attachment 25716   [details] \no.a.Catalina.ha.session Modified Patch\n\nIncludes SimpleTCPReplicationManager to this package descriptor. Earlier was in o.a.catalina.tribes descriptor. Adds missing attributes and methods to it.', 'chamith buddhika', '2010-07-06 12:51:09 UTC', 'tomcat_attachment/attachment 25716.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1331, '49234', '55', 'Created  attachment 25717   [details] \no.a.Catalina.ha.tcp Modified Patch\n\nMoves SimpleTcpCluster and ReplicationValve from o.a.Catalina.tribes descriptor to this descriptor.', 'chamith buddhika', '2010-07-06 12:58:25 UTC', 'tomcat_attachment/attachment 25717.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1332, '49234', '56', 'Created  attachment 25719   [details] \no.a.Catalina.tribes Modified Patch\n\nRemoves SimpleTcpReplicationManager, SimpleTcpCluster and ReplicationValve from this package descriptor since the classes themselves are not belonging to this package. Now the descriptor is empty. Possible to be removed.', 'chamith buddhika', '2010-07-06 13:05:22 UTC', 'tomcat_attachment/attachment 25719.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1333, '49234', '57', 'Created  attachment 25720   [details] \no.a.Catalina.tribes.transport Modified Patch\n\nNow the descriptor is empty. Possible to be removed.', 'chamith buddhika', '2010-07-06 13:11:26 UTC', 'tomcat_attachment/attachment 25720.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1334, '49234', '58', 'Created  attachment 25733   [details] \no.a.Catalina.users Patch\n\nRemoves non existent class descriptors.', 'chamith buddhika', '2010-07-08 07:05:50 UTC', 'tomcat_attachment/attachment 25733.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1335, '49234', '59', 'Created  attachment 25734   [details] \no.a.Catalina.valves Patch\n\nRemoves non existent class descriptors and adds missing attributes.', 'chamith buddhika', '2010-07-08 07:09:03 UTC', 'tomcat_attachment/attachment 25734.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1336, '49234', '60', 'All patches applied. Many thanks.', 'Mark Thomas', '2010-07-08 17:56:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1337, '49234', '61', 'Ping. No update/progress in over a week. Again.\n\nOverall I am beginning to have serious concerns about the rate of progress of this project.', 'Mark Thomas', '2010-07-15 16:52:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1338, '49234', '62', '(In reply to  comment #61 )\n> Ping. No update/progress in over a week. Again.\n> \n> Overall I am beginning to have serious concerns about the rate of progress of\n> this project.\n\nSorry. It seems the I have gone through all the mbean-descriptors in the tomcat packages as of now in the first round. Now I am evaluating what I have missed in the first round. There are some work left in several packages which I have been working on lately. Will provide a patch soon. e.g.: o.a.Catalina.Core POJO operations.Apart from those I guess descriptor related work should be pretty much done. Are there any specific other JMX related improvements that you have in mind?', 'chamith buddhika', '2010-07-15 21:45:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1339, '49234', '63', '(In reply to  comment #10 )\n> It seems that o.a.Catalina.Core descriptor has got operations containing POJO\n> objects instead of primitive types which make them inaccessible via JConsole.\n> Was this intended or does any one have suggestions for handling POJO object\n> parameters in mbean descriptors in general?\n\nFor this I was considering to use a separate MBean whose methods would take an oname of the respective component as a string. But it seems currently there is no facility (in the Registry) to obtain the associated resource object given the oname of a component. Alternatively it is possible to create a component from a scratch within the mbean method in add methods. But remove methods still requires obtaining the resource from the corresponding oname. Am I missing some thing here?', 'chamith buddhika', '2010-07-16 06:58:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1340, '49234', '64', '(In reply to  comment #63 )\n> (In reply to  comment #10 )\n> > It seems that o.a.Catalina.Core descriptor has got operations containing POJO\n> > objects instead of primitive types which make them inaccessible via JConsole.\n> > Was this intended or does any one have suggestions for handling POJO object\n> > parameters in mbean descriptors in general?\n> \n> For this I was considering to use a separate MBean whose methods would take an\n> oname of the respective component as a string. But it seems currently there is\n> no facility (in the Registry) to obtain the associated resource object given\n> the oname of a component. Alternatively it is possible to create a component\n> from a scratch within the mbean method in add methods. But remove methods still\n> requires obtaining the resource from the corresponding oname. Am I missing some\n> thing here?\n\nHi All,\n\nCurrently I am bit stuck on above. Any ideas on this?', 'chamith buddhika', '2010-07-19 10:25:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1341, '49234', '65', '(In reply to  comment #64 )\n> Currently I am bit stuck on above. Any ideas on this?\n\nI\'d start by looking at the MBeans for the components that currently have separate MBeans.', 'Mark Thomas', '2010-07-21 12:19:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1342, '49234', '66', 'Created  attachment 25796   [details] \no.a.Catalina.Core Operations Patch\n\nThis deals with operations add/remove valve/lifecycleListener in the StandardContext mbean. Seperate MBean called ContainerMBean has been created with the operations. The operations are available at container level (not just StandardContext level) hence the name ContainerMBean. But this still doesn\'t account for addChild methods present in the descriptor. For valves and lifecycleListeners new instances have been created using the provided classnames. I am still exploring the possibility of using that approach to addChild methods as well.', 'chamith buddhika', '2010-07-23 03:58:36 UTC', 'tomcat_attachment/attachment 25796.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1343, '49234', '67', '(In reply to  comment #66 )\n> Created an attachment (id=25796) [details]\n> o.a.Catalina.Core Operations Patch\n> \n> This deals with operations add/remove valve/lifecycleListener in the\n> StandardContext mbean. Seperate MBean called ContainerMBean has been created\n> with the operations. The operations are available at container level (not just\n> StandardContext level) hence the name ContainerMBean. But this still doesn\'t\n> account for addChild methods present in the descriptor. For valves and\n> lifecycleListeners new instances have been created using the provided\n> classnames. I am still exploring the possibility of using that approach to\n> addChild methods as well.\n\nAny comments on this? However I am not sure this approach can be applied to addChild methods since different child types (Host, Context e.g.) require different parameters for their initialization.', 'chamith buddhika', '2010-07-31 10:46:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1344, '49234', '68', '(In reply to  comment #67 )\n> Any comments on this? However I am not sure this approach can be applied to\n> addChild methods since different child types (Host, Context e.g.) require\n> different parameters for their initialization.\n\nPlease ping sooner if you don\'t getting a reply in 48 hours. I missed your 23/07 post.\n\n1. Please use 4 spaces not tabs\n2. All public methods should have Javadoc comments\n3. Why only modify the descriptor for StandardContext? What about Host, Engine etc\n4. re addChild. All children *must* implement Container and they all should have a no-arg constructor. It should be simple to write a addChild method that takes a class name. The startChldren attribute on the parent can be used to prevent the added child from being started until it has been initialised. You may need to change the visibility of the LifecycleMBeanBase.register() method\n\nOverall, this looks to be heading in the right direction but I\'d like to see it get to the point where all containers can be added and removed via JMX before it is committed.', 'Mark Thomas', '2010-08-01 16:06:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1345, '49234', '69', 'Created  attachment 25837   [details] \no.a.Catalina.Core Operations Second Patch\n\nThis patch address the first three concerns raised by Mark for the initial patch. Add/RemoveChild methods have also been incorporated to the ContainerMbean class though they may require some more work.', 'chamith buddhika', '2010-08-04 00:45:33 UTC', 'tomcat_attachment/attachment 25837.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1346, '49234', '70', '(In reply to  comment #69 )\n\n\'May require some work\'?\n\nIt sure does. The following needs to be supported:\n- Start Tomcat\n- Via JMX, select the host\n- Create a new context\n- Configure it to serve content (e.g. from an external directory)\n- Start it\n- Check the content is accessible\n\nHint: It will be a lot easier if you modify your addChild() method to also specify the name of the child.', 'Mark Thomas', '2010-08-05 17:52:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1347, '49234', '71', '(In reply to  comment #70 )\n> (In reply to  comment #69 )\n\nI am little bit confused here.\n> - Start Tomcat\n\nI was under the impression Tomcat should have been already started for MBean Server to be up and running and to do any work with JMX.\n\n> - Via JMX, select the host\n> - Create a new context\n> - Configure it to serve content (e.g. from an external directory)\n> - Start it\n\nThese can be done in one method or using a series of JMX method invocations. But I guess we can provide the flexibility for both ways. The issue I am having in order to incorporate these into addChild() is the fact that this method is common to Engine, Host and Context. But the above steps seem to be specified towards adding a child (a Context) to a given host. To accommodate that within addChild we may have to conditionally check for each type of the child (whether it is a Host or a Context etc.) and take suitable actions (if new Context above steps or if new Host something else) according to that. It is possible but one issue that may crop up is different types of children needing different types of configuration parameters. (e.g: for Context workDir, for Host appBase). May be we can provide this using a extended MBean classes for different types of children which overload addChild method with different parameters. WDYT?  \n\n\n> - Check the content is accessible', 'chamith buddhika', '2010-08-06 01:50:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1348, '49234', '72', '(In reply to  comment #71 )\n> (In reply to  comment #70 )\n> > (In reply to  comment #69 )\n> \n> I am little bit confused here.\n> > - Start Tomcat\n> \n> I was under the impression Tomcat should have been already started for MBean\n> Server to be up and running and to do any work with JMX.\n\nThose steps are a series of actions the user should be able to perform.\n\n> These can be done in one method or using a series of JMX method invocations.\n\nNeither. These are user actions. But, the JMX methods need to be there to support them once Tomcat has been started.\n\n> But I guess we can provide the flexibility for both ways.\n\nNot necessary.\n\n> WDYT?\n\nI think you missed the point. addChild() needs to make sure that the child is visible in JMX so it can be configured (again via JMX) before it is started. Note my previous comment about using startChildren attribute of the parent to ensure the child isn\'t started until it has been configured.', 'Mark Thomas', '2010-08-06 02:46:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1349, '49234', '73', 'Created  attachment 25862   [details] \no.a.Catalina.Core Operations Third Patch\n\nThis patch adds to addChild method in ContainerMBean and does some adding and redorderings to the o.a.c.Core descriptor.\n\n- Start Tomcat\n- Via JMX, select the host\n\n- Create a new context       ----> addChild \n\n- Configure it to serve content (e.g. from an external directory) ---> Other descriptor methods in StandardContext\n\n- Start it  --> start/ startChild methods\n\n- Check the content is accessible  --> Currently not sure how this can be done', 'chamith buddhika', '2010-08-07 22:04:13 UTC', 'tomcat_attachment/attachment 25862.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1350, '49234', '74', '(In reply to  comment #73 )\n> Created an attachment (id=25862) [details]\n> o.a.Catalina.Core Operations Third Patch\n> \n> This patch adds to addChild method in ContainerMBean and does some adding and\n> redorderings to the o.a.c.Core descriptor.\n> \n> - Start Tomcat\n> - Via JMX, select the host\n> \n> - Create a new context       ----> addChild \n> \n> - Configure it to serve content (e.g. from an external directory) ---> Other\n> descriptor methods in StandardContext\n> \n> - Start it  --> start/ startChild methods\n> \n> - Check the content is accessible  --> Currently not sure how this can be done\n\nAny comment on this?', 'chamith buddhika', '2010-08-10 00:22:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1351, '49234', '75', '> > Created an attachment (id=25862) [details] [details]\n> \n> Any comment on this?\n\nI only have intermittent internet access at the moment. I have just downloaded this for review.', 'Mark Thomas', '2010-08-10 09:46:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1352, '49234', '76', 'Thanks for the updated patch.\n\nI wasn\'t thinking of explicitly setting startChildren in the addChild() method but it is a good idea and I like it. However, you need to rework your patch to ensure startChildren is always reset, even if an Exception occurs.\n\nAlso, there is no need to manipulate startChildren in startChild() - at least I can\'t see one.', 'Mark Thomas', '2010-08-11 12:59:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1353, '49234', '77', 'Just as a reminder remember one of the goals of this work was to be able to start with a \'blank\' server object and completely configure a Tomcat instance via JMX. i.e. add a servic, engine, host and contexts. Add one or more connectors and be able to serve content from the contexts.\n\nI\'ll be happy to apply this patch when it can be used to add children to containers via X.', 'Mark Thomas', '2010-08-11 13:07:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1354, '49234', '78', '(In reply to  comment #77 )\n> Just as a reminder remember one of the goals of this work was to be able to\n> start with a \'blank\' server object and completely configure a Tomcat instance\n> via JMX. i.e. add a servic, engine, host and contexts. Add one or more\n> connectors and be able to serve content from the contexts.\n\nI guess above (add a servic, engine, host and contexts. Add one or more\nconnectors and be able to serve content from the contexts) can be done using a combination of addChild and/or MBeanFactory create methods as of now.', 'chamith buddhika', '2010-08-11 23:09:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1355, '49234', '79', '(In reply to  comment #78 )\n> (In reply to  comment #77 )\n> > Just as a reminder remember one of the goals of this work was to be able to\n> > start with a \'blank\' server object and completely configure a Tomcat instance\n> > via JMX. i.e. add a servic, engine, host and contexts. Add one or more\n> > connectors and be able to serve content from the contexts.\n> \n> I guess above (add a servic, engine, host and contexts. Add one or more\n> connectors and be able to serve content from the contexts) can be done using a\n> combination of addChild and/or MBeanFactory create methods as of now.\n\nAny comment on this?', 'chamith buddhika', '2010-08-13 00:47:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1356, '49234', '80', '(In reply to  comment #79 )\n> (In reply to  comment #78 )\n> > (In reply to  comment #77 )\n> > > Just as a reminder remember one of the goals of this work was to be able to\n> > > start with a \'blank\' server object and completely configure a Tomcat instance\n> > > via JMX. i.e. add a servic, engine, host and contexts. Add one or more\n> > > connectors and be able to serve content from the contexts.\n> > \n> > I guess above (add a servic, engine, host and contexts. Add one or more\n> > connectors and be able to serve content from the contexts) can be done using a\n> > combination of addChild and/or MBeanFactory create methods as of now.\n> \n> Any comment on this?\n\nMark is away, please be patient.', 'Pid', '2010-08-13 03:26:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1357, '49234', '81', 'Created  attachment 25885   [details] \no.a.Catalina.Core Operations Fourth Patch\n\nModifies startChildren handling even with an exception thrown.', 'chamith buddhika', '2010-08-14 21:31:34 UTC', 'tomcat_attachment/attachment 25885.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1358, '49234', '82', 'Created  attachment 25888   [details] \no.a.Catalina.Core Operations Fifth Patch\n\nAdds ContextMBean to support find methods of Context implementations.', 'chamith buddhika', '2010-08-15 11:28:51 UTC', 'tomcat_attachment/attachment 25888.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1359, '49234', '83', '(In reply to  comment #79 )\n> (In reply to  comment #78 )\n> > (In reply to  comment #77 )\n> > > Just as a reminder remember one of the goals of this work was to be able to\n> > > start with a \'blank\' server object and completely configure a Tomcat instance\n> > > via JMX. i.e. add a servic, engine, host and contexts. Add one or more\n> > > connectors and be able to serve content from the contexts.\n> > \n> > I guess above (add a servic, engine, host and contexts. Add one or more\n> > connectors and be able to serve content from the contexts) can be done using a\n> > combination of addChild and/or MBeanFactory create methods as of now.\n> \n> Any comment on this?\n\nRather than \'guessing\' and copy and pasting my own comments, what you should have been doing is trying this for yourself.', 'Mark Thomas', '2010-08-17 11:23:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1360, '49234', '84', 'Created  attachment 25908   [details] \no.a.Catalina.Core Operations Patch- Fix\n\nA bug fix patch for earlier patches. Now it is possible to start from a Server and add a service, engine, host, context and connectors to come up with a configured server.', 'chamith buddhika', '2010-08-18 12:28:25 UTC', 'tomcat_attachment/attachment 25908.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1361, '49234', '85', 'The patch is getting there but there is still quite a lot of work to do.\n\nStarting from just a Server object the patch is insufficient. See my commits earlier today for StandardServer and MBeanFactory. Further work is also required. See below for details.\n\nThe patch contained a number of tabs. I\'d suggest enabling validation as it will pick this up as part of the build process.\n\nThe two new files are missing the mandatory AL2 license header.\n\nWhen adding child containers, the children need to be initialized. This will register them with the MBeanServer so they can be configured before they are started. That should also make the startChild() method unnecessary.\n\nI fixed most of the above and then tested with a server.xml that just had a Server object defined. I could add everything I needed to and some bits worked (others didn\'t) but I still saw a lot of errors. Overall I think you need to do more testing and generally make things more robust.\n\nOn a related point, I noticed that the addConnector method on Service isn\'t available via JMX. I suspect that this isn\'t an isolated issue and that other methods exposed via MBeans will have similar issues that need to be fixed.', 'Mark Thomas', '2010-08-20 11:31:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1362, '49234', '86', '(In reply to  comment #85 )\n\n \n> When adding child containers, the children need to be initialized. This will\n> register them with the MBeanServer so they can be configured before they are\n> started. That should also make the startChild() method unnecessary.\n> \n\nI am little bit confused here. MBean registration for the component happens within  init(). But it is called as a part of the start() procedure. If I am not mistaken init() consist of only part of this start procedure. So still we may have to call the start method of the child to get the other stuff properly executed (e.g: startInternal())? Calling start on already inited component doesn\'t have any other side effects as I understood looking at the state diagram on the Lifecycle class.', 'chamith buddhika', '2010-08-23 09:41:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1363, '49234', '87', '(In reply to  comment #86 )\n\n> I am little bit confused here. MBean registration for the component happens\n> within  init(). But it is called as a part of the start() procedure.\n\nIt can be called as part of start() but it doesn\'t have to be.\n\n> If I am\n> not mistaken init() consist of only part of this start procedure. So still we\n> may have to call the start method of the child to get the other stuff properly\n> executed (e.g: startInternal())? Calling start on already inited component\n> doesn\'t have any other side effects as I understood looking at the state\n> diagram on the Lifecycle class.\n\nTake a look at the LifecycleBase class.', 'Mark Thomas', '2010-08-23 09:53:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1364, '49234', '88', '(In reply to  comment #86 )\n\n> I am little bit confused here. MBean registration for the component happens\n> within  init(). But it is called as a part of the start() procedure. If I am\n> not mistaken init() consist of only part of this start procedure. So still we\n> may have to call the start method of the child to get the other stuff properly\n> executed (e.g: startInternal())? Calling start on already inited component\n> doesn\'t have any other side effects as I understood looking at the state\n> diagram on the Lifecycle class.\n\nActually now I realize that once the child is visible via JMX we can directly call child\'s start method to start it once we are finished configuring it. So the startChild method of the parent is not strictly necessary. So I guess I will be removing that.', 'chamith buddhika', '2010-08-23 10:16:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1365, '49234', '89', 'Created  attachment 25937   [details] \no.a.Catalina.core Operations Patch 6\n\nThis iteration of the patch adds a ServiceMBean to enhance Service related functionalities. AddConnector and related methods are now properly available in Service MBean. Includes several other modifications for the earlier patch like removal of startChild method in ContainerMBean and initializing the children during addChild.', 'chamith buddhika', '2010-08-25 10:42:02 UTC', 'tomcat_attachment/attachment 25937.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1366, '49234', '90', '(In reply to  comment #89 )\n> Created an attachment (id=25937) [details]\n> o.a.Catalina.core Operations Patch 6\n> \n> This iteration of the patch adds a ServiceMBean to enhance Service related\n> functionalities. AddConnector and related methods are now properly available in\n> Service MBean. Includes several other modifications for the earlier patch like\n> removal of startChild method in ContainerMBean and initializing the children\n> during addChild.\n\nWith this patch I am able to do following successfully.\n\n1. Create a Service and Engine\n2. Create and add a connector to the service\n3. Initialize the service, engine and connectors\n3. Create a Host and Context and initialize them\n\nIt is not clear what sequence of next steps to be taken to add and serve a resource after this. Any ideas on how to proceed?', 'chamith buddhika', '2010-09-09 11:01:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1367, '49234', '91', 'Please enable validation in your build process and ensure in future that patch you provide build with validation enabled. This one had a number of tabs that needs to be replaced with spaces.', 'Mark Thomas', '2010-09-11 13:18:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1368, '49234', '92', 'The patch is heading in the right direction and I am tempted to commit it. However, I see a bunch of stack traces in the logs when I try to start a Context so I think there is still some more work required but definitely making progress.', 'Mark Thomas', '2010-09-11 13:51:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1369, '49234', '93', 'I got to the bottom of the problem. The correct parent class loader was not being passed down the object hierarchy. I fixed that and applied your patch. I can now get to the point where I can create a context with static content and JSPs via JMX from a server.xml that just contains a Server object. Woot!\n\nWith this patch the basic functionality is in place. The MBeans exposed are a lot better than they were but there is still work to do. For example a quick review of the StandardContext found a bunch if typos, a missing attribute and other attributes that are not visible in JConsole. See  r996235  for details.\n\nI recommend that the next step is to work through the MBeans in JConsole and resolving the following issues:\n- attributes that show up as Unavailable (in red text)\n- methods that can not be called (you\'ll see an error message when you click on \'Operations\' in the navigation tree)\n\nSome will be easier than others. I\'d go for the quick win typos (like those in  r966235 ) first.', 'Mark Thomas', '2010-09-11 21:44:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1370, '49234', '94', '(In reply to  comment #93 )\n> I got to the bottom of the problem. The correct parent class loader was not\n> being passed down the object hierarchy. I fixed that and applied your patch. I\n> can now get to the point where I can create a context with static content and\n> JSPs via JMX from a server.xml that just contains a Server object. Woot!\n> \n> With this patch the basic functionality is in place. The MBeans exposed are a\n> lot better than they were but there is still work to do. For example a quick\n> review of the StandardContext found a bunch if typos, a missing attribute and\n> other attributes that are not visible in JConsole. See  r996235  for details.\n> \n> I recommend that the next step is to work through the MBeans in JConsole and\n> resolving the following issues:\n> - attributes that show up as Unavailable (in red text)\n> - methods that can not be called (you\'ll see an error message when you click on\n> \'Operations\' in the navigation tree)\n> \n> Some will be easier than others. I\'d go for the quick win typos (like those in\n>  r966235 ) first.\n\nI will look in to these issues in next couple of days.', 'chamith buddhika', '2010-09-14 20:36:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1371, '49234', '95', 'Now might be a good time to resolve this issue as FIXED and move to using separate issues for any future improvements. That would keep this issue as an archive of your GSOC work.', 'Mark Thomas', '2010-09-15 11:33:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1372, '49749', '1', 'Since the setting of HttpOnly should be controlled by the useHttpOnly attribute of the context, the code should probably read:\n\n798- response.addCookie(cookie)\n798+ response.addCookieInternal(cookie, request.getContext.getUserHttpOnly());', 'dheinecke', '2010-08-16 13:04:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1373, '49749', '2', 'This has been fixed in trunk and will be included in 7.0.3 onwards.\n\nI\'ll take a look at proposing backports for 6.0.x and 5.5.x.', 'Mark Thomas', '2010-08-25 07:38:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1374, '49749', '3', 'Patch proposed for 6.0.x and 5.5.x', 'Mark Thomas', '2010-08-25 08:08:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1375, '48738', '1', 'Thank you for the patch.\nI updated Summary and Severity of this issue.', 'Konstantin Kolinko', '2010-02-13 23:47:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1376, '48738', '2', 'The patch (with some slight modifications) has been applied to trunk and will be included in 7.0.3 onwards.', 'Mark Thomas', '2010-08-24 06:09:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1377, '48738', '3', 'Created  attachment 25932   [details] \nPort of TC7 patch for Tomact 6\n\nI\'ll propose this patch for 6.0.x', 'Mark Thomas', '2010-08-24 14:59:52 UTC', 'tomcat_attachment/attachment 25932.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1378, '49670', '1', 'Can you provide a simple test case which demonstrates the problem?', 'Pid', '2010-08-03 05:47:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1379, '49670', '2', 'Created  attachment 25879   [details] \nFirst participating war file.\n\nPlease add the jaas.jar file from this project o you tomcat/lib folder as i contains the jaas principal and login module implementation.', 'chornsey', '2010-08-11 23:14:16 UTC', 'tomcat_attachment/attachment 25879');
INSERT INTO `tomcatbeforefixcomments` VALUES (1380, '49670', '3', 'Created  attachment 25880   [details] \nSecond participating web appliaction.', 'chornsey', '2010-08-11 23:14:56 UTC', 'tomcat_attachment/attachment 25880');
INSERT INTO `tomcatbeforefixcomments` VALUES (1381, '49670', '4', 'Created  attachment 25881   [details] \nThe tomcat jaas configuration file used on the test server.', 'chornsey', '2010-08-11 23:16:18 UTC', 'tomcat_attachment/attachment 25881');
INSERT INTO `tomcatbeforefixcomments` VALUES (1382, '49670', '5', 'Created  attachment 25882   [details] \nserver.xml with sso valve enabled.', 'chornsey', '2010-08-11 23:17:43 UTC', 'tomcat_attachment/attachment 25882.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1383, '49670', '6', 'Created  attachment 25883   [details] \neclipse jaas implementation project zipped.\n\nThis is the zipped eclipse project for all of the jaas files.  Includes the source for the login module and principals.', 'chornsey', '2010-08-11 23:21:31 UTC', 'tomcat_attachment/attachment 25883.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (1384, '49670', '7', 'I have added two war files, he server configuration, jaas configuration and the source code for the jaas implementation I used in this test case.\n\nAccessing the first web app requires a log in.  Accessing the second app does not require a login.  Using this test case in 6.x requires a login when accessing app 1, but not on the subsequent request for app2.', 'chornsey', '2010-08-11 23:23:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1385, '49721', '1', 'Probably your jar does not have a META-INF/web-fragment.xml file and thus is skipped.\n\nYou can look at jar files in webapp-3.0-fragments test webapp for a working example,\n http://svn.apache.org/repos/asf/tomcat/trunk/test/webapp-3.0-fragments/WEB-INF/lib/ ', 'Konstantin Kolinko', '2010-08-09 06:01:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1386, '49721', '2', 'Hi Konstantin,\n\nDuring my work on the Tomcat support in Eclipse Web Tools, the only requirement I found in the Servlet 3.0 spec for static resources in a jar was that they be found under \'META-INF/resources\' in the jar.  I didn\'t see any requirement that the jar be a web-fragment.\n\nWang,\n\nSince this behavior is only defined for Servlet 3.0 web applications, if your project has a web.xml, make sure it is a Servlet 3.0 web.xml in addition to making sure the JSP is in the \'META-INF/resources\' folder of the jar.  A quick test shows this working for me for Tomcat 7.0.0 and 7.0.2 (currently under vote).\n\nCheers,\nLarry', 'Larry Isaacs', '2010-08-09 09:48:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1387, '49721', '3', '(In reply to  comment #2 )\n> Hi Konstantin,\n> \n> During my work on the Tomcat support in Eclipse Web Tools, the only requirement\n> I found in the Servlet 3.0 spec for static resources in a jar was that they be\n> found under \'META-INF/resources\' in the jar.  I didn\'t see any requirement that\n> the jar be a web-fragment.\n> \n> Wang,\n> \n> Since this behavior is only defined for Servlet 3.0 web applications, if your\n> project has a web.xml, make sure it is a Servlet 3.0 web.xml in addition to\n> making sure the JSP is in the \'META-INF/resources\' folder of the jar.  A quick\n> test shows this working for me for Tomcat 7.0.0 and 7.0.2 (currently under\n> vote).\n> \n> Cheers,\n> Larry\n\nHi, Larry\n\nI also test an very simple case where there are only one jar file in the lib, it runs well. But when there are more than one jar files, it fails.\n\nI attach the two war files and please help to verify.\n\nThanks!', 'Wang Guangzhe', '2010-08-09 21:18:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1388, '49721', '4', 'Created  attachment 25867   [details] \nthe war file with more than one jar files', 'Wang Guangzhe', '2010-08-09 21:21:21 UTC', 'tomcat_attachment/attachment 25867');
INSERT INTO `tomcatbeforefixcomments` VALUES (1389, '49721', '5', 'Created  attachment 25868   [details] \nthe war file with only one jar file', 'Wang Guangzhe', '2010-08-09 21:22:19 UTC', 'tomcat_attachment/attachment 25868');
INSERT INTO `tomcatbeforefixcomments` VALUES (1390, '49721', '6', 'I believe the problem is in step 8 in the ContextConfig.webConfig() method.  Based on my read of the Servlet 3.0 spec (section 4.6 only says JAR and states order is undefined), the \'processResourceJARs(orderedFragments)\' should be \'processResourceJARs(fragments)\' instead.\n\nWang,\n\nBecause your web.xml specifies an <absolute-ordering>, jars which do not have a web-fragment.xml will not appear in the orderedFragments list and won\'t be scanned for static resources.  Adding a web-fragment.xml as Konstatin suggests would work around the problem for now, assuming the <absolute-ordering> can\'t be removed.\n\nLarry', 'Larry Isaacs', '2010-08-10 11:13:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1391, '49613', '1', 'Created  attachment 25782   [details] \nProfiler screenshot\n\nThis is a screenshot from a profiler. It shows how a JSF application calls getAttributeNames() 1222 times for a single page render.', 'Sampo Savolainen', '2010-07-19 06:28:59 UTC', 'tomcat_attachment/attachment 25782.png');
INSERT INTO `tomcatbeforefixcomments` VALUES (1392, '49613', '2', 'Application frameworks like MyFaces use attributes while rendering a page. Tomcat reads all SSL connector attributes for every call to getAttributeNames(). This creates a large number of calls to getAttributeNames(). The current 6.0.x implementation is very slow as it does not recognize it has already read the SSL specific attributes. \n\nI will attach a patch which uses an object boolean field to determine whether the SSL attributes have already been read or not. The speedup to the profiled application is 10x.', 'Sampo Savolainen', '2010-07-19 06:41:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1393, '49613', '3', 'Created  attachment 25783   [details] \nProposed patch to specified issue', 'Sampo Savolainen', '2010-07-19 06:44:20 UTC', 'tomcat_attachment/attachment 25783.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1394, '49613', '4', 'Looking at your patch, you apparently did not understand the code. But I can see you might incur a performance problem if SSL is enabled and there\'s no certificate chain (at least if it is null). Maybe. However, using getAttributesNames repeatedly (if at all) is ... disturbing.', 'Remy Maucherat', '2010-07-19 07:51:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1395, '49613', '5', 'Can you abbreviate on how I did not understand the code correctly? \n\nThis is how I understood it:\n\n\'getAttributes(Globals.CERTIFICATES_ATTR)\' is called when a secure connection is made. This call is made to make sure the \'if( isSSLAttribute(name) )\' branch is activated. This branch then fills out the attributes Map with the SSL attributes.\n\nThe only change I did was to use an object variable (sslAttributesRead) to make sure the \'if( isSSLAttribute(name) )\' branch is executed only once per request.\n\nSo this fixes the assumption the current code has, which is that once the SSL attributes are read, the \'getAttributes(Globals.CERTIFICATES_ATTR)\' call terminates as it finds a value for the attribute.\n\nI don\'t see a problem with my logic. Can you explain what I got wrong?\n\n\nRe: disturbing...\n\nYou are very correct that this is a bit disturbing. But given the complexity and generic nature of web application frameworks, such use is inevitable. And, the performance hit the application takes is unacceptable (response time of 40 seconds instead of 4 in one case) especially since this is easily solvable.', 'Sampo Savolainen', '2010-07-19 08:18:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1396, '49613', '6', 'Actually, the patch is appropriate for TC 6. I thought it should be in getAttribute, but this would interfere with the SSLAuthenticator.', 'Remy Maucherat', '2010-07-20 10:20:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1397, '49613', '7', 'Thanks for the patch.\n\nIt has been applied to 7.0.x and will be in 7.0.1 onwards.\n\nIt has been proposed for 6.0.x.', 'Mark Thomas', '2010-07-22 10:38:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1398, '49567', '1', 'Looks like you attached the wrong test case to this report.', 'Mark Thomas', '2010-07-10 17:26:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1399, '49567', '2', '(In reply to  comment #1 )\n> Looks like you attached the wrong test case to this report.\n\nDear Mark,\n\nwhy do you think this is the wrong test case?\nAre you not able to reproduce the problem with it?\n\nKind regards,\n\nPieter', 'Pieter Libin', '2010-07-12 04:23:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1400, '49567', '3', 'Because at first glance the test case appears to be identical to the previous bug you reported and there is no reference in it to doPost which you refer to in both the title and the description. On closer inspection I see there are differences but I am still confused about the references to doPost in the title and description.', 'Mark Thomas', '2010-07-12 04:40:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1401, '49567', '4', '(In reply to  comment #3 )\n> Because at first glance the test case appears to be identical to the previous\n> bug you reported and there is no reference in it to doPost which you refer to\n> in both the title and the description. On closer inspection I see there are\n> differences but I am still confused about the references to doPost in the title\n> and description.\n\nI\'m sorry for the confusion, please replace doPost by doGet.', 'Pieter Libin', '2010-07-12 05:26:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1402, '49567', '5', 'I\'ve converted the attached test case to a Tomcat 7 unit test and can reproduce the issue. Looking at it now...', 'Mark Thomas', '2010-07-12 09:58:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1403, '49567', '6', '***  Bug 49635  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2010-07-22 02:08:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1404, '48998', '1', 'Created  attachment 25208   [details] \nPort of mod_expires as ExpiresFilter with optimized null checks\n\nThis patch slightly smaller than previous .patch file because the previous .patch file included twice TestExpiresFilter.java.\n\nChanges in this patch:\n* ExpiresFilter.java : reduce null checks for speed optimization,\n* filter.xml : add a comment in to warn users not to declare blank chars between \';\' and \'charset=\' for \'ExpiresByType\' directives,\n* TestExpiresFilter.java : narrow the precision interval in cache-control checks.', 'Cyrille Le Clerc', '2010-03-29 18:17:29 UTC', 'tomcat_attachment/attachment 25208.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1405, '48998', '2', 'why not use  http://tuckey.org/urlrewrite/  ? it can do this and many other things...', 'Sylvain Laurent', '2010-03-29 18:40:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1406, '48998', '3', '(In reply to  comment #2 )\n> why not use  http://tuckey.org/urlrewrite/  ? it can do this and many other\n> things...\n\nMy understanding is that the UrlRewriteFilter can add response headers (e.g. \'Expires\' and \'Cache-Control\') according to request attributes like a URI pattern (e.g. *.html).\n\nHowever, I don\'t see how I could express something like \'if the response content type is \'application/rss+xml\' and if no expiration header has been defined, then add an expiration of 5 minutes\'.\n\nA challenge I see in this kind of feature is to apply the expiration-header-generation logic just before the servlet engine starts to write in the response body in the socket.', 'Cyrille Le Clerc', '2010-03-29 19:02:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1407, '48960', '1', 'Patches for enhancements are always welcome', 'Mark Thomas', '2010-03-22 17:11:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1408, '48960', '2', 'Created  attachment 25166   [details] \nReplacement for  SSIServlet.java SSIProcessor.java SSIFilter.java\n\nAttached is a quick fix that adds \'allowExec\' parameter to the SSI servlet and filter. I could not build the complete Tomcat tree - I\'ll be happy to test any patched version with this (or similar change).\n\nOverall < 50 lines of changes.\n\nBasic logic: remove the exec command from the SSIProcessor, unless the allow_exec is true.', 'Yair Lenga', '2010-03-22 18:06:18 UTC', 'tomcat_attachment/attachment 25166');
INSERT INTO `tomcatbeforefixcomments` VALUES (1409, '48960', '3', 'Will you take a patch for Tomcat 5.5 ?\n\nI\'m using RedHat5, which has a Tomcat 5.5 bundled in. It\'s much easier to get a security upgrade installed, than to get a new version upgrade.', 'Yair Lenga', '2010-03-22 18:10:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1410, '48960', '4', '***  Bug 49520  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2010-06-29 12:45:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1411, '48960', '5', '(In reply to  comment #4 )\n> ***  Bug 49520  has been marked as a duplicate of this bug. ***\n\nMark,\n\nIs there anything I can do to speed up the inclusion of this change ? I\'ve noticed it did not make it for 6.0.28, where few other CGI/SSI related changed were incorporated. I would love to use the SSI, but I can not use it because of the security reisk of the \'unsafe\' include/exec.', 'Yair Lenga', '2010-07-09 10:01:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1412, '48960', '6', 'Providing patches in diff -u format would help.', 'Mark Thomas', '2010-07-09 10:17:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1413, '48960', '7', 'Created  attachment 25760   [details] \nPatch to disable exec by default, new allowExec tag\n\nPatch for three files, created against 6.0.26-src', 'Yair Lenga', '2010-07-13 15:52:28 UTC', 'tomcat_attachment/attachment 25760.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1414, '48960', '8', 'The diff is inverted and the patch is using tabs rather than spaces. I should eb able to work with that but you might need to fix it.', 'Mark Thomas', '2010-07-13 17:16:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1415, '48960', '9', 'In the end I used the patch a guide and write a new one. Some additional comments:\n- if you do an svn diff against a normal source tree patches usually apply cleanly\n- new features should be documented\n\nThe patch has been applied to truck and proposed for 6.0.x', 'Mark Thomas', '2010-07-13 17:38:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1416, '48960', '10', 'Mark,\n\nThanks for taking the change. I\'ll follow you suggestions regarding svn diff for the next time.\n\nDo I have to submit anything for the change to flow to 7.X ?\n\nYair', 'Yair Lenga', '2010-07-13 17:54:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1417, '48960', '11', 'Sorry truck should have been trunk and trunk == 7.0.x so it is already there.', 'Mark Thomas', '2010-07-13 18:08:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1418, '49570', '1', 'The current approach to gzip compression is fundamentally flawed. See  bug46538  and  bug39727  for an explanation of why. Transfer-Encoding is the correct way to go but browser support is still patchy.\n\nThat said, the majority of the current botched solutions - Tomcat included - do set the Vary header. The proposed patch isn\'t quite right - see  bug 48660  for details.\n\nI have applied a corrected patch to to 7.0.x and it will be included in 7.0.1 onwards.', 'Mark Thomas', '2010-07-10 13:21:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1419, '49570', '2', 'The patch in SVN doesn\'t work for me because there is no method HttpServletResponse.getHeader()\n\n\nprotected HttpServletResponse response = null;\n....\nresponse.addHeader(\'Content-Encoding\', \'gzip\');\nString vary = response.getHeader(\'Vary\');\nif (vary == null) {\n    // Add a new Vary header\n    response.setHeader(\'Vary\', \'Accept-Encoding\');\n} else if (vary.equals(\'*\')) {\n    // No action required\n} else {\n    // Merge into current header\n    response.setHeader(\'Vary\', vary + \',Accept-Encoding\');\n}', 'Thai Ha', '2010-07-12 23:39:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1420, '49570', '3', '\nA proposed patch is below:\n\nif (response.containsHeader(\'Vary\')) {\n  response.addHeader(\'Vary\', \'Accept-Encoding\');\n} else {\n  response.setHeader(\'Vary\', \'Accept-Encoding\');\n}', 'Thai Ha', '2010-07-15 22:12:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1421, '49550', '1', 'Check the archives. This has come up before. isSpace() has the behaviour required, isWhiteSpace() does not.', 'Mark Thomas', '2010-07-05 08:24:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1422, '49550', '2', 'In that case, may I suggest the following patch to document this for future maintainers?', 'Sebb', '2010-07-05 09:10:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1423, '49550', '3', 'Created  attachment 25704   [details] \nDocument why still using deprecated method', 'Sebb', '2010-07-05 09:11:09 UTC', 'tomcat_attachment/attachment 25704.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1424, '49525', '1', 'The difference cookie header of tomcat 6 & 7\n\nTomcat 7 \nSet-Cookie: JSESSIONID=E33BFF1384284F317D75025391BF5CB3; Path=\'\'; HttpOnly\n\nTomcat 6\nSet-Cookie: JSESSIONID=F6EB3C21AC71EC2AA305A2BBEE37DBE9; Path=/', 'oschina.net', '2010-06-29 22:26:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1425, '49525', '2', 'Thanks for the report. Fixed in trunk and will be included in 7.0.1 onwards.', 'Mark Thomas', '2010-07-01 15:37:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1426, '49525', '3', 'Thanks for your reply :)', 'oschina.net', '2010-07-01 19:51:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1427, '49525', '4', 'I am seeing this exact problem on 7.0.6, but only Tomcat on Linux.  I have another install of 7.0.6 on Windows and it works fine.\n\nThis is the error I see in the logs:\n\nFeb 3, 2011 11:44:15 PM org.apache.tomcat.util.http.Cookies processCookieHeader\nINFO: Cookies: Invalid cookie. Value not a token or quoted value\n\nAgain, this only happens on IE 8 hitting 7.0.6 on Linux.  Unfortunately we have a LOT of IE 8 users.  I rolled back to Tomcat 6 and it\'s working fine again.\n\nThanks very much!', 'Bmeist', '2011-02-04 11:09:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1428, '49445', '1', 'Created  attachment 25596   [details] \nI made a patch.', 'Keiichi Fujino', '2010-06-16 06:53:58 UTC', 'tomcat_attachment/attachment 25596.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1429, '49445', '2', 'Fixed in trunk and proposed for 6.0.x and 5.5.x.', 'Keiichi Fujino', '2010-06-16 07:12:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1430, '49445', '3', 'Since this is fixed in 7.0.x (it will be included in 7.0.1 onwards) move this issue to 6.0.x', 'Mark Thomas', '2010-06-19 10:24:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1431, '49445', '4', 'This fix applied to 6.0, will be in 6.0.28 onwards.', 'Keiichi Fujino', '2010-06-22 06:14:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1432, '48971', '1', 'For a better description of the side effect, see  http://wiki.apache.org/tomcat/MemoryLeakProtection#cclThreadSpawnedByCommonClassLoader ', 'Sylvain Laurent', '2010-03-23 22:58:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1433, '48971', '2', 'There is no patch attached to this bug report.\n\nI\'d rather keep the protection by default and provide a way to disable it if necessary. That said, your expendable class-loader idea is probably a better way of dealing with this. Is there a complete patch for that anywhere? I don\'t recall seeing one.', 'Mark Thomas', '2010-03-24 00:32:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1434, '48971', '3', 'Created  attachment 25170   [details] \npatch for tomcat 7', 'Sylvain Laurent', '2010-03-24 05:32:39 UTC', 'tomcat_attachment/attachment 25170.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1435, '48971', '4', 'you\'re correct,  I did not submit any patch for the expendable classloader, I\'d like to discuss another approach on the dev list in the next days.\n\nRegarding this present issue, I think that it would be more coherent/consistent to either stop all \'leaking\' threads or none. Currently, the default behavior depends on the actual class of the Thread, which is not self-evident for users...\n\nAnd my opinion is still that such an option should be \'opt-in\' rather than \'opt-out\'.', 'Sylvain Laurent', '2010-03-24 20:08:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1436, '48971', '5', 'Created  attachment 25203   [details] \n bug48971 _DBCP_reproducer.zip - IllegalStateException caused by stopped timer\n\nAny DBCP pool that has timeBetweenEvictionRunsMillis attribute set to a positive value will suffer from this issue.\n\nThe class that creates the timer is org.apache.commons.pool.impl.EvictionTimer and is (after being renamed) in tomcat-dbcp.jar, which is in the Common class loader.\n\nIt looks that the TimerThread created by the Timer will belong to the first web application that happens to access the pool. Forcibly stopping the timer creates an invalid state in the DBCP and the next web applications may fail to start.\n\nI am attaching configuration that reproduces this issue.\n\nTo reproduce:\n1. Unpack the zip archive, and place the provided files on top of the default configuration of Tomcat 6.0.26.\n\nIt contains:\n1) /data - Two sample HSQLDB databases ( http://hsqldb.org/ ), \'database\' and \'database2\'. These are identical and contain a single table with two rows of data - see the *.script files.\n2) /lib - HSQLDB 1.8.1.2 jar.\n3) /conf - server.xml that defines a database pool in GlobalResources.\n         - tomcat-users.xml that contains a username and password for the manager application\n4) /webapps - Two web applications, test1 and test2. These are nearly identical, with the following only difference between them (see META-INF/context.xml):\n- test1 uses connection pool defined in server.xml\n- test2 uses its own connection pool\n5) /logs - Logs from my test run.\n\n2. Copy jstl.jar and standard.jar from /webapps/examples/WEB-INF/lib/ of Tomcat into the /lib folder of Tomcat.\n\n3. Start Tomcat\n4. Go to  http://localhost:8080/test1/   A test page should load and print two database rows.\n5. Go to  http://localhost:8080/manager/html/  and stop the test1 application.\nNote, that Tomcat stops TimerThread created by DBCP.\n\n6. Go to  http://localhost:8080/test2/ \nExpected result: The same output as for test1 before.\nActual result:  The page fails to load, displaying\nDataSource invalid: \'java.lang.IllegalStateException: Timer already cancelled.\'\n\n\nIt is not seen from the stack trace, but my understanding here is that that occurs because in Commons Pools, when a new pool is initialized, the GenericObjectPool#startEvictor(..) method creates a new Evictor and calls Timer.schedule(..) to schedule it, but the timer is already canceled.\n\nOther issues:\n1) I suspect that when the pool defined in server.xml is initialized, the TCCL occurs to be equal to the classloader of the web application. I have not yet confirmed that, but that will be a separate bug (causing its own leaks) if it is the case.\n2) HSQLDB creates its own \'HSQLDB Timer\' thread. That is not important, because DBCP issue I am talking about is independent of what database is used. If anyone is curious: that thread is created by the org.hsqldb.lib.HsqlTimer class.\n\n\nRegarding the feature of stopping TimerThreads:\n1) I agree with Sylvain that it looks like that it would be better to have it disabled by default, but I would like to have a separate option to control enabling this feature.\n2) I think that another strategy is possible here: to call Thread.setContextClassLoader(null) on the affected threads. That can have its consequences, but might be better than stopping the threads.\n\nWorkaround:  Do not set \'timeBetweenEvictionRunsMillis\' attribute on a pool.', 'Konstantin Kolinko', '2010-03-28 21:30:07 UTC', 'tomcat_attachment/attachment 25203.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (1437, '48971', '6', 'Mark, could you consider fixing this issue for 6.0.27 ? there\'s my (now old) patch for trunk attached, do you need a more recent one and one for tomcat 6 as well ?', 'Sylvain Laurent', '2010-05-06 17:18:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1438, '48971', '7', 'The approach suggested by Sylvain on the dev list was to set the Thread\'s context class loader to null. I\'m not 100% about the side-effects of that either. However, that did trigger another idea - setting the context class loader to the parent of the webapp class loader, normally the common class loader. In that case, we still need to log an error - it is just the corrective action that changes.\n\nI\'ll test this idea out over the next day or so.', 'Mark Thomas', '2010-05-24 10:22:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1439, '48971', '8', 'Hello Mark,\n\nI had tried this too, but I still had the leak because I often had some ProtectionDomain instances that referenced the webapp classloader.\n\nThe urgent thing to do is to fix the current issue by making the stopping of TimerThread optional, and open a new BZ issue for an enhancement in this matter.', 'Sylvain Laurent', '2010-05-24 17:43:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1440, '48971', '9', 'This has been fixed in trunk and proposed for 6.0.x.', 'Mark Thomas', '2010-06-01 13:01:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1441, '48971', '10', 'Note I have fixed the DBCP issue in commons pool. The fix will be in pool 1.5.5 onwards.', 'Mark Thomas', '2010-06-01 15:15:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1442, '48971', '11', 'reference to the commons-pool issue :  https://issues.apache.org/jira/browse/POOL-161 ', 'Sylvain Laurent', '2010-06-01 17:05:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1443, '49224', '1', 'I\'m guessing that the solution is as simple as changing lines 215 and 216 of PooledConnection to the following:\n\npoolProperties.getDbProperties().setProperty(\'user\', usr != null ? usr : \'\');\npoolProperties.getDbProperties().setProperty(\'password\', pwd != null ? pwd : \'\');\n\n--Matt', 'Matt Passell', '2010-04-29 11:18:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1444, '49224', '2', '(In reply to  comment #1 )\n> I\'m guessing that the solution is as simple as changing lines 215 and 216 of\n> PooledConnection to the following:\n> \n> poolProperties.getDbProperties().setProperty(\'user\', usr != null ? usr : \'\');\n> poolProperties.getDbProperties().setProperty(\'password\', pwd != null ? pwd :\n> \'\');\n> \n> --Matt\n\n\'\' is not the same as null, my guess is that the property should not even be set of the value is null', 'Filip Hanik', '2010-04-29 18:19:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1445, '49224', '3', '(In reply to  comment #2 )\n> \'\' is not the same as null, my guess is that the property should not even be\n> set of the value is null\n\nGood point.  That\'s even better, as long as you make sure that any code calling PoolProperties.getDbProperties().getProperty() is null-tolerant as well.', 'Matt Passell', '2010-04-29 18:24:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1446, '49224', '4', 'Created  attachment 25427   [details] \nonly set username and password if the values are not null\n\nLooking at how the dbProperties are just passed to the driver, it\'s clear that any driver willing to accept a connection without a username or password should be fine without values for those properties being passed through.  So, the patch I\'m attaching does just what Filip was suggesting and only sets the username/password if they\'re not null.', 'Matt Passell', '2010-05-11 13:07:05 UTC', 'tomcat_attachment/attachment 25427.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1447, '48689', '1', 'Created  attachment 24933   [details] \nProposed patch for this issue.\n\nProposed patch for this issue is now attached. The patch introduces JarResource interface through which most of the embedded TLD lookup is done. In most places the code uses JarResource.getEntry() to get an URL to a specific entry within the JarResource. In one or two places JarResource.getJarFile() is used but really JarResource.getEntry() should be preferred.', 'Jarek Gawor', '2010-02-05 12:38:53 UTC', 'tomcat_attachment/attachment 24933.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1448, '48689', '2', 'Tomcat 7 already includes a number of features added specifically to support TLD scanning in OSGi environments. Can you elaborate as to what you can\'t currently do with Tomcat 7?\n\nAlso, could you provide an example of situations when a URL can\'t be provided?', 'Mark Thomas', '2010-02-06 05:53:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1449, '48689', '3', 'First, can you quickly describe or point me to the features that were added to support TLD scanning in OSGi env. in case I missed them?\n\nWe have a custom implementation of TldLocationsCache.java. If the TLD is within the application bundle (accessible via ServletContext or within a jar file in a bundle) everything works fine. But in some cases we want to return a TLD that is located in another bundle. So all we have is a URL to the TLD. For example, something like bundle://123:0/META-INF/foo.tld. And in this case there is no \'jar url\' I can pass/return to Jasper.', 'Jarek Gawor', '2010-02-06 10:01:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1450, '48689', '4', 'It was  bug47834  and mainly  r814617  and  r817685 .\n\nBundles (as long as they are on the class path) are handled if org.apache.jasper.compiler.TldLocationsCache.SCAN_ALL_FILES is set as any file on the class path is checked to see if it is in JAR format and if it is, it is scanned.\n\nExploded bundles (again as long as they are on the class path) are handled if org.apache.jasper.compiler.TldLocationsCache.SCAN_ALL_DIRS is set and any directory on the class path is checked to see it it is an exploded JAR/bundle. If it is it is scanned.\n\nAs an aside, the TLD scanning is likely to see another refactoring once the Servlet 3.0 work is complete to take advantage of some of the new features to simplify the code.', 'Mark Thomas', '2010-02-06 12:13:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1451, '48689', '5', 'Thanks for the pointers. I am aware of that code but it doesn\'t really help or address the problem described in this bug. Jasper shouldn\'t require (as it doesn\'t really need) a jar url to be passed from TldLocationsCache just to parse the TLD or tag files within it. The problem is not with TLD scanning itself but what TldLocationsCache.getLocation() method forces me to return and rest of the Jasper code that uses the location information to do its stuff.', 'Jarek Gawor', '2010-02-08 08:01:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1452, '43642', '1', 'Created  attachment 20996   [details] \nPatch against 6.0.14', 'Ruediger Pluem', '2007-10-17 08:01:15 UTC', 'tomcat_attachment/attachment 20996.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1453, '43642', '2', 'Ping? Any interest? If needed I can provide a patch against 6.0.26.', 'Ruediger Pluem', '2010-04-12 07:56:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1454, '43642', '3', 'Nope a  patch against trunk would be better.', 'jfclere', '2010-04-13 02:20:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1455, '43642', '4', 'Created  attachment 25291   [details] \nPatch against Tomcat 6.0 trunk', 'Ruediger Pluem', '2010-04-14 05:14:34 UTC', 'tomcat_attachment/attachment 25291.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1456, '43642', '5', 'Created  attachment 25292   [details] \nPatch against Tomcat trunk', 'Ruediger Pluem', '2010-04-14 05:15:01 UTC', 'tomcat_attachment/attachment 25292.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1457, '49045', '1', 'Created  attachment 25228   [details] \nAdding createStandardService method to MBeanFactory\n\nThis initial version of the patch adds createStandarService method. However I am having some issues with the usage of the MBean with respect to MBeanFactory. In the case of MBeanFactory both the managed resource and the associated MBean are MBeanFactory instances. But only resource MBeanFactory object is properly populated with a reference to the Server in its container field. The associated MBean instance which gets registered in the MBean Server (created by JMX infrastructure) doesn\'t get populated with this field since it is being created using reflection in createMBean() method in ManagedBean class. \n\nNow when the MBean createStandardService method is invoked using JMX (which depends on container field being properly set - in this case the reference to the single Server instance) the MBean and not the managed resource is invoked causing a null pointer exception. The below code snippet in BaseModelBean causes the above behaviour.\n\n// Invoke the selected method on the appropriate object\nObject result = null;\ntry {\n    if( method.getDeclaringClass().isAssignableFrom( this.getClass()) ) {\n       result = method.invoke(this, params );\n    } else {\n       result = method.invoke(resource, params);\n    }\n}\n\nHere as can be seen the precedence is given to the MBean object instead of the associated resource object. Can somebody comment on the reason for the above logic? \n\nTo get the resource MBeanFactory instance invoked I have included a check as follows in the above condition which I think is not the way to go.\n \n if( method.getDeclaringClass().isAssignableFrom( this.getClass())\n         && !method.getDeclaringClass().equals(this.getClass()) ) {\n\nAny ideas on this issue?', 'chamith buddhika', '2010-04-04 06:24:32 UTC', 'tomcat_attachment/attachment 25228.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1458, '49045', '2', 'A couple of comments.\n\nYou should be targeting your patches at Tomcat 7 aka trunk. Please raise bugs against Tomcat 7 too.\n\nThe Factory can be associated with a Server or a Service. If it is associated with a Service it isn\'t valid to try adding another Service. That should probably throw an Exception.\n\nIf the Factory is associated with a Server then casting container to Server should work.\n\nWhy are you creating an Engine too? Only a Service should be created. Creating an Engine should be a separate method.\n\nI haven\'t looked at this in much detail but I\'d be surprised if modifying the modeler code is necessary. I\'d find a method on a bean that does work (eg the addAlias() method on a host) and see if anything is different about the way it is set up compared to the MBeanFactory.', 'Mark Thomas', '2010-04-06 21:32:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1459, '49045', '3', '(In reply to  comment #2 )\nHi Mark,\n\n> You should be targeting your patches at Tomcat 7 aka trunk. Please raise bugs\n> against Tomcat 7 too.\n\nI will raise a bug for Tomcat 7 as well.\n\n> The Factory can be associated with a Server or a Service. If it is associated\n> with a Service it isn\'t valid to try adding another Service. That should\n> probably throw an Exception.\n\nHere what I was thinking was since technically a Server can contain more than one service that it would be possible to add another service to the server associated with the current service component in the MBeanFactory. I will change it to throw an exception.\n\n> Why are you creating an Engine too? Only a Service should be created. Creating\n> an Engine should be a separate method.\n\nPlease correct me if I am wrong here. Since one service is always mapped only to one Engine component it would be not possible to use an existing registered Engine component with the newly created service without any side effects. Hence the creation of a brand new engine within the new service. I saw this has been done in the removed codes using ServerFactory as well. Another option would be that user can seperately create an Engine component prior to Service creation and register it and then use it to create the new Service. I will add a separate method to create an Engine component in that case.\n\n> I haven\'t looked at this in much detail but I\'d be surprised if modifying the\n> modeler code is necessary. I\'d find a method on a bean that does work (eg the\n> addAlias() method on a host) and see if anything is different about the way it\n> is set up compared to the MBeanFactory.\n\nI will look in to this further. \n\nThanks', 'chamith buddhika', '2010-04-07 11:45:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1460, '49045', '4', '(In reply to  comment #3 )\n> I will raise a bug for Tomcat 7 as well.\nThat wasn\'t quite what I meant. I meant that this bug should be against Tomcat 7, not Tomcat 6. I\'ll move it.\n\n> Here what I was thinking was since technically a Server can contain more than\n> one service that it would be possible to add another service to the server\n> associated with the current service component in the MBeanFactory. I will\n> change it to throw an exception.\nThere are cases where there is a service with no server. Hence the exception is the better option.\n\n> Please correct me if I am wrong here. Since one service is always mapped only\n> to one Engine component it would be not possible to use an existing registered\n> Engine component with the newly created service without any side effects. Hence\n> the creation of a brand new engine within the new service. I saw this has been\n> done in the removed codes using ServerFactory as well. Another option would be\n> that user can seperately create an Engine component prior to Service creation\n> and register it and then use it to create the new Service. I will add a\n> separate method to create an Engine component in that case.\nYou are correct that there is a 1 to 1 mapping between service and engine. For simplicity, I\'d still keep them separate.', 'Mark Thomas', '2010-04-07 19:20:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1461, '49045', '5', '***  Bug 49062  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2010-04-07 19:20:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1462, '49045', '6', 'Ping. When do you expect to have an updated patch?', 'Mark Thomas', '2010-04-12 17:58:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1463, '49045', '7', 'Created  attachment 25277   [details] \nAdding createStandardService method to MBeanFactory\n\nSorry for the delay. I was busy summing up some other work. I have been looking more in to the issue of MBeanFactory.The issue was caused by the fact that MBeanFactory itself being a BaseModelBean unlike other normal classes such as StandardService etc. Although it extends BaseModelBean it doesn\'t utilise any of its inherited methods and it being a BaseModelBean is not leveraged in any other point in the sources. So I suggest removing \'is a\' relationship between MBeanFactory and BaseModelBean and make MBeanFactory a normal class which can be managed using a BaseModelBean object. It solves the issue that both managed resource and the mbean being instances of the same class, a situation which is unique to MBeanFactory.\n\nIn this patch I have reversed the changes made to the modeler code in order to overcome the earlier issue. And additionally separate create method has been added to create an Engine component.', 'chamith buddhika', '2010-04-13 07:32:51 UTC', 'tomcat_attachment/attachment 25277.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1464, '49086', '1', 'Created  attachment 25253   [details] \nJavadoc patch for WebListener annotation', 'Pid', '2010-04-11 16:46:32 UTC', 'tomcat_attachment/attachment 25253.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1465, '49086', '2', 'Created  attachment 25254   [details] \nJavadoc patch for WebInitParam annotation', 'Pid', '2010-04-11 16:47:58 UTC', 'tomcat_attachment/attachment 25254.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1466, '49086', '3', 'Created  attachment 25255   [details] \nJavadoc patch for WebFilter annotation', 'Pid', '2010-04-11 16:48:32 UTC', 'tomcat_attachment/attachment 25255.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1467, '49086', '4', 'Created  attachment 25256   [details] \nJavadoc patch for ServletSecurity annotation', 'Pid', '2010-04-11 16:49:32 UTC', 'tomcat_attachment/attachment 25256.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1468, '49086', '5', 'Created  attachment 25257   [details] \nJavadoc patch for MultipartConfig annotation', 'Pid', '2010-04-11 16:50:18 UTC', 'tomcat_attachment/attachment 25257.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1469, '49086', '6', 'Created  attachment 25258   [details] \nJavadoc patch for HttpMethodConstraint annotation', 'Pid', '2010-04-11 16:51:17 UTC', 'tomcat_attachment/attachment 25258.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1470, '49086', '7', 'Created  attachment 25259   [details] \nJavadoc patch for HttpConstraint annotation', 'Pid', '2010-04-11 16:51:54 UTC', 'tomcat_attachment/attachment 25259.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1471, '49086', '8', 'Created  attachment 25260   [details] \nJavadoc patch for HandlesTypes annotation', 'Pid', '2010-04-11 16:52:41 UTC', 'tomcat_attachment/attachment 25260.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1472, '48717', '1', 'Confirmed and fixed in trunk for 7.0.x\n\nI have proposed the same fix for 6.0.x and 5.5.x', 'Mark Thomas', '2010-03-28 19:42:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1473, '48717', '2', 'This has been fixed in 6.0.x and will be included in 6.0.27 onwards.', 'Mark Thomas', '2010-05-05 17:54:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1474, '48717', '3', 'Is there any chance you\'ll also be backporting to 5.5.x as well?\n\nAppreciate the updates...', 'David Rees', '2010-05-05 18:01:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1475, '48717', '4', 'As per  comment #1 , it has been proposed for 5.5.x. When it gets enough votes, it will be committed.', 'Mark Thomas', '2010-05-05 18:05:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1476, '48717', '5', 'This has been fixed in 5.5.x and will be included in 5.5.30 onwards.', 'Mark Thomas', '2010-05-18 13:17:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1477, '48717', '6', 'I never got a chance to test that this was fixed until now, but testing on 5.5.32 still does not appear to work.\n\nHow I\'m testing:\n\nTwo Linux systems running Tomcat 5.5.32 with a Cluster defined in the Host section like this:\n\n<Cluster className=\'org.apache.catalina.cluster.tcp.SimpleTcpCluster\' receiver.sendAck=\'false\' sender.waitForAck=\'false\' sender.doTransmitterProcessingStats=\'true\' sender.queueDoStats=\'true\' sender.queueTimeWait=\'true\'>\n<Valve className=\'org.apache.catalina.cluster.tcp.ReplicationValve\' filter=\'.* .gif;.* .js;.* .jpg;.* .png;.* .htm;.* .html;.* .css;.* .txt;\'/>\n<Valve className=\'org.apache.catalina.cluster.session.JvmRouteBinderValve\' enabled=\'true\'/>\n<ClusterListener className=\'org.apache.catalina.cluster.session.ClusterSessionListener\'/>\n<ClusterListener className=\'org.apache.catalina.cluster.session.JvmRouteSessionIDBinderListener\'/>\n</Cluster>\n\nThe application has a <listener><listener-class> defined in the web.xml which implements ServletContextListener and HttpSessionListener.  The HttpSessionListener methods work fine on each node.\n\nThe application adds an attribute to a session which implements HttpSessionActivationListener, HttpSessionBindingListener and Serializable.  The HttpSessionBindingListener methods work fine on each node.\n\nWhen restarting a node, the session attribute never receives any calls to sessionDidActivate when that node comes back online.\n\nLet me know if you need any more details.', 'David Rees', '2011-02-09 19:29:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1478, '48717', '7', 'Created  attachment 26679   [details] \nAdds sessionDidActivate calss\n\nThe previous fix handled session creation/destruction but not activation', 'Mark Thomas', '2011-02-18 06:45:45 UTC', 'tomcat_attachment/attachment 26679.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1479, '48717', '8', 'Thanks - so I guess to test this I\'d have to apply the patch to Tomcat source and build it myself?', 'David Rees', '2011-02-24 17:48:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1480, '48717', '9', '\'fraid so.', 'Mark Thomas', '2011-02-24 17:52:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1481, '48760', '1', 'An exact duplicate already exists, so no need to open a new bug. Mark\'s comments are also perfectly sensible, don\'t you agree ?\n\n*** This bug has been marked as a duplicate of  bug 45601  ***', 'Remy Maucherat', '2010-02-17 22:07:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1482, '48760', '2', '(In reply to  comment #1 )\n> An exact duplicate already exists, so no need to open a new bug. Mark\'s\n> comments are also perfectly sensible, don\'t you agree ?\n> \n> *** This bug has been marked as a duplicate of  bug 45601  ***\n\nThat bug was resolved invalid, and none of the response comments are helpful or correct in any way. This IS an issue, and it\'s reproducible. The original poster did not give a reproducible scenario, and I believe I have. As such, I believe that the previous ticket should be reopened with this exact test scenario as proof of the bug (high load, large binary file), or this ticket should stay open as it stands.\n\nThis bug is critically damaging our successful deployment under Tomcat, and it\'s something that needs to be resolved, rather than closed because those involved don\'t understand the problem. A reproducible bug is a bug whether it is understandable or not.', 'Stefan Kendall', '2010-02-17 23:04:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1483, '48760', '3', '(In reply to  comment #2 )\n> This IS an issue, and it\'s reproducible.\n\nBeing reproducible is not sufficient, on its own, to make it a Tomcat bug. There are plenty of other possible causes. Please see  https://issues.apache.org/bugzilla/show_bug.cgi?id=45601#c3  and follow the advice there.', 'Mark Thomas', '2010-02-17 23:17:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1484, '48760', '4', '(In reply to  comment #3 )\n> (In reply to  comment #2 )\n> > This IS an issue, and it\'s reproducible.\n> \n> Being reproducible is not sufficient, on its own, to make it a Tomcat bug.\n> There are plenty of other possible causes. Please see\n>  https://issues.apache.org/bugzilla/show_bug.cgi?id=45601#c3  and follow the\n> advice there.\n\nThe only advice is this:\n\n\'A Google search suggests that a lack of OS resources could also be a cause of\nthis error. Given that the environment is highly threaded, and taking this to\nalso mean highly loaded, this looks more like a JVM/OS issue to me.\'\n\nResource usage is next to nothing on the servers I\'ve run against. Furthermore, even if this is an OS/JVM issue, will you simply drop all claims of support for Solaris? I\'ve tested against multiple JVM versions, and this does not seem to affect the performance of Tomcat. This may only be an issue with Solaris, but if the price of Solaris support is a \'a negligible performance impact\', then why not implement the fix, noting that it only corrects the Solaris environment? Not integrating a fix because it \'should work\' is absurd from a practical, \'my-business-application-really-needs-to-work-or-I\'ll-lose-money\' mindset.\n\nYou claim that the fix would exacerbate the issue, which it did not. Clearly, the issue is not well-enough understood to make such sweeping statements. I do not have the time to spend the next month researching the internals of Tomcat and Solaris to understand why this specific test scenario fails repeatedly. As an pragmatic person, I fail to understand why a clear solution for a popular server operating system backed by Sun with a slow release cycle with minimal negative impact would be rejected.\n\nI claim that unless someone can prove that the fix is explicitly harmful, with actual test data, the fix should be implemented, as it has been proven explicitly helpful with actual test data.\n\nIs this not a rational argument?', 'Stefan Kendall', '2010-02-17 23:33:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1485, '48760', '5', 'What the patch will do is that it disables the content cache, which is used for small files. As a result, only big files will be accessed, and apparently your great/mature/stable OS does not like that usage pattern.', 'Remy Maucherat', '2010-02-17 23:59:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1486, '48760', '6', ' https://issues.apache.org/bugzilla/show_bug.cgi?id=45601#c3  sets out the circumstances under which the patch would be applied and points to a resource to help figure out the necessary information. If you choose not to go down that route, that is your choice.\n\nWithout an understanding of why the problem occurs and how the patch addresses it there is no certainty that the root cause will be fixed or that other users won\'t see regressions.\n\nGiven the patch does address it for you, there are ways to reduce the burden of running a patched Tomcat version to no more than a couple of minutes of additional work per upgrade. Again, the users list can help with this.', 'Mark Thomas', '2010-02-18 00:01:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1487, '48760', '7', '(In reply to  comment #5 )\n> What the patch will do is that it disables the content cache, which is used for\n> small files. As a result, only big files will be accessed, and apparently your\n> great/mature/stable OS does not like that usage pattern.\n\nI have no particular fondness for Solaris, but I\'m not a fool. I understand that it\'s a major server OS, and for it to simply \'not-be-supported\' is completely unacceptable. If the benefits of the fix (removes complete breakage) outweighs the costs of implementing the fix (negligable performance loss, solvable with bigger hardware?), then I think the fix should be implemented.\n\nTell me how my argument is incorrect, please.', 'Stefan Kendall', '2010-02-18 00:03:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1488, '48760', '8', '(In reply to  comment #6 )\n>  https://issues.apache.org/bugzilla/show_bug.cgi?id=45601#c3  sets out the\n> circumstances under which the patch would be applied and points to a resource\n> to help figure out the necessary information. If you choose not to go down that\n> route, that is your choice.\n> \n> Without an understanding of why the problem occurs and how the patch addresses\n> it there is no certainty that the root cause will be fixed or that other users\n> won\'t see regressions.\n> \n> Given the patch does address it for you, there are ways to reduce the burden of\n> running a patched Tomcat version to no more than a couple of minutes of\n> additional work per upgrade. Again, the users list can help with this.\n\nMark, I will address your concerns in turn.\n\n1.) This is clearly an issue *with Tomcat*. For every person that chooses to serve a large file through Tomcat, should they also lose months of productivity to obscure, hard to trace down bugs that have been documented and reproduced? As network connections and bandwidth continually improve, the chance that businesses choose to send down bigger, richer files is likely to increase (think larger images, swfs, etc.). As such, this is clearly an issue if Tomcat expects to continue being a viable Servlet container. Tomcat solves a number of problems for a number of people, but if it cannot support the growing trends in web development (more data, richer data), then surely it will fail. Failing to address this issue not only hurts the product as a whole, but it sets a dangerous precedent for all future bug finds.\n\n2.) Would you like performance metrics with a week of constant load, or real world usage data to confirm my claims? I can provide all of that, but as I am not a Tomcat developer, I cannot give you a mathematical proof as to why the fix works. The original posters ideas were discarded, so I cannot say why exactly the fix works. I do know, however, that for two built deployments of Tomcat 1.6.16->latest, one with the fix and one without, I can reliably reproduce the problem on the unpatched version with load generation tools (and wget), and I cannot reproduce the problem on the patched version (even with  unrealistically high load).\n\n3.) So then, you agree that there\'s a simple solution to the root cause of my problem, and it\'s a small change to the source base? As an application developer, I cannot suddenly become responsible for the entirety of the Tomcat code base. If you extend this scenario, any small problem *you* or *I* can not understand thoroughly should be self-maintained, correct? As problems increase, the reliability of the main Tomcat distribution would then become questionable. \n\nConclusion:\n\nI submit that unless the problem can be proven harmful (via whatever automated test systems currently exist, or real life usage data), then the patch should be implemented. If no such tests exist, or no one can prove the patch harmful to the stability of Tomcat, then why not implement? There is a strong business case to implement the patch, and there is a weak case against implementation. \n\nIf this does cause regressions for any party, then they can log an issue as I did. Remember that the optimization has not always existed, so at some point, the implementation of the optimization DID cause regressions, but you just didn\'t see it. This optimization removal would be an undoing of a -problem- introduced into the tomcat source in 5.5, rather than an out-of-nowhere fix that may cause issues. Regressions weren\'t a concern in 5.5, and they shouldn\'t be a concern now, when real data is involved to prove the fix viable and the previous optimization unstable.', 'Stefan Kendall', '2010-02-18 00:21:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1489, '48760', '9', 'Une cacheObjectMaxSize=\'0\' on the Context element and stop wasting your time posting nonsense ...', 'Remy Maucherat', '2010-02-18 00:34:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1490, '48760', '10', '(In reply to  comment #9 )\n> Une cacheObjectMaxSize=\'0\' on the Context element and stop wasting your time\n> posting nonsense ...\n\nRemy, your comment does not make sense.\n\nAs per the documentation, files over 512KB are not cached (default setting). My file is 1.8MB large; I stated this in my initial bugpost.\n\nDocs:\n http://tomcat.apache.org/tomcat-6.0-doc/config/context.html \n\nFurthermore, I even tried this supposed fix (although it made no sense given the documentation), and it did not work. The only fix for this issue, still, is to remove the \'optimization\' introduced in Tomcat 5-5.', 'Stefan Kendall', '2010-02-18 17:01:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1491, '48760', '11', ' gfuser9999@yahoo.co.uk  has presented a reasoned explanation of what is happening below. Apparently, this is a problem that needs to be backported from Glassfish.\n\nI\'ve copied the e-mail below:\n\nNow, really the REAL bug fix in Tomcat you need to port \nback from\n Glassfish is actually this \n\n http://fisheye5.cenqua.com/changelog/glassfish?cs=SJSAS91_FCS_BRANCH%3Asultal%3A20080904082511 \n\nThis is the actual root cause for 45601 which is not\nupdated back to Tomcat bug entry in the late 2008 but \nthis is the RCA and is fixed in SUN Glassfish Application\nserver (where they share the same common TC code).\n\n--------------------------\nHere\'s the salient point:\n--------------------------\n0. You notice the issue happens in DefaultServlet copyRange\n   as all your submitters submit\n\n- The code all do something like this\n   InputStream resourceInputStream \n      = cacheEntry.resource.streamContent();\n\n1. So they all take a FileResource/Resource from\n   a cache entry  (which is looked up from some cache)\n\n2. Now We know that this is a FileResource (static resource)\n\n3. Finally most of the code will have this\n\n   reader = new\n InputStreamReader(resourceInputStream,\n                               fileEncoding);\n   copyRange(reader,....) <-- do something\n   reader.close();\n\n4.\n Now, you notice that reader.close() will CLOSE\n   the underlying FileInputStream when it is run.\n\n5. Hence, there is a SUBTLE race in FileResource.streamContent\n   where a TWO or more threads get the SAME InputStream.\n   This is due to the FACT that multiple requests can\n   get hold of the same cached entry and hence due to\n   the BAD way the FileResource streamContent stuff the\n   InputStream to a temp instance variable.. \n\n   Due to MT scheduling (it is possible to get a MT schedule\n   where two threads gets the some common InputStream.)\n   [Please see TC code to see why this can happen]\n\nTesting?\n------------\nIt is easy to ARTIFICIALLY reproduce & to confirm\nYou can slow things down in the\n FileResource.streamContent()\nby putting delays and etc (or also printing\nthe resulting InputStream in the copy while\ndoing two or more parallel wget for the same\nFileResource of filesize of some large MB to see.', 'Stefan Kendall', '2010-02-18 20:02:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1492, '48760', '12', 'Bingo. That looks like the sort of analysis that is needed to move this forward. Re-opening to take a look at this potential race condition.\n\nNote that we can\'t just copy the Glassfish patch without jumping through some legal licensing hoops that I\'d prefer to avoid.', 'Mark Thomas', '2010-02-18 20:26:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1493, '48760', '13', 'Based in the analysis in  comment 11 , I can see a couple of places where there is a problem. These have been fixed in trunk and the patch proposed for 6.0.x and 5.5.x ( http://svn.apache.org/viewvc?rev=920858&view=rev )\n\nStefan: Are you able to confirm that using this patch rather than the one in  bug 45601  still fixes the issue for you? I remain concerned that you may be seeing a different issue as I can\'t see a reason, apart from just altering the execution timing, why the  bug 45601  patch should fix / work around the issue described in  comment 11 .', 'Mark Thomas', '2010-03-09 13:40:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1494, '48760', '14', '(In reply to  comment #13 )\n> Based in the analysis in  comment 11 , I can see a couple of places where there\n> is a problem. These have been fixed in trunk and the patch proposed for 6.0.x\n> and 5.5.x ( http://svn.apache.org/viewvc?rev=920858&view=rev )\n> \n> Stefan: Are you able to confirm that using this patch rather than the one in\n>  bug 45601  still fixes the issue for you? I remain concerned that you may be\n> seeing a different issue as I can\'t see a reason, apart from just altering the\n> execution timing, why the  bug 45601  patch should fix / work around the issue\n> described in  comment 11 .\n\nThe fix seemed to slow the issue, but further testing indicated that this problem was still caused with the patch in 45601. This may have been specific to the timing of our specific system; changing code willy-nilly would alter the frequency at which we would see issues. It\'s good to hear that a *true* fix has been proposed for 5.5.x/6.0.x .', 'Stefan Kendall', '2010-03-09 15:12:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1495, '48760', '15', 'Thanks for that feedback on the patch in  bug 45601 . That does make it more likely the issue you are seeing is fixed by the patch in  r920858  but you obviously need to test that yourself to be 100% sure.', 'Mark Thomas', '2010-03-09 15:18:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1496, '48760', '16', 'The patch ( r920858 ) was applied to Tomcat 5.5, will be in 5.5.29 onwards.', 'Konstantin Kolinko', '2010-03-10 22:45:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1497, '48760', '17', '(In reply to  comment #16 )\n> The patch ( r920858 ) was applied to Tomcat 5.5, will be in 5.5.29 onwards.\n\n r920858  definitively solves our problem. Is there an estimate for when this will be available in a stable release of 6.0.x?', 'Stefan Kendall', '2010-03-25 18:01:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1498, '48760', '18', '(In reply to  comment #17 )\nIt is already proposed for 6.0 (see the STATUS file in svn). All that is needed is 1) third vote from some committer so that it can be applied, 2) wait for the release to happen, 3) test the release to ensure that it is stable.', 'Konstantin Kolinko', '2010-03-25 18:27:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1499, '48760', '19', '(In reply to  comment #18 )\n> (In reply to  comment #17 )\n> It is already proposed for 6.0 (see the STATUS file in svn). All that is needed\n> is 1) third vote from some committer so that it can be applied, 2) wait for the\n> release to happen, 3) test the release to ensure that it is stable.\n\nGood to know. Thanks!', 'Stefan Kendall', '2010-03-25 18:33:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1500, '48737', '1', 'Thanks for the patch.\n\nThis has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2010-03-09 12:34:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1501, '48737', '2', '(In reply to  comment #1 )\n> Thanks for the patch.\n> \n> This has been fixed in trunk and proposed for 6.0.x\n\ngreat! Can you tell if it has been included in 6.0.26? I couldn\'t find a good way to guess this from bugzilla...', 'Fabrizio Giustina', '2010-03-16 14:42:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1502, '48737', '3', 'That would be what the 6.0.26 change log is for.', 'Mark Thomas', '2010-03-16 15:15:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1503, '48737', '4', '(In reply to  comment #3 )\n> That would be what the 6.0.26 change log is for.\n\nyou are right, I\'m too used with the \'fixed versions\' in jira...\n\nso it\'s not in 6.0.26, any chance to see it in a 6.0.x release soon? Thanks', 'Fabrizio Giustina', '2010-03-21 19:10:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1504, '48582', '1', 'I should also have noted that after this NullPointerException occurs, we then continue to get this error over and over:\n\nERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[localhost].[/d].[jsp]] Servlet.service() for servlet jsp threw exception\n\'java.lang.NoClassDefFoundError: org/apache/jsp/tag/meta/internal_002dtitle_tag\n\npresumably for the JSP tag file whose compilation failed.  I don\'t know if that\'s the behavior you want, as the error is pretty cryptic.  You may want something more explicit like \'compilation of this JSP failed\'?', 'Tim McCune', '2010-01-20 13:28:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1505, '48582', '2', 'I just confirmed that this issue still affects the latest version (6.0.24).', 'Tim McCune', '2010-01-25 14:48:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1506, '48582', '3', 'Fixed in 7.0.x and proposed for 6.0.x', 'Mark Thomas', '2010-02-16 11:08:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1507, '48580', '1', '***  Bug 48438  has been marked as a duplicate of this bug. ***', 'Konstantin Kolinko', '2010-01-20 12:02:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1508, '48580', '2', 'Created  attachment 24866   [details] \nlocalhost.2010-01-20.log\n\nThe stack trace with an AccessControlException and with NoClassDefFoundError errors when trying to refresh that failing page.', 'Konstantin Kolinko', '2010-01-20 12:09:18 UTC', 'tomcat_attachment/attachment 24866.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1509, '48580', '3', 'Reproduced in 6.0.24 with 6u18 and 6u16 JREs.\nReproduced in 6.0.20 with 6u18 and 6u17 JREs and catalina.policy file from 6.0.24. So, technically, it is not a regression.', 'Konstantin Kolinko', '2010-01-20 13:43:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1510, '48580', '4', 'This has been fixed in 7.0.x and proposed for 6.0.x', 'Mark Thomas', '2010-02-16 09:29:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1511, '48580', '5', 'This has been fixed in 6.0.x and will be included in 6.0.25 onwards.', 'Mark Thomas', '2010-02-22 21:19:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1512, '48580', '6', 'Observing this issue with the current tc5.5.x of  revision 919529 \nat the following pages of jsp-examples webapp:\n\n http://localhost:8080/jsp-examples/jsp2/el/implicit-objects.jsp?foo=bar \n\n http://localhost:8080/jsp-examples/jsp2/el/functions.jsp?foo=JSP+2.0 ', 'Konstantin Kolinko', '2010-03-05 21:45:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1513, '48580', '7', 'Created  attachment 25089   [details] \nlocalhost.2010-03-06.log from tomcat 5.5.x', 'Konstantin Kolinko', '2010-03-05 21:49:45 UTC', 'tomcat_attachment/attachment 25089.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1514, '48580', '8', 'Created  attachment 25094   [details] \n2010-03-06_tc55_bug48580.patch -- backport of  r915070 \n\nTC 5.5 patch for the issue. It is a backport of  r915070 .', 'Konstantin Kolinko', '2010-03-06 14:18:14 UTC', 'tomcat_attachment/attachment 25094.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1515, '48498', '1', 'Created  attachment 24809   [details] \n/webapps/examples/jsp/jsp2/jspx/basic.jspx\n\nOne more example - a JSP page.\n\nLocation: /webapps/examples/jsp/jsp2/jspx/basic.jspx\nHTTP Address:  http://localhost:8080/examples/jsp/jsp2/jspx/basic.jspx \n\nDisplays\n java.lang.ArrayIndexOutOfBoundsException: 57', 'Konstantin Kolinko', '2010-01-06 19:47:10 UTC', 'tomcat_attachment/attachment 24809.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1516, '48498', '2', 'Reproducible in 6.0.20.\nSo, it is not a regression in the current 6.0.x.\n\n\nIf anyone encounters this, one way to find where it failed is to search in the /work directory for a *.java file that does not have *.class file of the same name. That matches to a jsp or tag file that failed to compile.', 'Konstantin Kolinko', '2010-01-13 17:00:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1517, '48498', '3', 'This is not a Tomcat but, but a bug in the SAX Parser provided by the JDK. Local testing shows:\n1.5.0_22_x64 - works\n1.6.0_16_x64 - ArrayIndexOutOfBoundsException\n1.7.0_b76_x64 - ArrayIndexOutOfBoundsException\n\nThe bug is that in LexicalHandler.startCDATA() the Locator points to the end of the CDATA section rather than the start. This will always lead to misleading JSP snippets any may result in an ArrayIndexOutOfBoundsException if the CDATA block is close enough to the end of the JSP file.\n\nI have reported the bug to Sun and am awaiting a public bug number. I\'ll update this issue when I get it.\n\nYou can use Xerces 2.9.1 to override the default SAX Parser provided by the JDK to work around this bug if required.\n\nI looked at providing a work around in Tomcat but correctly handling the behaviour of different JDKs with and without Xerces overriding was getting just too messy to be worth while.', 'Mark Thomas', '2010-02-15 16:42:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1518, '48498', '4', 'Reopening. Even if we cannot fix/workaround the root cause, at least we can add bounds checking to JavacErrorDetail constructor.\n\nThe sad outcome of this issue was that when this ArrayIndexOutOfBoundsException error occurs, there is no information in the stack trace about what JSP or Tag file caused this issue.\n\nEven if we cannot display the source lines, it would be nice to display all other details.', 'Konstantin Kolinko', '2010-02-15 17:53:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1519, '48498', '5', 'As much as it pains me to have to add a workaround in Tomcat for a Java bug you have a fair point that hiding the compilation error is a nasty side-effect.\n\nWorkaround added to 7.0.x and proposed for 6.0.x', 'Mark Thomas', '2010-02-16 00:48:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1520, '48371', '1', 'Can you provide step-by-step instructions, how to reproduce it on a fresh instance of Tomcat?', 'Konstantin Kolinko', '2009-12-22 19:23:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1521, '48371', '2', 'In the webapp\'s web.xml, have display-name and then description.  Before the listener, include the snippet below(commented out).\n\nRun an ANT script to precompile JSPs:\n\n<import file=\'${tomcat.home}/bin/catalina-tasks.xml\'/>\n<jasper validateXml=\'false\'\n                uriroot=\'${work.core}\'\n                webXmlFragment=\'${jsp.generated.web.xml}\'\n                addWebXmlMappings=\'true\'\n                outputDir=\'${work.src}\'/>\n\nThe resulting web.xml ${jsp.generated.web.xml} is malformed.\n\nHere is the snippet from the web.xml before instructing jasper to addWebXmlMappings.\n\n  <!--\n    <security-constraint>\n        <web-resource-collection>\n            <web-resource-name>Entire Application</web-resource-name>\n            <url-pattern>/*</url-pattern>\n        </web-resource-collection>\n        <user-data-constraint>\n            <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n        </user-data-constraint>\n    </security-constraint>\n    -->\n\n    <!--<security-constraint>\n        <web-resource-collection>\n            <web-resource-name>Deny Direct Access</web-resource-name>\n            <description>Deny direct access to JSPs. All such requests should be\n                handled by the Container in the protection domain\n            </description>\n            <url-pattern>*.jsp</url-pattern>\n        </web-resource-collection>\n        <auth-constraint>\n            <role-name>NoOneCanAccess</role-name>\n        </auth-constraint>\n    </security-constraint>\n    <security-role>\n        <role-name>NoOneCanAccess</role-name>\n    </security-role>-->\n\n\n    <!-- modify in web.xml in tomcat/conf/\n   <servlet>\n       <servlet-name>jsp</servlet-name>\n       <servlet-class>org.apache.jasper.servlet.JspServlet</servlet-class>\n       <init-param>\n           <param-name>fork</param-name>\n           <param-value>false</param-value>\n       </init-param>\n       <init-param>\n           <param-name>xpoweredBy</param-name>\n           <param-value>false</param-value>\n       </init-param>\n       <init-param>\n           <param-name>compilerSourceVM</param-name>\n           <param-value>1.5</param-value>\n       </init-param>\n       <init-param>\n           <param-name>compilerTargetVM</param-name>\n           <param-value>1.5</param-value>\n       </init-param>\n       <load-on-startup>3</load-on-startup>\n   </servlet> -->', 'Lee Clemens', '2009-12-24 09:29:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1522, '48371', '3', 'This has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2010-02-13 19:24:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1523, '48170', '1', '(In reply to  comment #0 )\n> I have a soak test at constant load that is initially stable.  Within the hour,\n> an ever increasing number of blocked threads develops.  The vast majority of\n> threads are in JSP rendering, blocked on JspFactory.getDefaultFactory().\n> \n> The server eventually crashes.\n> \n> We are running Java 6.\n> \n> Upon code inspection, there appears to be no real reason for synchronizing the\n> getDefaultFactory() and setDefaultFactory() as the setter is called only once\n> upon startup when the sub-class loads.\n\nIn which case, the setter should be package-protected?\n\n> Patching the jar, I tried three other experiments:\n> 1) Removing the synchronized keyword entirely.\n> 2) Locking on an inner static class instead of the JspFactory.class.\n> 3) Using volatile for the static member variable.\n> \n> Both experiments #1 and #3 showed vastly better stability.  I was able to\n> double the throughput of the server without seeing increasing number of blocked\n> threads.\n> \n> Experiment #2 yielded the same behavior as the original code.  Thus, no other\n> code\n> is synchronizing on JspFactory.class.  Rather, there seem to be some sort of\n> contention in the java.lang.Class monitor.\n> \n> Using volatile would preserve the multi-threading semantics while avoiding\n> contributing to the instability issue.\n\nMight be worth trying synch. on a private static lock Object instead of an inner class?\n\nIf the JspFactory class can be loaded after the JspRuntimeContext class, then JspRuntimeContext could store the factory as a static final field which could be accessed by JspFactory on startup.\n\nOr indeed, do away with setDefaultFactory() and have getDefaultFactory() return the static final value from JspRuntimeContext?', 'Sebb', '2009-11-11 03:09:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1524, '48170', '2', '(In reply to  comment #1 )\n> (In reply to  comment #0 )\n> > I have a soak test at constant load that is initially stable.  Within the hour,\n> > an ever increasing number of blocked threads develops.  The vast majority of\n> > threads are in JSP rendering, blocked on JspFactory.getDefaultFactory().\n> > \n> > The server eventually crashes.\n> > \n> > We are running Java 6.\n> > \n> > Upon code inspection, there appears to be no real reason for synchronizing the\n> > getDefaultFactory() and setDefaultFactory() as the setter is called only once\n> > upon startup when the sub-class loads.\n> \n> In which case, the setter should be package-protected?\n\nSorry, that\'s nonsense - different packages.\n\n> > Patching the jar, I tried three other experiments:\n> > 1) Removing the synchronized keyword entirely.\n> > 2) Locking on an inner static class instead of the JspFactory.class.\n> > 3) Using volatile for the static member variable.\n> > \n> > Both experiments #1 and #3 showed vastly better stability.  I was able to\n> > double the throughput of the server without seeing increasing number of blocked\n> > threads.\n> > \n> > Experiment #2 yielded the same behavior as the original code.  Thus, no other\n> > code\n> > is synchronizing on JspFactory.class.  Rather, there seem to be some sort of\n> > contention in the java.lang.Class monitor.\n> > \n> > Using volatile would preserve the multi-threading semantics while avoiding\n> > contributing to the instability issue.\n> \n> Might be worth trying synch. on a private static lock Object instead of an\n> inner class?\n\nThat might perhaps help.\n\n> If the JspFactory class can be loaded after the JspRuntimeContext class, then\n> JspRuntimeContext could store the factory as a static final field which could\n> be accessed by JspFactory on startup.\n> \n> Or indeed, do away with setDefaultFactory() and have getDefaultFactory() return\n> the static final value from JspRuntimeContext?\n\nThat\'s nonsense too.', 'Sebb', '2009-11-11 03:13:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1525, '48170', '3', 'The simplest approach is to change the static member variable declaration:\n\nprivate static volatile JspFactory deflt = null;\n\nand then remove the synchronized keyword on the getter/setter.\n\nThis preserves the existing multi-threaded guarantees while not incurring the monitor overhead.  If effect, exchanging a monitor for a memory latch.', 'Earl Nolan', '2009-11-11 09:27:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1526, '48170', '4', 'Fixed in trunk and proposed for 6.0.x\n\nNote as a part of the JSP API, the changes permitted are limited.', 'Mark Thomas', '2010-02-08 14:24:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1527, '48643', '1', 'There are similar problems in session.StandardManager.doUnload():\n\nline 502, 530, and at line 542 there\'s a block of code:\n\n// Flush and close the output stream\ntry {\n    oos.flush();\n    oos.close();\n    oos = null;\n} catch (IOException e) {\n    if (oos != null) {\n        try {\n            oos.close();\n        } catch (IOException f) {\n            // Ignore\n        }\n        oos = null;\n    }\n    throw e;\n}\n\nThis code looks as though it is trying to close() oos if the flush() fails, but it will also try to close() oos if the close() fails.\n\nProbably the first oos.close() should be removed. \nAFAICT, there is also no need to set the oos field to null.', 'Sebb', '2010-01-30 17:10:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1528, '48643', '2', '(In reply to  comment #0 )\n> Note: these bugs were detected by the Eclipse compiler.\n\nI think it is pointless to try to please Eclipse IDE here. That \'possible null access check\' is an optional feature (off by default), depends on the version of IDE that you are using, and also buggy at times, as I experiences just recently (it gave me contradictory tips regarding \'unnecessary null check\' for one line, and then \'possible null pointer access\' for the same variable few lines later). Then some other tool will start complaining that we have not closed a stream there...\n\n\nBack to the code: I\'ll agree that you are right that first oos.close(); is actually never called,  but I do not think we need to close fos here.\n\nI do not see what can fail in the \'new ObjectOutputStream(new BufferedOutputStream(fos))\' line, besides maybe an OutOfMemoryError.\n\nAs of now, the code is easier to read, even if it is redundant.', 'Konstantin Kolinko', '2010-01-30 17:49:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1529, '48643', '3', '(In reply to  comment #2 )\n> (In reply to  comment #0 )\n> > Note: these bugs were detected by the Eclipse compiler.\n> \n> I think it is pointless to try to please Eclipse IDE here. That \'possible null\n> access check\' is an optional feature (off by default), depends on the version\n> of IDE that you are using, and also buggy at times\n\nIt\'s not a question of trying to \'please\' Eclipse. \nIt has reported a possible error; in this case manual inspection shows that it was correct to do so.\n\n> Back to the code: I\'ll agree that you are right that first oos.close(); is\n> actually never called,  but I do not think we need to close fos here.\n\nIn which case I think the try catch block can be removed entirely.\n\n> I do not see what can fail in the \'new ObjectOutputStream(new\n> BufferedOutputStream(fos))\' line, besides maybe an OutOfMemoryError.\n\nAgreed. So why try to close oos?\n\n> As of now, the code is easier to read, even if it is redundant.\n\nDisagree - it\'s confusing to have code that cannot be executed.', 'Sebb', '2010-01-31 03:23:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1530, '48516', '1', 'Created  attachment 24825   [details] \nPatch to fix NPE', 'Kevin Conaway', '2010-01-11 05:46:00 UTC', 'tomcat_attachment/attachment 24825');
INSERT INTO `tomcatbeforefixcomments` VALUES (1531, '48516', '2', 'Many thanks for the patch. It has been applied to trunk and proposed for 6.0.x and 5.5.x.', 'Mark Thomas', '2010-01-12 14:46:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1532, '48516', '3', 'Thanks again for the patch. It has been applied to 6.0.x and will be included in 6.0.23 onwards.', 'Mark Thomas', '2010-01-13 02:38:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1533, '48004', '1', '***  Bug 48005  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2009-10-15 11:31:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1534, '48004', '2', 'This has been fixed in trunk and proposed for 6.0.x and 5.5.x.\n\nNote that you can set the server attribute on the connector to override the default server name. I updated the HTTP connector docs to clarify how this works.', 'Mark Thomas', '2010-01-12 13:39:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1535, '48004', '3', 'The patch has been applied to 6.0.x and will be included in 6.0.23 onwards.', 'Mark Thomas', '2010-01-13 02:42:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1536, '48004', '4', 'This fix is imcomplete.\n\nThere should be a distinction between setting a header to an empty string \'\' and setting it to null (which should clear the header entirely since there is no .removeHeader() on http response).\n\nNevertheless, there is no way to completely avoid sending the \'Server\' header.\nSecurity audits fail just because of the header presence, under the assupmtion that the specific header, even if blank, is still revealing something about the server.\n\nThe solution I have is this (Http11Processor for now):\n\n1-add a field\n\'protected boolean addServerHeader = true;\'\n\n\n2-Implement the setServer() this way, to distinguish the desire to avoid the header completely. If the server.xml doesn\'t have a server property, the setServer() shouldn\'t be called and the default is to add server header.\n\n    public void setServer( String server ) {\n        if (server==null) {\n            this.server = null;\n            this.addServerHeader = true;\n        } else if (server.equals(\'\')) {\n            this.server = null;\n            this.addServerHeader = false;\n        } else {\n            this.server = server;\n            this.addServerHeader = true;\n        }\n    }\n\n\n3-At the end of prepareResponse(), conditionally add the server header:\n\n        if(addServerHeader) {\n        	if (server != null) {\n            	// Always overrides anything the app might set\n	            headers.setValue(\'Server\').setString(server);\n        	} else if (headers.getValue(\'Server\') == null) {\n            	// If app didn\'t set the header, use the default\n	            outputBuffer.write(Constants.SERVER_BYTES);\n        	}\n        }\n\n\nThis is the proper fix which at least is tomcat specific and doesn\'t break the servlet spec. I won\'t argue about the httpresponse.setHeader(\'Server\', null) since it is not specified in the servelt spec (which means it should be legal to remove the header!).', 'quartz', '2010-02-08 14:51:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1537, '48006', '1', 'This is already available in conf/web.xml - default is off since its a waste of bandwidth and a security hole. (information disclosure)', 'Tim Funk', '2009-10-15 11:41:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1538, '48006', '2', 'True that it\'s there in web.xml and even in the 5.5 version.\nI agree that it is a security hole IN PRODUCTION but for a development and test environment this is not a concern.\n\nMoreover you do not have the precise Tomcat version and the precise JVM version\n\nYou have this header\nServer	Apache-Coyote/1.1\nand this one\nX-Powered-By	JSP/2.1\n\nThis should be like IMHO to be really useful something such as\nServer	Apache-Coyote/1.1\nX-Powered-By	JSP/2.1 Tomcat/5.5.28 JRE/SUN/1.5.0_12-b04)\n\nAnd if you consider this to be a security hole then the the server header is also one and should be banned too for the same reasons.\n\nSorry to insist but the operation teams are not always what they should be and this information saves time for some development teams like mine.\n\nI am perfectly OK with a default value of \'false\' in web.xml to not show the header for the reasons mentioned by Tim.\n\nThanks to consider my point of view\n\nOlivier', 'olivier dupuy', '2009-10-15 12:01:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1539, '48006', '3', 'Note that you can modify the server header to display anything you want to.\n\nThe updated X-Powered-By header has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2009-12-31 02:47:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1540, '43819', '1', 'Created  attachment 21097   [details] \nPatch to make EL self-contained\n\nAdded patch.', 'Christoph Beck', '2007-11-08 14:52:03 UTC', 'tomcat_attachment/attachment 21097.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1541, '43819', '2', 'Comment on  attachment 21097   [details] \nPatch to make EL self-contained\n\nCDDL is not compatible with AL2 for source code.', 'Mark Thomas', '2007-11-08 15:27:46 UTC', 'tomcat_attachment/attachment 21097.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1542, '43819', '3', 'Created  attachment 21099   [details] \nnew patch\n\nSorry... Updated the patch to be pure AL2.', 'Christoph Beck', '2007-11-09 01:29:07 UTC', 'tomcat_attachment/attachment 21099.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1543, '43819', '4', 'I haven\'t tested this personally but since the patch changes the signature of a\nspec API class I would assume that this would break tck compliance until a\njsr245-MR1 tck is obtained from sun.', 'david jencks', '2007-12-18 15:56:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1544, '43819', '5', 'My reading of 245-MR1 is that it will form part of JSP 2.2. I have added some\nTomcat 7 notes to trunk and included a reference to this issue.\n\nIf I have mis-read 245-MR1 and does become part of JSP 2.1 then we can come back\nto this issue once there is a maintenance release (ie when the spec actually\nchanges).', 'Mark Thomas', '2007-12-30 14:45:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1545, '43819', '6', 'Created  attachment 21446   [details] \nJspUtil.patch\n\norg.apache.jasper.compiler.JspUtil.validateExpressions(Mark, String, Class,\nFunctionMapper, ErrorDispatcher) seems to be already obsoleted. The declared\nstatic ExpressionFactory there can be safely removed.', 'Tuomas Kiviaho', '2008-01-30 03:29:40 UTC', 'tomcat_attachment/attachment 21446.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1546, '43819', '7', 'Created  attachment 21447   [details] \nPageInfo.patch\n\nPageInfo holds ExpressionFactory instance which is only used by\nValidator.ValidateVisitor. Since PageInfo only is created in\nCompiler.generateJava and Validator.ValidateVisitor only used there the\ninstance can be safely be deprecated from PageInfo and moved to\nValidator.ValidateVisitor.', 'Tuomas Kiviaho', '2008-01-30 04:05:05 UTC', 'tomcat_attachment/attachment 21447.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1547, '43819', '8', 'Created  attachment 21448   [details] \nNode.patch\n\nThe expressionFactory reference is used in Validator.Validate to catch invalid\njsp attribute expressions by using Node.JspAttribute.validateEL which has no\nother refences to it. Almost identical approach is used validating plain\nexpressions but the validation mechanism isn\'t incorporated with the\nNode.ELExpression. By combining these two the number of expression factory\nreferences can be cut down even further.', 'Tuomas Kiviaho', '2008-01-30 06:18:05 UTC', 'tomcat_attachment/attachment 21448.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1548, '43819', '9', 'Created  attachment 21450   [details] \nValidator.patch\n\nVariableMapper is the only place at JSP compile time that requires currently\nExpressionFactory. createValueExpression is the only method in use and it\nfunctions as a factory so ExpressionBuilder can be called directly instead and\nstill achieve the same functionality as before. Cross referencing to EL\nimplementation packages existed before as well but it\'s now just moved from\nPageInfo to Validator. Main difference is that after these changes there isn\'t\nanymore an explicit reference to ExpressionFactoryImpl at JSP compile time.', 'Tuomas Kiviaho', '2008-01-30 08:42:01 UTC', 'tomcat_attachment/attachment 21450.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1549, '43819', '10', 'Created  attachment 21451   [details] \njasper.compiler.patch', 'Tuomas Kiviaho', '2008-01-30 08:55:01 UTC', 'tomcat_attachment/attachment 21451.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1550, '43819', '11', 'Created  attachment 21454   [details] \njasper.compiler.patch2\n\nSecond attempt. I missed also coercion types from Validator from the original\npost. jsr245 enforces EL syntax and semantics way beyond #{} vs. ${} that make\nit impossible to get rid of expression building. This patch and the previous\nones only concentrates the EL validation in one location, nothing more. There\nseems to be also some level of syntax check done with ELParser and EL function\nmapper and these are compiler specific classes.', 'Tuomas Kiviaho', '2008-01-30 12:37:32 UTC', 'tomcat_attachment/attachment 21454.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1551, '43819', '12', 'Re-opening to evaluate the patches as these changes did become part of JSP 2.2', 'Mark Thomas', '2009-12-30 10:31:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1552, '47744', '1', 'Created  attachment 24171   [details] \nPatch for this issue.', 'Greg Vanore', '2009-08-26 11:02:48 UTC', 'tomcat_attachment/attachment 24171.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1553, '47744', '2', 'I should add, this was observed with a 64-bit Linux server JVM.  Sun has dispatched a bug to investigate whether this is a JVM/JRE problem or not.', 'Greg Vanore', '2009-09-03 07:10:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1554, '47744', '3', 'I\'m not a big fan of trying to work around JVM bugs, but this patch looks like it is OK (once the missing synchronizing is added).  Synchronizing will add a small hit, but this part of the code is well off the critical path.', 'Bill Barker', '2009-10-25 16:56:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1555, '47744', '4', '(In reply to  comment #3 )\n> I\'m not a big fan of trying to work around JVM bugs, but this patch looks like\n> it is OK (once the missing synchronizing is added).  Synchronizing will add a\n> small hit, but this part of the code is well off the critical path.\n\nYes, I agree with everything you said, except Sun has closed and concluded it is *not* a problem with the VM:  http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6877740  \n\nA bit after posting this I revised my local copy of the patch to add synchronization - should I repost the patch to include it?', 'Greg Vanore', '2009-10-26 09:33:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1556, '47744', '5', 'Thanks for the report and the patch. I have applied a modified patch to trunk and proposed it for 6.0.x and 5.5.x.', 'Mark Thomas', '2009-12-14 06:58:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1557, '47744', '6', 'Patch has been applied to trunk and will be included in 6.0.21 onwards.', 'Mark Thomas', '2009-12-21 03:13:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1558, '47502', '1', 'StandardSession excludes the session attribute named javax.security.auth.subject from being serialized. DeltaSession does not. \n\nHere\'s what StandardSession excludes from serializing:\n    protected static final String[] excludedAttributes = {\n        Globals.SUBJECT_ATTR\n    };\n\n\nOf course ... I suspect (without a deeper code dive) that excluding this from serialization might mean that you are not logged in across the whole cluster.\n\nHow to test ...\n\nHere is the existing code in DeltaSession.writeObject\n        for (int i = 0; i < keys.length; i++) {\n            Object value = null;\n            value = attributes.get(keys[i]);\n            if (value == null)\n                continue;\n            else if (value instanceof Serializable) {\n                saveNames.add(keys[i]);\n                saveValues.add(value);\n            }\n        }\n\ntry changing it to (so we are excluding it from serialization) \n        for (int i = 0; i < keys.length; i++) {\n            Object value = null;\n            value = attributes.get(keys[i]);\n            if (value == null || exclude(keys[i]))\n                continue;\n            else if (value instanceof Serializable) {\n                saveNames.add(keys[i]);\n                saveValues.add(value);\n            }\n        }\n\n\nHERE is the patch ...\nIndex: java/org/apache/catalina/ha/session/DeltaSession.java\n===================================================================\n--- java/org/apache/catalina/ha/session/DeltaSession.java       ( revision 833086 )\n+++ java/org/apache/catalina/ha/session/DeltaSession.java       (working copy)\n@@ -731,7 +731,7 @@\n         for (int i = 0; i < keys.length; i++) {\n             Object value = null;\n             value = attributes.get(keys[i]);\n-            if (value == null)\n+            if (value == null || exclude(keys[i]))\n                 continue;\n             else if (value instanceof Serializable) {\n                 saveNames.add(keys[i]);', 'Tim Funk', '2009-11-05 10:10:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1559, '47502', '2', 'changing status to NEEDINFO based on last comment', 'Tim Funk', '2009-11-05 10:29:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1560, '47502', '3', 'This session attribute used when running under a security manager. Authentication is handled separately. The patch looks good to me.\n\nI\'ve applied it to trunk and proposed it for 6.0.x', 'Mark Thomas', '2009-12-01 16:33:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1561, '47342', '1', 'I\'m unable to replicate your use case, mostly cause it seems as the className attribute is ignored on the conf/context.xml element', 'Filip Hanik', '2009-06-18 11:16:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1562, '47342', '2', '(In reply to  comment #1 )\n> I\'m unable to replicate your use case, mostly cause it seems as the className\n> attribute is ignored on the conf/context.xml element\n\nI\'m so sorry in the insufficient explanation. \nTo reproduce this bug\nIt is necessary to set ReplicatedContext to <<contextName>>.xml of conf/Catalina/localhost/directory. \nIt is not conf/context.xml. \n\nIMHO,\nI think that className attribute is ignored in conf/context.xml. \n\nBecause\ncontext instance is created by deployXXXX method of HostConfig.\nand\nThe ContextRuleSet created by ContextConfig(parse conf/context.xml) is as follows. \n  RuleSet contextRuleSet = new ContextRuleSet(\'\', false);\n  \nWhen boolean of the second argument is false, context instance is not created by Digester. \nAs a Result, \nObjectCreateRule to className attribute of Context is not added.', 'Keiichi Fujino', '2009-06-18 23:56:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1563, '47342', '3', 'Thanks for the patch.\n\nThe patch has been applied to trunk (although other changes in trunk mean the\nNPE doesn\'t occur) and has been proposed for 6.0.x.', 'Mark Thomas', '2009-11-30 16:39:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1564, '48267', '1', 'The javax.* packages have to match the specification APIs. We can\'t add generics if the API doesn\'t use them (as much as I\'d like to).', 'Mark Thomas', '2009-11-24 16:57:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1565, '48267', '2', 'How about applying generics fixes just to internal code and private variables, and using @SuppressWarnings on the rest?\n\n[Or just use @SuppressWarnings throughout]\n\nIf so, I can create a new patch.', 'Sebb', '2009-11-24 17:11:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1566, '48267', '3', '(In reply to  comment #2 )\n> How about applying generics fixes just to internal code and private variables,\n> and using @SuppressWarnings on the rest?\n+1\n\n> If so, I can create a new patch.\nTx', 'Mark Thomas', '2009-11-25 03:16:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1567, '48267', '4', 'Created  attachment 24611   [details] \nModified patch which does not change API spec.', 'Sebb', '2009-11-25 06:22:13 UTC', 'tomcat_attachment/attachment 24611.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1568, '47799', '1', 'Created  attachment 24224   [details] \nMcastService\'s patch\n\nsorry.\nThe previous patch is broken. \nThis is correct patch.', 'Keiichi Fujino', '2009-09-08 02:52:50 UTC', 'tomcat_attachment/attachment 24224');
INSERT INTO `tomcatbeforefixcomments` VALUES (1569, '47799', '2', 'Created  attachment 24225   [details] \nDomainFilterInterceptor\'s patch\n\nsorry.\nThe previous DomainFilterInterceptor\'s patch is broken. \nThis is correct patch.', 'Keiichi Fujino', '2009-09-08 02:54:08 UTC', 'tomcat_attachment/attachment 24225');
INSERT INTO `tomcatbeforefixcomments` VALUES (1570, '47799', '3', 'Hi.\n\nPlease do not ignore this bug report and patch. \nThis problem is important.\n\nIf we can not specify domain in Membership and DomainFilterInterceptor, \nwe can not divide the cluster into a smaller group by the domain.\n\nAfter all, DomainFilterInterceptor can not be used.', 'Keiichi Fujino', '2009-09-15 02:11:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1571, '47799', '4', 'Thanks for the patch. It has been applied to trunk and proposed for 6.0.x', 'Mark Thomas', '2009-11-22 14:39:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1572, '47462', '1', 'Thanks for the patch. It has been applied to trunk and proposed for 5.5.x and 6.0.x', 'Mark Thomas', '2009-11-22 12:52:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1573, '47462', '2', 'SRV.14.5 of Servlet 2.5 says that if “metadata-complete” attribute is absent, it must be treated the same way as having the value of \'false\'.\n\nThus, if we allow to specify it in global conf/web.xml, setting it to \'true\' there will result in violation of the spec.', 'Konstantin Kolinko', '2009-12-16 23:45:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1574, '47462', '3', 'Created  attachment 24721   [details] \nnew patch.\n\nOops!\nMy patch was a mistake. \nHowever, even if this patch is reverted, it is a violation of spec yet. \n\nIf “metadata-complete\' of conf/web.xml is set true, \nand “metadata-complete\' is not specified in each webApp, \nthe annotation is invalid yet. \n\nThis is violation of spec.\n\nI made a new patch. \nif“metadata-complete\' is not specified, the annotation is made effective.', 'Keiichi Fujino', '2009-12-17 02:08:29 UTC', 'tomcat_attachment/attachment 24721');
INSERT INTO `tomcatbeforefixcomments` VALUES (1575, '47462', '4', '(In reply to  comment #2 )\n> SRV.14.5 of Servlet 2.5 says that if “metadata-complete” attribute is absent,\n> it must be treated the same way as having the value of \'false\'.\n> \n> Thus, if we allow to specify it in global conf/web.xml, setting it to \'true\'\n> there will result in violation of the spec.\n\nI disagree. The spec does not consider the concept of a global or default web.xml. A global web.xml is a Tomcat invention and one where Tomcat controls how it is to be interpreted, not the spec. The convention is the the global web.xml sets the defaults for all application web.xml files unless explicitly overridden at the application level. Hence the behaviour with the patch applied is as expected.', 'Mark Thomas', '2009-12-17 08:16:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1576, '47462', '5', '(In reply to  comment #3 )\n> Created an attachment (id=24721) [details]\n> new patch.\n\nI can\'t see why null needs to be handled here. The only acceptable values are true or false.', 'Mark Thomas', '2009-12-17 08:17:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1577, '47462', '6', 'From second thought:\n- The spec authors had to specify how to interpret the missing value. Leaving that unspecified would be much worse.\n- The default content of global conf/web.xml provides specification-compliant behavior. If you start changing that file, you should know what you are doing.\n\nThus, let\'s go with the original patch.', 'Konstantin Kolinko', '2009-12-17 12:21:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1578, '47462', '7', '(In reply to  comment #5 )\n> (In reply to  comment #3 )\n> > Created an attachment (id=24721) [details] [details]\n> > new patch.\n> \n> I can\'t see why null needs to be handled here. The only acceptable values are\n> true or false.\n\nI think.\nf \'metadata-complete\' is not specified for web.xml, value becomes null. \nIn a new patch.\nFor a strict spec, if \'metadata-complete\' is not specified, the annotation was made effective. \nHowever, I think that the concept is more profitable of conf/web.xml as for the  comment 4 . \n\nI support the previous patch. \n\nmany thanks.', 'Keiichi Fujino', '2009-12-17 16:42:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1579, '47462', '8', 'The patch has been applied to 6.0.x and will be included in 6.0.21 onwards.', 'Mark Thomas', '2009-12-19 14:35:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1580, '47997', '1', 'I just want to add that without this patch, the standard Admin app functionality of adding a DataSource to a deployed Web app does not work.  (Adding a DataSource dynamically is my app\'s use case as well, incidentally.)', 'Michael Allman', '2009-10-28 11:49:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1581, '47997', '2', 'Thanks for the patch. It has been applied to trunk and proposed for 6.0.x and 5.5.x', 'Mark Thomas', '2009-11-22 12:02:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1582, '47997', '3', 'This has been fixed in 6.0.x and will be included in 6.0.21 onwards. Thanks again for the patch.', 'Mark Thomas', '2009-12-21 08:22:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1583, '47997', '4', 'Can this please be applied to 5.5.x and released with 5.5.29?  I ask because my client is using a patched (with this patch) version of 5.5.28 in production and I\'d like to simplify their upgrades by obviating the need to patch and build future releases of 5.5.x.  Thanks.', 'Michael Allman', '2009-12-21 12:39:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1584, '47718', '1', 'This issue also applies to Tomcat 6.0.20.', 'George Sexton', '2009-10-23 11:38:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1585, '47718', '2', 'Many thanks for the patch. It has been applied to trunk and proposed for 6.0.x and 5.5.x', 'Mark Thomas', '2009-11-22 11:41:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1586, '47718', '3', 'The patch has been applied to 6.0.x and will be included in 6.0.21 onwards.', 'Mark Thomas', '2009-12-16 08:40:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1587, '48172', '1', 'Created  attachment 24514   [details] \nConvert jspReloadCount to AtomicInteger', 'Sebb', '2009-11-11 03:38:03 UTC', 'tomcat_attachment/attachment 24514.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1588, '48172', '2', 'The lastCheck field is also not synch. \n\nThis is not problem, so long as:\n* the instance of JspRuntimeContext is created before the background thread is started\n* checkCompile() is only ever called from the background thread\n\nIMO such pre-conditions (if true) should be documented.', 'Sebb', '2009-11-11 03:52:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1589, '48172', '3', 'Created  attachment 24515   [details] \nMake fields final', 'Sebb', '2009-11-11 06:22:34 UTC', 'tomcat_attachment/attachment 24515.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1590, '47881', '1', 'Actually, I do not see startd and stopd commands to be documented anywhere. Maybe we can just safely remove them?\n\nWith startd, Tomcat will exit immediately upon startup. Though it may be useful for testing config files.\n\nWith stopd ... you cannot stop server that is not running.\n\nAnd if you have an instance of Bootstrap, you can call load/start/stop directly, not relying on how Bootstrap#main() parses the arguments.\n\nRegarding the patch: args are not used in \'stopd\', that line can be omitted completely, or we can do as OP proposes. Regarding \'startd\': yes, the fix is correct.', 'Konstantin Kolinko', '2009-10-08 05:31:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1591, '47881', '2', '(In reply to  comment #1 )\n> Actually, I do not see startd and stopd commands to be documented anywhere.\n> Maybe we can just safely remove them?\n> \n> With startd, Tomcat will exit immediately upon startup. Though it may be useful\n> for testing config files.\n> \n> With stopd ... you cannot stop server that is not running.\n> \n> And if you have an instance of Bootstrap, you can call load/start/stop\n> directly, not relying on how Bootstrap#main() parses the arguments.\n> \n> Regarding the patch: args are not used in \'stopd\', that line can be omitted\n> completely, or we can do as OP proposes. Regarding \'startd\': yes, the fix is\n> correct.\n\n(In reply to  comment #1 )\n> Actually, I do not see startd and stopd commands to be documented anywhere.\n> Maybe we can just safely remove them?\n> \n> With startd, Tomcat will exit immediately upon startup. Though it may be useful\n> for testing config files.\n> \n> With stopd ... you cannot stop server that is not running.\n> \n> And if you have an instance of Bootstrap, you can call load/start/stop\n> directly, not relying on how Bootstrap#main() parses the arguments.\n> \n> Regarding the patch: args are not used in \'stopd\', that line can be omitted\n> completely, or we can do as OP proposes. Regarding \'startd\': yes, the fix is\n> correct.\n\nThe only difference between \'startd\' and \'start\' is that \'startd\' doesn\'t invoke Catalina\'s await() method after the server has been started, or \'startd\' doesn\'t need to allocate a \'SHUTDOWN\' port to listening to be sent a \'SHUTDOWN\' message. \'stopd\' is the counterpart of \'stop\'. If tomcat is started by \'startd\', you must invoke \'stopd\' to shutdown it, otherwise the server can\'t  be stopped, because \'stop\' invoke Catalina\'s stopServer() method, which relies on the allocated \'SHUTDOWN\' port exclusively. On the contrary, \'stopd\' invokes Catalina\'s stop() method instead, which invoke server\'s stop() method directly. Below is the two different methods invoked by \'stop\' and \'stopd\':\n\n\n//invoked by \'stop\'\npublic void stopServer() {\n        stopServer(null);\n    }\n\n    public void stopServer(String[] arguments) {\n\n        if (arguments != null) {\n            arguments(arguments);\n        }\n\n        if( server == null ) {\n            // Create and execute our Digester\n            Digester digester = createStopDigester();\n            digester.setClassLoader(Thread.currentThread().getContextClassLoader());\n            File file = configFile();\n            try {\n                InputSource is =\n                    new InputSource(\'file://\' + file.getAbsolutePath());\n                FileInputStream fis = new FileInputStream(file);\n                is.setByteStream(fis);\n                digester.push(this);\n                digester.parse(is);\n                fis.close();\n            } catch (Exception e) {\n                log.error(\'Catalina.stop: \', e);\n                System.exit(1);\n            }\n        }\n\n        // Stop the existing server\n        try {\n            if (server.getPort()>0) {\n            	String hostAddress = InetAddress.getByName(\'localhost\').getHostAddress();\n            	Socket socket = new Socket(hostAddress, server.getPort());\n            	OutputStream stream = socket.getOutputStream();\n            	String shutdown = server.getShutdown();\n            	for (int i = 0; i < shutdown.length(); i++)\n            		stream.write(shutdown.charAt(i));\n            	stream.flush();\n            	stream.close();\n            	socket.close();\n            } else {\n                log.error(sm.getString(\'catalina.stopServer\'));\n                System.exit(1);\n            }\n        } catch (IOException e) {\n            log.error(\'Catalina.stop: \', e);\n            System.exit(1);\n        }\n\n    }\n\n\n    // invoked by \'stopd\'\n    public void stop() {\n\n        try {\n            // Remove the ShutdownHook first so that server.stop() \n            // doesn\'t get invoked twice\n            if (useShutdownHook) {\n                Runtime.getRuntime().removeShutdownHook(shutdownHook);\n            }\n        } catch (Throwable t) {\n            // This will fail on JDK 1.2. Ignoring, as Tomcat can run\n            // fine without the shutdown hook.\n        }\n\n        // Shut down the server\n        if (server instanceof Lifecycle) {\n            try {\n                ((Lifecycle) server).stop();\n            } catch (LifecycleException e) {\n                log.error(\'Catalina.stop\', e);\n            }\n        }\n\n    }\n\n\nMy suggestion: We don\'t need to remove \'startd\' and \'stopd\', they are useful in some situations. The only place we need to correct is the Bootstrap\'s main() method, as in the patches I have submitted. Thanks!', 'qingyang.xu', '2009-10-08 16:20:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1592, '47881', '3', 'With \'startd\', as there is no \'await\', the method completes immediately (and the application quits).\n\nThat it is only useful if exiting that \'main\' method does not complete the application. Thus if it is not the actual entry point of the application. If so, does anyone need to use it that way?', 'Konstantin Kolinko', '2009-10-09 01:42:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1593, '47881', '4', '(In reply to  comment #3 )\n> With \'startd\', as there is no \'await\', the method completes immediately (and\n> the application quits).\n> \n> That it is only useful if exiting that \'main\' method does not complete the\n> application. Thus if it is not the actual entry point of the application. If\n> so, does anyone need to use it that way?\n\nYes, you are totally right. After the main method ends, all the daemon threads (such as \'http-8080-Acceptor-0\', \'TP-Processor\', etc.) will end too. I never thought of this consequence. So, what\'s the point of \'startd\' and \'stopd\', anyway?', 'qingyang.xu', '2009-10-09 02:00:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1594, '47881', '5', '(In reply to  comment #4 )\n> (In reply to  comment #3 )\n> > With \'startd\', as there is no \'await\', the method completes immediately (and\n> > the application quits).\n> > \n> > That it is only useful if exiting that \'main\' method does not complete the\n> > application. Thus if it is not the actual entry point of the application. If\n> > so, does anyone need to use it that way?\n> \n> Yes, you are totally right. After the main method ends, all the daemon threads\n> (such as \'http-8080-Acceptor-0\', \'TP-Processor\', etc.) will end too. I never\n> thought of this consequence. So, what\'s the point of \'startd\' and \'stopd\',\n> anyway?\n\npublic static void main(String[] args) can be called from another Java class, its not exclusive to the JVM\n\nIt would be a different way of embedding Tomcat, at which point one wants the thread to return', 'Filip Hanik', '2009-10-09 06:48:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1595, '47881', '6', '> public static void main(String[] args) can be called from another Java class,\n> its not exclusive to the JVM\n> \n> It would be a different way of embedding Tomcat, at which point one wants the\n> thread to return\n\nUnderstood. So my patch is still relevant, right?', 'qingyang.xu', '2009-10-09 18:39:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1596, '47881', '7', '\n\n*** This bug has been marked as a duplicate of  bug 48059  ***', 'qingyang.xu', '2009-10-26 17:38:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1597, '47881', '8', 'Reduced severity. There is nothing in this issue that makes it \'critical\'.', 'Konstantin Kolinko', '2009-11-02 02:45:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1598, '47881', '9', '***  Bug 48059  has been marked as a duplicate of this bug. ***', 'Konstantin Kolinko', '2009-11-02 02:46:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1599, '47881', '10', 'Fixed in trunk, proposed for TC 6.0', 'Konstantin Kolinko', '2009-11-02 03:04:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1600, '47451', '1', '(In reply to  comment #0 )\n> A brief analysis of the JnlpDownloadServlet code shows that the\n> content-encoding\n> header on the response is being set to null in\n> DownloadResponse$FileDownloadResponse.\n> \n> (...)\n> \n> Since this occurs with the JnlpDownloadServlet provided by Sun (see\n>  http://java.sun.com/j2se/1.5.0/docs/guide/javaws/developersguide/downloadservletguide.html ),\n> I imagine more people might be running into this problem.\n\nNull should not be used as a value in a call to HttpServletResponse#setHeader()/#addHeader().\n\nThe servlet spec (including the proposed final draft of servlet-3.0) does not define the behavior of null value for those methods, but certainly such value cannot be transmitted over the wire and cannot be interpreted as removal of the header, as the spec does not allow removal of the headers.\n\nThe same applies to null value for name.\n\nThus expect #setHeader(name, null) to fail in a container-dependent way. I would prefer an early failure with an NPE in setHeader/addHeader, as opposed to the late failure seen by the OP. Should we make it configurable, e.g. with STRICT_SERVLET_COMPLIANCE?', 'Konstantin Kolinko', '2009-10-02 04:34:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1601, '47451', '2', 'Fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2009-11-01 14:59:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1602, '47451', '3', 'This has been fixed in 6.0.x and will be included in 6.0.21 onwards.', 'Mark Thomas', '2009-12-21 11:19:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1603, '40001', '1', 'If for example FF crashes, and you restart it, it could popup with the\nmanager-pages in it with reload?path=/, it will immediately, and unwantedly,\nrestart the web-app ', 'Michiel Meeuwissen', '2006-07-10 14:34:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1604, '40001', '2', 'I like the easy functionality.  I\'m guessing you want a POST to better comply\nwith some notion of HTTP semantics where GETs shouldn\'t do anything but read\ndata?  If so, please provide a patch accordingly.\n\nSetting Severity to enhancement.', 'Yoav Shapira', '2006-12-26 07:29:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1605, '40001', '3', '***  Bug 42795  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2007-07-02 17:17:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1606, '40001', '4', 'Created  attachment 24139   [details] \nsuggested fix\n\nThis patch changes the reload/start/stop/undeploy links to buttons and makes sure the servlet only reacts to POST requests. It also improves the text of the Javascript confirmation dialog a bit.', 'lucenebugs2006', '2009-08-15 15:20:41 UTC', 'tomcat_attachment/attachment 24139.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1607, '40001', '5', 'Setting back to \'NEW\' as requested by the instructions.', 'lucenebugs2006', '2009-08-15 15:21:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1608, '47499', '1', 'Created  attachment 23946   [details] \ntomcat_rfe_47499patch.txt\n\nan idea how to improve the error reported', 'Ralf Hauser', '2009-07-08 22:06:49 UTC', 'tomcat_attachment/attachment 23946.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1609, '47499', '2', 'reported also to  http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=536328 .\n\nSome discussion that may end in fingerpointing between debian and tomcat is here\n  http://marc.info/?l=tomcat-user&m=124698302231803&w=2  and  http://marc.info/?l=tomcat-user&m=124698405701221&w=2 ', 'Ralf Hauser', '2009-07-08 23:30:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1610, '47499', '3', 'Created  attachment 24302   [details] \nAlternative patch\n\nI have fixed this in trunk and have attached an alternative patch for 6.0.x. I\'ll propose the alternative patch for 6.0.x shortly.', 'Mark Thomas', '2009-09-22 14:18:58 UTC', 'tomcat_attachment/attachment 24302');
INSERT INTO `tomcatbeforefixcomments` VALUES (1611, '47866', '1', 'I can\'t reproduce this with a simple test case ( r817201  &  r817204 ). If you can provide a patch to that test case that demonstrates the issue that would be great.', 'Mark Thomas', '2009-09-21 04:07:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1612, '47866', '2', 'Sorry for the noise. Should be  r817201  and  r817207 ', 'Mark Thomas', '2009-09-21 04:08:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1613, '47866', '3', 'The problem is that if there is an exception in a ServletContextListener, then Tomcat.start() fails to actually start the server and actually actively tries to stop it, destroying the class loader in the process.  Any background threads started by the listener before it failed can then fail in weird ways, for instance throwing the exception reported above.\n\nTwo things you could do to make it more friendly if you feel like it: 1) throw a more informative exception in the WebappClassLoader, 2) throw an exception when Tomcat.start() encounters this kind of problem, and has already called stop().  \n\nI see this in the log:\n\n{noformat}\n2009-09-21 12:56:19,658 ERROR main [org.apache.catalina.core.StandardContext] - <Error listenerStart>\n2009-09-21 12:56:19,658 ERROR main [org.apache.catalina.core.StandardContext] - <Context [] startup failed due to previous errors>\n{noformat}\n\nBut the exception that caused this is not propagated.  This is probably more important than the original NPE.  DO you want to change the bug summary?', 'Dave Syer', '2009-09-21 04:58:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1614, '47161', '1', 'Created  attachment 24272   [details] \nPatch for 6.0.x\n\nTrunk has been fixed and a patch is attached for 6.0.x. The patch ensures that the thread counts returned are correct with or without an executor.', 'Mark Thomas', '2009-09-15 15:05:55 UTC', 'tomcat_attachment/attachment 24272');
INSERT INTO `tomcatbeforefixcomments` VALUES (1615, '47161', '2', 'The patch has been proposed for 6.0.x', 'Mark Thomas', '2009-09-15 15:08:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1616, '47161', '3', 'Comment on  attachment 24272   [details] \nPatch for 6.0.x\n\nThe patch has been withdrawn as it creates unwanted dependencies', 'Mark Thomas', '2009-10-03 13:27:52 UTC', 'tomcat_attachment/attachment 24272');
INSERT INTO `tomcatbeforefixcomments` VALUES (1617, '47161', '4', 'Created  attachment 24341   [details] \nPatch V2\n\nNew patch. Can\'t address issue completely in 6.0.x without fairly invasive changes. Ensure -1 is returned consistently for maxThreads if an executor is in use and return a correct value for the NIO connector where we can.', 'Mark Thomas', '2009-10-03 13:47:10 UTC', 'tomcat_attachment/attachment 24341.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1618, '47161', '5', 'The new patch has been proposed for 6.0.x', 'Mark Thomas', '2009-10-03 13:49:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1619, '46950', '1', 'There is no <auth-constraint> in the configuration, so of course Tomcat doesn\'t ask for a certificate.', 'william.barker', '2009-04-01 11:43:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1620, '46950', '2', 'Ok. So now I changed the security-constraint to:\n<security-constraint id=\'SecurityConstraint_1\'>\n                <web-resource-collection id=\'WebResourceCollection_1\'>\n                        <web-resource-name/>\n                        <url-pattern>/LoginWithCert.do</url-pattern>\n                        <http-method>DELETE</http-method>\n                        <http-method>GET</http-method>\n                        <http-method>POST</http-method>\n                        <http-method>PUT</http-method>\n                        <http-method>HEAD</http-method>\n                </web-resource-collection>\n                <auth-constraint>\n                        <role-name>*</role-name>\n                </auth-constraint>\n                <user-data-constraint id=\'UserDataConstraint_4\'>\n                        <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n                </user-data-constraint>\n</security-constraint>\n\nNow I get this error when I access the resource:\nHTTP Status 400 - No client certificate chain in this request\n\nBUT no certificate was asked in the SSL (re-)negotiation.', 'Andre Cruz', '2009-04-02 03:00:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1621, '46950', '3', 'The following configuration works for me. At a guess, you haven\'t configured Tomcat to trust the issuer of your client certificate. The browser only prompts you to select a cert if it has one that the server will trust.\n\nPlease use the users list if you need further help configuring your SSL certs.\n\n  <security-constraint>\n    <web-resource-collection>\n      <web-resource-name> Bug46950 </web-resource-name>\n      <url-pattern>/ bug46381 .jsp</url-pattern>\n    </web-resource-collection>\n    <auth-constraint>\n      <role-name>manager</role-name>\n    </auth-constraint>\n  </security-constraint>\n  <security-constraint>\n    <web-resource-collection>\n      <web-resource-name>Everything</web-resource-name>\n      <url-pattern>/*</url-pattern>\n    </web-resource-collection>\n    <user-data-constraint>\n      <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n    </user-data-constraint>\n  </security-constraint>\n  <login-config>\n    <auth-method>CLIENT-CERT</auth-method>\n  </login-config>', 'Mark Thomas', '2009-04-14 16:15:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1622, '46950', '4', 'What works for you? Did you even read what I said?\n\nHow can the browser know if a server trusts a certain certificate or not without even asking for it?\n\nLet me explain the problem better.\n\nMost of my site runs without client cert checking, so I have SSLVerifyClient=\'none\' on the connector. But I have one servlet that DOES want a client certificate and so I configured the security restriction accordingly in the deployment descriptor. Just that one resource, not the entire site.\n\nIt\'s in these cases that a SSL renegotiation does not occur to ask for the client certificate. Tomcat only knows that I want a client certificate after the client sends the http request.\n\nApache httpd has this feature and someone at the tomcat user\'s list asked me to file this as a bug. Maybe it\'s just a missing feature.', 'Andre Cruz', '2009-04-15 04:03:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1623, '46950', '5', '(In reply to  comment #4 )\n> What works for you?\nThe security constraint and login configuration I posted which requires SSL for the entire context but only requires user authentication for a single JSP. If I browse to any resource except the one that requires auth using http I get switched to https as expected. If I then request the protected resource I get prompted for my certificate.\n\n> Did you even read what I said?\nYes I did. Quite carefully. Taking that attitude is not going to induce people to help you.\n\n> How can the browser know if a server trusts a certain certificate or not\n> without even asking for it?\nThis is the way the SSL handshake works. The server provides a client with a list of trusted certs. If the client doesn\'t have a user cert issued by one of the trysted certs the client doesn\'t waste time prompting the user to select one.\n\n> Let me explain the problem better.\n> \n> Most of my site runs without client cert checking, so I have\n> SSLVerifyClient=\'none\' on the connector.\n\nThat is new information. Your original bug report made no mention of using the APR/native connector. I\'d expect the behaviour to remain the same but I\'ll re-test with the native and see.', 'Mark Thomas', '2009-04-15 04:38:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1624, '46950', '6', 'OK, I can confirm this when I test with the APR/native connector. Looking for a fix now...', 'Mark Thomas', '2009-04-15 05:21:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1625, '46950', '7', 'This is going to require a change to the APR/native connector.', 'Mark Thomas', '2009-04-16 12:37:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1626, '46950', '8', 'Created  attachment 23663   [details] \nPatch that makes the Apr connector behave like the non-Apr\n\nThis patch will turn on the SSL Client requirement prior to the SSL renegotiation prompting the browser for one.', 'Andre Cruz', '2009-05-14 04:17:52 UTC', 'tomcat_attachment/attachment 23663.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1627, '46950', '9', 'The proposed patch does not work exactly as intended. It does not trigger renegotiation, rather it sets SSLVerifyClient for the all future SSL sessions created by that request processor.\n\nThe side effects of this are:\n- cert still not prompted for when transitioning from resource that doesn\'t require cert to one that does\n- subsequent SSL requests handled by that processor will prompt for a cert, even when not required.\n\nAs per  comment #7 , a fix for this that aligns the APR/native connector behaviour with the Java connectors will require a change to the native component of the native connector (to enable the connection to be renegotiated for the current connection).', 'Mark Thomas', '2009-05-27 06:08:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1628, '46950', '10', 'The native fixes have been applied to the 1.1.x branch and trunk (1.2.x)\nThe Tomcat fixes have been applied to trunk (7.0.x) and proposed for 6.0.x and 5.5.x. Note that the 6.0.x/5.5.x patch depends on there being a new tc-native release', 'Mark Thomas', '2009-09-15 10:59:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1629, '46950', '11', 'This has been fixed in 6.0.x and will be included in 6.0.21 onwards.\n\nIt will also be proposed for backport to 5.5.x', 'Mark Thomas', '2009-11-02 16:33:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1630, '46950', '12', 'Thanks!', 'Andre Cruz', '2009-11-03 02:54:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1631, '47378', '1', 'You\'ll need a physical file called index.jspf as a \'placeholder\' for the action to occur. The file placeholder can be 0 bytes if you want. Or you can write a filter to detect a directory is requested and forward to index.jspf.\n\nThe reason for needing a physical file is the servlet container is to allow for multiple welcome file types. \n\nImagine I had welcome files of index.jsp, then index.html, then index.htm.\n\nImagine I have a directory that is missing index.jsp, but has an index.html. If I always tried to invoke index.jsp like the welcome file list says, then the JSP servlet will return a 404 since there is no mechanism in the servlet api to defer that decision. \n\nIIRC - there are more discussions of this in the archives, but those talks are REALLY old.', 'Tim Funk', '2009-06-17 04:05:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1632, '47378', '2', 'In the scenario that you described (the multiple welcome files index.jsp, index.html, etc), I would think that the container should try each in succession until it finds one that is valid.  The mechanism for \'defering that decision\' would have to be built into the DefaultServlet.  \nThis means that if a developer wanted to forward a user to some random servlet, \'/dosomething\', or to a Struts action, or to a JSF page, I would have to create some dummy file in which all it did was forward the request?\nThis has been an issue with other jsp/servlet containers in the past and the developer community fixed it.  I was hoping that the Tomcat community would provide a fix for this.  Instead it looks like if I want to run my apps on Tomcat, I will have to modify them all...', 'Bobby Lawrence', '2009-06-17 06:29:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1633, '47378', '3', 'The \'other\' jsp/servlet containers that I was referring to is Jetty.\nWeblogic already handles this now.  But since the Tomcat catalina core is used in so many other containers (Geronimo, Glassfish), this has become an issue on those containers as well.', 'Bobby Lawrence', '2009-06-17 06:32:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1634, '47378', '4', 'Hi, Dear devs, \nHas this bug been resolved? I am instreseting in it, where can I get a snapshot build to have a try? Was that committed to 7.0 trunk or 6.0 trunk?\n\n-Rex', 'Rex Wang', '2009-07-13 01:22:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1635, '47378', '5', 'From my point of view, I don\'t like the work around to create a dummy file to help  request the servlet. The logic I prefer is:\n1. scan welcome list from actual files. If one is found, use it.\n2. If none are found, try servlet mappings, for example:\nif there is a /Hello in weclome list:\n  <welcome-file-list>\n    <welcome-file>/Hello</welcome-file>\n  </welcome-file-list>\nwe should find in the wel.xml to look if there is a <servlet-mapping> hold a <url-pattern> that can match \'/Hello\', such as \n<url-pattern>/Hello</url-pattern> or <url-pattern>/*</url-pattern>\n\nAny thoughts?\n\n-Rex\n\n(In reply to  comment #1 )\n> You\'ll need a physical file called index.jspf as a \'placeholder\' for the action\n> to occur. The file placeholder can be 0 bytes if you want. Or you can write a\n> filter to detect a directory is requested and forward to index.jspf.\n> \n> The reason for needing a physical file is the servlet container is to allow for\n> multiple welcome file types. \n> \n> Imagine I had welcome files of index.jsp, then index.html, then index.htm.\n> \n> Imagine I have a directory that is missing index.jsp, but has an index.html. If\n> I always tried to invoke index.jsp like the welcome file list says, then the\n> JSP servlet will return a 404 since there is no mechanism in the servlet api to\n> defer that decision. \n> \n> IIRC - there are more discussions of this in the archives, but those talks are\n> REALLY old.', 'Rex Wang', '2009-07-13 01:57:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1636, '47378', '6', 'This wasn\'t fixed.\n\nSRV.9.10 makes it clear the servlet mappings in web.xml should be supported. Until this gets fixed, you can use the workaround Tim describes.\n\nPatches are always welcome.', 'Mark Thomas', '2009-07-13 02:26:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1637, '47378', '7', 'This issue came up in jetty recently and it became clear in e.g. discussions that the spec wording interpreted literally implies a non-workable solution.  The wording may be clarified in servlet 3.0, meanwhile see\n\n http://jira.codehaus.org/browse/JETTY-936 \n\nfor the apparent consensus on what is intended.', 'david jencks', '2009-07-13 14:18:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1638, '47378', '8', 'This might work as a patch to org.apache.tomcat.util.http.mapper.Mapper - add it before // Rule 7 -- Default servlet and after          // Rule 4 -- Welcome resources processing for servlets\n\n        // DAMMIT - welcome file processing - take 2\n        // take first matching welcome match\n        // its a copy of rule 4 since it needs to do less\n        if (mappingData.wrapper == null) {\n            boolean checkWelcomeFiles = checkJspWelcomeFiles;\n            if (!checkWelcomeFiles) {\n                char[] buf = path.getBuffer();\n                checkWelcomeFiles = (buf[pathEnd - 1] == \'/\');\n            }\n            if (checkWelcomeFiles) {\n                for (int i = 0; (i < context.welcomeResources.length)\n                         && (mappingData.wrapper == null); i++) {\n                    path.setOffset(pathOffset);\n                    path.setEnd(pathEnd);\n                    path.append(context.welcomeResources[i], 0,\n                                context.welcomeResources[i].length());\n                    path.setOffset(servletPath);\n\n                    internalMapExtensionWrapper(extensionWrappers,\n                                                path, mappingData);\n                    if (mappingData.wrapper == null\n                        && context.defaultWrapper != null) {\n                        mappingData.wrapper =\n                            context.defaultWrapper.object;\n                        mappingData.requestPath.setChars\n                            (path.getBuffer(), path.getStart(),\n                             path.getLength());\n                        mappingData.wrapperPath.setChars\n                            (path.getBuffer(), path.getStart(),\n                             path.getLength());\n                        mappingData.requestPath.setString(pathStr);\n                        mappingData.wrapperPath.setString(pathStr);\n                    }\n                }\n\n                path.setOffset(servletPath);\n                path.setEnd(pathEnd);\n            }\n\n        }', 'Tim Funk', '2009-07-18 18:26:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1639, '47378', '9', 'hi Tim, I tried adding this, but it does not work...\nbtw, I added one line: String pathStr = path.toString(); to pass compiling.\n-Rex\n\n(In reply to  comment #8 )\n> This might work as a patch to org.apache.tomcat.util.http.mapper.Mapper - add\n> it before // Rule 7 -- Default servlet and after          // Rule 4 -- Welcome\n> resources processing for servlets\n> \n>         // DAMMIT - welcome file processing - take 2\n>         // take first matching welcome match\n>         // its a copy of rule 4 since it needs to do less\n>         if (mappingData.wrapper == null) {\n>             boolean checkWelcomeFiles = checkJspWelcomeFiles;\n>             if (!checkWelcomeFiles) {\n>                 char[] buf = path.getBuffer();\n>                 checkWelcomeFiles = (buf[pathEnd - 1] == \'/\');\n>             }\n>             if (checkWelcomeFiles) {\n>                 for (int i = 0; (i < context.welcomeResources.length)\n>                          && (mappingData.wrapper == null); i++) {\n>                     path.setOffset(pathOffset);\n>                     path.setEnd(pathEnd);\n>                     path.append(context.welcomeResources[i], 0,\n>                                 context.welcomeResources[i].length());\n>                     path.setOffset(servletPath);\n> \n>                     internalMapExtensionWrapper(extensionWrappers,\n>                                                 path, mappingData);\n>                     if (mappingData.wrapper == null\n>                         && context.defaultWrapper != null) {\n>                         mappingData.wrapper =\n>                             context.defaultWrapper.object;\n>                         mappingData.requestPath.setChars\n>                             (path.getBuffer(), path.getStart(),\n>                              path.getLength());\n>                         mappingData.wrapperPath.setChars\n>                             (path.getBuffer(), path.getStart(),\n>                              path.getLength());\n>                         mappingData.requestPath.setString(pathStr);\n>                         mappingData.wrapperPath.setString(pathStr);\n>                     }\n>                 }\n> \n>                 path.setOffset(servletPath);\n>                 path.setEnd(pathEnd);\n>             }\n> \n>         }', 'Rex Wang', '2009-07-29 01:56:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1640, '47378', '10', 'Created  attachment 24065   [details] \nPatch against tomcat 6.0\n\nHere is a working patch. (At least in a simple test case) Previous attempt was wrong on soooo many levels.', 'Tim Funk', '2009-07-30 08:01:55 UTC', 'tomcat_attachment/attachment 24065.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1641, '47378', '11', '\nHi Tim, I tried again.. but still not work. I am not sure if we are on the same page, this is my web.xml:\n<web-app xmlns:xsi=\' http://www.w3.org/2001/XMLSchema-instance \' ...>\n  <welcome-file-list>\n    <welcome-file>/Hello</welcome-file>\n  </welcome-file-list>\n  <servlet>\n    <servlet-name>HelloServlet</servlet-name>\n    <servlet-class>com.abc.HelloServlet</servlet-class>\n  </servlet>\n  <servlet-mapping>\n    <servlet-name>HelloServlet</servlet-name>\n    <url-pattern>/Hello</url-pattern>\n  </servlet-mapping>\n</web-app>\n\n(In reply to  comment #10 )\n> Created an attachment (id=24065) [details]\n> Patch against tomcat 6.0\n> \n> Here is a working patch. (At least in a simple test case) Previous attempt was\n> wrong on soooo many levels.', 'Rex Wang', '2009-08-02 19:41:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1642, '47378', '12', 'and I did not create a \'placeholder\'. \n\n-Rex', 'Rex Wang', '2009-08-02 19:43:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1643, '47378', '13', 'Hi, Tim\n\nif I set \n  <welcome-file-list>\n    <welcome-file>Hello</welcome-file>      ## not \'/Hello\' here\n  </welcome-file-list>\nit seems work correctly.\n\nI tried tracking the code, and if use \'Hello\', the mappingData.wrapper != null\nBut, if use \'/Hello\', the mappingData.wrapper = = null. Then will run into the new logic, why not don\'t allow \'/Hello\', which is actually a servlet mapping here?\n\n-Rex', 'Rex Wang', '2009-08-02 22:40:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1644, '47378', '14', 'Because welcome files define file names not servlet mappings. It needs to be Hello to be consistent.', 'Mark Thomas', '2009-08-03 02:18:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1645, '47378', '15', 'Ahhh ... I see the issue. My patch was to handle the case for file extension matches. For example: index.jsf (which is what was for the original report).\n\n Comment 5  could be considered a \'different bug\'. But in this case:\n- Welcome file is /Hello\n- Servlet exists mapped to /Hello\n- So when calculating welcome files - /Hello (while not existing as a file) is an exact match - so that should be used.\n\ntime permitting - I\'ll take a look later today.', 'Tim Funk', '2009-08-03 03:59:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1646, '47378', '16', 'Given welcome files are defined without the leading / - ie \'index.html\' rather than \'/index.html\' - I still think to match a servlet mapping of \'/Hello\' the welcome file setting should be \'Hello\'. This would also be consistent with the current workaround of creating a dummy file.', 'Mark Thomas', '2009-08-03 04:13:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1647, '47378', '17', 'Created  attachment 24088   [details] \nWar file demonstrating exact mappings\n\nExact mappings dont need a physical file. (At least with the way the mapper works right now)\n\nAttached is example working on tomcat 6\n\n\nas a timesaver ... here is the web.xml\n  <servlet>\n    <servlet-name>fooo</servlet-name>\n    <jsp-file>/foo.jsp</jsp-file>\n  </servlet>\n  <servlet-mapping>\n     <servlet-name>fooo</servlet-name>\n     <url-pattern>/TIMMAY</url-pattern>\n   </servlet-mapping>\n   <welcome-file-list>\n     <welcome-file>TIMMAY</welcome-file>\n   </welcome-file-list>\n\n\n\nIf / is requested - then the servlet named fooo (path=/TIMMAY) will be used. All this is without the patch I supplied. \n\nFor   Rex Wang (comments  5 , 11 , 12 ) - I think you have a config issue which needs moved to the user list so they can help you.', 'Tim Funk', '2009-08-03 04:45:22 UTC', 'tomcat_attachment/attachment 24088');
INSERT INTO `tomcatbeforefixcomments` VALUES (1648, '47378', '18', 'All right, many thanks, Tim and Mark!\n\n-Rex', 'Rex Wang', '2009-08-03 09:37:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1649, '47378', '19', 'Applied this to trunk - so it should make its way into tomcat7\n http://svn.apache.org/viewvc?rev=809596&view=rev \n\nI am not proposing this for backport to tomcat 6. But wouldn\'t be against it if it were proposed. So I\'m moving this to enhancement.', 'Tim Funk', '2009-08-31 07:02:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1650, '41824', '1', 'I am also having this problem with simple tag handlers (as opposed to classic\ntag handlers described here by Renaud).  I get the exact same behavior he\ndescribed when trying to use an inner class for the type attribute in our simple\ntag handler attributes.  Any idea when this might be fixed?', 'Brian Lenz', '2007-06-04 11:34:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1651, '41824', '2', 'This has been fixed in trunk and proposed for 5.5.x and 6.0.x', 'Mark Thomas', '2009-07-24 12:10:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1652, '41824', '3', 'This has been fixed in 6.0.x and will be included in 6.0.21 onwards.', 'Mark Thomas', '2009-08-15 10:59:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1653, '46907', '1', 'this is on tomcat 5.5.26', 'Olivier Lau', '2009-03-25 01:17:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1654, '46907', '2', 'I will investigate this bug and fix it if I needed', 'IzhikovNikolay', '2009-04-06 03:17:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1655, '46907', '3', 'Created  attachment 23445   [details] \ntest application. I try to reproduce bug with it\n\nI can\'t reproduce problem with attached test application.\nI test it with tomcat builded from this url\n http://svn.apache.org/repos/asf/tomcat/current-svn15/tc5.5.x \n\nCan you provide test application and log file to reproduce problem', 'IzhikovNikolay', '2009-04-06 04:33:44 UTC', 'tomcat_attachment/attachment 23445.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (1656, '46907', '4', 'Can\'t reproduce bug with test application', 'IzhikovNikolay', '2009-04-06 04:34:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1657, '46907', '5', 'Created  attachment 23461   [details] \nweb archive reproducing #46907', 'Olivier Lau', '2009-04-08 05:49:03 UTC', 'tomcat_attachment/attachment 23461');
INSERT INTO `tomcatbeforefixcomments` VALUES (1658, '46907', '6', 'Attached .war file (test_log4j.war, sources included) demonstrating the problem.\nPlease note the presence of commons-logging into /web-inf/lib, as without this Tomcat would not issue any log, and therefore the problem would not be reproduced.\n\nUsage:\n- run the provided webapp under tomcat 5.5.26 (problem may exist on more recent versions too) on a given host (ex: localhost)\n- perform an HTTP POST with body data on  http://localhost/testlog4j/post.jsp \n(with curl: curl -d \'name=value\'  http://localhost/testlog4j/post.jsp )\n- if things would work, the jsp would return the content of the POST body, but it doesn\'t, because Jasper consumes the request stream with its debug traces before the JSP is called.\n- to make it work, disable Jasper debug logging: edit /web-inf/classes/log4j.properties and uncomment the \'log4j.category.org.apache.jasper.servlet.JspServlet=WARN\' line : this way Jasper will not log anymore debug traces, therefore not consuming the stream the JSP is using.', 'Olivier Lau', '2009-04-08 05:50:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1659, '46907', '7', 'Ok. I take a look.', 'IzhikovNikolay', '2009-04-09 04:12:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1660, '46907', '8', 'I was able to reproduce this with 5.5.26 (the OP\'s stated version) and 5.5.27 (the current latest 5.5.x version). However, versions 6.0.0-alpha through to 6.0.18 (the current latest 6.0.x version) as well as the trunk do not exhibit this behavior.\n\nSo a question for the Tomcat developers, do we want to fix this for 5.5.x or do we instead suggest the user upgrade?', 'Kirk True', '2009-04-16 08:18:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1661, '46907', '9', 'It will depend what the patch looks like. Create a patch and one of us will take a look. If the patch is OK, we\'ll propose it for 5.5.x.', 'Mark Thomas', '2009-04-16 08:21:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1662, '46907', '10', 'I still can\'t reproduce the bug.\nI\'m on WindowsXP \njdk - 1.6.0_07', 'IzhikovNikolay', '2009-04-17 03:00:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1663, '46907', '11', 'I should mention I\'m on Linux (Fedora 10 x64). Here\'s my java -version:\n\n    java version \'1.6.0_12\'\n    Java(TM) SE Runtime Environment (build 1.6.0_12-b04)\n    Java HotSpot(TM) 64-Bit Server VM (build 11.2-b01, mixed mode)', 'Kirk True', '2009-04-17 09:03:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1664, '46907', '12', 'I have removed the debug logging (of the request parameters) that caused the input stream to be consumed in trunk. The patch has been proposed for 5.5.x and 6.0.x.', 'Mark Thomas', '2009-07-23 23:18:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1665, '46907', '13', 'The patch has been applied to 5.5.x and will be included in 5.5.29 onwards.', 'Mark Thomas', '2009-08-12 04:36:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1666, '47518', '1', 'That looks like the correct fix to me. No need to log 5.5.x separately although patches for both would be appreciated.', 'Mark Thomas', '2009-07-13 12:09:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1667, '47518', '2', 'Created  attachment 23996   [details] \nPatch to fix javadoc: s/invokeNext/getNext()/invoke/g', 'Christopher Schultz', '2009-07-16 14:48:48 UTC', 'tomcat_attachment/attachment 23996.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1668, '47518', '3', 'Created  attachment 23997   [details] \nPatch to fix javadoc in tc5.5', 'Christopher Schultz', '2009-07-16 14:53:13 UTC', 'tomcat_attachment/attachment 23997.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1669, '41059', '1', 'You are not supposed to have any threads associated with this classloader at\nthis point.', 'Remy Maucherat', '2006-11-28 15:48:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1670, '41059', '2', 'Note that if you want a \'fix\', you can offer a patch disabling this code (with a\nsystem property or some other mechanism like that).', 'Remy Maucherat', '2006-11-28 15:53:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1671, '41059', '3', 'Here is a patch that uses a system property to disable this feature.  The \npatch was made against tomcat 5.5.20 source.\n\n--- WebappClassLoader.java.orig 2006-09-12 11:12:42.000000000 -0400\n+++ WebappClassLoader.java      2006-11-29 09:03:42.000000000 -0500\n@@ -163,7 +163,12 @@ public class WebappClassLoader\n      * resources.\n      */\n     boolean antiJARLocking = false;\n-\n+\n+    /**\n+     * Use clearReferences experimental code to deal with possible memory \nleaks.\n+     */\n+    private static final boolean ENABLE_CLEAR_REFERENCES = Boolean.valueOf\n(System.getProperty\n(\'org.apache.catalina.loader.WebappClassLoader.ENABLE_CLEAR_REFERENCES\', \'true\'\n)).booleanValue();\n+\n\n     // ----------------------------------------------------------- \nConstructors\n\n@@ -1489,7 +1494,9 @@ public class WebappClassLoader\n\n         // Clearing references should be done before setting started to\n         // false, due to possible side effects\n-        clearReferences();\n+        if(ENABLE_CLEAR_REFERENCES) {\n+            clearReferences();\n+        }\n\n         started = false;\n', 'James Birmingham', '2006-11-29 06:05:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1672, '41059', '4', 'I provided a patch to work around this issue.  ', 'James Birmingham', '2006-11-30 05:36:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1673, '41059', '5', 'Just marking as an enhancement.', 'Mark Thomas', '2006-12-02 09:12:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1674, '41059', '6', 'The patch was bad: it is wrong to disable the whole method.', 'Remy Maucherat', '2006-12-05 02:56:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1675, '41059', '7', 'Here is a new patch that disables only the code which resets the static and \nfinal variables.\n\n--- WebappClassLoader.java.orig 2006-09-12 11:12:42.000000000 -0400\n+++ WebappClassLoader.java      2006-12-05 08:34:52.000000000 -0500\n@@ -163,7 +163,16 @@ public class WebappClassLoader\n      * resources.\n      */\n     boolean antiJARLocking = false;\n-\n+\n+    /**\n+     * Use experimental code in clearReferences to reset static and final \nvariables\n+     * to deal with possible memory leaks.\n+     */\n+    private static final boolean ENABLE_NULLING_STATIC_FINAL_REFERENCES =\n+            Boolean.valueOf(System.getProperty(\n+                    \'org.apache.catalina.loader.WebappClassLoader.ENABLE_NULLI\nNG_STATIC_FINAL_REFERENCES\',\n+                    \'true\')).booleanValue();\n+\n\n     // ----------------------------------------------------------- \nConstructors\n\n@@ -1585,46 +1594,48 @@ public class WebappClassLoader\n\n         // Null out any static or final fields from loaded classes,\n         // as a workaround for apparent garbage collection bugs\n-        Iterator loadedClasses = ((HashMap) resourceEntries.clone()).values\n().iterator();\n-        while (loadedClasses.hasNext()) {\n-            ResourceEntry entry = (ResourceEntry) loadedClasses.next();\n-            if (entry.loadedClass != null) {\n-                Class clazz = entry.loadedClass;\n-                try {\n-                    Field[] fields = clazz.getDeclaredFields();\n-                    for (int i = 0; i < fields.length; i++) {\n-                        Field field = fields[i];\n-                        int mods = field.getModifiers();\n-                        if (field.getType().isPrimitive()\n-                                || (field.getName().indexOf(\'$\') != -1)) {\n-                            continue;\n-                        }\n-                        if (Modifier.isStatic(mods)) {\n-                            try {\n-                                field.setAccessible(true);\n-                                if (Modifier.isFinal(mods)) {\n-                                    if (!((field.getType().getName\n().startsWith(\'java.\'))\n-                                            || (field.getType().getName\n().startsWith(\'javax.\')))) {\n-                                        nullInstance(field.get(null));\n+        if(ENABLE_NULLING_STATIC_FINAL_REFERENCES) {\n+            Iterator loadedClasses = ((HashMap) resourceEntries.clone\n()).values().iterator();\n+            while (loadedClasses.hasNext()) {\n+                ResourceEntry entry = (ResourceEntry) loadedClasses.next();\n+                if (entry.loadedClass != null) {\n+                    Class clazz = entry.loadedClass;\n+                    try {\n+                        Field[] fields = clazz.getDeclaredFields();\n+                        for (int i = 0; i < fields.length; i++) {\n+                            Field field = fields[i];\n+                            int mods = field.getModifiers();\n+                            if (field.getType().isPrimitive()\n+                                    || (field.getName().indexOf(\'$\') != -1)) {\n+                                continue;\n+                            }\n+                            if (Modifier.isStatic(mods)) {\n+                                try {\n+                                    field.setAccessible(true);\n+                                    if (Modifier.isFinal(mods)) {\n+                                        if (!((field.getType().getName\n().startsWith(\'java.\'))\n+                                                || (field.getType().getName\n().startsWith(\'javax.\')))) {\n+                                            nullInstance(field.get(null));\n+                                        }\n+                                    } else {\n+                                        field.set(null, null);\n+                                        if (log.isDebugEnabled()) {\n+                                            log.debug(\'Set field \' + \nfield.getName()\n+                                                    + \' to null in class \' + \nclazz.getName());\n+                                        }\n                                     }\n-                                } else {\n-                                    field.set(null, null);\n+                                } catch (Throwable t) {\n                                     if (log.isDebugEnabled()) {\n-                                        log.debug(\'Set field \' + field.getName\n()\n-                                                + \' to null in class \' + \nclazz.getName());\n+                                        log.debug(\'Could not set field \' + \nfield.getName()\n+                                                + \' to null in class \' + \nclazz.getName(), t);\n                                     }\n                                 }\n-                            } catch (Throwable t) {\n-                                if (log.isDebugEnabled()) {\n-                                    log.debug(\'Could not set field \' + \nfield.getName()\n-                                            + \' to null in class \' + \nclazz.getName(), t);\n-                                }\n                             }\n                         }\n-                    }\n-                } catch (Throwable t) {\n-                    if (log.isDebugEnabled()) {\n-                        log.debug(\'Could not clean fields for class \' + \nclazz.getName(), t);\n+                    } catch (Throwable t) {\n+                        if (log.isDebugEnabled()) {\n+                            log.debug(\'Could not clean fields for class \' + \nclazz.getName(), t);\n+                        }\n                     }\n                 }\n             }\n', 'James Birmingham', '2006-12-05 05:47:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1676, '41059', '8', 'This is causing a problem for me also and I think requires a fix other than the \npatch given here. I get the following stack trace which shows that the error \noccurs on  Tomcat\'s clean up thread and therefore should be addressed with a \nmore permanent fix.\n\nThe problem arises because Tomcat tries to null a static/final field of a type \nthat has not yet been loaded, which causes the class initializer to run. In my \ncase, that initializer fetched a log from Commons Logging, which had \n(presumably) already been \'cleaned up\' by Tomcat, and threw an NPE.\n\n\n[FATAL] LoggingInit - Failed to obtain logger returning simple logger for \nCONFIG.com.commons.monitoring.util.Instrument \n<org.apache.commons.logging.LogConfigurationException: \njava.lang.NullPointerException (Caused by java.lang.NullPointerException)\n>org.apache.commons.logging.LogConfigurationException: \njava.lang.NullPointerException (Caused by java.lang.NullPointerException)\n	at org.apache.commons.logging.impl.LogFactoryImpl.newInstance\n(LogFactoryImpl.java:538)\n	at org.apache.commons.logging.impl.LogFactoryImpl.getInstance\n(LogFactoryImpl.java:235)\n	at org.apache.commons.logging.LogFactory.getLog(LogFactory.java:370)\n	at com.commons.logging.LoggingInit.getLog(LoggingInit.java:334)\n	at sun.reflect.GeneratedMethodAccessor22.invoke(Unknown Source)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n	at java.lang.reflect.Method.invoke(Unknown Source)\n	at com.commons.catalog.CatalogUtils.getLog(CatalogUtils.java:75)\n	at com.commons.catalog.GenericTrace.<init>(GenericTrace.java:279)\n	at com.commons.catalog.SimpleTrace.<init>(SimpleTrace.java:34)\n	at com.commons.monitoring.util.Instrument.<clinit>\n(AbstractRuntimeInstrument.java:44)\n	at sun.misc.Unsafe.ensureClassInitialized(Native Method)\n	at sun.reflect.UnsafeFieldAccessorFactory.newFieldAccessor(Unknown \nSource)\n	at sun.reflect.ReflectionFactory.newFieldAccessor(Unknown Source)\n	at java.lang.reflect.Field.acquireFieldAccessor(Unknown Source)\n	at java.lang.reflect.Field.getFieldAccessor(Unknown Source)\n	at java.lang.reflect.Field.get(Unknown Source)\n	at org.apache.catalina.loader.WebappClassLoader.clearReferences\n(WebappClassLoader.java:1612)\n	at org.apache.catalina.loader.WebappClassLoader.stop\n(WebappClassLoader.java:1496)\n	at org.apache.catalina.loader.WebappLoader.stop(WebappLoader.java:734)\n	at org.apache.catalina.core.StandardContext.stop\n(StandardContext.java:4398)\n	at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1067)\n	at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1067)\n	at org.apache.catalina.core.StandardEngine.stop(StandardEngine.java:448)\n	at org.apache.catalina.core.StandardService.stop\n(StandardService.java:510)\n	at org.apache.catalina.core.StandardServer.stop(StandardServer.java:734)\n	at org.apache.catalina.startup.Catalina.stop(Catalina.java:602)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:577)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n	at java.lang.reflect.Method.invoke(Unknown Source)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)\nCaused by: java.lang.NullPointerException\n\n\nUpgrading Commons Logging to v1.1 on Tomcat\'s server classpath removes the NPE \nbut the problem isn\'t really fixed.\n\nPossible solution is to use two phases: first collect all the non-null Fields \n(Field.get will cause the declared type to be loaded) then null them.', 'Michael Moynihan', '2007-05-04 09:20:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1677, '41059', '9', 'Created  attachment 22408   [details] \nAdds preliminary pass to clearReferences to prevent untimely class initialization\n\nThis issue is resulting in bugs (40212 and 43867, specifically maybe others) being reported to log4j.\n\nThe patch seems reasonable and compiles, but has not been tested.  I\'m putting here and inviting those currently tracking 43867 to check that it fixes the problems that they are observing and add comments here.', 'Curt Arnold', '2008-08-07 22:09:08 UTC', 'tomcat_attachment/attachment 22408.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1678, '41059', '10', 'Curt\'s patch fixes the problem without disabling any part of the code.', 'Gili', '2008-08-08 07:35:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1679, '41059', '11', 'BTW, this causes Tomcat to hang when shutting down (randomly) for me. It happens rather frequently and is a problem because I restart Tomcat nightly (due to unrelated memory leak problems). I am increasing severity to \'major\' but leaving the priority as is. Curt I will gladly test out your patch if you can provide me with a drop-in JAR file or otherwise indicate how I can patch my existing Tomcat system without rebuilding the entire thing from source.', 'Gili', '2008-09-04 19:04:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1680, '41059', '12', 'Could this bug be taken into consideration?\n\nIn my case, I have the symptoms outlined in  bug #43867  and this is caused by the following situation (I\'m using Tomcat 5.5.26):\n\n- WebappClassLoader.clearReferences() at line 1617 inspects some static fields in order to set them to null afterwards, using reflection\n- one of these fields seems to be a field of an Axis2 class (I have an Axis2 Servlet with load-on-startup configured in my web.xml); field.get(null) causes the VM to pass through sun.misc.Unsafe.ensureClassInitialized(Class) (in other words: Tomcat is trying to inspect a static field of a class that hasn\'t ever be initialized before)\n- that method of Sun implementation causes specifically org.apache.axis2.context.OperationContext to be initialized; this class has a static field declared as:\nprivate static final Log log = LogFactory.getLog(OperationContext.class);\n- this static declaration causes a new Log4JLogger to be created; this is still in charge of the WebappClassLoader, so when Log4JLogger constructor calls getLogger(), a call to org.apache.log4j.LogManager.getLoggerRepository() is made\n- however, at this time the static field repositorySelector is null, probabily because it has been set to null by a previous iteration of the same loop that is in running in WebappClassLoader.clearReferences() (this is just a hypothesis)\n\nSo, from what I have said, I think that either:\n- WebappClassLoader.clearReferences() should skip to inspect fields of classes that have not been initialized yet, otherwise they will be initialized at that point (and it might be too late!)\n- I didn\'t look at Curt\'s patch, but I assume he worked on this issue and he followed a 2-pass approach that also solves it\n\nI hope this helps in any way.\nMauro.', 'Mauro Molinari', '2009-01-13 01:57:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1681, '41059', '13', 'FYI, Glassfish fixed this bug within a week of being reported:  https://glassfish.dev.java.net/issues/show_bug.cgi?id=6637 \n\nI\'ll leave it up to you to draw your own conclusions.', 'Gili', '2009-01-13 03:31:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1682, '41059', '14', 'This has been fixed in trunk and proposed for 6.0.x and 5.5.x\n\nKeep in mind that ENABLE_CLEAR_REFERENCES=true is intended to:\na) work around GC issues in old JVMs (unlikely to an issue with current jvms)\nb) work around one source of memory leaks in webapps that are buggy or use buggy libraries\n\nThe very nature of the ENABLE_CLEAR_REFERENCES code is that it is likely to cause problems - as it does with log4j. Whilst this patch (thanks for the patch by the way) will reduce the chances or seeing errors, it will not eliminate them.\n\nA better approach is to set ENABLE_CLEAR_REFERENCES=false and to use a profiler to identify and fix the root causes of any memory leaks. A well-written app using well behaved libraries should not need ENABLE_CLEAR_REFERENCES=true\n\nIf when doing this you find a memory leak in the Tomcat code (hopefully you won\'t - all the ones we know about should be fixed) then please open a new Bugzilla entry and report it.', 'Mark Thomas', '2009-07-17 10:30:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1683, '40551', '1', 'Created  attachment 18890   [details] \nRecommended patch', 'Chris Chandler', '2006-09-20 01:34:40 UTC', 'tomcat_attachment/attachment 18890.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1684, '40551', '2', 'A slightly modified version of your patch has been applied to SVN and will be\nincluded in 5.5.21 onwards.\n\nMany thanks for the patch.', 'Mark Thomas', '2006-12-11 19:47:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1685, '40551', '3', 'Re-opening to change resolution type.', 'Mark Thomas', '2006-12-13 18:06:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1686, '40551', '4', 'As per the discussion on the dev list -\n http://marc.theaimsgroup.com/?t=116592092300008&r=1&w=2  - this patch will nto be\ncommmitted.\n\nThe JvmRouteBinderValve should provide the functionality you require in this case.', 'Mark Thomas', '2006-12-13 18:09:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1687, '40551', '5', 'Created  attachment 19470   [details] \nAdditional strings for StringManager\n\nAdded an additional string for logging', 'Chris Chandler', '2007-01-26 12:32:06 UTC', 'tomcat_attachment/attachment 19470.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1688, '40551', '6', 'Created  attachment 19471   [details] \nModifications to JvmRouteBinderValve\n\nModifications made to JvmRouteBinderValve to make it agnostic of whether or not\nin-memory clusting is being used.', 'Chris Chandler', '2007-01-26 12:33:11 UTC', 'tomcat_attachment/attachment 19471.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1689, '40551', '7', 'Please reopen and investigate this bug.  I have made the modifications to the\nJvmRouteBinderValve as per the discussion on the dev mailing list.  My initial\ntesting shows this valve now works as expected for JDBC clustering.', 'Chris Chandler', '2007-01-26 12:34:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1690, '40551', '8', 'Filip, what do you think about the patch as it is right now, for Tomcat 5.5 (not\n6.0)?', 'Yoav Shapira', '2007-03-25 14:47:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1691, '40551', '9', 'I have applied a modified fix to trunk and proposed it for 6.0.x and 5.5.x', 'Mark Thomas', '2009-07-16 13:11:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1692, '47515', '1', 'Many thanks, can you please attach the patch as an attachment as line breaks get inserted into your copy paste', 'Filip Hanik', '2009-07-13 12:41:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1693, '47515', '2', 'Created  attachment 23972   [details] \nDeltaManager\'s patch\n\n Sorry.\n\n This is the patch for DeltaManager.\n\n Best regards.', 'Ryuichi Yoshihara', '2009-07-13 17:23:30 UTC', 'tomcat_attachment/attachment 23972.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1694, '47515', '3', 'Created  attachment 23973   [details] \nDeltaManager\'s patch\n\nSorry, I miss the patch.\n\nThis is the patch for DeltaManager.\n\nBest regards.', 'Ryuichi Yoshihara', '2009-07-13 18:02:10 UTC', 'tomcat_attachment/attachment 23973.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1695, '40380', '1', 'Have you run into any issues with this, or was it just a random code inspection?', 'Yoav Shapira', '2006-12-25 05:43:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1696, '40380', '2', 'Just to butt in here.  \n\nThe easiest fix is to move or copy the if(expiring) inside the synchronized()\nsection.\n\nDoes such a large block have to be synchronized(this) {} ?  I can\'t see any\nother code using synchronized(this) in the class (or synchronized(session) in\nthe package), so I guess the only thing being protected is the\nif(expiring==false) { expiring=true; } test and set.\n\n\nAs things stand now is the StandardSession author sure there is no issue of\nneeding to make the JVM perform a memory write barrier ?  To ensure that\nexpiring=true is flushed for other threads see it immediately.  Otherwise the\nJVM maybe free to optimize (and defer) this write to memory (unless you start\ngetting into declaring \'expiring\' volatile).\n\n\nSuggestion:\n\nif (expiring)\n    return;\n\nsynchronized (this) {\n    if (expiring)\n        return;\n    if (manager == null)\n        return;\n    expiring = true;\n}\n\n// From here is no need to keep the lock AFAIKS and by closing the\nsynchronized() we will ensure memory write barrier.\n\n// Towards the end of the function it sets expiring=false; I dont think the any\ncode in critical to seeing the expiring==false again, not once isValid==false in\nanycase.', 'Darryl Miles', '2006-12-27 01:42:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1697, '40380', '3', 'This has been fixed in trunk and proposed for 6.0.x and 5.5.x', 'Mark Thomas', '2009-07-14 10:36:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1698, '39231', '1', '1. Can you point specifically to the section in the JAAS specification to which\nyou\'re referring?\n\n2. If you could submit a code patch for Tomcat for this matter, that would be\ngreat.  Thanks!', 'Yoav Shapira', '2006-04-13 17:52:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1699, '39231', '2', '1. \n http://java.sun.com/j2se/1.5.0/docs/api/javax/security/auth/login/LoginContext.h \ntml\n\n\'A typical caller instantiates a LoginContext with a name and a \nCallbackHandler...\'\n\n\'Once the caller has instantiated a LoginContext, it invokes the login method \nto authenticate a Subject...\'\n\n\'To logout the Subject, the caller calls the logout method. As with the login \nmethod, this logout method invokes the logout method for the configured \nmodules...\'\n\n\n2. Unfortunately, I am on a tight deadline for my company, so can not work on \nthe patch (for myself I\'ve just create a workaround for my logout requirements \nby utilizing the HttpSessionBindingListener interface, though I haven\'t tested \nit yet). ', 'Seva Popov', '2006-04-13 18:11:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1700, '39231', '3', 'OK, thanks.  If/when you get a chance to work on a patch, I will be glad to\nreview and commit it as necessary.  I myself don\'t have the time to develop one\nright now either, but I wanted to make sure you were still interested.  Thanks.', 'Yoav Shapira', '2006-04-13 18:21:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1701, '39231', '4', 'Normal is P3, not P1.', 'Yoav Shapira', '2006-04-13 21:34:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1702, '39231', '5', 'I don\'t have a patch, but I do have a solution that I can outline here.  \n\nBasically, the LoginContext needs to be saved in the session so logout can be \ncalled on it when the session is invalidated or expires.  Currently, this is a \nproblem because the LoginContext is created in the JAASRealm and discarded \nafter login is called and the only place that the session is available is in \nthe Authenticator.\n\nHere is a proposed solution:\n\n1) Create a pojo that has getPrincipal() and getLoginContext().  Let\'s call \nthis pojo, RealmPrincipal.\n\n2) Change the Realm\'s authenticate methods to return a RealmPrincipal object \ninstead of a Principal.\n\n3) Change the Realm impl\'s to create and return the RealmPrincipal, including \nthe LoginContext where appropriate.\n\n4) Change the Authentcator\'s to check to see if the LoginContext is not null \nand add it to the session notes the same as currently is being done with the \nprincipal.\n\n5) Change the StandardSession expires() method to check for the LoginContext \nin the notes and call logout on it, if it is present.\n\n\nI hope this is clear and sufficient for a timely fix.  Thanks.', 'Jason Chaffee', '2006-04-19 00:45:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1703, '39231', '6', 'I have fixed trunk and proposed the patch for 6.0.x and 5.5.x', 'Mark Thomas', '2009-07-07 09:42:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1704, '39231', '7', 'Note that if you have multiple Tomcat nodes in a cluster and use the JAASRealm then since the LoginContext is not Serializable there will be some scenarios where if a node fails the logout method will never be called.', 'Mark Thomas', '2009-08-03 02:17:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1705, '39231', '8', 'This has been fixed in 6.0.x and will be included in 6.0.21 onwards.', 'Mark Thomas', '2009-11-03 16:09:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1706, '37984', '1', 'Created  attachment 17249   [details] \nHandle password digests that are prefixed with \'{MD5}\'.', 'Eric Lenio', '2005-12-21 05:52:39 UTC', 'tomcat_attachment/attachment 17249.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1707, '37984', '2', 'Thanks for the patch and sorry for the delay.\n\nThis has been applied to trunk and proposed for 6.0.x and 5.5.x', 'Mark Thomas', '2009-07-01 15:15:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1708, '37984', '3', 'Fixed in 6.0.x and will be included in 6.0.21 omwards', 'Mark Thomas', '2009-07-07 06:38:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1709, '47440', '1', 'Created  attachment 23890   [details] \nRemove setValidattionQuery() calls', 'Sebb', '2009-06-27 05:19:01 UTC', 'tomcat_attachment/attachment 23890.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1710, '47440', '2', 'Created  attachment 23891   [details] \nUse validationQuery instead of \'SELECT 1\'', 'Sebb', '2009-06-27 05:19:46 UTC', 'tomcat_attachment/attachment 23891.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1711, '47440', '3', 'This would change the way the tests run, and that is not the intention of your enhancement.\nI cant remove the set validation query without replacing it with something, ie a default query, that can be swapped out.\n\nThere is no default query set', 'Filip Hanik', '2009-06-28 16:47:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1712, '47440', '4', 'OK, I\'d not noticed that the DefaultProperties.validationQuery field was not propagated by DefaultTestCase.createDefaultDataSource().\n\nSo the first patch was wrong, but the original problem still remains - the tests are DB-specific.\n\nTwo possible solutions:\n- DefaultTestCase.createDefaultDataSource() could set the query from the default\n- change the patch to pick up the default query and use that.\n\nThe other patch is surely OK as it stands?', 'Sebb', '2009-06-28 17:36:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1713, '47439', '1', 'I\'m not aware of any driver that returns null, when there is a checked exception on the method Driver.connect()', 'Filip Hanik', '2009-06-27 11:27:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1714, '47439', '2', 'The Javadoc for Driver.connect() states:\n\n>>\nAttempts to make a database connection to the given URL. The driver should return \'null\' if it realizes it is the wrong kind of driver to connect to the given URL. This will be common, as when the JDBC driver manager is asked to connect to a given URL it passes the URL to each loaded driver in turn. \n\nThe driver should throw an SQLException if it is the right driver to connect to the given URL but has trouble connecting to the database. \n<<\n\nAs it happens, the JDBC driver for Derby also returns null in other cases, which is how I found the problem.', 'Sebb', '2009-06-27 12:09:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1715, '47439', '3', 'Here\'s the result of using a \'jdbc:oracle:\' URL with the Derby JDBC client:\n\n Testcase: testException(org.apache.tomcat.jdbc.test.TestException): Caused an ERROR\n null\n java.sql.SQLException\n     at org.apache.tomcat.jdbc.pool.ConnectionPool.createConnection(ConnectionPool.java:540)\n     at org.apache.tomcat.jdbc.pool.ConnectionPool.borrowConnection(ConnectionPool.java:471)\n     at org.apache.tomcat.jdbc.pool.ConnectionPool.init(ConnectionPool.java:370)\n     at org.apache.tomcat.jdbc.pool.ConnectionPool.<init>(ConnectionPool.java:118)\n     at org.apache.tomcat.jdbc.pool.DataSourceProxy.createPool(DataSourceProxy.java:85)\n     at org.apache.tomcat.jdbc.pool.DataSourceProxy.getConnection(DataSourceProxy.java:96)\n     at org.apache.tomcat.jdbc.test.TestException.testException(TestException.java:22)\n Caused by: java.lang.NullPointerException\n     at org.apache.tomcat.jdbc.pool.PooledConnection.connect(PooledConnection.java:168)\n     at org.apache.tomcat.jdbc.pool.ConnectionPool.createConnection(ConnectionPool.java:517)\n\n===\n\nThis is what happens if a local database \'jdbc:derby:dbname\' cannot be found:\n\nTestcase: testGetConnection(org.apache.tomcat.jdbc.test.TestGetConnection): Caused an ERROR\nnull\njava.sql.SQLException\n    at org.apache.tomcat.jdbc.pool.ConnectionPool.createConnection(ConnectionPool.java:540)\n    at org.apache.tomcat.jdbc.pool.ConnectionPool.borrowConnection(ConnectionPool.java:471)\n    at org.apache.tomcat.jdbc.pool.ConnectionPool.init(ConnectionPool.java:370)\n    at org.apache.tomcat.jdbc.pool.ConnectionPool.<init>(ConnectionPool.java:118)\n    at org.apache.tomcat.jdbc.pool.DataSourceProxy.createPool(DataSourceProxy.java:85)\n    at org.apache.tomcat.jdbc.pool.DataSourceProxy.getConnection(DataSourceProxy.java:96)\n    at org.apache.tomcat.jdbc.test.TestGetConnection.testGetConnection(TestGetConnection.java:32)\nCaused by: java.lang.NullPointerException\n    at org.apache.tomcat.jdbc.pool.PooledConnection.connect(PooledConnection.java:168)\n    at org.apache.tomcat.jdbc.pool.ConnectionPool.createConnection(ConnectionPool.java:517)', 'Sebb', '2009-06-27 13:03:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1716, '47439', '4', 'In both cases you get a SQLException, as specified by the API for getting a connection.', 'Filip Hanik', '2009-06-27 15:38:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1717, '47439', '5', 'I think we are talking about two different APIs here.\n\nThe Driver.connect() API specifically says that it returns null for some cases.\n\nI\'m not sure which API you are referring to, as I could not find any Javadoc for any of the methods involved.\n\nThe NPE is caught later and converted into an SQLException, but the resulting Exception is difficult to debug.', 'Sebb', '2009-06-27 16:10:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1718, '47439', '6', '(In reply to  comment #2 )\n> The Javadoc for Driver.connect() states:\n> \n> >>\n> Attempts to make a database connection to the given URL. The driver should\n> return \'null\' if it realizes it is the wrong kind of driver to connect to the\n> given URL. This will be common, as when the JDBC driver manager is asked to\n> connect to a given URL it passes the URL to each loaded driver in turn. \n> \n> The driver should throw an SQLException if it is the right driver to connect to\n> the given URL but has trouble connecting to the database. \n> <<\n> \n> As it happens, the JDBC driver for Derby also returns null in other cases,\n> which is how I found the problem.\n\nThe \'other cases\' turned out to be a red herring - I was using the wrong driver, so it was equivalent to the first case. Derby JDBC behaves as per the API, i.e. returns null if it cannot handle the url.', 'Sebb', '2009-06-28 05:31:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1719, '38352', '1', 'Created  attachment 17486   [details] \nA diff file incorporating proposed changes.', 'George Sexton', '2006-01-22 20:28:24 UTC', 'tomcat_attachment/attachment 17486.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1720, '38352', '2', '(In reply to  comment #0 )\n\nOk, lets see if I can get myself fired here ;-).\n\n> This patch adds additional entries to the catalina.policy file. Specifically:\n> The catalina.base/shared directory is added and given equal permissions to\n> catalina.home/common\n\nIf it works for you, fine.  Change it in your copy.  However, in general \n${catalina.base}/shared will consist of untrusted code, so I don\'t think it\'s \na good idea to trust it in the default policy file (which, by design, tries to \nbe as strict as possible).\n\n> java.io.tmpdir is now readable.\n\nDon\'t see the need.  If you depend on this, your app is non-portable since \nthere is no requirement that javax.servlet.context.tempdir has any relation to \njava.io.tmpdir.  In fact, a servlet container is perfectly free to set \njava.io.tmpdir to /dev/null if it wants.\n\n> javax.servlet.context.tempdir is now readable. I think to be compliant with \nthe\n> spec, this must be allowed.\n\nThis is a request attribute, not a System attribute.  This does nothing.\n\n> Directory specified by java.io.tmpdir (which is what tomcat points\n> javax.servlet.context.tempdir to) is now read, write, delete. Again, I think \nthe\n> spec requires this.\n\nWould need to research this one.  Like pretty much everybody else, I don\'t \nspend enough time testing with SM.\n', 'william.barker', '2006-02-21 03:24:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1721, '38352', '3', 'Making java.io.tmpdir writable is fixing an implementation specific issue. The\nspec says that the container MUST make temporary working directories available.\n\nThe IMPLEMENTATION that tomcat uses is to set javax.servlet.context.tempdir to\njava.io.tempdir\n\n\nSo, my making that writable fixes an implementation specific issue for\ntomcat. I\'ll say it again in case I wasn\'t clear.\n\n1)	The spec says javax.servlet.context.tempdir must be a working\ndirectory\n2)	TOMCAT sets that value to the value of java.io.tmpdir\n\nTHEREFORE\n\nFOR THE TOMCAT IMPLEMENTATION\n\njava.io.tmpdir MUST BE WRITABLE.\n', 'George Sexton', '2006-02-21 18:51:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1722, '38352', '4', 'I was wrong. tempdir is not defined in terms of java.io.tmpdir. I apologize to\nBill whom I said was wrong and wrote an inflamatory and ill-advised message to.', 'George Sexton', '2006-02-21 23:02:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1723, '38352', '5', 'Created  attachment 17767   [details] \nSimple JSP page to exibit the bug\n\nYes, you have a legitimate bug here. It is true that\njavax.servlet.context.tempdir is not writable with the default catalina.policy\nsettings (in violation of the spec) when running with a SM.', 'william.barker', '2006-02-22 05:51:07 UTC', 'tomcat_attachment/attachment 17767.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1724, '38352', '6', 'So Bill and George, if I understand the result of your debate correctly, the\nfollowing lines from George\'s patch should be added to the default policy file:\n\npermission java.util.PropertyPermission \'java.io.tmpdir\', \'read\';        \npermission java.util.PropertyPermission \'javax.servlet.context.tempdir\', \'read\';	\npermission java.io.FilePermission \'${java.io.tmpdir}${file.separator}-\', \'read,\nwrite, delete\';\n\nIs that right?\n', 'Yoav Shapira', '2006-12-24 18:06:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1725, '38352', '7', 'Not quite.\n\nThe javax.servlet.context.tempdir is a context attribute rather than a system property. There is a complication that the name of the work directory varies per context and is not know when the policy file is parsed.\n\nIn trunk, 6.0.x and 5.5.x the WebappLoader sets the necessary permissions when it is started. However, the JasperLoader gets its permissions from the JspRuntimeContext that only gave a read permission for those files.\n\nI have patched trunk to give JasperLoader read/write and proposed the fix for 6.0.x and 5.5.x', 'Mark Thomas', '2009-06-19 06:06:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1726, '38352', '8', 'Update status', 'Mark Thomas', '2009-06-19 06:06:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1727, '38352', '9', 'This has been fixed in 6.0.x and will be included in 6.0.21 onwards.', 'Mark Thomas', '2009-06-24 12:36:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1728, '47046', '1', 'This has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2009-04-29 16:32:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1729, '47046', '2', 'This has been fixed in 6.0.x and will be included in 6.0.21 onwards.', 'Mark Thomas', '2009-05-22 09:41:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1730, '47046', '3', 'Re-opening as the port from trunk missed some Jk components that have been removed in trunk but still exist in 6.0.x', 'Mark Thomas', '2009-08-11 06:53:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1731, '47046', '4', 'Created  attachment 24125   [details] \nAdditional patch required to clean up Jk components', 'Mark Thomas', '2009-08-11 06:54:57 UTC', 'tomcat_attachment/attachment 24125');
INSERT INTO `tomcatbeforefixcomments` VALUES (1732, '37929', '1', '***  Bug 37699  has been marked as a duplicate of this bug. ***', 'Pierre Delisle', '2005-12-16 02:00:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1733, '37929', '2', 'In the future, please attach patches from GlassFish rather than inlining \nthem.  As it is, I can\'t do anything about this since I\'ve already seen the \npatch, so I\'m tainted from an IP persective.\n\nBefore this patch can be accepted, we need to know that your submission is \ncovered by a CCLA.  Otherwise, Sun owns the code, so it can\'t be incorporated \ninto Tomcat.', 'william.barker', '2005-12-16 06:57:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1734, '37929', '3', 'Hi William,\n\nThanks for looking into this so quickly.\n\nThe situation is the same as the one you encountered\nwith Kin-Man on  bug 35351 :\n\n>> Just to be clear, is this patch is still covered by your CCLA?  In English, is \n>> this a grant from glassfish to that ASF?\n>> \n\n> This is just a patch, and there is no license or copyright, so YES.\n\nLet me know if you need anything else.\n\n', 'Pierre Delisle', '2005-12-16 07:32:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1735, '37929', '4', '(In reply to  comment #3 )\n> Hi William,\n> Thanks for looking into this so quickly.\n> The situation is the same as the one you encountered\n> with Kin-Man on  bug 35351 :\n> >> Just to be clear, is this patch is still covered by your CCLA?  In \nEnglish, is \n> >> this a grant from glassfish to that ASF?\n> >> \n> > This is just a patch, and there is no license or copyright, so YES.\n> Let me know if you need anything else.\n\nI accepted Kin-Man\'s patch based on the fact that he is a Tomcat committer, \nand as such should have a CCLA on file with the ASF.  If that is still valid, \nthan that means that Sun has trusted him with deciding about donating Sun code \nto the ASF.  Were I to find out that Kin-Man\'s CCLA has been revoked, I would \nrevert the commit in a heart-beat :).\n\nIANAL, but from all of the ASF lists that I have followed, the above reasoning \ndoesn\'t even hold a drop of water.  So again I ask if you have a CCLA on file \nso that the ASF can accept your donation of Sun\'s code?  \n\nThe patch is nice, so I\'m hoping that you say yes ;-).\n\n\n', 'william.barker', '2005-12-16 09:34:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1736, '37929', '5', 'With very minor style changes, your patch has been committed to SVN trunk, and \nwill appear in 5.5.15.\n\nThanks much!', 'william.barker', '2005-12-18 02:09:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1737, '37929', '6', 'It seems the problem still exists in the Tomcat 6.0.18. Moreover, I took a look at the PageContextImpl.java class and I do not see there any fixes related to this bug. I browsed svn repository and it looks like this commit has reverted the fix:\n\n http://svn.apache.org/viewvc/tomcat/jasper/tc6.0.x/src/share/org/apache/jasper/runtime/PageContextImpl.java?view=log \n\nIs it supposed to be so? Or fix was reverted by mistake?', 'Pavel Sher', '2009-04-14 13:44:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1738, '37929', '7', 'Moving to Tomcat 6', 'Mark Thomas', '2009-04-14 16:24:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1739, '37929', '8', 'Thanks for the report and the research. This has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2009-04-16 08:22:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1740, '37929', '9', 'This has been fixed in 6.0.x and will be included in 6.0.20 onwards.', 'Mark Thomas', '2009-04-28 06:45:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1741, '47013', '1', 'I don;t see this with trunk. Looks to be a duplicate of  bug 41606  that was fixed recently.\n\n*** This bug has been marked as a duplicate of  bug 41606  ***', 'Mark Thomas', '2009-04-14 14:58:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1742, '47013', '2', 'Shouldn\'t that precompile flag be changed though (bottom of the note).', 'Robert Flaherty', '2009-04-14 15:07:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1743, '47013', '3', 'Re-opening to track the secondary issue. It has been fixed in trunk and proposed for 6.0.x.', 'Mark Thomas', '2009-04-14 15:19:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1744, '47013', '4', 'This has been fixed in trunk and will be in 6.0.20 onwards.', 'Mark Thomas', '2009-05-02 18:33:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1745, '42579', '1', 'Created  attachment 20310   [details] \nMy patch to fix this issue', 'Brandon DuRette', '2007-06-04 14:14:32 UTC', 'tomcat_attachment/attachment 20310.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1746, '42579', '2', 'By the way of JNDI/Tomcat + Active Directory:\n\nAs JNDIRealm is/was never quite happy with Active\nDirectory for a variety of reasons. After a bunch\nof frustrations (of which the lying isUserInGruop()\nwas one of the worst), I decided to write a new \nRealm class, which I may contribute. \n\n http://www.a-weinert.de/java/docs/aWeinertBib/de/a_weinert/realm/ADweRealm.html \n\nADweRealm seaches only one way (performance!) from \n(authenticated) users to their groups. It follows \nthe quite important group-in-group relations, and so on.\n\nExperiences in a Windows Server 2003 domain (3000+ user\naccounts, hundreds of groups etc.) are quite encouraging.\nNone of the Tomcat + Active Directory problems, of which\nGoogle is full of, arised any more.\n\nSorry, this comment is not quite related to below\nbug, bat anybody facing AD problems might as well give\nADweRealm a try. For 6.0.x, just  put \n http://www.a-weinert.de/java/catErgWe.jar \ninto lib, and configure accordingly:\n\n   <!--  ADweRealm added 17.02.2008, a Realm for Active Directory      \n      Special development logging can be switched on by \n       devLog=\'C: Programme Apache Tomcat logs awRe.log\'\n      or\n       devLog=\' \'\n      which gives above as default.           \n      Omit for no extra logging by de.a_weinert.realm.ADweRealm.DevLog\n      \n      Default attributes (can be omitted if value fits) are:\n          userRoleName=\'memberOf\' \n          userSubtree=\'true\'\n          userSearch=\'(sAMAccountName={0})\'\n          shortRoles=\'true\'\n          followRoles=\'true\'\n       -->\n   <Realm name=\'ADsso\' className=\'de.a_weinert.realm.ADweRealm\' debug=\'999\'\n      devLog=\'C: Programme Apache Tomcat logs awRe.log\'\n      allRolesMode=\'authOnly\'\n      \n      connectionURL=\'ldap://193.175.115.2:389\'\n      alternateURL=\'ldap://193.175.115.4:389\'\n      connectionName=\'CN=ldap Leser,CN=Users,DC=FB3-MEVA,DC=fh-bochum,DC=de\'\n      connectionPassword=\'mauseSpatz\'\n\n      userBase=\'DC=FB3-MEVA,DC=fh-bochum,DC=de\'\n      defaultRole=\'fb3-meva_user\'\n      shortRoles=\'short\'\n    />  \n\n\n\n \n (what\nJNDIRealm can\'tlinks ', 'Dr. Albrecht Weinert', '2008-02-27 22:48:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1747, '42579', '3', 'This has been fixed in 6.0.x and will be included in 6.0.20 onwards.', 'Mark Thomas', '2009-04-28 06:42:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1748, '42579', '4', 'This has been fixed in 5.5.x and will be included in 5.5.28 onwards.', 'Mark Thomas', '2009-05-25 02:51:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1749, '42579', '5', 'I looked at the changes that were made in the 6.0 branch and note that you factored the code in my patch into a method, but then failed to invoke it, so the bug still exists. This is in  revision 769402 . I didn\'t go check to see if the same mistake was made in the 5.5 branch.', 'Brandon DuRette', '2009-10-08 08:55:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1750, '42579', '6', '(In reply to  comment #5 )\nThis was corrected in a later commit for 6.0.x. 5.5.x is also fine.', 'Mark Thomas', '2009-10-21 14:54:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1751, '46354', '1', 'Upgrading to 5.5.27 may well fix this.', 'Mark Thomas', '2008-12-05 09:04:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1752, '46354', '2', 'I will try, but nothing in the release notes jumped out at me...', 'Ed Hill', '2008-12-05 09:16:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1753, '46354', '3', 'I\'ve upgraded to Tomcat-5.5.27 and Java 1.6.0_11 and I still am getting the exception (with a slightly different stack trace - just not showing the arraycopy)\n\nDec 8, 2008 10:57:20 AM org.apache.catalina.core.StandardWrapperValve invoke\nSEVERE: Servlet.service() for servlet StripesDispatcher threw exception\njava.lang.ArrayIndexOutOfBoundsException\n        at java.lang.String.getChars(String.java:855)\n        at org.apache.jasper.runtime.BodyContentImpl.write(BodyContentImpl.java:146)\n        at org.apache.jasper.runtime.BodyContentImpl.write(BodyContentImpl.java:159)\n        at org.apache.jsp.tag.web.labelAndValue_tag._jspx_meth_c_005fif_005f1(labelAndValue_tag.java:1069)\n        at org.apache.jsp.tag.web.labelAndValue_tag._jspx_meth_c_005fif_005f0(labelAndValue_tag.java:1039)\n        at org.apache.jsp.tag.web.labelAndValue_tag.doTag(labelAndValue_tag.java:304)\n        at org.apache.jsp.WEB_002dINF.pages.admissions.prospects.Prospect.inspect.person_002dtab_jsp._jspx_meth_tags_005flabelAndValue_005f0(person_002dtab_jsp.java:608)\n        at org.apache.jsp.WEB_002dINF.pages.admissions.prospects.Prospect.inspect.person_002dtab_jsp._jspService(person_002dtab_jsp.java:199)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:98)', 'Ed Hill', '2008-12-08 09:06:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1754, '46354', '4', 'This is caused by bug in implementation of o.a.jasper.runtime.BodyContentImpl#setWriter(Writer)\nin current tc6.0.x and tc5.5.x code (and thus in TC 6.0.18, TC 5.5.27).\n\nThat method is called by PageContextImpl#pushBody(Writer) and is the one that prepares the bodycontent instance for reuse.\n\nThe current code, with comments omitted, is the following:\n\n558:    void setWriter(Writer writer) {\n559:        this.writer = writer;\n560:        closed = false;\n561:        if (writer != null) {\n571:            if (bufferSize != 0) {\n572:                bufferSizeSave = bufferSize;\n573:                bufferSize = 0;\n574:            }\n575:        } else {\n576:            bufferSize = bufferSizeSave;\n577:            clearBody();\n578:        }\n579:    }\n\nThe unconditional assignment on line 576 is wrong.\n\nConsider the following sequence of events:\n1. setWriter(null)\n   bufferSize = bufferSizeSave  is assigned 0 // <- this is wrong (1)\n2. write more than 512 bytes of data\n   bufferSize becomes > 512\n\n3. setWriter(writer)\n   bufferSizeSave = bufferSize  is assigned value that is > 512\n\n4. setWriter(null)\n   bufferSize = bufferSizeSave  is > 512\n   BodyContentImpl#clear() is called and shrinks the buffer to its default size of 512, bufferSize becomes 512\n5. write several bytes of data\n\n6. setWriter(null)\n   bufferSize = bufferSizeSave  is > 512  // <- this is wrong (2)\n7. write more than 512 bytes of data\n\nAt this point the ArrayIndexOutOfBoundsException should occur, because bufferSize is > 512, but the buffer is only 512 bytes.', 'Konstantin Kolinko', '2009-01-03 16:14:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1755, '46354', '5', 'Created  attachment 23076   [details] \nwebapp that reproduces the issue\n\nTo reproduce the issue:\n\n1. deploy the war file\n2. append the following line to conf/catalina.properties :\norg.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true\n3. launch the server and access  http://localhost:8080/bug46354/ \n4. Error 500 report is observed with stacktrace of \njava.lang.ArrayIndexOutOfBoundsException exception\n\nWithout step 2. the page works and displays some text.\n\nReproducible in TC 5.5.27 and in current tc6.0.x', 'Konstantin Kolinko', '2009-01-03 17:11:01 UTC', 'tomcat_attachment/attachment 23076.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (1756, '46354', '6', 'Created  attachment 23077   [details] \npatch for BodyContentImpl class of tc6.0.x\n\nI think that the straightforward way to fix this is to remove the private bufferSizeSave field and the trick from the #setWriter() method and to overwrite the #getBufferSize() method.\n\nThe bufferSize field is just declared in JspWriter and is not used for calculations neither there nor in BodyContent class, nor the JSP 2.1 spec requires any calculations from them (all methods except the #getBufferSize() getter are abstract). All the calculations are implemented in BodyContentImpl.\n\nThus the attached patch. It fixes the issue.', 'Konstantin Kolinko', '2009-01-03 18:33:11 UTC', 'tomcat_attachment/attachment 23077.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1757, '46354', '7', 'Many thanks for the test case and patch, as well as your efforts in tracking this one down.\n\nThe patch has been applied to trunk and proposed for 6.0.x and 5.5.x', 'Mark Thomas', '2009-04-09 08:14:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1758, '46354', '8', 'This has been fixed in 6.0.x and will be included in 6.0.20 onwards. Thanks again for the patch.', 'Mark Thomas', '2009-04-28 06:32:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1759, '46562', '1', '(In reply to  comment #0 )\n> SHTML files are locked when using windows. Closing the reader solves the\n> problem.\n> \n\nHow to reproduce? Please, provide an example.', 'Flavio Crispim', '2009-01-20 13:07:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1760, '46562', '2', 'Try editing an SSI Include with Dreamweaver on XP (version seems to be irrelevant). Eclipse and good editors will work.\n\nKind regards, Michael', 'Michael Rauner', '2009-01-20 23:33:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1761, '46562', '3', 'Please Give Some more details about this bug , (explain briefly)', 'Arunkumar', '2009-01-22 08:17:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1762, '46562', '4', 'If you try to edit a file which is served by the SSI servlet with Dreamweaver, you won\'t be able to save the file.\n\nAs a workaround I have added bufferedReader.close() at the end of processSSI(...) method call and things work fine.\n\nHope this helps, kind regards. Michael', 'Michael Rauner', '2009-01-22 09:00:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1763, '46562', '5', 'Created  attachment 23187   [details] \nTest application\n\nTest application, needs a SSI enabled TC.', 'Flavio Crispim', '2009-01-28 06:52:56 UTC', 'tomcat_attachment/attachment 23187');
INSERT INTO `tomcatbeforefixcomments` VALUES (1764, '46562', '6', 'Created  attachment 23188   [details] \nProcess Monitor logs.', 'Flavio Crispim', '2009-01-28 06:54:29 UTC', 'tomcat_attachment/attachment 23188');
INSERT INTO `tomcatbeforefixcomments` VALUES (1765, '46562', '7', 'Hi\n\nI don´t have permision to install Dreamweaver and I was unable reproduce this issue.\n\nI´ve attached Process Monitor logs( http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx ) and seems ok to me (here in my enviroment)\n\nEnviroment\nXP.sp3\nSUN 1.6.0_11\nTC 5.5.27\n\nLet me know if you can reproduce with the Test-app (attached).\n\nFlavio', 'Flavio Crispim', '2009-01-28 07:06:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1766, '46562', '8', 'Thanks for the suggested fix. It has been applied to trunk and proposed for 6.0.x and 5.5.x', 'Mark Thomas', '2009-04-09 04:09:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1767, '46562', '9', 'This has been fixed in 6.0.x and will be in 6.0.20 onwards.', 'Mark Thomas', '2009-04-28 06:27:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1768, '46991', '1', 'Thanks for the report. This has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2009-04-08 09:31:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1769, '46991', '2', '(In reply to  comment #1 )\n> Thanks for the report. This has been fixed in trunk and proposed for 6.0.x\n\nwhich version ? I use version 6.0.18,how can I get the fixed version?', 'huangfeng', '2009-04-08 19:10:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1770, '46991', '3', 'It will probably be in 6.0.20 but that depends on a) it getting the 3 +1 votes to be back-ported and b) there being a 6.0.20 release. Given that 6.0.19 is still in progress 6.0.20 is likely to be some time away.\n\nAlternatively, you can build Tomcat from source with the patch. If you want to do that, the users list is the place to get help.', 'Mark Thomas', '2009-04-09 01:51:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1771, '46991', '4', 'Thanks !', 'huangfeng', '2009-04-09 02:11:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1772, '46967', '1', 'Thanks for the patch. I have applied it to trunk and proposed it for 6.0.x.\n\nI extended your patch to make the behaviour consistent when running under a security manager.', 'Mark Thomas', '2009-04-08 06:02:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1773, '46967', '2', 'This has been fixed in 6.0.x and will be in 6.0.21 onwards.', 'Mark Thomas', '2009-05-22 08:15:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1774, '46967', '3', '***  Bug 47276  has been marked as a duplicate of this bug. ***', 'Konstantin Kolinko', '2009-07-17 10:41:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1775, '46967', '4', 'Reopening, to track fixing it in 5.5 branch.', 'Konstantin Kolinko', '2009-07-17 10:45:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1776, '46933', '1', 'Thanks for the patch. It can actually be even simpler as there is no longer a need to ensure that the args provided are non-null. This was only an issue with very early JVMs.\n\nThe patch has been applied to trunk and proposed for 6.0.x', 'Mark Thomas', '2009-04-08 04:09:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1777, '46933', '2', 'applied to trunk', 'Jens Kapitza', '2009-04-08 11:02:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1778, '46933', '3', 'Bugs are not marked as fixed until they are applied to the appropriate release branch(es)', 'Mark Thomas', '2009-04-09 01:49:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1779, '46933', '4', 'Created  attachment 23550   [details] \ndo caching the resources like the docu say it \n\ndo caching the resources like the docu say it', 'Jens Kapitza', '2009-04-27 06:21:29 UTC', 'tomcat_attachment/attachment 23550.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1780, '46933', '5', 'Can you create a new bugzilla issue for your second patch please. We try and keep each bugzilla entry to s single problem. Cheers.', 'Mark Thomas', '2009-04-28 05:00:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1781, '46933', '6', 'This has been fixed in 6.0.x and will be in 6.0.20 onwards. This issue can be marked as fixed once the second patch is moved to a new bugzilla entry.', 'Mark Thomas', '2009-04-28 06:14:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1782, '46982', '1', 'Thanks for the report. This has been fixed in trunk and proposed for 5.5.x and 6.0.x', 'Mark Thomas', '2009-04-08 03:21:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1783, '46982', '2', 'This has been fixed in 6.0.x and will be included in 6.0.20 onwards.', 'Mark Thomas', '2009-04-28 04:54:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1784, '46982', '3', 'Opps. Still open for 5.5.x', 'Mark Thomas', '2009-04-28 04:55:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1785, '41606', '1', 'Created  attachment 19692   [details] \nPatch to prevent double jspInit() when a JSP is set in web.xml to load-on-startup\n\nConfirmed in 5.5.23.  I\'ve attached a patch based on the OP\'s suggested fix.', 'Chris Halstead', '2007-03-09 12:42:55 UTC', 'tomcat_attachment/attachment 19692.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1786, '41606', '2', '***  Bug 45774  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2009-03-27 02:43:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1787, '41606', '3', 'Chris - thanks for the patch.\n\nThe patch has been applied to trunk and proposed for 6.0.x and 5.5.x', 'Mark Thomas', '2009-03-27 02:49:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1788, '41606', '4', '***  Bug 47013  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2009-04-14 14:58:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1789, '41606', '5', 'This has been fixed in 6.0.x and will be included in 6.0.20 onwards.', 'Mark Thomas', '2009-04-28 04:22:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1790, '46875', '1', 'I think you have a fair point, but not much can be done about it. These events are asynchronous, so the most likely is that it will be processed after the session is gone, and not much can be done about that.\n\nI think the calls to the session should be safer (wrapped with a try/catch).', 'Remy Maucherat', '2009-03-19 11:23:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1791, '46875', '2', 'I\'ve added try/catch blocks as per Remy\'s suggestion to trunk and proposed the fix for 6.0.x', 'Mark Thomas', '2009-03-25 12:03:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1792, '46875', '3', 'This has been fixed in 6.0.x and will be included in 6.0.20 onwards.', 'Mark Thomas', '2009-04-28 03:39:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1793, '46875', '4', 'What about reliability? I can not rely on a CometEvent with EventSubType.SESSION_END. That\'s really bad.', 'holger.schott', '2009-05-29 14:12:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1794, '46666', '1', 'Looks reasonable to me. I have made the change in trunk and proposed it for 6.0.x. There is always a chance, particularly with the connector code, that I have missed a use case that explains why this is so. If that is the case, I am sure one of my fellow committers will point it out.', 'Mark Thomas', '2009-02-13 08:19:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1795, '46666', '2', 'Hi Mark,\n\nThanks.  I agree with your assessment of unintended consequences. The location in such well exercised code does make one pause.  I am a newbie to this process. Do you have information as to how I can look at the modification in the trunk?\n\nRegards\nDoug', 'Doug Drechsel', '2009-02-13 14:42:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1796, '46666', '3', 'Best to keep an eye on the tomcat dev list. Details here:  http://tomcat.apache.org/lists.html \n\nIf you aren\'t already subscribed to the dev list, the commit message an be found in one of the many archives such as  http://markmail.org/message/f744kl4i6bkruh5i ', 'Mark Thomas', '2009-02-14 11:57:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1797, '39396', '1', 'Confirming the bug on Tomcat 5.5.17 where Coyote reports itself as Apache-Coyote/1.1.\n\nSteps to reproduce:\n\n$ telnet example.com 8080\nOPTIONS /directory/ HTTP/1.0\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nAllow: GET, HEAD, POST, TRACE, OPTIONS\nContent-Type: text/html\nContent-Length: 0\nDate: Thu, 20 Mar 2008 00:44:46 GMT\nConnection: close\n\n\nWhat\'s interesting, the same request using HTTP/1.1 instead of HTTP/1.0 fails:\n\n$ telnet example.com 8080\nOPTIONS /directory/ HTTP/1.1\n\nHTTP/1.1 400 Bad Request\nServer: Apache-Coyote/1.1\nTransfer-Encoding: chunked\nDate: Thu, 20 Mar 2008 00:51:03 GMT\nConnection: close\n\n0\n', 'Aleksander Adamowski', '2008-03-19 17:52:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1798, '39396', '2', '(In reply to  comment #1 )\n> Confirming the bug on Tomcat 5.5.17 where Coyote reports itself as\n> Apache-Coyote/1.1.\n> \n> Steps to reproduce:\n> \n> $ telnet example.com 8080\n> OPTIONS /directory/ HTTP/1.0\n> \n> HTTP/1.1 200 OK\n> Server: Apache-Coyote/1.1\n> Allow: GET, HEAD, POST, TRACE, OPTIONS\n> Content-Type: text/html\n> Content-Length: 0\n> Date: Thu, 20 Mar 2008 00:44:46 GMT\n> Connection: close\n> \n> \n> What\'s interesting, the same request using HTTP/1.1 instead of HTTP/1.0 fails:\n> \n> $ telnet example.com 8080\n> OPTIONS /directory/ HTTP/1.1\n> \n> HTTP/1.1 400 Bad Request\n> Server: Apache-Coyote/1.1\n> Transfer-Encoding: chunked\n> Date: Thu, 20 Mar 2008 00:51:03 GMT\n> Connection: close\n> \n> 0\n> \n\nIF you want HTTP/1.1 shouldn\'t you create a valid HTTP/1.1 request?', 'Filip Hanik', '2008-03-19 18:25:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1799, '39396', '3', 'The Allow header should contain those methods for which the server would not return 405 (Not Allowed).\n\nThus, if it returns 403 for DELETE, it\'s totally correct to include DELETE in the Allow header.\n\nIn doubt, come over to the HTTP mailing list for further discussion :-).', 'Julian Reschke', '2008-03-20 09:26:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1800, '39396', '4', 'Julian Reschke wrote:\n\n>The Allow header should contain those methods for which the server would not\n>return 405 (Not Allowed).\n>\n>Thus, if it returns 403 for DELETE, it\'s totally correct to include DELETE in\n>the Allow header.\n\nActually it returns 405 for TRACE method:\n\n\n$ telnet example.com 8080\nOPTIONS /directory/ HTTP/1.0\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nAllow: GET, HEAD, POST, TRACE, OPTIONS\nContent-Type: text/html\nContent-Length: 0\nDate: Thu, 20 Mar 2008 17:19:57 GMT\nConnection: close\n\n$ telnet example.com 8080\nTRACE /directory/ HTTP/1.0\nX-Test-Header: blahblah\n\nHTTP/1.1 405 TRACE method is not allowed\nServer: Apache-Coyote/1.1\nAllow: OPTIONS\nContent-Length: 0\nDate: Thu, 20 Mar 2008 17:20:18 GMT\nConnection: close\n\n_This_ behaviour is inconsistent IMO. Correct me if I\'m wrong.\n\n=======\n\nFilip Hanik wrote\n> IF you want HTTP/1.1 shouldn\'t you create a valid HTTP/1.1 request?\n\nWhat do you mean? I don\'t see any deviations from RFC 2616 in my second HTTP/1.1 request (although the RFC is quite unspecific on OPTIONS method).\n', 'Aleksander Adamowski', '2008-03-20 10:28:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1801, '39396', '5', 'Filip\'s point is that you get a 400 since you have no host header in your request.\n\nI have modified the default servlet to include TRACE in the Allow header based on the setting of allowTrace for the connector associated with the request. This change has been made to trunk and proposed for 6.0.x and 5.5.x.', 'Mark Thomas', '2009-02-09 12:24:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1802, '39396', '6', 'This has been fixed in 6.0.x and will be included in 6.0.19 onwards.', 'Mark Thomas', '2009-03-06 07:21:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1803, '38570', '1', 'looks like fixed in 5.5.15', 'Edith', '2006-03-06 16:25:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1804, '38570', '2', 'Found in 5.5.9, seemed to be fixed in 5.5.15, now in 5.5.17 beta the error is\nhere again.', 'Edith', '2006-04-19 10:39:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1805, '38570', '3', 'webapps is the default appBase for the Host, and there\'s some special processing\nthat occurs when the docBase includes webapps, if Automatic Application\nDeployment is enabled.  Does this still happen to you in 5.5.23?', 'Yoav Shapira', '2007-03-25 14:05:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1806, '38570', '4', 'Hmmm... I tried against the trunk, 5.5.27 (current 5.5.x), and 5.5.9 (original reported version) on Linux (Fedora 8) and 5.5.9 on Windows XP (SP3). I can\'t reproduce the issue using the tomcat-docs.xml provided, the \'D: be JAVA_IDE jakarta-tomcat-5.5.9\' path, etc.\n\nWhat am I missing?\n\nThanks.', 'Kirk True', '2008-11-28 17:12:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1807, '38570', '5', 'I can recreate this with the latest 5.5.x and the issue appears to be present in trunk and 6.0.x as well. I have applied the necessary fix to trunk and proposed it for 6.0.x and 5.5.x', 'Mark Thomas', '2009-02-09 11:09:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1808, '38570', '6', 'This has been fixed in 6.0.x and will be included in 6.0.19 onwards.', 'Mark Thomas', '2009-03-06 06:47:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1809, '38553', '1', 'I understand your point, and have located the relevant code:\norg.apache.catalina.authenticator.SSLAuthenticator line 139.  However, I\'m not\nconvinced the behavior you\'re asking for is correct: does the RFC say 401\n(instead of 400, or more generally 4xx) is *required* for the case where a\nrequest has no certificates at all?\n\nIf you could point out the relevant spec part that makes this clear, we can\nchange the code.', 'Yoav Shapira', '2006-04-13 20:52:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1810, '38553', '2', 'A request that has no certificitates at all is not necessarily a bad request.\n\nWhen establishing a ssl connection, the server sends its certificate to the client.\nThis includes the certificates of the CAs which are trusted by the server.\n\nThe client only answers with certificates that are signed by one of the trusted\nCAs (directly or chained).\n\nWhen the client sends no certificate, it means that he has no matching\ncertificate. This is an authentication issue and has nothing to do with the\nrequest syntax.\n\nRFC 2616 says for 400 Bad Request:\n\'The request could not be understood by the server due to malformed\nsyntax.\'\n\nAs I stated before, a request that has no certificates attached (because there\nwere none in the browser keystore) is not malformed. This behavior is specified\nin the SSL RFC 2264\n\n\'7.4.6. Client certificate\n(...) If no suitable certificate is\navailable, the client should send a certificate message\ncontaining no certificates. (...)\'', 'Markus', '2006-04-25 09:37:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1811, '38553', '3', 'Point taken. I have fixed this in trunk and proposed it for 6.0.x and 5.5.x', 'Mark Thomas', '2009-02-04 02:46:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1812, '38553', '4', 'This has been fixed in 6.0.x and will be included in 6.0.19 onwards.', 'Mark Thomas', '2009-02-20 14:57:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1813, '38197', '1', 'Please see:\n http://tomcat.apache.org/faq/misc.html#tagbroken \n\n http://issues.apache.org/bugzilla/show_bug.cgi?id=16001 ', 'Tim Funk', '2007-01-16 05:09:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1814, '38197', '2', 'Well it has been a while since I reported this.  I am not sure the current\nstatus of the implementation right now. At the time I checked the code, there\nwas a bug in the way of picking the pooled instance, and since it was closed as\ninvalid I will assume it was not fixed.\n\nFrom the JSP spec:\n\'The JSP container may reuse classic tag handler instances for multiple\noccurrences of the corresponding custom action, in the same page or in different\npages, but only if the same set of attributes are used for all occurrences. If a\ntag handler is used for more than one occurence, the container must reset all\nattributes where the values differ between the custom action occurrences. If an\nattribute value is set as a request-time attribute value (using a scripting or\nan EL expression), the container must reset the attribute between all reuses of\nthe tag handler instance ...\'\n\n\nThe pool implementation is using attributes specified in the basic way for\nselecting a pooled instance. I mean:\n\n<mytag attr=\'1\'/>\n\nBut it is not considering the alternate way of specifying an attribute\n\n<mytag>\n<jsp:attribute name=\'attr\'>1</jsp:attribute>\n</mytag>\n\n\nFrom the spec:\n\'The <jsp:attribute> action must only be used to specify an attribute value for\nstandard or custom actions.\'\n\nSo <jsp:attribute> is valid way of specifying an attribute for a custom action\nand TagLibs are actions, therefore, the container should use attributes defined\nby this mean when selecting the pooled instance.\n\nIn the example code I posted originally (when I reported the bug), the same\ninstance of the TagHandler is used, and although the attributes set differs,\nthose attributes are not reset as the specification states.\nFor the way the pool is implemented, a different instance should be used because\nan additional attribute is specified.\n\nAs a conclusion, if a properly developed TagHandler is used and one of its\nattributes is specified using <jsp:attribute>, which is completely valid, the\nobtained result could be wrong due to the way the Pool is implemented.\n', 'Diego Belfer', '2007-12-05 10:16:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1815, '38197', '3', 'Thanks for the report. I have fixed this in trunk and proposed the fix for 6.0.x and 5.5.x', 'Mark Thomas', '2009-02-04 02:28:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1816, '38197', '4', 'This has been fixed in 6.0.x and will be included in 6.0.19 onwards', 'Mark Thomas', '2009-02-20 14:46:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1817, '46261', '1', 'Created  attachment 22910   [details] \nProposed patch', 'Joe Kislo', '2008-11-21 08:35:26 UTC', 'tomcat_attachment/attachment 22910.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1818, '46261', '2', 'I have attached a patch that I have been using to work around this issue. It modifies findChild to decode the name if the initial lookup fails.', 'Joe Kislo', '2008-11-21 08:36:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1819, '46261', '3', 'The correct way to do this in 6.0.18 is to use the # character rather than %2F.\n\n%2F should be interpreted literally.', 'Mark Thomas', '2008-11-21 08:45:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1820, '46261', '4', 'This has been fixed in trunk. I want to do some more testing of this and look at  bug 46262  before proposed anything for 6.0.x', 'Mark Thomas', '2008-12-26 15:51:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1821, '46261', '5', '***  Bug 46262  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2008-12-28 15:59:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1822, '46261', '6', 'I couldn\'t break my fix in my testing so I have proposed the fix for 6.0.x', 'Mark Thomas', '2008-12-28 16:03:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1823, '46381', '1', 'I have applied a fix to trunk but I want to do some more testing with the TCK (which I don\'t have to immediately to hand) before proposing for 6.0.x', 'Mark Thomas', '2008-12-26 15:43:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1824, '46381', '2', 'The TCK passes so this has been proposed for 6.0.x', 'Mark Thomas', '2008-12-27 13:36:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1825, '46381', '3', 'This has been fixed in 6.0.x and will be include din 6.0.19 onwards.', 'Mark Thomas', '2009-01-14 15:51:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1826, '46381', '4', 'Dear Tomcat Developers,\n\nwhen i have a JSP page with this tag/expression...\n\n<c:out value=\'${assignment.companyHeader.address.name01} ${assignment.companyHeader.address.name02}\' />\n\n... and \'companyHeader\' evaluates to null, \n\nthe output in Tomcat 6.0.18 is \' \' (which is correct),\n\nbut the output in Tomcat 6.0.20 is \'null \' (which is not correct).\n\nI think that many JSP developers are concerned by this bug and I hope that there will be released a new Tomcat version containing a bug fix as soon as possible.\n\nBest Regards\nAlfred', 'Alfred Staflinger', '2009-06-08 07:14:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1827, '46397', '1', 'The test case you have provided doesn\'t do anything. There is no web.xml and no static content. Is there an index.jsp or similar missing?\n\nI should be able to generate a simple test case of my own.', 'Mark Thomas', '2008-12-23 08:34:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1828, '46397', '2', 'There is some inefficient use of memory here but no leak. Some tags are incorrectly placed in the pool (I have a patch for that) but all instances are released when the web application is reloaded.\n\nThe patch has been applied to trunk and proposed for 6.0.x.', 'Mark Thomas', '2008-12-23 10:32:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1829, '46397', '3', 'Cool. Thanks for checking.', 'Jochen Wuttke', '2008-12-23 10:50:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1830, '46403', '1', 'Created  attachment 23027   [details] \nSimple JSP that reproduces the behavior.', 'Matt Wiseley', '2008-12-15 17:52:34 UTC', 'tomcat_attachment/attachment 23027.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1831, '46403', '2', 'Created  attachment 23028   [details] \nPatch to always include Expires parameter regardless of version\n\nThis patch adds the Expires cookie parameter in addition to the Max-Age parameter. Though not technically to the cookies spec, it works. Tested in Google Chrome, Firefox 3.0 and IE7.', 'Matt Wiseley', '2008-12-15 19:26:41 UTC', 'tomcat_attachment/attachment 23028.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1832, '46403', '3', 'For completeness, the cookie parsing changes were required to correct various security vulnerabilities.\n\nI really don\'t like the idea of adding work arounds to Tomcat for bugs in other software but I don\'t see a choice here.\n\nI have applied a variation of your patch to trunk and proposed it for 6.0.x. The variation is making the addition of the expires header optional.\n\nThere are occassional ASF/MS get togethers where issues like this can be raised (and hopefully fixed). I have a list of things to raise at the next one and I\'ve added this to it. As far as I am aware there are no dates set for the next get together so don\'t expect an IE fix any time soon.', 'Mark Thomas', '2008-12-23 05:19:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1833, '46408', '1', 'Thanks for the report. This has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2008-12-19 06:30:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1834, '46408', '2', 'It seems that tomcats 5.5.x suffer from the same issue.', 'Kazimierz Pogoda', '2008-12-22 11:41:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1835, '46408', '3', 'I\'ve proposed the same fix for 5.5.x', 'Mark Thomas', '2008-12-22 13:14:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1836, '46408', '4', 'This has been fixed in 6.0.x and will be included in 6.0.19 onwards.\n\nI am changing the product to TC5 as it is still open there.', 'Mark Thomas', '2008-12-27 11:47:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1837, '46247', '1', 'Thanks for the patch.\n\nI have applied it to trunk less the .bat/.sh changes which I am -1 on and the mime-type changes which I couldn\'t see why you wanted to change them.', 'Mark Thomas', '2008-12-05 07:57:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1838, '46247', '2', 'Created  attachment 22998   [details] \nSVN property fixes\n\nA few more SVN properties that seem to have been missed.\n\nI\'ve removed the .bat/.sh changes.', 'Sebb', '2008-12-05 09:12:03 UTC', 'tomcat_attachment/attachment 22998.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1839, '46247', '3', 'Most of those are already set. I have updated the few that weren\'t.', 'Mark Thomas', '2008-12-05 09:49:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1840, '46247', '4', 'Sorry, I had not realised that native/connector was an external - seems to be a bug in Subclipse, as normally these are flagged - this stops my script working.\n\nTwo more recent files have crept in without properties:\n\nsvn ps svn:eol-style native modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/CreateTestTable.java\nsvn ps svn:eol-style native modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestSlowQueryReport.java', 'Sebb', '2008-12-05 10:25:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1841, '42693', '1', 'Created  attachment 20374   [details] \nlog entries from localhost.log\n\nthese stack traces might have something to do with the described error', 'Frank Hofmann', '2007-06-20 02:17:44 UTC', 'tomcat_attachment/attachment 20374.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1842, '42693', '2', 'Tested with Tomcat 6.0.14 Windows XP SP2 and it works as expected.\nAFAICT, there should be no differences with the Linux version.\n\nPlease attach a full test case that shows the faulty behavior.', 'Lucas Galfaso', '2007-10-04 19:33:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1843, '42693', '3', 'Created  attachment 20926   [details] \nwar file to demonstrate defect\n\nI did describe the defect as tomcat 6 not being able any more (contrary to\ntomcat 5.5.x) to process reentrant / recursive tagfiles. As far as I see, there\nis an error in the algorithm to generate the java sources, because the way it\nis implemented now (in version 6) assumes a static call stack for tagfiles.\n\nThe tester was a little bit lazy and didn\'t read my bug description properly,\nso I had to spent the time to write a ready to run test case: see the test.war\nfile attached. It shows the jdk file structure on the machine running tomcat,\nand it works with 5.5.17, but not any more with version 6.0.13!\n\nPlease process this incident more properly and timely, because it really takes\na lot of time to create such contributions! Thanks.', 'Frank Hofmann', '2007-10-05 11:01:23 UTC', 'tomcat_attachment/attachment 20926');
INSERT INTO `tomcatbeforefixcomments` VALUES (1844, '42693', '4', 'Created  attachment 20931   [details] \nAttaching the generated file by renderFileSystemEntry.tagx\n\n(In reply to  comment #3 )\n\nTested the attached war file with Tomcat 6.0.13 and 6.0.14 using Java 1.5_10\nand Java 1.5_11 using the war file to deploy the web app and expanding the war\ninto a folder at TOMCAT_HOME/webapps/test.\nIn all eight cases, the page worked as expected, there was only a warning\nsaying that the file /WEB-INF/web.xml was missing.\n\nPlease specify the specific OS used and Java version that was used to perform\nthis test.\n\nPlease, lets try to keep this using good manners.', 'Lucas Galfaso', '2007-10-05 19:06:17 UTC', 'tomcat_attachment/attachment 20931.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1845, '42693', '5', 'Created  attachment 20933   [details] \nslightly modified test application to show runtime specifica\n\njust throw it into webapps dir of \na) tomcat 5.5.x\nb) tomcat 6.0.x\nand request  http://SERVER:8081/tomcat_bug \n-- it will show different results, with the latter being wrong,\nbecause the JSP specification doesn\'t disallow Tags or tagfiles (which should\ntransparently being transformed into equivalent Java code) to recursively call\nanother instance of itself. Many problems are naturally solved by recursive\nalgorithms.\n\nPlease watch the 2 html files attached hereafter, where the evidence is\ndocumented for the 2 machines/configurations I currently have access to. They\ndefinitively differ.', 'Frank Hofmann', '2007-10-06 05:08:49 UTC', 'tomcat_attachment/attachment 20933');
INSERT INTO `tomcatbeforefixcomments` VALUES (1846, '42693', '6', 'Created  attachment 20934   [details] \ncorrect result from running the web app with tomcat 5.5.17 (save as HTML to view, correct MIME type was not permitted for upload by Bugzilla)', 'Frank Hofmann', '2007-10-06 05:10:03 UTC', 'tomcat_attachment/attachment 20934.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1847, '42693', '7', 'Created  attachment 20935   [details] \nincorrect results from running web app with tomcat 6.0.13 (save as HTML to view, correct MIME type was not permitted for upload by Bugzilla)', 'Frank Hofmann', '2007-10-06 05:11:14 UTC', 'tomcat_attachment/attachment 20935.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1848, '42693', '8', 'Created  attachment 20940   [details] \nOpen the outputWriter when sure that no other process will write a file with the same name\n\nThis patch fixes the following situation, when a .tagx file needs to be\ncompiled, and by any form of dependency it depends on itself, be sure that the\noutput .java file is opened after the prototype file is generated compiled and\nclosed.', 'Lucas Galfaso', '2007-10-07 13:14:53 UTC', 'tomcat_attachment/attachment 20940.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1849, '42693', '9', '(In reply to  comment #8 )\n\nMmm.. I think that a better description would be:\n\nOpen the outputWriter when positive that this same process will not open a\ncompilation context to generate a prototype of this same class.\n\nThis patch fixes the following situation, when a .tagx file needs to be\ncompiled, and by any form of dependency it depends on itself, be sure that the\noutput .java file is opened after the prototype .java file is generated,\ncompiled and closed.\n\n', 'Lucas Galfaso', '2007-10-07 13:21:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1850, '42693', '10', 'The patch looks to be applied against tomcat trunk as well as 6.0 HEAD.\n\nCan this be verified?\n', 'Tim Funk', '2007-12-26 17:48:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1851, '42693', '11', 'if you invoke recursive twice tag the bug still occurs\n\nexample:\n\nindex.jsp\n-------------------------------------------------------------\n<%@ taglib prefix=\'u\' tagdir=\'/WEB-INF/tags\' %>\n<html>\n<head><title>taglib test</title></head>\n<body>\n<u:seq arg=\'5\' max=\'12\'/>\n</body>\n</html>\n\n\nseq.tag\n-------------------------------------------------------------\n<%@ attribute \n    name=\'arg\'\n    required=\'true\'\n    type=\'java.lang.Integer\'\n%>\n<%@ attribute\n    name=\'max\'\n    required=\'true\'\n    type=\'java.lang.Integer\'\n%>\n<%@ taglib prefix=\'c\' uri=\' http://java.sun.com/jsp/jstl/core \' %>\n<%@ taglib prefix=\'n\' tagdir=\'/WEB-INF/tags\' %>\n\n<p><c:out value=\'${arg}\'/></p>\n<c:if test=\'${arg lt max}\'>\n  <n:seq arg=\'${arg + 1}\' max=\'${max}\'/>\n  <n:seq arg=\'${arg + 1}\' max=\'${max}\'/>\n</c:if>\n\n\njdk: 1.6.0_07\ntomcat: 6.0.18\nos: Windows XP and Ubuntu 8.04.1\n', 'Przemek Dyk', '2008-10-24 12:48:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1852, '42693', '12', 'I have committed a fix to trunk. After a little more testing I\'ll propose it for 6.0.x.', 'Mark Thomas', '2008-11-23 13:28:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1853, '42693', '13', 'This has now been proposed for 6.0.x', 'Mark Thomas', '2008-12-23 05:24:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1854, '42707', '1', 'The support for this in Mapper.java is easy to add: (Note -- this is based on code posted by Luke Kirby, inelegantly re-written)\n\n    public synchronized void addHost(String name, String[] aliases,\n                                     Object host) {\n        Host[] newHosts = new Host[hosts.length + 1];\n        Host newHost = new Host();\n        ContextList contextList = new ContextList();\n        newHost.name = name;\n        newHost.contextList = contextList;\n        newHost.object = host;\n        if (insertMap(hosts, newHosts, newHost)) {\n            hosts = newHosts;\n        \n        for (int i = 0; i < aliases.length; i++) {\n            newHosts = new Host[hosts.length + 1];\n            newHost = new Host();\n            newHost.name = aliases[i];\n            newHost.contextList = contextList;\n            newHost.object = host;\n            if (insertMap(hosts, newHosts, newHost)) {\n                hosts = newHosts;\n            }\n        }\n        }\n        else {\n        	Host aliasedHost;\n        	// insert failed because the host already exists; grab it\n        	int hostPos = find(hosts, name);\n        	if (hostPos >= 0) {\n        	aliasedHost = hosts[hostPos];\n                for (int i = 0; i < aliases.length; i++) {\n                    newHosts = new Host[hosts.length + 1];\n                    newHost = new Host();\n                    newHost.name = aliases[i];\n                    newHost.contextList = aliasedHost.contextList;\n                    newHost.object = aliasedHost.object;\n                    if (insertMap(hosts, newHosts, newHost)) {\n                        hosts = newHosts;\n                    }\n                }\n        	} else {\n        		\n        		System.out.println(\'huh?\');\n        	}\n\n        }\n    }', 'Andrew Mottaz', '2008-04-22 13:03:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1855, '42707', '2', '***  Bug 44856  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2008-04-23 14:56:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1856, '42707', '3', 'Note to self - need to port this to 5.5.x when fixed.', 'Mark Thomas', '2008-04-23 14:56:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1857, '42707', '4', 'I have added a fix for this to trunk. There are a couple of ways if implementing this so I\'ll leave it a little while to let people comment before proposing it for 6.0.x.', 'Mark Thomas', '2008-11-08 17:58:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1858, '42707', '5', 'No-one commented so I have proposed the fix for 6.0.x', 'Mark Thomas', '2008-12-28 16:16:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1859, '42707', '6', 'This has been fixed in 6.0.x and will be included in 6.0.19 onwards.', 'Mark Thomas', '2009-01-14 16:09:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1860, '42707', '7', 'I\'ve proposed backporting the fix to 5.5.x', 'Mark Thomas', '2009-04-09 08:23:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1861, '42409', '1', 'Not sure if it matters, but this occurred for me using the doGet() method in my\nservlet.  Also this problem appears to exist in 5.5.23, 6.0.10 and the\nunreleased 6.0.13 build.', 'Hayden James', '2007-05-14 09:06:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1862, '42409', '2', 'Was wondering how I could view the HTTP Headers. Found this useful:\n http://www.jmarshall.com/easy/http/http_footnotes.html#manually \n\nI could reproduce the reported behavior with trunk build tc6.0.x. \n\nNow looking at Specs to see if this is really a Bug.', 'Shiva Kumar H R', '2007-05-17 08:03:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1863, '42409', '3', 'I tried the same situation with jetty and it appears to work properly.  It seems\nincorrect for the response to not send all the data (including headers) I\nspecify just because the error page was set.  Also, an easy way to test this\nbehavior is to use the web developer plugin if you browse with firefox. \nInformation -> View Response Headers.', 'Hayden James', '2007-05-17 08:51:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1864, '42409', '4', 'Same problem exists in 6.0.13.  How can I motivate someone to fix this bug or at\nleast point me in the right direction so I can fix it myself?', 'Hayden James', '2007-05-30 17:49:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1865, '42409', '5', 'I too tested this scenario on Jetty, as well as on WebSphere Application Server\n(WAS) binaries and this problem doesn\'t occur with them. In both Jetty and WAS,\nI am able to see the extra response header even when using custom error page.\n\nMy search of specification for anything against it has been in vain.\n\nFollowing is the piece of code that I have looked into:\norg.apache.catalina.core.StandardHostValve\nprotected void status(Request request, Response response);\nprotected boolean custom(Request request, Response response, ErrorPage errorPage);\n\nHere are my observations:\n1) When a custom error page is used, client request is \'forwarded\' to the custom\nerror page. \n\nNow, as per Servlet 2.4 specification (page 65, SRV.8.4):\n\'The forward method of the RequestDispatcher interface may be called by the\ncalling servlet only when no output has been committed to the client. If output\ndata exists in the response buffer that has not been committed, the content must\nbe cleared before the target servlet’s service method is called. If the response\nhas been committed, an IllegalStateException must be thrown.\'\n\nI see that in current Tomcat code, in \'protected boolean custom(Request request,\nResponse response,ErrorPage errorPage)\' method we are calling\n\'response.reset(statusCode, message)\' to clear the response content. This also\nclears the response headers that users might have set in their code.\n\nQuestion for Committers:\nI am seeing that the specification asks us to reset just the response buffer\n(before \'forwarding\' requests) while we are resetting the entire response object\n(which also resets response headers). \n\nCan we replace the call to \'response.reset(statusCode, message)\' with a call to\n\'response.resetBuffer()\'? \n\nIf yes, some of the \'request.getAttribute(..)\' calls in \'protected boolean\ncustom(Request request, Response response, ErrorPage errorPage)\' method and\nhence some of the \'request.setAttribute(..)\' calls in \'protected void\nstatus(Request request, Response response)\' method might become redundant and\ncould be removed as well.\n\n2) When default error page is used, there is no request \'forwarding\' and hence\nno response resets (and hence the response headers that users set in their code\nare preserved). I think an error message is simply added to existing response\'s\nbody and response is pushed to client.\n\n- Shiva', 'Shiva Kumar H R', '2007-05-31 05:15:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1866, '42409', '6', 'Created  attachment 20297   [details] \nWAR with custom error page; extra response headers not seen\n\npage to run:  http://localhost:8080/Bug_42409_error/test ', 'Shiva Kumar H R', '2007-05-31 05:24:31 UTC', 'tomcat_attachment/attachment 20297');
INSERT INTO `tomcatbeforefixcomments` VALUES (1867, '42409', '7', 'Created  attachment 20298   [details] \nWAR with default error page; extra response headers seen\n\npage to run:  http://localhost:8080/Bug_42409_correct/test ', 'Shiva Kumar H R', '2007-05-31 05:25:59 UTC', 'tomcat_attachment/attachment 20298');
INSERT INTO `tomcatbeforefixcomments` VALUES (1868, '42409', '8', 'Created  attachment 20299   [details] \ncall \'response.resetBuffer()\' instead of \'response.reset(statusCode, message)\'\n\ndoes anyone foresee any regressions out of this?', 'Shiva Kumar H R', '2007-05-31 07:53:26 UTC', 'tomcat_attachment/attachment 20299.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1869, '42409', '9', 'No, I don\'t think we\'re going to change this. We\'ll keep the current code which\nsets the status code + message, but your customization for your own is fine too.', 'Remy Maucherat', '2007-05-31 09:11:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1870, '42409', '10', 'If the code is kept as is, how would one use a custom error page and still be\nable to set response headers?  I\'m a little confused, is it not a bug?', 'Hayden James', '2007-05-31 09:59:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1871, '42409', '11', 'James,\nIf you have any strong use-case for your requirement, this might be reconsidered.', 'Shiva Kumar H R', '2007-05-31 22:10:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1872, '42409', '12', 'Forgot to mention the answer to your question. Extra response headers set in the\nCustom error page will be preserved and passed back to the client. \n\nIs there any strong reason why you are not doing this and why you want to set\nthe extra response headers in the Servlet/JSP from where error is thrown?', 'Shiva Kumar H R', '2007-05-31 22:26:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1873, '42409', '13', 'Ok.  I will tell you what my use case is for this feature.  I\'m writing a set of\nservlets that handle requests via javascript and the XMLHttpRequest js object. \nIn order to differentiate between good requests and bad requests, I either have\nthe response code set to 200 for success and 400 for failure.  I have separate\nhandlers for each status number on the javascript end.  As part of the response,\nI send data in the header via the \'X-JSON\' header with a json string as the\nvalue in the header.  The client reads the json parses the json string in both\nsuccess responses and error responses (SC_BAD_REQUEST).  The reason im using a\nspecial error page for 400 responses is that the default tomcat page is a lot\nmore verbose, I want to respond with a very small json string, not a full html page.\n\nThe prototype javascript library, ( http://www.prototypejs.org ) is what\nautomatically evaluates json for me via the X-JSON response header (in case that\ninformation helps).  Anyway, I think this is a pretty reasonable use case, but\nif others disagree, I would at least like to know some other avenues I can take\nto get this type of usage with tomcat.  Thanks.', 'Hayden James', '2007-06-02 07:58:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1874, '42409', '14', 'Interesting use-case. One immediate solution that is coming to mind is setting\n\'X-JSON\' header in your custom error page for 400 response. Doesn\'t this work\nfor you?', 'Shiva Kumar H R', '2007-06-04 07:36:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1875, '42409', '15', 'How would that work?  If a javascript client makes a request to the\ncontroller/servlet, the controller decides whether the request is \'good\' or not,\nif not then the controller generates the response json and sets it in the header\nand returns a page containing that header.  It seems it would be easier to set\nthe header on the page if the header value was always the same but it isn\'t.', 'Hayden James', '2007-06-04 08:29:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1876, '42409', '16', '\nWhen you need to pass information from the controller to a page, you normally use\nrequest attributes, not response attributes.\nYou can can do the same in your case.\n\nI hope that helps.\nR\n', 'rm', '2007-06-05 02:58:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1877, '42409', '17', 'As hinted in  Comment #16 , I tried this:\n\n1) In \'TestServlet.java\' (see\n http://issues.apache.org/bugzilla/attachment.cgi?id=20297 ) modified the doGet()\nmethod as below:\n		//response.setHeader(\'X-BUG\', \'Value1\');\n		request.setAttribute(\'X-BUG\', \'Value1\');\n		response.sendError(HttpServletResponse.SC_BAD_REQUEST);\n\n2) Updated \'400.jsp\' as below:\n<html>\n<body>\n<h3>Custom 400 error page</h3>\n<% String value = (String) request.getAttribute(\'X-BUG\');\nif(value != null && value.length() > 0) {\n	response.setHeader(\'X-BUG\', value);\n} %>\n</body>\n</html>\n\nDoes this solve your problem?', 'Shiva Kumar H R', '2007-06-05 07:20:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1878, '42409', '18', 'I guess this workaround should work, unfortunately I\'ll have to rip through all\nmy source to replace setHeader with setAttribute and then add a scriptlet to my\nerror jsp page.  However, I still don\'t understand why this won\'t be fixed,\nseems like a legitimate bug.  Anyhow, thanks for the help.', 'Hayden James', '2007-06-07 08:27:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1879, '42409', '19', 'One problem I find with the above code is that if I decide not to use a custom\n400 page then my extra header will not be available in the response.  Is there\nanother solution where it would work regardless of page I use (besides fixing\nthe bug I guess)?', 'Hayden James', '2007-06-16 19:00:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1880, '42409', '20', 'Hi, I would like to add my use case on to the scales.\n\nWe are using Acegi Security Library for Spring ( http://acegisecurity.org/ ) to\nperform authentication and authorization tasks in our web application. In\nessence, it works as a filter, declared in web.xml, and preprocesses the web\nrequest. We are using Digest authentication as per RFC 2617, but you might\nconsider using Basic authentication as well.\n\nWhen there is a need to request user credentials, the library ([1]) generates\nWWW-Authenticate header containing realm name, random nonce value, and other\ninformation, and calls\nhttpResponse.sendError(HttpServletResponse.SC_UNAUTHORIZED), and the rest of the\nresponse is generated by the tomcat error page.\n\nNow, if I configure my own dynamic or static page for error code 401, the\nauthentication stops working, because the WWW-Authenticate header is lost from\nthe response.\n\n\nVersions:\n - Tomcat: 5.5.23\n - Acegi Security System for Spring: 1.0.4\n\nThe relevant Acegi Security source code is method \'commence()\' of class\norg.acegisecurity.ui.digestauth.DigestProcessingFilterEntryPoint, lines 104-105\nand above ([1])\n\n\n [1]\n http://svn.sourceforge.net/viewvc/acegisecurity/tags/release_1_0_4/core/src/main/java/org/acegisecurity/ui/digestauth/DigestProcessingFilterEntryPoint.java?revision=1881&view=markup ', 'Konstantin Kolinko', '2007-07-03 15:21:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1881, '42409', '21', 'I\'ll add that other contains (Jetty, BEA/Oracle WebLogic Server, etc) appear to be handling this case correctly.\n\nWe are having a similar issue to  Comment #20  with Spring Security (new name for ACEGI).\n\nThis really needs to be fixed. The resolution suggested in  Comment #5  sounds like it would fix this issue and keep Tomcat spec compliant. At this point Tomcat is doing *more* than the spec requires.', 'Brian Curnow', '2008-10-22 06:22:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1882, '42409', '22', 'we are investigating this further, thank you for the detailed report\n\nFilip', 'Filip Hanik', '2008-10-22 22:59:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1883, '42409', '23', 'After some further review, this has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2008-11-03 06:28:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1884, '42409', '24', 'Great, I\'m glad to see this fix, I had given up hope last year and started using jetty since that didn\'t have this issue.', 'Hayden James', '2008-11-03 18:47:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1885, '46051', '1', 'The change is  http://svn.apache.org/viewvc?view=rev&revision=298149 \n\nI am tempted to leave this as is. Whilst strict adherence to the PrintWriter interface requires that System.getProperty(\'line.separator\') is used, any truly portable web application is going to have to write it\'s own new lines anyway to be resilient against the case where it runs on a different platform.\n\nIf this was fixed, I would change the initialisation of LINE_SEP.', 'Mark Thomas', '2008-10-21 12:23:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1886, '46051', '2', 'I see where you are coming from, and somewhat agree - though I think there is value in strict adherance to the API.  The decision is yours - I just wanted to make sure you were aware of it.\n\nLuckily, I had the code to this servlet and patched it to work around this.\n\nJust to note, we were actually bit by this bug when we upgraded from Tomcat 4 on our CAS (  http://www.ja-sig.org/products/cas/  ) central authentication server.  The Yale CAS server code writes out XML using the response Writer, and after the upgrade this output then contained the additional \' r\'.  Of course, this technically shouldn\'t matter to the XML either, except that the old (2.0.10) mod_cas C client we are using on some old servers apparently doesn\'t use a real XML parser and breaks reading these line endings in.  We can\'t upgrade the client in our legacy environment because their newer mod_auth_cas client requires a newer Apache.  So, yeah, I patched the server to work as before, and we are working to upgrade all our old client servers, but as with any enterprise, that takes time.\n', 'Chris Hubick', '2008-10-21 12:50:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1887, '46051', '3', 'Just testing a new way to provide an svn link:\n r298149 \nor\n revision 298149 \n\n', 'Mark Thomas', '2008-10-22 12:59:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1888, '46051', '4', 'Testing svn links in mail messages - please ignore.\n\n r298149 \nor\n revision 298149 \n', 'Mark Thomas', '2008-10-23 12:43:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1889, '46051', '5', 'Testing svn links in mail messages again - please ignore.\n\n r298149 \nor\n revision 298149 \n', 'Mark Thomas', '2008-10-23 12:53:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1890, '46096', '1', 'This has been fixed in trunk and a patch ( http://people.apache.org/~markt/patches/2008-10-27-bug46096.patch ) proposed for 6.0.x', 'Mark Thomas', '2008-10-27 11:27:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1891, '46096', '2', 'As a temporary workround, I added a java.lang.RuntimePermission for JSPs to catalina.policy.\n\nI then had a different exception:\n\njava.security.AccessControlException: access denied (java.util.PropertyPermission org.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER read)\n	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:323)\n	at java.security.AccessController.checkPermission(AccessController.java:546)\n	at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\n	at java.lang.SecurityManager.checkPropertyAccess(SecurityManager.java:1285)\n	at java.lang.System.getProperty(System.java:688)\n	at org.apache.jasper.runtime.BodyContentImpl.<clinit>(BodyContentImpl.java:44)\n	at org.apache.jasper.runtime.PageContextImpl.pushBody(PageContextImpl.java:717)\n	at org.apache.jasper.runtime.PageContextImpl.pushBody(PageContextImpl.java:707)\n\nI think the property access in BodyContentImpl also needs to run in a privileged block.  Or the class should be initialized at startup.\n\nThis probably should be a different bug?', 'Richard Evans', '2008-10-31 05:21:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1892, '46096', '3', ' Comment#2  looks like a configuration issue. The security policy already grants that permission to all code.', 'Mark Thomas', '2008-11-01 17:44:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1893, '45933', '1', 'Created  attachment 22666   [details] \nTest webapp that demonstrates error', 'Eddy Chan', '2008-10-02 01:06:39 UTC', 'tomcat_attachment/attachment 22666');
INSERT INTO `tomcatbeforefixcomments` VALUES (1894, '45933', '2', 'I am unable to reproduce this. Looking at your stack trace the security exception is caused when trying to read jsp-api.jar. This jar should never be scanned as it is on the exclude list so I don\'t understand how you can be seeing this error.\n\nReviewing the code does show that there is an issue. Additionally, the XML validation settings of the first context precessed are used for all contexts. I can fix these issues based purely on code review but it would be nice to be able to confirm the fix with a test case.', 'Mark Thomas', '2008-10-02 04:18:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1895, '45933', '3', 'Ignore my previous. I now have a test case.\n\nThanks for the report. This has been fixed in trunk and proposed for 6.0.x and 5.5.x.', 'Mark Thomas', '2008-10-03 04:54:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1896, '45933', '4', 'This has been fixed 6.0.x and will be included in 6.0.19 onwards.', 'Mark Thomas', '2009-01-31 00:26:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1897, '45933', '5', '***  Bug 46549  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2009-04-08 10:20:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1898, '45851', '1', 'That\'s correct, in 6.0.x the deployer no longer works. it broke somewhere during 5.5.x when the deployer was rebuilt. \n\nthe fix is to go back to 5.0.x strategy, where the files are copied to a temp directory and deployed from there. but that is work that is to be done. \n\ncontributions happily accepted.\n\nbest\nFilip\n', 'Filip Hanik', '2008-09-22 19:59:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1899, '45851', '2', 'I\'ve fixed the issues issues I could see in the FarmWarDeployer. Any additional testing much appreciated.\n\nI will propose the fix for inclusion in 6.0.x.', 'Mark Thomas', '2008-09-26 10:38:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1900, '45851', '3', 'I can definitely test that more.  If this ends up in the next point release, I\'ll upgrade my development environment and test.', 'Paul McGurn', '2008-09-26 10:45:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1901, '45851', '4', '***  Bug 42681  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2008-10-06 10:36:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1902, '45026', '1', 'With the same version of Tomcat (trunk) and a slightly older mod_jk (1.2.24) this appears to be a difference between httpd 1.3.x and 2.2.x\n\nI\'ve has a quick look in RFC 2616 and I didn\'t find anything relating to custom status codes. Can you provide a reference to the section of RFC2616 to which you are referring.\n\nI need to take a look at the httpd docs.', 'Mark Thomas', '2008-05-18 05:02:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1903, '45026', '2', 'If necessary, the httpd part of this issue should be discussed in its predecessor BZ 44495 (  https://issues.apache.org/bugzilla/show_bug.cgi?id=44995  ).', 'Rainer Jung', '2008-05-18 08:43:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1904, '45026', '3', 'Thanks Rainer. It would of been helpful if that had been included in the original report.\n\nI\'ve taken a look at mod_jk and it seems to be complaining about a lack of a body. I\'m not sure if this is a Tomcat or a mod_jk issue at the minute. Need to do more testing.', 'Mark Thomas', '2008-05-18 09:46:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1905, '45026', '4', 'Rainer - this might be quicker for you to track down. The following patch ensures the correct status is returned but the body generated by Tomcat is disappearing somewhere (I suspect inside mod_jk).\n\nIndex: java/org/apache/jk/common/JkInputStream.java\n===================================================================\n--- java/org/apache/jk/common/JkInputStream.java	( revision 657140 )\n+++ java/org/apache/jk/common/JkInputStream.java	(working copy)\n@@ -278,6 +278,10 @@\n         } else {\n             message = message.replace(\' n\', \' \').replace(\' r\', \' \');\n         }\n+        if (message == null) {\n+            // mod_jk + httpd 2.x fails with a null status message -  bug 45026 \n+            message = Integer.toString(res.getStatus());\n+        }\n         tempMB.setString( message );\n         c2b.convert( tempMB );\n         outputMsg.appendBytes(tempMB);\n', 'Mark Thomas', '2008-05-18 11:27:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1906, '45026', '5', 'That helped a lot. Indeed it seems httpd 2.x forces a status line to contain a non empty reason phrase, although RFC 2616 seems to allow empty ones. I posted to httpd-dev about that.\n\nI would say your patch looks good, because having a trivial one looks better then none and it fixes the problem independent of any httpd fix.\n\nDepending on the httpd discussion, I\'ll see, if we add the same check to mod_jk as well, to fix the problem for older TC and httpd.\n', 'Rainer Jung', '2008-05-20 06:01:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1907, '45026', '6', 'See:  http://marc.info/?t=121128830700002&r=1&w=2 ', 'Rainer Jung', '2008-05-20 07:24:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1908, '45419', '1', 'We might have lost sight of the issue here; this issue is not whether or not\nit\'s possible to encode utf-16-le, it\'s that the URI was not encoded in that\ncharacter set.\n\nAs I pointed out above, in the similar -be encoding, we need 16 bits to transmit \neach character,  This particular browser sent 8 bit octets.  That is not utf-16.\n\nTwo escaped characters does not constitute a utf-16 request, it\'s a utf-16\nfragment within an ASCII/ISO-8859/UTF-8/whatever bytestream.  I would recommend\nno change whatsoever in Tomcat\'s code on this issue.\n\nAs far as working around it, it might be nice if one could deploy a Valve that\nwas triggered based on User-Agent, that would probably be the most elegant hack\nfor this browser flaw.', 'William A. Rowe Jr.', '2008-07-17 08:02:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1909, '45419', '2', 'Ignore  comment #1 ; bugzilla navigation bites again; this relates to another issue.', 'William A. Rowe Jr.', '2008-07-17 08:09:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1910, '45419', '3', 'I think this is a design flaw of the Adobe client. There are plenty of servlets, so adding this to the default servlet is pointless, as it might not be the one answering the request on which the Adobe client . I think you\'re better off using a valve or a filter to achieve this.', 'Remy Maucherat', '2008-07-24 06:34:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1911, '45419', '4', 'I think this is a design flaw of the Adobe client. There are plenty of\nservlets, so adding this to the default servlet is pointless, as it might not\nbe the one answering the request on which the Adobe client will base its decidion to use a range. I think you\'re better off using a valve or a filter to achieve this.\n', 'Remy Maucherat', '2008-07-24 06:34:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1912, '45419', '5', 'The Adobe client will request the entire document, but if it finds it\'s Linearized and the server accepts Ranges it will interrupt that initial request. If Ranges aren\'t supported and it interrupts the request anyway it will have to re-download the entire document, which (if it\'s dynamically generated) could be a very expensive operation. So the Accept-Ranges header really is essential to this transaction.\n\nYes, this could be resolved with a Filter or some other workaround on the part of the webapp developer, but I\'m not clear why this is a better approach than modifying the DefaultServlet, which after all is designed to a) serve files from the filesystem, and b) support Ranges. Advertising that fact in the headers is completely inline with the HTTP specification and has at least one demonstrable case where it\'s necessary by design. More to the point, it will improve the user experience of Tomcat out of the box for a not-insignificant number of requests, at a cost of one line of code and an extra 20 bytes for each response.\n', 'Mike Bremford', '2008-07-24 07:08:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1913, '45419', '6', 'I\'m guessing the Apache web server supports this just fine.\n\nIf so, then that\'s both a workaround and a reason to improve Tomcat.  Tomcat should strive to be a suitable replacement for Apache for non-esoteric things.  Serving PDFs well is certainly not esoteric.  [Neither is serving as a load balancing reverse proxy ala mod_proxy_ajp -- if Tomcat did this that would eliminate my major reason for using Apache in front of Tomcat.]', 'Jess Holle', '2008-07-24 07:50:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1914, '45419', '7', 'Yes, the Apache web server sets this header.', 'Mike Bremford', '2008-07-24 08:13:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1915, '45419', '8', 'It\'s difficult to create a generally correct work-around for this in a filter, since a filter won\'t know which requests are destined for DefaultServlet. In my case I know that all my PDFs are served by DefaultServlet, so a filter works. But that\'s not universally true.\n\nI\'ve never written a valve, but I can imagine similar problems there.', 'Fred Toth', '2008-09-14 18:32:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1916, '45419', '9', 'This has been fixed in trunk and proposed for 6.0.x. It is enabled by default but can be disabled if required.', 'Mark Thomas', '2008-09-17 12:28:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1917, '45441', '1', 'This is still a bug in .0.1.  Same fix/patch as before.\n\nSure would be nice if someone implemented this in the trunk code base.', 'Andrzej Taramina', '2008-08-23 13:46:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1918, '45441', '2', 'Ooops.  That should have said 6.0.18...', 'Andrzej Taramina', '2008-08-23 13:47:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1919, '45441', '3', 'Note that the proposed patch will not work for contexts other than the ROOT context since, as per SRV.3.4:\nrequestURI = contextPath + servletPath + pathInfo\n\nThe correct fix is to append pathInfo to servletPath.\n\nThis has been fixed in trunk and proposed for 6.0.x.', 'Mark Thomas', '2008-09-17 04:15:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1920, '45618', '1', 'Have you observed a memory leak associated with these objects? If so, in what circumstances?', 'Mark Thomas', '2008-08-12 07:01:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1921, '45618', '2', '(In reply to  comment #1 )\n> Have you observed a memory leak associated with these objects? If so, in what\n> circumstances?\n\nActually, I am a PhD student in Computer Science and I am conducting an experiment on automatically detecting bugs. As my approach detected the bug statically, I cannot provide in what circumstances it will cause memory leak. \nStill, I will be quite happy if my tool really finds some useful results for you.', 'Hao Zhong', '2008-08-13 18:17:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1922, '45618', '3', 'Given how the selector is used, I can\'t see this causing a problem.\n\nIt is my experience that automated tools tend to produce a lot of false positives. Any automated analysis of the Tomcat code base is welcome but there is a risk that a large amount of effort is expended investigating potential issues that turn out not to be bugs.\n\nThe best way to avoid this is to filter issues before reporting them. Ideally, a bug report should contain a test case that demonstrates the issue, eg memory leak. If that isn\'t possible, then an explanation of how the issue may occur.\n\nAs I stated above, I can\'t see how this could cause an issue so I am closing it as invalid. If you believe this to be incorrect, please re-open this report with an explanation of how not closing the selector leads to problems.', 'Mark Thomas', '2008-08-14 01:29:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1923, '45618', '4', 'Please take a look at a confirmed bug in JDK 1.5 [1]. This bug is caused by not explicitly closing a selector. I copy some descriptions from the bug report as follows.\n\n\'However, when SocketAdaptor is done with the temporarily created selector, it never explicitly calls selector.close(), which causes the Pipe-related sockets to be orphaned and left in an ESTABLISHED state until process death.  Over time, this exhausts the number of available sockets and degrades both application and operating system performance. Pipe-related sockets are only cleaned up when the owning process is killed.\'\n\nI agree that automatic tools can produce some false positives. As you suggested, I do not report all the violations but report those violations that make sense in my opinion.\n\nI am sorry that my tool cannot provide in what situation a bug will cause problem as my tool relies on static analysis. Still, I believe that you should take the report into careful considerations because as you can see, not closing a selector has already cause some problems in JDK 1.5 and they do take efforts to fix the problems.\n\n\n[1]  http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=5083450 \n', 'Hao Zhong', '2008-08-14 18:48:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1924, '45618', '5', 'I still can\'t see this causing an issue in any real world deployment. You would have to go out of your way to create the circumstances where this bug would occur. I came close to closing this as INVALID again for this reason.\n\nHowever, there is - technically - a bug here so it has been fixed in trunk and proposed for 6.0.x.', 'Mark Thomas', '2008-09-02 14:46:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1925, '45666', '1', 'I have tried to repeat this with 5.5.x and 6.0.x but have not had any luck. I\'ve also reviewed the code to see if I could find where the method is called but couldn\'t find anywhere. Could you provide a simple test war that demonstrates the issue?', 'Mark Thomas', '2008-08-31 10:28:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1926, '45666', '2', 'Created  attachment 22504   [details] \nDemonstrates issue #45666\n\nSee /WEB-INF/tags/tag.tag\n\nTo demonstrate the issue, access the /index.jsp page.\n\nExpected result:\nA page with \'Hello world!\' message.\n\nActual result (in tc6.0):\n\'HTTP Status 500\' error page - java.lang.StackOverflowError\n\nReplacing \'include(\'/include.html\', false);\' call in tag.tag with include(\'/include.html\'); displays the \'Hello world!\' message as expected.', 'Konstantin Kolinko', '2008-08-31 13:33:59 UTC', 'tomcat_attachment/attachment 22504.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (1927, '45666', '3', 'Many thanks for the test case - it makes fixing bugs so much quicker.\n\nThis has been fixed in trunk and proposed for 6.0.x and 5.5.x.', 'Mark Thomas', '2008-08-31 14:09:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1928, '45666', '4', 'The patch has been applied to 6.0.x and will be included in 6.0.19 onwards.', 'Mark Thomas', '2008-09-06 13:13:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1929, '45666', '5', 'any chance to get this into the 5.5 line?  it\'s really quite a bogus bug with an obvious fix.', 'David Mansfield', '2009-01-20 13:26:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1930, '45648', '1', 'Note: \n\nThe \'build exported from trunk on 2008/08/14\' means this bug happens against a tomcat build exported from svn on that date. The Archiva build is a \'stock\' 1.1.1.\n\nObs: Changed priority to P3 and severity to regression.\n', 'Carlos Costa e Silva', '2008-08-18 19:59:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1931, '45648', '2', 'Another note: this problem doesn\'t happen with tomcat 6.0.16.', 'Carlos Costa e Silva', '2008-08-20 09:04:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1932, '45648', '3', 'Deployed a CAS server v3.3 and found this in the logs:\n\njavax.el.ELException: Function \'f:escapeXml\' not found\n	at org.apache.el.lang.ExpressionBuilder.visit(ExpressionBuilder.java:171)\n	at org.apache.el.parser.SimpleNode.accept(SimpleNode.java:145)\n...\n', 'Carlos Costa e Silva', '2008-08-20 11:39:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1933, '45648', '4', 'I ran into the same problem.\nCopying the ELParser files from tc6.0.x/trunk (6.0.19) over the 6.0.18 files and rebuilding fixed this problem, but now I\'m seeing other JSP TCK failures....\n\n', 'Donald Woods', '2008-08-21 06:36:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1934, '45648', '5', 'I am confirming that it is reproducible with the examples app bundled with Tomcat, with the current top of tc6.0.x branch (2008-08-22, rev.688071).\n\nThe page that fails is /examples/jsp/jsp2/el/functions.jsp\nFrom the root application, click JSP Examples. That page is the 4th example there (\'Functions\' in the JSP 2.0 Examples group).\n\nThe issue disappears if I rollback to rev.685696 of 2008-08-14.\n\nThe released version 6.0.18 is not affected. I tested the page there\nand it works.', 'Konstantin Kolinko', '2008-08-22 05:18:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1935, '45648', '6', 'This has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2008-08-31 12:45:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1936, '45648', '7', 'Confirm fixed: works for me with the latest revision from trunk.', 'Carlos Costa e Silva', '2008-09-02 05:19:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1937, '45648', '8', 'This has been fixed in 6.0.x and will be in 6.0.19 onwards.', 'Mark Thomas', '2008-09-25 03:36:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1938, '45691', '1', 'Created  attachment 22482   [details] \nWAR of a test application to reproduce the bug\n\nHere is a WAR, which can be used to replay the bug. After installing the war, you have to start your tomcat and a debugger. Then do the following steps:\n* set a breakpoint on JspUtil.nextTemporaryVariableName()\n* open /duplicateVariableName/test1.jsp in your browser\n* your debugger stops at JspUtil.nextTemporaryVariableName()\n* resume the debugger\n* again your debugger stops at JspUtil.nextTemporaryVariableName()\n* open /duplicateVariableName/test2.jsp in your browser\n* your debugger stops at JspUtil.nextTemporaryVariableName()\n* switch to the thread of /duplicateVariableName/test1.jsp\n* resume the debugger\n* the browser window of /duplicateVariableName/test1.jsp shows the error', 'Stefan Birkner', '2008-08-26 07:31:41 UTC', 'tomcat_attachment/attachment 22482');
INSERT INTO `tomcatbeforefixcomments` VALUES (1939, '45691', '2', 'Created  attachment 22483   [details] \nPatch to be applied to the package org.apache.jasper.compiler\n\nThis patch changes two classes: org.apache.jasper.compiler.Generator and org.apache.jasper.compiler.Node.\n\nInstead of creating the variable names of NamedAtttributes when parsing the JSP code, the names are created when the Generator generates the java code.\n\nThe Generator class has two additional members: an HashMap<NamedAttribute, String> variableNamesOfNamedAttributes, which stores the mapping between NamedAttributes and there variable names, and a variableNameCounter, which is used to create the variables\' names. The new method getVariableName(NamedAttribute) returns the variable names.\n\nThe member temporaryVariableName and its getter getTemporaryVariableName() are removed from the node class.', 'Stefan Birkner', '2008-08-26 07:49:41 UTC', 'tomcat_attachment/attachment 22483.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1940, '45691', '3', 'I have fixed this in trunk with a more general fix that should address all possible issues if this nature.\n\nThe fix has been proposed for 6.0.x', 'Mark Thomas', '2008-08-31 07:05:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1941, '43327', '1', 'I am having trouble reproducing this error. It may have already been fixed or it may be an issue with your build environment.\n\nPlease can you re-test with the latest APR, openssl, tomcat-native and 6.0.16 and, if you still see this error, provide the exact version numbers and commands you used to build so I can try and repeat this.', 'Mark Thomas', '2008-04-30 15:39:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1942, '43327', '2', 'I also get this problem.\n\nUsing: \n\n * Tomcat 6.0.16\n * APR 1.2.11-1 from Ubuntu Hardy\n * OpenSSL 0.9.8g-4ubuntu3.1 from Hardy\n * tcnative 1.1.12\n\nI\'m attempting to package this for debian and ubuntu. You can fetch the build from my git repo at svn://femme.catnip.org.uk/tomcat6.git', 'David Pashley', '2008-05-29 08:43:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1943, '43327', '3', 'That should be git://femme.catnip.org.uk/tomcat6.git\n', 'David Pashley', '2008-05-29 08:44:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1944, '43327', '4', 'Suitable snippet from the strace log:\n\n9749  socket(PF_INET6, SOCK_STREAM, IPPROTO_TCP) = 30\n9749  setsockopt(30, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0\n9749  setsockopt(30, SOL_SOCKET, SO_KEEPALIVE, [1], 4) = 0\n9749  bind(30, {sa_family=AF_INET, sin_port=htons(8180), sin_addr=inet_addr(\'0.0.0.0\')}, 16) = -1 EINVAL (Invalid argument)\n', 'David Pashley', '2008-05-29 08:45:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1945, '43327', '5', 'I still can\'t reproduce this. I wonder if the some local changes in the Ubuntu packages are involved.\n\nCan you provide step by step instructions to reproduce this using the distros from an Apache mirror rather than the Ubuntu versions. Also, what is the IP config of the machine you are using?', 'Mark Thomas', '2008-05-29 16:29:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1946, '43327', '6', 'I can attempt to build using the tarballs from upstream. Do you have IPv6 enabled on your box, as that appears to be the problem? If you disable IPv6 there isn\'t a problem. If you enable it, it attempts to create an IPv6 socket and then attempts to bind to an IPv4 address of \'0.0.0.0\'. \n\nI\'ve checked the packaging of APR in hardy and there are no patches that would affect sockets. There is nothing in the tomcat packaging. ', 'David Pashley', '2008-05-29 22:12:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1947, '43327', '7', 'beebo david% ip addr\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:09:6b:42:b2:61 brd ff:ff:ff:ff:ff:ff\n3: wifi0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ieee802.11 00:04:e2:63:83:ee brd ff:ff:ff:ff:ff:ff\n4: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue \n    link/ether 00:04:e2:63:83:ee brd ff:ff:ff:ff:ff:ff\n    inet 10.1.0.6/24 brd 10.1.0.255 scope global eth1\n    inet6 fe80::204:e2ff:fe63:83ee/64 scope link \n       valid_lft forever preferred_lft forever\n\nI\'ve attached a script I\'ve used to replicate this bug and the build log. I\'m not entirely sure why configure spits out errors. From a cursory glance at the code, it appears to iterate through the environment attempting to eval them all. It doesn\'t appear to result in any functional problems:\n\n30-May-2008 05:52:43 org.apache.catalina.core.AprLifecycleListener init\nINFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: /usr/lib/jvm/java-6-sun-1.6.0.06/jre/lib/i386/client:/usr/lib/jvm/java-6-sun-1.6.0.06/jre/lib/i386:/usr/lib/jvm/java-6-sun-1.6.0.06/jre/../lib/i386:/usr/java/packages/lib/i386:/lib:/usr/lib\n30-May-2008 05:52:43 org.apache.coyote.http11.Http11Protocol init\nINFO: Initializing Coyote HTTP/1.1 on http-8080\n30-May-2008 05:52:43 org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 1963 ms\n30-May-2008 05:52:44 org.apache.catalina.core.StandardService start\nINFO: Starting service Catalina\n30-May-2008 05:52:44 org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.16\n30-May-2008 05:52:45 org.apache.catalina.core.StandardContext addApplicationListener\nINFO: The listener \'listeners.ContextListener\' is already configured for this context. The duplicate definition has been ignored.\n30-May-2008 05:52:45 org.apache.catalina.core.StandardContext addApplicationListener\nINFO: The listener \'listeners.SessionListener\' is already configured for this context. The duplicate definition has been ignored.\n30-May-2008 05:52:46 org.apache.coyote.http11.Http11Protocol start\nINFO: Starting Coyote HTTP/1.1 on http-8080\n30-May-2008 05:52:46 org.apache.jk.common.ChannelSocket init\nINFO: JK: ajp13 listening on /0.0.0.0:8009\n30-May-2008 05:52:46 org.apache.jk.server.JkMain start\nINFO: Jk running ID=0 time=0/204  config=null\n30-May-2008 05:52:46 org.apache.catalina.startup.Catalina start\nINFO: Server startup in 2795 ms\n30-May-2008 05:52:52 org.apache.coyote.http11.Http11Protocol pause\nINFO: Pausing Coyote HTTP/1.1 on http-8080\n30-May-2008 05:52:53 org.apache.catalina.core.StandardService stop\nINFO: Stopping service Catalina\n30-May-2008 05:52:53 org.apache.coyote.http11.Http11Protocol destroy\nINFO: Stopping Coyote HTTP/1.1 on http-8080\n30-May-2008 05:52:56 org.apache.catalina.core.AprLifecycleListener init\nINFO: Loaded APR based Apache Tomcat Native library 1.1.12.\n30-May-2008 05:52:56 org.apache.catalina.core.AprLifecycleListener init\nINFO: APR capabilities: IPv6 [true], sendfile [true], accept filters [false], random [true].\n30-May-2008 05:53:04 org.apache.catalina.startup.Catalina stopServer\nSEVERE: Catalina.stop: \njava.net.ConnectException: Connection refused\n	at java.net.PlainSocketImpl.socketConnect(Native Method)\n	at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)\n	at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)\n	at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)\n	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)\n	at java.net.Socket.connect(Socket.java:519)\n	at java.net.Socket.connect(Socket.java:469)\n	at java.net.Socket.<init>(Socket.java:366)\n	at java.net.Socket.<init>(Socket.java:180)\n	at org.apache.catalina.startup.Catalina.stopServer(Catalina.java:421)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.stopServer(Bootstrap.java:337)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)', 'David Pashley', '2008-05-29 22:57:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1948, '43327', '8', 'Created  attachment 22036   [details] \nscript to demonstrate problem', 'David Pashley', '2008-05-29 22:58:04 UTC', 'tomcat_attachment/attachment 22036');
INSERT INTO `tomcatbeforefixcomments` VALUES (1949, '43327', '9', 'Created  attachment 22037   [details] \nlogfile of build using the script', 'David Pashley', '2008-05-29 22:59:53 UTC', 'tomcat_attachment/attachment 22037');
INSERT INTO `tomcatbeforefixcomments` VALUES (1950, '43327', '10', 'Hi, I could add another target environment with same problems, except that no SSL is being used.\n\nLinux openSUSE-103-64-minimal 2.6.22.9-0.4-default #1 SMP 2007/10/05 21:32:04 UTC x86_64 x86_64 x86_64 GNU/Linux\nTomcat 6.0.14\n\nIt is pretty frigthening that a server help tool like jsvc prevents this lib from working. It looks that the design and integration of jsvc or APR has some side effects. I could not recommend any furhter production use of this combination.\n', 'Siegmund Gorr', '2008-06-02 23:02:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1951, '43327', '11', 'David,\nIPv6 is enabled. I was using tcnative 1.1.13. It might be worth testing with that. Also, could you provide the contents of /etc/network/interfaces and the connector elements of your server.xml. Finally, are you starting with jsvc? Meanwhile, I\'ll double check I have IPv6 enabled.\n\nSiegmund,\nWhere does jsvc fit into this? Are you saying you only see this issue when starting via jsvc but not when starting from the scripts?', 'Mark Thomas', '2008-06-03 00:06:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1952, '43327', '12', 'I did a diff from what is in tomcat6-6.0.16/bin/tcnative.tar.gz and tcnative-1.1.13 and the only differences were svn commit info in the comments, so there is no code difference what so ever.\n\nI am running via jsvc:\nroot      3966  0.0  0.1   2056   364 ?        Ss   May30   0:00 /usr/bin/jsvc -user tomcat6 -cp /usr/share/java/commons-daemon.jar:/usr/share/tomcat6/bin/bootstrap.jar -outfile /var/lib/tomcat6/logs/catalina.out -errfile /usr/share/tomcat6/logs/catalina.err -pidfile /var/run/tomcat6.pid -Djava.awt.headless=true -Xmx128M -Djava.endorsed.dirs=/usr/share/tomcat6/common/endorsed -Dcatalina.base=/var/lib/tomcat6 -Dcatalina.home=/usr/share/tomcat6 -Djava.io.tmpdir=/var/lib/tomcat6/temp -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.config.file=/var/lib/tomcat6/conf/logging.properties org.apache.catalina.startup.Bootstrap\ntomcat6   3974  0.0 10.4 282728 27484 ?        Sl   May30   2:40 /usr/bin/jsvc -user tomcat6 -cp /usr/share/java/commons-daemon.jar:/usr/share/tomcat6/bin/bootstrap.jar -outfile /var/lib/tomcat6/logs/catalina.out -errfile /usr/share/tomcat6/logs/catalina.err -pidfile /var/run/tomcat6.pid -Djava.awt.headless=true -Xmx128M -Djava.endorsed.dirs=/usr/share/tomcat6/common/endorsed -Dcatalina.base=/var/lib/tomcat6 -Dcatalina.home=/usr/share/tomcat6 -Djava.io.tmpdir=/var/lib/tomcat6/temp -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.config.file=/var/lib/tomcat6/conf/logging.properties org.apache.catalina.startup.Bootstrap\n\n\nmy interfaces file is:\n\n# This file describes the network interfaces available on your system\n# and how to activate them. For more information, see interfaces(5).\n\n# The loopback network interface\nauto lo\niface lo inet loopback\n\n# The primary network interface\nauto eth0\niface eth0 inet dhcp\n# post-up ethtool -K eth0 tx off\n\n#\n# The commented out line above will disable TCP checksumming which\n# might resolve problems for some users.  It is disabled by default\n#\n\nresults in:\n\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether aa:00:0a:00:02:3b brd ff:ff:ff:ff:ff:ff\n    inet 10.0.2.59/16 brd 10.0.255.255 scope global eth0\n    inet6 fe80::a800:aff:fe00:23b/64 scope link \n       valid_lft forever preferred_lft forever\n\n\n\nMy only enabled connectors are:\n\n    <!-- Define a non-SSL HTTP/1.1 Connector on port 8180 -->\n    <Connector port=\'8180\' maxHttpHeaderSize=\'8192\'\n               maxThreads=\'150\' minSpareThreads=\'25\' maxSpareThreads=\'75\'\n               enableLookups=\'false\' redirectPort=\'8443\' acceptCount=\'100\'\n               connectionTimeout=\'20000\' disableUploadTimeout=\'true\' />\n    <!-- Define an AJP 1.3 Connector on port 8009 -->\n    <Connector port=\'8009\' \n               enableLookups=\'false\' redirectPort=\'8443\' protocol=\'AJP/1.3\' />\n', 'David Pashley', '2008-06-03 00:42:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1953, '43327', '13', 'Update on JSVC and APR\n\nInvolving debugging I found that my problem with JSVC and APR could be drilled down to SSL library access I did not found the reason why it hangs - may be the privileges are not sufficient after switching from root to the www-user. After a time period (on my three servers approx. 6 min. the startup suddenly continues - like a timeout has been reached.\n\nMy problems could be resolved by deactivating ssl in the tomcat apr configuration which might be a hint for other server operators as well. \nWe are handling the ssl separat and do not pass the data via the Apache mod_jk module to the AJP handler (which is been boosted by APR).\nSo configuration in httpd.conf is\n\nJkOptions +ForwardkeySize +ForwardURICompat -ForwardDirectories\nJkExtractSSL off\nJkRequestLogFormat \'%w %V %T\'\n\nAnd whithin server.xml\n<Listener className=\'org.apache.catalina.core.AprLifecycleListener\'\n  SSLEngine=\'off\' />\n \nSorry but I did not find the reason why this problems is not existing when we start tomcat without jsvc.\n\n', 'Siegmund Gorr', '2008-06-03 12:55:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1954, '43327', '14', 'Bingo! I can now reproduce this. Hopefully a fix won\'t be too far away...', 'Mark Thomas', '2008-07-04 14:06:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1955, '43327', '15', 'OK. There are two issues here.\n\nThe first is that the APR calls eventually called as a result of Address.info() and Socket.create() in o.a.t.util.net.AprEndpoint use slightly different logic to determine whether to create an IPv4 socket or an IPv6 socket. If you have an IPv6 capable interface that does not have an explicit IPv6 address defined these functions will assume different IP families.\n\nThe second issue is that whilst the first issue could be fixed by using Address.getInfo().family to specify that the family of the address should be used to use to create the socket, Address.getInfo() does not convert the APR_INET and APR_INET6 constants back into the ones defined in Socket (the constants are different in the Java code and in APR).\n\nSo, I have two patches. The first converts the constants back to the Java defined values and the second uses the family from the address to create the socket. Patches to follow.', 'Mark Thomas', '2008-07-05 15:40:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1956, '43327', '16', 'Created  attachment 22216   [details] \nNative patch\n\n*Health Warning*\n\nI am no C programmer. This patch fixes the problem for me but it needs to be checked by someone who actually knows what they are doing.', 'Mark Thomas', '2008-07-05 15:46:22 UTC', 'tomcat_attachment/attachment 22216.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1957, '43327', '17', 'Created  attachment 22217   [details] \nAPR Java connector patch\n\nThis needs the native patch to work.', 'Mark Thomas', '2008-07-05 15:47:22 UTC', 'tomcat_attachment/attachment 22217.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1958, '43327', '18', 'I (finally) tested it on my development machine which has both a NAT IPv4 and an IPv6 address, and it does not appear to work any better.\n\nNo address attribute -> error 22\naddress=\'127.0.0.1\'-> error 22\naddress=\'myIPv6\'-> no error (and ot correctly)', 'Remy Maucherat', '2008-08-19 06:56:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1959, '43327', '19', 'Ok, so I was testing the old version :(\n\nThe new testing result is:\n- no address attribute -> slow bind (20s at least), and does not bind the IPv6\n- address=\'127.0.0.1\'-> works\n- address=\'myIPv6\'-> works\n\nSo it\'s a lot better, but not glitch free yet.', 'Remy Maucherat', '2008-08-19 10:26:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1960, '43327', '20', 'Is this true on Linux, Remy?  Or another OS.  Solaris, for example, is known\nto not tolerate sharing an ipv4+6 listener very well.\n\nEssentially, any OS in which the ipv4 stack is built of different driver\ncomponents than the ipv6 stack gives headaches attempting a single listener.\nFor all of these cases, two listening sockets, one explicitly IPv4 and the\nother IPv6 is preferable.', 'William A. Rowe Jr.', '2008-08-19 10:57:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1961, '43327', '21', 'I am testing on Linux.', 'Remy Maucherat', '2008-08-19 11:03:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1962, '43327', '22', 'With the latest changes, this now works :) Really tricky to get right ...', 'Remy Maucherat', '2008-08-22 01:46:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1963, '45608', '1', 'This has been fixed in trunk and proposed for 6.0.x', 'Mark Thomas', '2008-08-12 08:12:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1964, '45608', '2', '\n\n*** This bug has been marked as a duplicate of  bug 43228  ***', 'Takayuki Kaneko', '2008-08-12 09:32:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1965, '45608', '3', 'I\'m sorry.\nI only wanted to notify the related bug.', 'Takayuki Kaneko', '2008-08-12 09:35:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1966, '41407', '1', '\nYou try to do authorization with client certs?\nI\'m afraid this is not implemented tomcat\'s JAASRealm.\n\nI am sure it is possible to create an extended JAASRealm2 which is\nable to provide full JAAS functionality with client certs also.\nThe way to do it could be:\n1. Implement authenticate(X509Certificate certs[]) just like\n   the user/pwd-authenticate in JAASrealm.\n2. Add an appropriate CallbackHandler for the cert chain\n   to pass the certificates to the custom LoginModule.\n\nThe custom authorization stuff has to go to the LoginModule\nso the new JAASRealm2 should be finished.\n\nPlease let me know if you plan to implement it.', 'rm', '2007-01-19 05:37:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1967, '41407', '2', 'This has been fixed in trunk and proposed for 5.5.x and 6.0.x', 'Mark Thomas', '2008-08-09 07:36:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1968, '41407', '3', 'This has been committed for 6.0.x and will be in 6.0.19 onwards.', 'Mark Thomas', '2008-09-06 13:02:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1969, '45591', '1', 'Thanks for the report and patch. I have committed a slightly different version to trunk and proposed it for 6.0.x and 5.5.x', 'Mark Thomas', '2008-08-08 07:36:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1970, '45591', '2', '(In reply to  comment #1 )\n> Thanks for the report and patch. I have committed a slightly different version\n> to trunk and proposed it for 6.0.x and 5.5.x\n\n\nThanks!\n\n--Matt', 'Matt Passell', '2008-08-08 08:23:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1971, '45591', '3', 'This has been fixed in 6.0.x and will be included in 6.0.19 onwards.', 'Mark Thomas', '2008-08-13 15:35:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1972, '45453', '1', 'Created  attachment 22301   [details] \nproposed patch for tomcat-6.0.16\n\nsynchronize JDBCRealm.getPrincipal', 'Santtu Hyrkkö', '2008-07-23 00:54:05 UTC', 'tomcat_attachment/attachment 22301.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1973, '45453', '2', 'Created  attachment 22302   [details] \nproposed patch for tomcat-5.5.26\n\nsynchronize JDBCRealm.getPrincipal()', 'Santtu Hyrkkö', '2008-07-23 00:54:33 UTC', 'tomcat_attachment/attachment 22302.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1974, '45453', '3', 'The problem is also in 6.0.16', 'Santtu Hyrkkö', '2008-07-23 01:01:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1975, '45453', '4', 'Thanks for the patch. It has been applied to trunk and proposed for 6.0.x and 5.5.x.\nNote you will probably be better off using the DataSourceRealm.', 'Mark Thomas', '2008-07-29 08:00:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1976, '45453', '5', 'This has been fixed in 6.0.x and will be included in 6.0.19 onwards.', 'Mark Thomas', '2008-08-13 15:05:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1977, '42727', '1', 'Created  attachment 20405   [details] \nChecks aggregator==null before returning null\n\nI attached a patch to check that aggregator==null before returning null.', 'Will Pugh', '2007-06-27 15:02:32 UTC', 'tomcat_attachment/attachment 20405.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1978, '42727', '2', '***  Bug 44060  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2007-12-11 13:10:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1979, '42727', '3', 'I have reproduce similar behavior. \nI cannot read anything from ServletRequest.getInputStream or getReader for\nTomcat ver 5.5.15+.\nAny idea?\n\nRegards\nMladen', 'Mladen Dryankov', '2008-02-20 03:34:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1980, '42727', '4', 'Any chance of getting this fix in tomcat 5.5 ? \n\nAfter a few hours of debugging my application, i finally discovered this bug was the root cause. It\'s still there in Tomcat 5.5.26. ', 'gui', '2008-07-17 08:29:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1981, '42727', '5', 'Thanks for the patch. It has been applied to trunk and proposed for 6.0.x and 5.5.x.', 'Mark Thomas', '2008-07-17 15:14:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1982, '42722', '1', 'Thanks for the patch. A version of it has been applied to trunk and proposed for 6.0.x', 'Mark Thomas', '2008-07-10 14:21:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1983, '42722', '2', 'As Mark points out, this is a JAVA bug.  It\'s contingent on the Sun Java instsller\nto provide msvcr71.\n\nThis is *NOT* a system library (msvcrt.dll is).  In fact MS expects everyone who\nconsumes it to install it privately, which is why it\'s flagged as a redist.\n\nPlease, don\'t waste your time and ours by reopening.', 'William A. Rowe Jr.', '2008-07-10 14:33:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1984, '42722', '3', 'Wrong bug Bill.', 'Mark Thomas', '2008-07-10 14:46:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1985, '42722', '4', 'Glad this was reopened, and entirely unsure of what bugzilla or firefox just did to me :)\n\nThanks again Nils for this fix ', 'William A. Rowe Jr.', '2008-07-10 14:48:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1986, '36155', '1', 'Dont know whether related or not.\nMigrated some old 4.0 serlvet to 4.1 with mod_jk - 1.2.0\n\nAfter I upgraded mod_jk to 1.2.15\nmy tomcat-4.1.31 start to point to wrong host.\n(the serlvet binaries are copied from another host,\n my point is Previous version did not give me problem)\n\n patricko@staff.singnet.com.sg ', 'patrick ong', '2005-12-25 18:23:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1987, '36155', '2', 'So the problem still exists with mod_jk 1.2.15 and Tomcat 5.5.12.\n\nIf two VirtualHosts use the same worker, Tomcat receives the wrong ServerName.\nIMHO, it has something todo with some cache or some other flaw.\n(The caches are worker-wise, aren\'t they?)\n\nDoes somebody care about this?\n\n@Patrick: i don\'t know if your problem is related. For me, the problem is\nreproducable, but it does not go wrong always:\nfirst HTTP-request works, second doesn\'t, third works again, some random ...', 'Sven', '2005-12-25 19:13:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1988, '36155', '3', 'Patrick, I don\'t think your problem is related.  Try  users@tomcat.apache.org  for\nhelp.  Sven, I can\'t reproduce your problem.  If you\'re still experiencing it\nand can post the configuration files for Apache, Tomcat, mod_jk, please do.', 'Yoav Shapira', '2006-01-10 20:12:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1989, '36155', '4', 'I\'ll do my best, to reproduce it with a small testcase.', 'Sven', '2006-01-10 20:29:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1990, '36155', '5', 'Created  attachment 17404   [details] \ntestcase for the problem i described\n\nThere are two hosts in tomcat: host1 and host2\nThey point to /tmp/host1 and /tmp/host2 (which is also in the tgz)\nThere are two hosts in apache: host1/alias1 and host2/alias2\nThere are two workers defined, but only one is in use from both virtualhosts\nPut the line \'127.0.0.1 host1 host2 alias1 alias2\' in /etc/hosts\n\nIf you run \'./test.sh alias1\' and \'./test.sh alias2\' in two terminals you\nshould see only \'host1\' in one window, and \'host2\' in the other window.\n\nWhat i experience is, that \'./test.sh alias2\' output \'host1\' sometimes - or\n\'./test.sh alias1\' outputs \'host2\'. When i change apache\'s virtualhosts to use\ntwo different workers, the problem is gone.', 'Sven', '2006-01-12 20:58:04 UTC', 'tomcat_attachment/attachment 17404');
INSERT INTO `tomcatbeforefixcomments` VALUES (1991, '36155', '6', 'you can also start \'./test.sh host1\' and \'./test.sh host2\' with the same strange\nresult: \'./test.sh host1\' sometimes outputs \'host2\', and \'./test.sh host2\'\nsometimes outputs \'host1\'', 'Sven', '2006-01-12 21:43:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1992, '36155', '7', 'Sven,\n Both workers on the same port? Why not match the \'host\' name in\n workers.properties to the \'host\' container name in server.xml?  Why point\n both at 127.0.0.1?\n\n Seems the proper config is to use names for the workers\' host values instead\n of the same (port and) ip addy in both cases.\n\n-Dan', 'Dan Carwin', '2006-01-17 19:24:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1993, '36155', '8', '@Dan: i want to use only one worker - and the config attached to this bug only\nuses one worker - though two are declared.\nUsing two workers that point to the same tomcat is a workaround for me, so that\nthe bug described here doesn\'t rise.\nI don\'t understand, what you mean with \'using names\' in the worker-file. That\ndoesn\'t make sense to me since the proper DNS-name would be \'localhost\' in both\ncases. The AJP-Connector only listenes on localhost. The names used in the\nworker-file are _not_ sent to Tomcat by mod_jk, AFAIK.', 'Sven', '2006-01-18 01:15:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1994, '36155', '9', 'The comment by Dan sounded much like \'your config cannot work at all\'. So i\nthink i need to explain a little more:\n\nThe config does work, if you:\n- restart apache, then run only \'./test.sh alias1\': you will only see host1 on\nthe console\n- restart apache, then run only \'./test.sh alias2\': you will only see host2 on\nthe console\n- use worker1 for the one virtualhost, and use worker2 for the other, then run\n\'./test.sh alias1\' and \'./test.sh alias2\' in parallel: both scripts return the\nright results.\n\nI hope that you agree with me, that tomcat chooses the hosts like it should.\nNote, that the server.xml says useIPVHosts=\'true\' - so tomcat does AFAIK not\nlook at the host-header, but at some other information that mod_jk sends. Since\ni also use \'UseCanonicalName On\' for apache, mod_jk is supposed to send the\nServerName declared for the virtualhost.\n\nThe config does not work, if you use the same worker for both virtualhosts -\nwhich is \'the right thing\' IMHO since there is also only one tomcat running.\nWhat do i mean, with \'it does not work\' - well:\nStart \'./test.sh alias1\' and \'./test.sh alias2\' in parallel. If you\'re lucky, it\nworks for 10 requests and you see what you should: \'host1\' returned by the first\ncommand, and \'host2\' returned by the second command.\n\nThe result changes for me, and the at least one command \'goes crazy\' and returns\nsomething else: either the command only returns host1 instead of host2 (or vice\nversa of course) or sometimes i even get an alternating sequence of host1 and\nhost2 by one of the commands - or even by both.\n\nEspecially the alternating output is a case, that should not occur. The choice\nmade by tomcat is deterministic AFAIK and tomcat is only considering the data\nthat it gets by mod_jk, so how can there be an alternating sequence?\n\nMy conclusion is, that mod_jk sends the wrong servername, or perhaps sending the\nservername is optional and tomcat just \'reuses\' the information it has been\ngiven by a former AJP-request on the same connection - but i have no clue about\nthose internal things.', 'Sven', '2006-01-18 17:51:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1995, '36155', '10', 'I was not able to reproduce the problem.\nWith your test files and mod_jk from SVN it works OK.', 'Mladen Turk', '2006-03-17 09:25:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1996, '36155', '11', 'I found the bug.\nIt\'s still present in Tomcat 6.0.10.\nI will supply details soon, as well as a patch.\n', 'Sven', '2007-03-02 20:13:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1997, '36155', '12', 'So the bug is in the class org.apache.tomcat.util.buf.MessageBytes.\n\nThe method setBytes doesn\'t clear the char-buffer. And the method setChars\ndoesn\'t clear the byte-buffer.\n\nIf useIPVHosts is enabled, then the parameter \'host\' of the\norg.apache.tomcat.util.http.mapper.map()-method is a MessageBytes-Object of the\ntype T_BYTES. The method MessageBytes.toChars()-method is called. But this\nmethod exists, if the charbuffer is already filled.\n\nAnd in deed, the char-buffer is already filled. While the byte-buffer contains\nthe value \'host1\', the char-buffer may still contain the value \'host2\' because\nthe MessageBytes objects are reused. And instead of converting the\nbyte-buffer-value \'host1\' to chars, the old value \'host2\' is used. This resulted\nin the bug.\n\nSo the following patch fixes the problem.\n\n\nWith your permission, i would like to clean up the class MessageBytes.\nIt really needs it - IMHO.\n', 'Sven', '2007-03-02 21:59:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (1998, '36155', '13', 'Created  attachment 19659   [details] \npatch for this bug\n\nThe patch should apply cleanly to Tomcat 6.0.10', 'Sven', '2007-03-02 22:00:42 UTC', 'tomcat_attachment/attachment 19659.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (1999, '36155', '14', 'I discovered, that calling byteC.recycle() also resets the Encoding that might\nhave been set. But actually the setEncoding() method is used nowhere.\nAnd calling byteC.reset() doesn\'t work, because the reset()-method leaves the\nByteChunk in an illegal state:  the array-pointer is set to null, but the\ninternal \'isSet\' which controlls the result of isNull() is not reset to false.\n\nI\'m quite unhappy with the class MessageBytes. For example setInt/setLong also\nforget to clear the char-buffer. toBytes() ignores the charset. In many cases i\ndiscovered strange handeling of non-ASCII characters. So i don\'t aim to clean it\nup. There are too many side-effects that might be hurt by any modification.', 'Sven', '2007-03-03 00:40:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2000, '36155', '15', '-1 for the patch. If the problem exists (I really doubt it), a better solution\nwill have to be found.', 'Remy Maucherat', '2007-03-03 02:00:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2001, '36155', '16', '(In reply to  comment #15 )\n> -1 for the patch. If the problem exists (I really doubt it), a better solution\n> will have to be found.\n\nSimply one question: Why?\nsetBytes() invalidates everything - except the value within charC is kept.\n\nAnyway: there might be one missing recycle call somewhere. I\'m already looking\nfor it.', 'Sven', '2007-03-03 06:25:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2002, '36155', '17', 'So in org.apache.coyote.Request.recylce(), this.localNameMB.recycle() is not\ncalled. If i add that call, the problem is gone too (my first patch has been\nreverted before testing).\n\nThe problem is: remoteAddrMB.recycle(), remoteHostMB.recycle(),\nlocalAddrMB.recycle() is also not called. And i have no clue why not or is it\nshould actually be called.\n\n\nAnyway: At least localNameMB gets reused without being recycled. So the internal\ncharC contains an old value. setBytes() doesn\'t clear internal the charC-cache.\ntoChars() reuses the old value. Hence the bug.\n\n\nI admit, that the semantics of the MessageBytes class are a ridle to me. I don\'t\nknow, why setBytes() shouldn\'t invalidate the charC cache (even though it\ninvalidates all other cached values).\nSomebody please explain the semantics of this class to me! And decide, whether\nsetBytes() should clear charC, or not.', 'Sven', '2007-03-03 06:57:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2003, '36155', '18', 'Additional information:\n\nthe value of localNameMB is set in AjpProcessor.prepareRequest() (line 645) by\ncalling \'requestHandlerMessage.getBytes(request.localName())\'. This getBytes\nmethod calls setBytes() of localNameMB.\n\nAbove that line, remoteAddrMB and remoteHostMB are also set with the same\nmethod. And they also might not have been recycled. I don\'t know for sure.', 'Sven', '2007-03-03 07:04:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2004, '36155', '19', '(In reply to  comment #17 )\n> And decide, whether setBytes() should clear charC, or not.\n\nIt seems you\'re eager to contribute and stuff, and I think that\'s good, but if I\nsaid -1 to your patch, this means the answer to this question is \'no\'. This will\ncause problems, and is also inefficient.\n\nI think this is a special case with AJP, where recycle should possibly be called\non the localName MessageBytes before reading the localName field (it should be\nfairly explicit that the localName/Addr are otherwise never recycled in the\nRequest object). This is indeed a special case with the IP vhost feature (which\nIMO is not a very good feature, but it\'s another story).', 'Remy Maucherat', '2007-03-03 14:45:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2005, '36155', '20', 'Do you understand, why we need to recycle the localName?\n(short reason: two ajp-requests with different localName over same AJP connection)\n\n\nSo i have the feeling, that you want this fix to be AJP specific.\nI will try to fix it in that way.\n\nI tried to fix AjpProcessor/AjpAprProcessor. But the fix only worked, when i did\nit in JkCoyoteHandler. I simply changed the code from\n  request.recycle();\nto\n  request.recycle();\n  request.localName().recycle();\n\n\nI don\'t feel well leaving the other 3 fields (remoteAddr, remoteHost, localAddr)\nunrecycled. Somehow i feel, like this issue also applies to the other fields.\nBut i don\'t have enough knowledge to be sure. So i leave this up to you.\n\n\nNow i will attach a new patch. Maybe you like it :-)', 'Sven', '2007-03-03 15:51:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2006, '36155', '21', 'Created  attachment 19660   [details] \nnew patch', 'Sven', '2007-03-03 15:53:02 UTC', 'tomcat_attachment/attachment 19660.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2007, '36155', '22', 'I\'ve committed a more general fix for the JK Connector (i.e. \nJkCoyoteHandler).  I can port it to the APR and AJP Connectors if/when Remy \nand Mladen doen\'t veto it.', 'william.barker', '2007-05-20 15:35:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2008, '36155', '23', '> I\'ve committed a more general fix for the JK Connector (i.e. \n> JkCoyoteHandler).  I can port it to the APR and AJP Connectors if/when Remy \n> and Mladen doen\'t veto it.\n\nThanks a lot!\n\nI took a look at your commits. I think, the JK Connector is fixed now. I will\ntest it soon. (At the moment, i don\'t have much time).', 'Sven', '2007-05-20 18:30:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2009, '36155', '24', '(In reply to  comment #23 )\n> I took a look at your commits. I think, the JK Connector is fixed now. I will\n> test it soon. (At the moment, i don\'t have much time).\n\nI ran my tests, and yes: it\'s fixed.\n\nSweet!', 'Sven', '2007-05-22 16:56:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2010, '36155', '25', 'So William has made a start. His patch works, and could be ported to the other 2\nconnectors.\n\nBut i think he\'s waiting for some reaction by Remy and Mladen.\n(see  comment #22 )\n\nLet\'s get this done, so this can be marked fixed.\n', 'Sven', '2007-08-06 07:17:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2011, '42750', '1', 'According to the HTTP spec there is one space character between the method and\nthe URL - i.e. your request is invalid HTTP.\n http://tools.ietf.org/html/rfc1945#page-23 \n\nThis ticket should probably be marked INVALID, but the error response doesn\'t\nlook appropriate - the response should probably be a 400 Bad Request.\n', 'Tim Whittington', '2007-06-26 17:56:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2012, '42750', '2', '(In reply to  comment #1 )\n> According to the HTTP spec there is one space character between the method \nand\n> the URL - i.e. your request is invalid HTTP.\n>  http://tools.ietf.org/html/rfc1945#page-23 \n> This ticket should probably be marked INVALID, but the error response doesn\'t\n> look appropriate - the response should probably be a 400 Bad Request.\n\nThank you for pointing me in the right direction. After reading the Http spec \nI have to agree with you that the Http is invalid. A point could be made that \nthe spec should be followed exactly when sending and be more forgiving when \nreceiving, but that is another issue.  I have passed the information you \nprovided to Software AG, who is now looking into making changes to correct the \nHttp on their end (in Natural).  Thanks again!', 'Dick Salisbury', '2007-07-09 07:43:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2013, '42750', '3', '>According to the HTTP spec there is one space character between the method and\n>the URL - i.e. your request is invalid HTTP.\n> http://tools.ietf.org/html/rfc1945#page-23 \n\n>This ticket should probably be marked INVALID, but the error response doesn\'t\n>look appropriate - the response should probably be a 400 Bad Request.\n\nIt is true that in the RFC the Request line is made up of single spaced\nelements, but if you look at appendix b\n( http://tools.ietf.org/html/rfc1945#page-55 ) it says \n\'   Clients should be tolerant in parsing the Status-Line and servers\n   tolerant when parsing the Request-Line. In particular, they should\n   accept any amount of SP or HT characters between fields, even though\n   only a single SP is required.\n\'', 'Danny Webb', '2007-12-05 10:05:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2014, '42750', '4', 'I have same 505 error with Natural 4.2 make a post on a tomcat 5 but after\nanalyse it, i have a different conclusion.\n\nThis for me doesn\'t work even if we remove space :\n\nPOST  http://C010030S:5599/NXAServer/NextAxiomServer  HTTP/1.0\n\nTomcat only accept this request :\n\nPOST /NXAServer/NextAxiomServer HTTP/1.0\nHost: C010030S:5599', 'DonKiShoot', '2008-02-13 01:42:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2015, '42750', '5', 'I have committed a patch to trunk that makes the parsing of the request line tolerant of multiple SP and/or HT. The patch has been proposed it for 6.0.x and 5.5.x\n\nI have also tested the example given in  comment #4  and cannot reproduce that issue.', 'Mark Thomas', '2008-05-19 13:10:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2016, '42750', '6', 'This patch has been applied to 6.0.x and will be in 6.0.17 onwards.', 'Mark Thomas', '2008-06-11 13:04:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2017, '42934', '1', 'Here is a link to the Seam Issue:\n\n http://jira.jboss.com/jira/browse/JBSEAM-1681 ', 'Mike Youngstrom', '2007-07-18 14:45:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2018, '42934', '2', 'According to the servlet spec, the listeners are supposed to be called in the\norder that they\'re declared in web.xml. Except at shutdown the session listeners\nare supposed to be called before the context listeners.\n\nSo the question is, how are the listeners declared in web.xml?\n\n(I don\'t know anything about how Seam integrates with Tomcat, but I guess there\nmust be a deployment descriptor somewhere with the <listener> declarations.)', 'Len Popp', '2007-08-01 07:21:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2019, '42934', '3', '> According to the servlet spec, the listeners are supposed to be called in the\n> order that they\'re declared in web.xml. Except at shutdown the session listeners\n> are supposed to be called before the context listeners.\n> \n> So the question is, how are the listeners declared in web.xml?\n> \n> (I don\'t know anything about how Seam integrates with Tomcat, but I guess there\n> must be a deployment descriptor somewhere with the <listener> declarations.)\n\nYes, Seam has a listener.  And at shutdown in Tomcat 6 the Session Listeners are\ncorrectly called before the Servlet Listeners.  The problem is that at server\n\'startup\' the session listeners are also called before the Servlet Listeners\nwhich is causing trouble for Seam since Seam needs contextInitialized() to be\ncalled before sessionDidActivate().\n\nMike\n\n', 'Mike Youngstrom', '2007-08-01 08:05:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2020, '42934', '4', 'You missed my point. The order in which the listeners are called depends (in\npart) on the order in which they are declared. The behaviour that you describe\ncould be perfectly correct according to the servlet spec, *depending on how the\nlisteners are declared*. For more details, see section 10.3.3 and 10.3.4 of the\nservlet specification.\n\nHere is a concrete example. Suppose web.xml contains these declarations:\n\n    <listener>\n        <listener-class>com.example.MySessionListener</listener-class>\n    </listener>\n    <listener>\n        <listener-class>com.example.MyContextListener</listener-class>\n    </listener>\n\nIn this example, on startup the session listener will be called before the\ncontext listener (according to section 10.3.3 of the servlet spec). On shutdown,\nthe session listener will again be called before the context listener (according\nto section 10.3.4).\n\nAnother possibility is that a single listener class implements two listener\ninterfaces. In that case, the spec doesn\'t say what order they should be called\non startup. I guess if the listeners need to be called in a certain order, they\nneed to be implemented in separate classes so that you can specify the order.\n\nSo, how are the listeners declared in your case?\nPlease post the contents of web.xml, or just the part with the <listener>\ndeclarations.\n', 'Len Popp', '2007-08-01 08:27:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2021, '42934', '5', 'I see the confusion.  When I say Session Listener I was talking about a class\nthat implements HttpSessionActivationListener where you were thinking I meant an\nHttpSessionListener.  When HttpSessionActivationListeners are not declared in\nthe web.xml but are automatically called by the container when the instance\npassivates and activates instances stored in the Session.\n\nSo what I\'m saying is that I would expect the\nServletContextListener.contextInitialized() to be called before\nHttpSessionActivationListener.sessionDidActivate().\n\nWhen shutting down ServletContextListener.contextDestroyed() is currently\ncorrectly called after HttpSessionActivationListener.sessionWillPassivate().\n\nDoes that clear things up?', 'Mike Youngstrom', '2007-08-01 08:41:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2022, '42934', '6', 'Sorry, you\'re right, I forgot about HttpSessionActivationListener objects being\nstored in the session itself.\n\nAs far as I can see, the spec doesn\'t say what order these events are fired\nrelative to the other types of events. Your idea that contextInitialized should\ncome before sessionDidActivate sounds reasonable, but you may be stuck in the\ntrap of \'Tomcat follows the spec so it doesn\'t need to be fixed.\'\n', 'Len Popp', '2007-08-01 10:29:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2023, '42934', '7', 'Ya, that\'s the trap I\'m afraid of. :)  I\'m hoping that because it is a Seam\nproblem perhaps Jboss might be able to assert some of their influence over\ntomcat to get them to fix it....but I guess we\'ll see.  Thanks for looking at\nthe issue.', 'Mike Youngstrom', '2007-08-01 10:31:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2024, '42934', '8', 'I really vote for this. \n\nMy own web application needs the same functionality. I use a spring\nWebApplicationContext and some of my Session Vales need beans from this context.\nSo I store them transient in the session values and fetch them at\nsessionDidActivate. But I can not do this if my context is not up and running.', 'Alexander Kiel', '2007-11-06 04:37:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2025, '42934', '9', 'Looking at this now...\n\nEven with the latest spec things are not explicit and could be read either way. However, 1) I agree with the assessment that logically you would expect the context to be present before the sessions are activated 2) and the last paragraph SRV.16.1.7 hints in this direction as well.\n\nI\'ll see how easy it is to make the change.', 'Mark Thomas', '2008-05-08 15:18:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2026, '42934', '10', 'See also  bug 30344 .', 'Mark Thomas', '2008-05-08 15:19:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2027, '42934', '11', 'I have committed a fix to trunk. Initial testing looks OK but I will eave it a few weeks to see if any issues arise before proposing it for 6.0.x', 'Mark Thomas', '2008-05-09 13:21:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2028, '42934', '12', 'Thanks tons for taking this on Mark.\n\nMike', 'Mike Youngstrom', '2008-05-10 20:21:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2029, '42934', '13', 'This is now proposed for 6.0.x', 'Mark Thomas', '2008-05-29 15:05:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2030, '42943', '1', 'Out of interest, what do you find if you move the \'dul\' namespace declaration up\nto the <jsp:root>? Any change?', 'Henri Yandell', '2007-08-06 20:02:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2031, '42943', '2', '(In reply to  comment #1 )\n> Out of interest, what do you find if you move the \'dul\' namespace declaration up\n> to the <jsp:root>? Any change?\n\nThat doesn\'t seem to change anything, I get the same error.', 'Vojtech Toman', '2007-08-28 04:16:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2032, '42943', '3', 'This has been fixed in trunk and proposed for 5.5.x and 6.0.x', 'Mark Thomas', '2008-05-08 14:56:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2033, '42943', '4', 'The patch has been applied to 6.0.x and will be included in 6.0.17 onwards.', 'Mark Thomas', '2008-05-15 13:59:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2034, '43080', '1', 'This class is using a static logger, and has no efficient way to access the\nwebapp logger.', 'Remy Maucherat', '2007-08-10 00:18:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2035, '43080', '2', 'If it cannot get the logger for the proper webapp then why does it log into some\nother webapp? At least it should log into catalina.out.\n\nThis is a serious issue.\n\nIf proper logging is impossible then the whole verification should be removed,\nit is useless like this IMHO.\n\n(Not to mention that it is broken -- that\'s a different bug report. But that\nshows that no one really used this information ever.)', 'Marius Scurtescu', '2007-08-10 00:31:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2036, '43080', '3', 'Marius, do you have a test case that easily generates these log messages?', 'Ryan Sweet', '2007-08-10 10:30:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2037, '43080', '4', 'AFAIK you only need:\n- URL patterns like \'/foo/*\' in you web.xml\n- debug level logging\n\nIf you have several web apps the log events may show up in the wrong web app log\nfile, don\'t know how to trigger that.\n\nSee also  bug 43079 ', 'Marius Scurtescu', '2007-08-10 10:43:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2038, '43080', '5', 'This has been fixed in trunk and proposed for 6.0.x and 5.5.x', 'Mark Thomas', '2008-05-04 03:43:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2039, '43080', '6', 'This has been fixed in 6.0.x and will be included in 6.0.17 onwards.', 'Mark Thomas', '2008-05-15 12:57:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2040, '43191', '1', 'The compressableMimeType isn\'t exactly ignored. It lets you add new MIME types\nfor compression, but there doesn\'t seem to be any way to remove the default set\nof types.\n\nThat is, if you specify compressableMimeType=\'text/html\' you effectively end up\nwith compressableMimeType=\'text/html,text/xml,text/plain,text/html\'.\n\nI have verified the problem in 5.5.23 and 6.0.trunk. It looks easy to fix, I\'ll\ngive it a try.', 'Len Popp', '2007-08-24 08:13:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2041, '43191', '2', 'Created  attachment 20702   [details] \npatch vs. tc6.0.x/trunk\n\nPatch for 6.0.trunk. Connector attribute compressableMimeType is the complete\nlist of compressable MIME types, instead of being added to the default list.', 'Len Popp', '2007-08-24 11:05:29 UTC', 'tomcat_attachment/attachment 20702.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2042, '43191', '3', 'Created  attachment 20713   [details] \npatch for 5.5\n\nHere\'s the same patch for 5.5, since that\'s what the bug was reported against.', 'Len Popp', '2007-08-27 06:39:56 UTC', 'tomcat_attachment/attachment 20713.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2043, '43191', '4', 'If seems that this is a good idea, but can be a regression with older tomcat versions :-(\n\nPeter', 'Peter Rossbach', '2007-08-28 06:10:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2044, '43191', '5', '***  Bug 37834  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2007-08-29 04:48:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2045, '43191', '6', '(In reply to  comment #4 )\n\nAs it is, there is no way to turn off gzip compression for one file type while\nkeeping it for others. That seems more serious than the possible regression,\nwhich is easy to fix by setting compressableMimeType correctly. (And are there\nreally a lot of users that are using it incorrectly? The documentation is quite\nclear.)\n\nAlternatively, I guess you could add a new attribute that does what\ncompressableMimeType was supposed to do...\n', 'Len Popp', '2007-08-31 06:37:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2046, '43191', '7', 'I have applied your patch to trunk (expanded to include the other connectors) and proposed it for 6.0.x and 5.5.x', 'Mark Thomas', '2008-05-03 03:26:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2047, '43191', '8', 'This has been applied to 6.0.x and will be included in 6.0.17 onwards.', 'Mark Thomas', '2008-05-15 12:35:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2048, '43191', '9', 'Opps - this is still open for 5.5.x', 'Mark Thomas', '2008-05-16 10:56:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2049, '43191', '10', 'I would like to share an alternative approach for this problem I just implemented which avoids having to update Tomcat (or patch it).\n\nGrab CompressionFilter.java, CompressionResponseStream.java and CompressionServletResponseWrapper.java from the Tomcat source code distribution (I did this with the 5.5.25 source).\n\nOpen up CompressionServletResponseWrapper.java and modify the writetoGZip() method. On line 305, replace...\n\n    response.addHeader(\'Content-Encoding\', \'gzip\');\n    gzipstream = new GZIPOutputStream(output);\n\n...with...\n\n    if ((response.getContentType()!=null) &&\n         (response.getContentType().equals(\'application/pdf\')) {\n\n        // I want to compress this content type\n        response.addHeader(\'Content-Encoding\', \'gzip\');\n        gzipstream = new GZIPOutputStream(output);\n    } else {\n        // Don\'t want to compress this content type\n        gzipstream = output;\n    }\n\nCompile all three Java classes, then add the filter into your web.xml file:\n\n    <filter>\n        <filter-name>Compressing Filter</filter-name>\n        <filter-class>compressionFilters.CompressionFilter</filter-class>\n        <init-param>\n            <param-name>compressionThreshold</param-name>\n            <param-value>1</param-value>\n        </init-param>\n    </filter>\n    <filter-mapping>\n        <filter-name>Compressing Filter</filter-name>\n        <url-pattern>/*</url-pattern>\n    </filter-mapping>\n\n\nThis is very handy if you don\'t want to upgrade Tomcat, or for Tomcat 5.5.x users for who there isn\'t an upgrade with the patch available yet. Also useful if you don\'t want to compress server-wide for all of your web applications.\n\nEnjoy!', 'Richard Mundell', '2008-06-16 05:44:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2050, '43191', '11', 'For such a simple concept, every compression filter I have ever seen has serious problems. Mostly the problems are not addressed, and instead all kinds of finely grained mechanisms are created to more selectively apply compression. For example, if a response sets the content-length header, I have seen compression filters break. The browser either hangs waiting for the rest of the response, or the response is truncated to the length set. I don\'t remember if Tomcat\'s compression filter is guilty of this behavior or not, but I suspect the latter due to the existence of the compressionThreshold setting. \n\nI have created my own GZIPFilter which addresses all the problems I have seen in various other compression filter implementations. I am posting it as an attachment to this bug, feel free to use it, or not. Its advantages are captured in the comments, in summary, it streams rather than makes a copy, it handles content-length correctly, it detects client support of gzip compression, and it doesn\'t double compress. It is not problem-free, the known problems and limitations are also captured in the comments.\n\nMy theory on filter mapping is to keep it simple. So my filter doesn\'t care about mime-types, or any other qualification other compression filters use to decide whether to compress or not. As I stated before, it is my experience that these features exist to \'fix\' other problems in the filters.\n\nThe original poster can use my GZIPFilter in one of a few ways:\n1) Use filter-mapping to selectively compress content.\n2) Extend GZIPFilter, look at the mime-type header, and compress or not by calling super.doFilter().\n3) Modify my GZIPFilter to look at mime-types.\n', 'Jonathan Leech', '2008-07-01 10:11:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2051, '43191', '12', 'Created  attachment 22203   [details] \nGZIP compression filter', 'Jonathan Leech', '2008-07-01 10:12:26 UTC', 'tomcat_attachment/attachment 22203.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2052, '43366', '1', 'The manager API has changed at 6.0.x ! Currently only the HTMLManagerServlet /manager/html/sessions \nis supported. :-)\n\nI hope Remy or Rainer can help\n\nPeter', 'Peter Rossbach', '2007-09-14 23:41:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2053, '43366', '2', 'Re-opened as at a minimum, the docs need to be updated.', 'Mark Thomas', '2007-09-15 06:18:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2054, '43366', '3', 'It\'s frustrating when functionality like this simply disappears when moving to a newer version. We have \nscripts that monitor our tomcat servers using the sessions command. (We use \'curl\' to get the results, and \nthen process the information.) The \'text\' version of this command worked great, and served our purpose. \nSadly, the html version referenced above does not provide the same information (session information \nbroken down in ten-minute ranges).....even after sifting through the HTML formatting.....something you \ndon\'t want when using a commandline tool like curl.\n{grumble}\n{sigh}', 'Greg Johnson', '2007-09-15 07:07:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2055, '43366', '4', 'OK, I talk with Rainer to make a port from tomcat 5.5!', 'Peter Rossbach', '2007-09-15 10:06:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2056, '43366', '5', 'Looking at the svn history, the functionality is still there it is just that the command name changed (to expire) when additional functionality was added to enable sessions to be expired.\n\nI have added back the sessions command but marked it as deprecated as it may well be removed in a future version.\n\nThe fix has been committed to svn and proposed for 6.0.x', 'Mark Thomas', '2008-04-27 11:08:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2057, '43366', '6', 'In TC 6 the HTML manager got a new feature behind the command \'sessions\'. It lists individual sessions and allows to invalidate individual sessions, remove attributes etc. This is feature A.\n\nSomehow parallel in time I saw, that the old sessions feature (session statistics by maxInactiveInterval) was pretty useless, in most cases maxInactiveInterval is constant for all sessions in one context. So I wrote a somewhat more useful thing, namely a session statistic by idle time. This is feature B.\n\nUnfortunately when I wanted to commit the new thing, the HTMLManager already had the new sessions feature A under the name \'sessions\'. I decided to put B in ManagerServlet and HTMLManagerServlet under a consistent name, now using \'expire\' instead of \'sessions\'.\n\nWith your latest commit, \'sessions\' is back to the ManagerServlet, but it does B, whereas in HTMLManagerServlet it does A. This is correct with respect to backwards compatibility but a little confusing.\n', 'Rainer Jung', '2008-04-28 01:10:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2058, '44877', '1', 'This has been fixed in trunk and proposed for 6.0.x and 5.5.x.', 'Mark Thomas', '2008-04-27 10:24:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2059, '44877', '2', 'The patch has been applied to 6.0.x and will be included in 6.0.17 onwards.', 'Mark Thomas', '2008-05-01 13:45:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2060, '44877', '3', 'Another opps - still open for 5.5.x', 'Mark Thomas', '2008-05-16 10:57:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2061, '31257', '1', 'Thanks for submitting this enhancement.  I\'ve applied it to both the Tomcat 5.0 \nand 5.5 branches: it will be in 5.0.29 and 5.5.3.  However, this applies to the \nAnt/Javac compiler only, not to the JDT compiler, which is the default in \n5.5.3.  If you have an equivalent patch for the JDT compiler, please submit \nit.  Otherwise, I\'ll do some research to try to find the equivalent JDT \ncompiler option, but if you submit a patch it\'ll get done faster.', 'Yoav Shapira', '2004-09-21 19:47:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2062, '31257', '2', 'There is still a bug in this fixing.\nWhen the endorsed dir is like:\n   C: Program Files Java jdk1.5.0_11 jre lib endorsed\nthe space char in dir will cause a compile error. \'Files Java jdk1.5.0_11\n jre lib endorsed\' part will be treated as a new parameter of javac. Please use \nquotation marks to quotate each dir in the endorsed dir list.', 'Goldyard', '2007-11-24 10:08:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2063, '31257', '3', 'The quoting issue has been fixed in trunk and proposed for 5.5.x and 6.0.x', 'Mark Thomas', '2008-04-20 15:39:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2064, '31257', '4', 'This has been committed to 6.0.x and will be in 6.0.17 onwards.', 'Mark Thomas', '2008-05-01 10:49:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2065, '29936', '1', 'BTW: Java SDK is version 1.4.2_01', 'peter neville', '2004-07-06 15:21:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2066, '29936', '2', 'I am afraid if you want this resolved, you\'ll have to investigate this further.\nOne thing which really hurts your report is the fact that this would be a\nclassloader issue, and yet there is no relevant functional changes in the\nclassloader since 5.0.16.', 'Remy Maucherat', '2004-07-06 15:52:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2067, '29936', '3', 'Are you sure you haven\'t duplicated the tagdef in the JSP multiple times?\n\nFor example - this would cause an error:\n<%@ taglib uri=\' http://java.sun.com/jstl/core/c.tld \' prefix=\'c\' %>\n<%@ taglib uri=\' http://java.sun.com/jstl/core/c.tld \' prefix=\'c\' %>\n\nOr this:\n<%@ taglib uri=\' http://java.sun.com/jstl/core/c.tld \' prefix=\'c\' %>\n<%@include page=\'foo.jsp\'%> \n\nwhere foo.jsp also has:\n<%@ taglib uri=\' http://java.sun.com/jstl/core/c.tld \' prefix=\'c\' %>', 'Tim Funk', '2004-07-06 16:02:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2068, '29936', '4', 'Remy: You mention that there hasn;t been any classloader chnages since 5.0.16, \nbut to the best of my knowledge 5.0.16 did not store service provider details \nin the apache work/catalina/localhost/webapp/loader sub-directories.\nAre there any explanations on this available?\n\nTim:\n\nThe taglibs are declared as:\n\n<%@ taglib prefix=\'c\' uri=\' http://java.sun.com/jsp/jstl/core \' %>\n<%@ taglib prefix=\'fn\' uri=\' http://java.sun.com/jsp/jstl/functions \' %>\n<%@ taglib prefix=\'fmt\' uri=\' http://java.sun.com/jsp/jstl/fmt \' %>\n\nSo not multiple declarations - there ins aninclude but this doesn\'t use taglibs.\n\nThe problem is instantly resolved by removing saxon and crimson from the web-\napp lib.\n\n\nThanks for your help so far...', 'peter neville', '2004-07-07 07:57:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2069, '29936', '5', 'Also, I must set my web.xml for the web-app to :\n<?xml version=\'1.0\' encoding=\'ISO-8859-1\'?>\n<web-app xmlns=\' http://java.sun.com/xml/ns/j2ee \'\n    xmlns:xsi=\' http://www.w3.org/2001/XMLSchema-instance \'\n    xsi:schemaLocation=\' http://java.sun.com/xml/ns/j2ee  web-app_2_4.xsd\'\n    version=\'2.4\'>\n\ninstead of :\n\n<?xml version=\'1.0\' encoding=\'ISO-8859-1\'?>\n<!DOCTYPE web-app\n    PUBLIC \'-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\'\n    \' http://java.sun.com/dtd/web-app_2_3.dtd \'>\n<web-app>\n\n\nOtherwise tomcat gives errors when compiling the jsp indicating that it can\'t \nfind bean properties etc.', 'peter neville', '2004-07-07 08:20:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2070, '29936', '6', 'If you don\'t know what 5.0.16 has and what it does not have, I think you need to\ncheck the CVS history. I really cannot see anything I\'d like to test in this bug\nreport (except the usual: we don\'t support replacing the XML provider, except\nusing the JVM provided mechanism).', 'Remy Maucherat', '2004-07-07 14:49:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2071, '29936', '7', 'for what it\'s worth I\'m seeing the same thing with:\n\ntomcat 5.0.25\njstl 1.1\nj2dsk 1.4.2_05\nlinux\n\nfor a web app that has crimson in the WEB-INF/lib. Removing the JAR that\ncontains crimson fixes it. It\'s surprising to me that tomcat is using the parser\nit finds in the web app for web.xml and JSP compilation - not what I\'d expect\nand will probably trip other people up the same way.', 'Eliot Stock', '2004-07-13 17:19:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2072, '29936', '8', 'This issue is also prevalent in 5.5.x.  To reproduce, do the following:\n\n1) Remove all stock webapps that come with the standard installation.  This\nincludes the ones in server/webapps.  Remember to remove the configurations in\nconf/Catalina.\n2) Add a webapp that has a saxon parser located in WEB-INF/lib.  For instance,\none from sourceforge.\n3) Start Tomcat.  You should a stack trace similar to this:\n\nJun 7, 2007 11:33:29 AM org.apache.commons.digester.Digester getParser\nSEVERE: Digester.getParser: \njavax.xml.parsers.ParserConfigurationException: AElfred parser is namespace-aware\n	at\ncom.icl.saxon.aelfred.SAXParserFactoryImpl.newSAXParser(SAXParserFactoryImpl.java:37)\n	at org.apache.commons.digester.Digester.getParser(Digester.java:686)\n	at org.apache.commons.digester.Digester.getXMLReader(Digester.java:902)\n	at org.apache.commons.digester.Digester.parse(Digester.java:1548)\n	at org.apache.catalina.startup.ContextConfig.defaultConfig(ContextConfig.java:515)\n	at org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:623)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:216)\n	at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:4290)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:823)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:807)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:595)\n	at\norg.apache.catalina.core.StandardHostDeployer.install(StandardHostDeployer.java:277)\n	at org.apache.catalina.core.StandardHost.install(StandardHost.java:832)\n	at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:625)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:431)\n	at org.apache.catalina.startup.HostConfig.start(HostConfig.java:983)\n	at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:349)\n	at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1091)\n	at org.apache.catalina.core.StandardHost.start(StandardHost.java:789)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1083)\n	at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:478)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:480)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:2313)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:556)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:287)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:425)\nJun 7, 2007 11:33:29 AM org.apache.catalina.startup.ContextConfig defaultConfig\nSEVERE: Parse error in default web.xml\njava.lang.NullPointerException\n	at org.apache.commons.digester.Digester.getXMLReader(Digester.java:902)\n	at org.apache.commons.digester.Digester.parse(Digester.java:1548)\n	at org.apache.catalina.startup.ContextConfig.defaultConfig(ContextConfig.java:515)\n	at org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:623)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:216)\n	at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:4290)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:823)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:807)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:595)\n	at\norg.apache.catalina.core.StandardHostDeployer.install(StandardHostDeployer.java:277)\n	at org.apache.catalina.core.StandardHost.install(StandardHost.java:832)\n	at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:625)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:431)\n	at org.apache.catalina.startup.HostConfig.start(HostConfig.java:983)\n	at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:349)\n	at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1091)\n	at org.apache.catalina.core.StandardHost.start(StandardHost.java:789)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1083)\n	at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:478)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:480)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:2313)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:556)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:287)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:425)\n\nI believe the issue here is that when the Digester to parse web.xml is set in\nContextConfig, the path to WEB-INF/lib is established for the WebappClassloader.\n When the SAXParserFactory is created with newInstance() within the call to\nDigester.getParser(), the rules dictate that it will search thirdmost for a file\nMETA-INF/services/javax.xml.parsers.SAXParserFactory in jars available, and it\nwill find it in saxon.jar, prior to defaulting to a platform default parser. \nThis webapp parser is now used for parsing the web.xml file, but since this task\nis the container\'s responsibility, it should not be used.  As a note, this\nparticular parser needs to be namespace-aware and the setting of it being not\nnamespace-aware throws this exception.\n\nA possible solution is to load the (default) parser into the Digester prior to\nhaving it being loaded by the WebappClassloader.  Since this appears to be\none-time settable, it will use this parser regardless of what the webapp has.', 'Eddy Chan', '2007-06-07 12:15:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2073, '29936', '9', 'Eddy, which particular sourceforge webapp did you use to test this?', 'Ryan Sweet', '2007-08-02 11:08:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2074, '29936', '10', 'The webapp was one of my own, but you just need a bare one, I believe.  It\ncontained a saxon parser from Sourceforge, which overrides the default parser.', 'Eddy Chan', '2007-08-07 14:10:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2075, '29936', '11', 'This works for me, at least I can\'t reproduce by following the steps provided\nhere, with the latest source from svn.\n\nPlease test this with the latest 5.5.x release. If you still see the issue,\nplease provide the simplest possible WAR that reproduces the issue on a clean\nTomcat install along with any additional configuration steps that may be required.', 'Mark Thomas', '2007-09-03 17:50:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2076, '29936', '12', 'Created  attachment 20889   [details] \nWAR causing problem for container', 'Eddy Chan', '2007-09-26 13:54:44 UTC', 'tomcat_attachment/attachment 20889');
INSERT INTO `tomcatbeforefixcomments` VALUES (2077, '29936', '13', 'I\'ve attached a small problematic WAR that just contains a blank web.xml along\nwith a saxon.jar in the WEB-INF/lib.  Remember that you need to remove ALL the\napps that come with Tomcat (rm -fr webapps/*) as well as the configs (rm -fr\nconf/Catalina).\n', 'Eddy Chan', '2007-09-26 13:56:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2078, '29936', '14', 'I can replicate this issue with the provided war on 5.5.x. It seems odd that\nthis only occurs with the conf/Catalina and other webapps missing.', 'John Kew', '2007-10-02 14:52:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2079, '29936', '15', 'The root cause of this issue is the ContextConfig class creating the parser for web.xml whilst it is using the webapp\'s classloader. This causes a problem if the app being processed includes an xml parser.\n\nI have committed a fix to trunk and will propose it for 6.0.x and 5.5.x.', 'Mark Thomas', '2008-04-20 13:46:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2080, '29936', '16', '***  Bug 43444  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2008-04-25 12:18:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2081, '29936', '17', 'This has been committed to 6.0.x and will be in 6.0.17 onwards.', 'Mark Thomas', '2008-05-01 10:43:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2082, '44562', '1', 'Thanks for the patch. It has been applied to trunk and proposed for 6.0.x (and 5.5.x and 4.1.x)', 'Mark Thomas', '2008-03-09 10:25:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2083, '44562', '2', 'This is fixed in 6.0.x and will be in 6.0.17 onwards.', 'Mark Thomas', '2008-03-19 16:16:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2084, '44562', '3', '***  Bug 44829  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2008-04-16 00:18:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2085, '44562', '4', 'Still open for 5.5.x', 'Mark Thomas', '2008-05-16 11:00:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2086, '43701', '1', 'One more important thing I missed out .\nThe condition when this bug is comming is if there is any preexisting connection\nwhich is trying to connect to the server but server is down and when I start it\nagain it will give this error.', 'prabhat', '2007-10-26 03:47:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2087, '43701', '2', 'I\'ve stumbled upon this bug too.\nLooks like it is being caused by the race condition between the main thread and \nthe newly created acceptor thread. I\'m getting this error quite often on my \nCore 2 Duo/WinXP 32-bit/Java 6u02.\n\nI think that\'s what happens here:\n1) Acceptor thread is started at NioEndpoint:792;\n2) Main thread allocates the pollers array (initially filled with nulls) at \nNioEndpoint:796;\n3) Acceptor thread immediately catches an incoming connection and accesses the \nstill uninitialized pollers array (inside the setSocketOptions method called at \nNioEndpoint:1169).\n\nSeems that poller threads should be created before starting acceptors; also, \npoller-related fields shall be marked volatile.', 'Pavel Zuev', '2007-10-30 14:22:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2088, '43701', '3', 'Http11AprProtocol has the same bug.', 'Pavel Zuev', '2007-10-30 14:29:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2089, '44268', '1', 'This is explicitly not allowed as a fix for\n http://issues.apache.org/bugzilla/show_bug.cgi?id=3770 \n\nThe change is here  http://svn.apache.org/viewvc?view=rev&revision=287588 \n\nThe problem is that it is hard to distinguish between when multiple listeners is\na bug (ie 3770) and when it is intentional (this issue).\n\nThere are a few places where the spec could be read as only expecting one\ninstance of each listener class per webapp but it is far from clear.\n\nI am going to resolve this as WONTFIX since working around this issue is easier\nthan trying working around 3770.', 'Mark Thomas', '2008-01-18 12:11:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2090, '44268', '2', 'Thanks a lot for your fast reply.\n\nYes I already recognized the spec is not that clear on this issue.\nCould you at least print a warning log message if a listener is registered more\nthan once?\n', 'Stefan Fleiter', '2008-01-21 01:15:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2091, '44268', '3', 'A warning seems reasonable. Re-opening and changing this to an enhancement.\n\nI\'ve committed a fix to trunk and proposed it for 6.0.x. It probably won\'t make\nthe 6.0.16 release but should make the following one.', 'Mark Thomas', '2008-01-21 13:17:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2092, '44223', '1', 'Created  attachment 21383   [details] \nsimple fix', 'Ivan Todoroski', '2008-01-14 04:26:15 UTC', 'tomcat_attachment/attachment 21383.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2093, '44223', '2', 'Tomcat ignores any of the SSL configuration system properties.\n\nI was going to say it has always been this way, I didn\'t know why and if you\nprovided a patch that addressed all of them it would be considered.\n\nHowever, my brain is now in gear and the problem seems obvious. When using\nsystem properties for configuration then everything is fine until two components\nrequire conflicting settings. In a container environment this pretty much a\ngiven. We had a similar issue with logging which is why Remy wrote JULI.\n\nTherefore, I am marking this as a WONTFIX on the grounds I see it causing more\nproblems than it solves.', 'Mark Thomas', '2008-01-14 13:13:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2094, '44223', '3', '(In reply to  comment #2 )\n> Tomcat ignores any of the SSL configuration system properties.\n\nBut this statement is not true. Tomcat already consults the \n\'javax.net.ssl.trustStore\' and \'javax.net.ssl.trustStorePassword\' properties, \nonly it was ignoring the third one, \'javax.net.ssl.trustStoreType\'. I am not \nasking for a new feature here, this bug is about the inconsistent \nimplementation of an existing feature. Look at the \nJSSESocketFactory.getTrustStore() method to see what\'s going on.\n\n> I was going to say it has always been this way, I didn\'t know why and if you\n> provided a patch that addressed all of them it would be considered.\n\nWell this patch completes the addressing of all of them. Only 2 out of 3 trust \nstore related properties are being taken into account at the moment, and this \npatch adds support for the 3rd one. Either this inconsistency should be fixed, \nor else remove support for ALL trust store properties. The current situation is \ninconsistent and leads to maddening configuration issues (i.e. any reasonable \nperson would assume that since 2 trust store properties appear supported the \nthird one would be also, and then scratch their head when a non-descriptive \nJSSE exception hits them).\n\n> However, my brain is now in gear and the problem seems obvious. When using\n> system properties for configuration then everything is fine until two \ncomponents\n> require conflicting settings. In a container environment this pretty much a\n> given. We had a similar issue with logging which is why Remy wrote JULI.\n> \n> Therefore, I am marking this as a WONTFIX on the grounds I see it causing more\n> problems than it solves.\n\nWhile I agree with your reasoning about container environments, I disagree with \nthe WONTFIX assessment. Currently you have partial support for an arbitrary \nsubset of trust store properties, which is the worst of both worlds.  Either \nsupport all of them or none of them.\n', 'Ivan Todoroski', '2008-01-17 04:12:09 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2095, '44223', '4', 'Fair point. I didn\'t realise we were using the others. Still don\'t like it but\nthat is an issue for another time.\n\nPatch applied to trunk and proposed for 6.0.x.\n\nMany thanks.', 'Mark Thomas', '2008-01-18 13:00:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2096, '11117', '1', 'Assuming that there\'s indeed a bug, this will be triggered by how the client\ngenerates the chunks (I can translate by: thanks for attaching a test servlet,\nbut what I actually need is the client).', 'Remy Maucherat', '2002-07-24 08:02:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2097, '11117', '2', 'Ok.\nI originally found this bug when using a program based on slide\'s webdav client\nlibraries. It does not appear to be specific to this, though (i.e. I had no\ndifficulty triggering it in other ways). \nFollowing is a (very) minimal test program that seems to trigger this, at least\nin combination with the test servlet I gave previously (i.e. the output file\nfrom the servlet is NOT the same as the input file for the program here):\n\nimport java.net.*;\nimport java.io.*;\n\npublic class TestChunkedPut\n{\n    private static final String HOST = \'localhost\';\n    private static final int PORT = 8080;\n    private static final String PATH = \'/testcontext/test\';\n    private static final String FILE = \'/tmp/testfile\';\n\n    public static void main(String[] args) {\n        try {\n            Socket sock = new Socket(HOST, PORT);\n\n            OutputStream os = sock.getOutputStream();\n\n            os.write((\'PUT \'+PATH+\' HTTP/1.1 r n\').getBytes());\n            os.write((\'Host: \'+HOST+\':\'+PORT+\' r n\').getBytes());\n            os.write(\'Transfer-Encoding: chunked r n\'.getBytes());\n            os.write(\' r n\'.getBytes());\n\n            InputStream is = new FileInputStream(FILE);\n\n            byte buf[] = new byte[4096];\n            int bytes;\n\n            while((bytes = is.read(buf)) > 0) {\n                os.write((Integer.toString(bytes, 16) + \' r n\').getBytes());\n                os.write(buf, 0, bytes);\n                os.write(\' r n\'.getBytes());\n            }\n\n            os.write(\'0 r n r n\'.getBytes());\n\n            os.close();\n            sock.close();\n            is.close();\n        } catch(Exception e) {\n            e.printStackTrace();\n        }\n\n        System.out.println(\'Done n\');\n    }\n}\n', 'Michael Smith', '2002-07-26 00:33:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2098, '11117', '3', 'Problem diagnosed, patch attached.\nThe detailed cause:\n\nThis code sets a particular buffer in a ByteChunk, and sets a specific start/end\nto this buffer. This allows sharing of the buffers, rather than copying them\naround.\n\nIn this code, the buffer was set (in chunk - the output ByteChunk) as pointing\nto some part of the buffer in readChunk (the input ByteChunk), which is fine.\nHowever, in one particular code path, this was immediately followed by a call to\nparseCRLF() - which simply swallows a CRLF pair. In the very unfortunate event\n(which happened on sufficiently large inputs with some regularity) of this CRLF\nbeing over the end of the buffer, more content would need to be read in order to\ndo this. This refilled readChunk, but because this was shared with the (output)\nchunk, the output buffer was _also_ overwritten. Output is then corrupted.\n\nThis is fixed here by deferring the parseCRLF() until later (the next call to\ndoRead())\n\nThis fix is critical for PUT (and presumably things like POST, or anything else\nwith a request-body) to work reliably with chunked transfer-encoding. \n\nIndex: filters/ChunkedInputFilter.java\n===================================================================\nRCS file:\n/home/cvspublic/jakarta-tomcat-connectors/http11/src/java/org/apache/coyote/http11/filters/ChunkedInputFilter.java,v\nretrieving  revision 1 .5\ndiff -u -r1.5 ChunkedInputFilter.java\n--- filters/ChunkedInputFilter.java     20 Jun 2002 11:14:30 -0000      1.5\n+++ filters/ChunkedInputFilter.java     1 Aug 2002 07:13:44 -0000\n@@ -136,6 +136,12 @@\n      */\n     protected boolean endChunk = false;\n \n+    /**\n+     * Flag set to true if the next call to doRead() must parse a CRLF pair\n+     * before doing anything else.\n+     */\n+    protected boolean needCRLFParse = false;\n+\n \n     // ------------------------------------------------------------- Properties\n \n@@ -158,6 +164,11 @@\n         if (endChunk)\n             return -1;\n \n+        if(needCRLFParse) {\n+            needCRLFParse = false;\n+            parseCRLF();\n+        }\n+\n         if (remaining <= 0) {\n             if (!parseChunkHeader()) {\n                 throw new IOException(\'Invalid chunk\');\n@@ -184,7 +195,7 @@\n             chunk.setBytes(buf, pos, remaining);\n             pos = pos + remaining;\n             remaining = 0;\n-            parseCRLF();\n+            needCRLFParse = true;\n         }\n \n         return result;\n\n', 'Michael Smith', '2002-08-01 07:14:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2099, '11117', '4', 'Any chance of getting this fix committed? This is the only thing holding us from\nmoving to using 4.1.x (which we want to do for all the other nice things it\nadds), and this patch is straightforward and well tested.\n', 'Michael Smith', '2002-08-05 06:02:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2100, '11117', '5', 'Your patch has been applied.\n\nThanks much!', 'william.barker', '2002-08-08 02:56:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2101, '11117', '6', 'Oh dear. Turns out there\'s another very closely related case which can be\ntriggered (but on my development machine, it never is - others have reported\nthis to me) in very rare circumstances. I changed the logic to compute the\nlength of the chunk as we read the chunk header, rather than first determining\nthe chunk header length, then computing it after the entire header has been\nread. This is neccesary because it\'s possible (if unlikely - so it gets\ntriggered rarely) for the buffer to be re-filled (with new data) in between\nthis, so the length computation fails.\n\nHere\'s the patch:\n\nIndex: src/java/org/apache/coyote/http11/filters/ChunkedInputFilter.java\n===================================================================\nRCS file:\n/home/cvspublic/jakarta-tomcat-connectors/http11/src/java/org/apache/coyote/http11/filters/ChunkedInputFilter.java,v\nretrieving  revision 1 .6\ndiff -u -r1.6 ChunkedInputFilter.java\n--- src/java/org/apache/coyote/http11/filters/ChunkedInputFilter.java   8 Aug\n2002 02:55:35 -0000       1.6\n+++ src/java/org/apache/coyote/http11/filters/ChunkedInputFilter.java   12 Aug\n2002 03:12:24 -0000\n@@ -283,8 +283,6 @@\n \n         int result = 0;\n         boolean eol = false;\n-        int begin = pos;\n-        int end = begin;\n         boolean readDigit = false;\n \n         while (!eol) {\n@@ -299,11 +297,9 @@\n                 eol = true;\n             } else {\n                 if (HexUtils.DEC[buf[pos]] != -1) {\n-                    if (!readDigit) {\n-                        readDigit = true;\n-                        begin = pos;\n-                    }\n-                    end = pos;\n+                    readDigit = true;\n+                    result *=16;\n+                    result += HexUtils.DEC[buf[pos]];\n                 }\n             }\n \n@@ -313,15 +309,6 @@\n \n         if (!readDigit)\n             return false;\n-\n-        int offset = 1;\n-        for (int i = end; i >= begin; i--) {\n-            int val = HexUtils.DEC[buf[i]];\n-            if (val == -1)\n-                return false;\n-            result = result + val * offset;\n-            offset = offset * 16;\n-        }\n \n         if (result == 0)\n             endChunk = true;\n', 'Michael Smith', '2002-08-12 07:34:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2102, '11117', '7', 'I don\'t see any reason not to compute the chunk length on the fly, and that \nmakes the algorithm simpler. Sorry for not doing that in the first place ... \nBill, can you apply the patch if it looks good to you ? (I would only be able \nto commit it tomorrow)', 'Remy Maucherat', '2002-08-12 11:02:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2103, '43285', '1', 'Created  attachment 20757   [details] \nSample web application reproducing the error', 'Bernhard Huemer', '2007-09-02 13:19:01 UTC', 'tomcat_attachment/attachment 20757.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (2104, '43285', '2', 'Created  attachment 20759   [details] \nProposed patch', 'Bernhard Huemer', '2007-09-02 13:20:34 UTC', 'tomcat_attachment/attachment 20759.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2105, '43285', '3', 'patch applied to trunk\nvote in place on 6.0.x HEAD\n', 'Tim Funk', '2007-12-26 18:13:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2106, '43285', '4', 'This has been committed to 6.0.x and will be included in 6.0.16 onwards.\n\nThanks for the patch.', 'Mark Thomas', '2007-12-30 14:11:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2107, '43285', '5', 'This introduced a new bug now. In 6.0.14, when you have a selecItem whose empty\nvalue is selected (value=\'\'), and the binding datatype was Long, EL evaluation\nwould set it to NULL. Now, its setting it to 0. ', 'Subba Ayyagari', '2008-02-19 15:38:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2108, '43285', '6', 'To add to my comment above: \n\nHere is my bean:\nMyBean { \n   private Long number; \n   ...//getter \n   .. //setter \n   .. // other methods\n}\n\nHere is my JSP (JSF Page rather):\n<h:selectOneMenu\n    value=\'#{myBean.number}\'\n    required=\'false\'\n    converterMessage=\'Number value is invalid\'>\n    <f:selectItems value=\'#{myBean.allNumbers}\'/>\n</h:selectOneMenu>\n\nmyBean.allNumbers is implemented as follows:\n\npublic List<SelectItem> getAllNumbers() {\n   List<SelectItem> list = new ArrayList<SelectItem>(0);\n   list.add(new SelectItem(\'\', \'--SELECT--\'));   // NOTE: this causes the issue\n   list.add(new SelectItem(\'1\', \'ONE\'));\n   list.add(new SelectItem(\'2\', \'TWO\'));\n   list.add(new SelectItem(\'1\', \'THREE\'));\n   return list;\n}\n\nNow, when i don\'t select a value (ie., leave the drop down on --SELECT--) for\nthe Number and submit the form, Tomcat 6.0.16 would set the myBean.number to 0.\nUntil Tomcat 6.0.14, the value is NULL.\n\nWhy is this important? It ends up putting 0\'s in the database instead of NULL\'s.\n\nThanks', 'Subba Ayyagari', '2008-02-19 15:48:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2109, '43285', '7', 'Note that the Expression Language specification requires this behaviour, see \'1.2.1.1 Eval-expressions as value expressions\': \'In the case of lvalues [...] the provided value is coerced to the actual type of the property the expression points to, before that property is set.\' Furthermore, according to the coercion rules defined in the section \'1.18.3 Coerce A to Number type N\' the Expression Language implementation has to coerce both null and \'\' to 0. \nAs you can see, this behaviour is not only what one would expect but also what the specification requires.', 'Bernhard Huemer', '2008-03-23 13:05:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2110, '43285', '8', 'Changing back to fixed based on previous comment.', 'Mark Thomas', '2008-04-09 15:37:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2111, '43285', '9', 'As far as this fix changes the behavior in a significant way it is a major change that will cause a lot of trouble.\n\nWith this fix it is not possible to deal with \'optional\' number fields. We don\'t no whether the user entered the value 0L or \'nothing\'. All of our SearchForms where we add restrictions for not-null fields are not working any more. To use bindings for such a simple thing is as nonpractical as using String for number fields. \n\nYou are right that your fix follows the JSP 2.1 specification. But even Sun\'s reference implementation allows null-values.\n\nTo enable Tomcat < 6.0.15 and JSF 1.2 Users to update to Tomcat > 6.0.16 I would recommend to make this behavoir configurable (e.g. with an context-param) or follow the RI and allow null-values.\n\nI will provided an other patch that solves Bernhards problem but is aware of null values. It assigns the value without coercion if it is assignable and uses coerceToType instead.\n', 'Nils Eckert', '2008-05-14 14:03:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2112, '43285', '10', 'Created  attachment 21962   [details] \nProposed patch taking care of primitive types\n\nThis patch extends the original AstValue.java with care about primitive types and not assignable values. It does not take care about the JSP 2.1 specification as far as it makes Objects nullable. It follows Suns RI EL-Implementation.', 'Nils Eckert', '2008-05-14 14:07:42 UTC', 'tomcat_attachment/attachment 21962.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2113, '43285', '11', 'That the RI has a bug and is not spec compliant is not a justification for deliberately inserting the same bug in Tomcat. That said, I am not against an enhancement that makes this configurable.\n\nJasper can\'t get at the Tomcat context configuration without making Jasper dependant on Tomcat internals, something we try not do to. To be consistent with similar configuration options it could be done with a system property (see  http://svn.apache.org/repos/asf/tomcat/trunk/webapps/docs/config/systemprops.xml  for examples). The code would need to ensure that setting org.apache.catalina.STRICT_SERVLET_COMPLIANCE overrides the new setting that allows nulls.', 'Mark Thomas', '2008-05-17 10:48:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2114, '43285', '12', 'Created  attachment 21981   [details] \nProposed patch taking care of primitive types (configurable)\n\nConfigurable with VM-parameter \'org.apache.catalina.STRICT_JSP_COMPLIANCE\'', 'Nils Eckert', '2008-05-19 04:11:14 UTC', 'tomcat_attachment/attachment 21981.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2115, '43285', '13', 'Created  attachment 21982   [details] \nProposed patch taking care of primitive types (configurable)\n\nI renamed the parameter to \'org.apache.catalina.STRICT_JSP_COMPLIANCE\' and had forgotten to refactor the corresponding  field-name. Please feel free to rename this field / parameter if needed.', 'Nils Eckert', '2008-05-19 04:23:09 UTC', 'tomcat_attachment/attachment 21982.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2116, '43285', '14', '***  Bug 45040  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2008-05-19 11:49:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2117, '43285', '15', 'Created  attachment 22028   [details] \nProposed patch taking care of primitive types (configurable)\n\nFixing NullpointerException in isAssignable when assigning values to a Map (targetClass is null then).', 'Nils Eckert', '2008-05-29 02:28:09 UTC', 'tomcat_attachment/attachment 22028.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2118, '43285', '16', 'I have applied your patch to make this optional to trunk and proposed it for 6.0.x', 'Mark Thomas', '2008-06-09 09:45:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2119, '42503', '1', 'Created  attachment 20263   [details] \nData file for the test case\n\nPut test.txt in the ROOT web app', 'Arvind Srinivasan', '2007-05-23 16:53:36 UTC', 'tomcat_attachment/attachment 20263.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2120, '42503', '2', 'Created  attachment 20264   [details] \nTest case\n\nPut test.jsp in the ROOT web app.', 'Arvind Srinivasan', '2007-05-23 16:54:14 UTC', 'tomcat_attachment/attachment 20264.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2121, '42503', '3', 'Created  attachment 20265   [details] \nPatch that updates the last modified time of the file when it is inserted into the cache\n\nThe problem occurs because the last modified timestamp in the\nFileResourceAttribute of CacheEntry isn\'t updated at the time the CacheEntry is\nfirst inserted into the cache. The timestamp gets updated when\nProxyDirContext.revalidate() is executed. The window between when the\nCacheEntry was inserted and when ProxyDirContext.revalidate() is called is\nwhere the problem occurs.\n\nThe attached patch fixes this by updating the last modified (and creation)\ntimestamp at the time the resource is created (i.e. inserted into the cache).', 'Arvind Srinivasan', '2007-05-23 17:00:19 UTC', 'tomcat_attachment/attachment 20265.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2122, '42503', '4', 'patch applied to trunk\npending vote for 6.0.x', 'Tim Funk', '2007-12-26 17:59:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2123, '43914', '1', 'Created  attachment 21160   [details] \nminimal webapp that demonstrates the problem', 'Ivan Todoroski', '2007-11-20 05:54:34 UTC', 'tomcat_attachment/attachment 21160');
INSERT INTO `tomcatbeforefixcomments` VALUES (2124, '43914', '2', 'Created  attachment 21161   [details] \nsimple fix\n\nI have no idea what the preferred internal Tomcat method for encoding URLs is,\nI just copied the URLEncoder stuff from DefaultServlet.', 'Ivan Todoroski', '2007-11-20 05:57:38 UTC', 'tomcat_attachment/attachment 21161.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2125, '43914', '3', 'I have been through RFC2616 and can\'t see anywhere that states that the location\nheader for a 302 must be encoded. Please provide reference(s) to the section(s)\nthat require this.', 'Mark Thomas', '2007-12-24 11:03:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2126, '43914', '4', 'Section 14.30 of RFC2616 specifies the Location header as:\n\n   Location       = \'Location\' \':\' absoluteURI\n\nThen, in section 3.2.1 it specifies the definition of absoluteURI:\n\n   For definitive information on\n   URL syntax and semantics, see \'Uniform Resource Identifiers (URI):\n   Generic Syntax and Semantics,\' RFC 2396 [42] (which replaces RFCs\n   1738 [4] and RFC 1808 [11]). This specification adopts the\n   definitions of \'URI-reference\', \'absoluteURI\', \'relativeURI\', \'port\',\n   \'host\',\'abs_path\', \'rel_path\', and \'authority\' from that\n   specification.\n\nMoving on to RFC2396, in section 3 you can find the start of the absoluteURI \nBNF. If you follow the production you will eventually see that the basic \ncharacters of the individual path components come down to this:\n\n      pchar         = unreserved | escaped |\n                      \':\' | \'@\' | \'&\' | \'=\' | \'+\' | \'$\' | \',\'\n\nBasically, the above says it can only contain unreserved characters and the \ncharacters explicitly specified, all the rest must be escaped.\n\nLook into sections 2.3 and 2.4.1 for the exact definitions of \'unreserved\' and \n\'escaped\', and you will see that none of them include the space character, \nwhich means \'pchar\' doesn\'t include it, which in turn means \'absoluteURI\' \ndoesn\'t include it, which means eventually that the Location header can\'t \ninclude it either. Same goes for many other special characters not explicitly \ncovered by \'pchar\', not just space.\n', 'Ivan Todoroski', '2007-12-25 21:23:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2127, '43914', '5', 'Thanks for the pointer. That makes perfect sense.\n\nI have applied your patch to trunk and proposed it for 6.0.x and 5.5.x', 'Mark Thomas', '2007-12-26 13:25:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2128, '43914', '6', 'Fixed in Tomcat 6.0.x.', 'Mark Thomas', '2007-12-28 13:08:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2129, '44084', '1', 'Created  attachment 21278   [details] \npatch to fix useContextClassLoader for JAASRealm', 'Noah Levitt', '2007-12-15 14:28:19 UTC', 'tomcat_attachment/attachment 21278.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2130, '44084', '2', 'Created  attachment 21279   [details] \nbetter patch\n\nMade a mistake about the second thing. Actually the only problem with the\nLoginContext stuff is that the logic was backwards. This patch is better.', 'Noah Levitt', '2007-12-15 14:34:57 UTC', 'tomcat_attachment/attachment 21279.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2131, '44084', '3', 'AFAIK this issue was caused by the patch applied for  bug 40150 .\nI reopened it because it really is a show stopper for us and blocks deploying\nour Jetspeed portal on Tomcat 5.5.25, and also on Tomcat 6 likewise.\nI think your patch can and need also be back ported to Tomcat 5.5', 'Ate Douma', '2007-12-18 02:42:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2132, '44084', '4', '***  Bug 43392  has been marked as a duplicate of this bug. ***', 'David', '2007-12-20 19:22:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2133, '44084', '5', 'Fixed in trunk and proposed for the next releases of 5.5.x and 6.0.x', 'Mark Thomas', '2007-12-23 13:58:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2134, '44084', '6', '(In reply to  comment #5 )\n> Fixed in trunk and proposed for the next releases of 5.5.x and 6.0.x\n\nThe proposal now has enough votes, so this issue will be fixed in Tomcat 6.0.15.', 'Yoav Shapira', '2007-12-27 14:28:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2135, '44084', '7', 'This has been fixed in svn and will be included in 6.0.16 onwards.', 'Mark Thomas', '2007-12-28 13:32:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2136, '43236', '1', 'This has been fixed in trunk and proposed for back port to 5.5.x and 6.0.x', 'Mark Thomas', '2007-12-18 15:48:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2137, '43236', '2', '***  Bug 37072  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2007-12-18 15:50:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2138, '43236', '3', 'Fixed in 6.0.x', 'Mark Thomas', '2007-12-23 12:16:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2139, '43241', '1', 'Created  attachment 20919   [details] \ntest war\n\nAdding test war.', 'John Kew', '2007-10-04 15:32:40 UTC', 'tomcat_attachment/attachment 20919');
INSERT INTO `tomcatbeforefixcomments` VALUES (2140, '43241', '2', 'Created  attachment 20920   [details] \none way of fixing this\n\nHere\'s a simple patch which \'fixes\' the problem. getResourceAsStream can not\nthrow an Exception (according to the spec), so I just return null. \n\nI\'m ambivalent about this patch. This may create problems for some people who\ndepend on the incorrect usage of this function. Plus, there may be a better\nsolution, such as always returning an input stream containing \'42\'', 'John Kew', '2007-10-04 15:36:32 UTC', 'tomcat_attachment/attachment 20920.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2141, '43241', '3', 'Whilst I like the \'42\' idea, I am fairly sure not everyone else shares my sense\nof humour so null it will have to be.\n\nPatch applied to trunk and proposed for 5.5.x and 6.0.x.\n\nMany thanks for the patch.', 'Mark Thomas', '2007-12-18 15:12:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2142, '43241', '4', 'Fixed in 6.0.x', 'Mark Thomas', '2007-12-23 12:09:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2143, '43241', '5', 'Fixed in 5.5.x and will be included in 5.5.26 onwards.', 'Mark Thomas', '2008-01-06 15:16:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2144, '43622', '1', 'Created  attachment 20977   [details] \nTest cases with different connector settings\n\nThese test cases can prove that either the documentation or the code needs to\nbe changed regarding the compression size settings', 'redeemer', '2007-10-15 03:55:31 UTC', 'tomcat_attachment/attachment 20977.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2145, '43622', '2', 'There is a mistake with the attribute name, it is compressionMinSize, not\nminCompressionSize\n\n(In reply to  comment #0 )\n> 2 of the compression related attributes for the http connector are:\n> \n> compression = on | off | force | <integer val>\n> The documentation states that integer val will be implemented as:\n> compression=\'on\' and minCompressionSize = <integer val>\n> \n> minCompressionSize = <integer val>\n> (The documentation for 5.5.12 doesnt mention this at all, but read this in the\n> server.xml)\n> \n> The problem is that the documenation gives the impression that only setting\n> compression=\'some integer val\' is sufficient, however the way the code is\n> written, the value of \'minCompressionSize\' always overrides the value specified\n> in the \'compression\' field. Even if minCompressionSize isnt set, it will still\n> get the default value of 2048 and override whatever value was there in the\n> \'compression\' field.\n> \n> I looked at the implementation of the http11 connector and found the following\n> code that might be the culprit:\n> \n> In org.apache.coyote.http11.Http11BaseProtocol.Http11ConnectionHandler.init\n>     processor.setCompression( proto.compression );\n>     processor.setCompressionMinSize( proto.compressionMinSize);\n> \n> since the \'setCompressionMinSize\' is called after compressionMinSize, its value\n> will override the value read from compression atttribute.\n> \n> \n> I have looked at the code for Tomcat 6.0 also, and the problems appears to still\n> be present.\n\n', 'redeemer', '2007-10-18 06:25:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2146, '43622', '3', 'Thanks for the report. This is fixed in trunk and proposed for 6.0.x and 5.5.x\n\n', 'Mark Thomas', '2007-11-30 11:17:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2147, '43757', '1', 'I am tempted to think that the source Tomcat is parsing isn\'t the source you\nthink it is. I can\'t reproduce the issue. Can you provide a simple JSP that\nexhibits this problem?', 'Mark Thomas', '2007-10-31 16:48:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2148, '43757', '2', '(In reply to  comment #1 )\n> I am tempted to think that the source Tomcat is parsing isn\'t the source you\n> think it is. I can\'t reproduce the issue. Can you provide a simple JSP that\n> exhibits this problem?\n\nGreetings Mark :)\n\nHere is a .jsp that should allow you to reproduce the issue:\n\n=========================\n\n<%@page contentType=\'text/html\'%>\n<%@page pageEncoding=\'UTF-8\'%>\n<%@page import=\'java.util.*\'%>\n<%@page import=\'javax.servlet.*\'%>\n<%\n\n\nServletContext context = this.getServletContext();\n\n\n\n// if (session.getAttribute(\'isAuth\') == null) {\n//     session.setAttribute(\'messageToUser\',\'Authentication failed.\');\n//        you.shouldNotParseThis();\n//     response.sendRedirect(\'./index.jsp\');\n// }\n\n// if (session.getAttribute(\'isAuth\') != null) {\n//     if (!session.getAttribute(\'isAuth\').toString().equals(\'true\')) {\n//        session.setAttribute(\'messageToUser\',\'Authentication failed.\');\n//         response.sendRedirect(\'./index.jsp\');\n//     }\n// }\n\nString state = \'\';\n\nif (request.getParameter(\'state\') != null) {\n    state = request.getParameter(\'state\');\n} else {\n    response.sendRedirect(\'./index.jsp\');\n}\n\n// each state is caught by name, final fall through goes back to index.jsp\nif (state.equals(\'CRInput\')) {\n    response.sendRedirect(\'./crinput.jsp\');\n} else {\n    response.sendRedirect(\'./index.jsp\');\n}\n\n\n%>\n\n==============================\n\nThere is actually a logical flaw with this (possible for two\nresponse.sendRedirect calls), and that is the root cause of the exception... my\nbad! But, the HTTP 500 response incorrectly points to the line number of the\nfirst occurrence of response.sendRedirect, whether it is commented out or not.\nThis makes debugging quite a pain.\n\nWith my recent discovery of the cause of the exception I feel that I set the\nseverity of this a bit high. I was not sure if it was my place to correct it, so\ndemote away if you\'d like.\n\nThank you for the swift response!', 'Charles Stahl', '2007-10-31 17:26:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2149, '43757', '3', 'Look at the generated java a little closer.\n\nYou\'ll notice after the commented code something like this: \nout.println(\' n\')\n\nBecause there is whitespace at the end of the file after the %>\n\nSo if one tried to write AFTER a redirect is done - you get an ISE.\n\nYou need\nif (someCondition) {\n  response.sendRedirect(\'./index.jsp\');\n  return;\n}\n', 'Tim Funk', '2007-10-31 17:32:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2150, '43757', '4', '(In reply to  comment #3 )\n> Look at the generated java a little closer.\n> You\'ll notice after the commented code something like this: \n> out.println(\' n\')\n> Because there is whitespace at the end of the file after the %>\n> So if one tried to write AFTER a redirect is done - you get an ISE.\n> You need\n> if (someCondition) {\n>   response.sendRedirect(\'./index.jsp\');\n>   return;\n> }\n\nYou are correct, and I noted the cause (a little less verbosely) in my reply \nto Mark Thomas\' response. However, the error generated does not properly \nindicate the line number that generated the error. That is what I\'m driving at.', 'Charles Stahl', '2007-10-31 19:02:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2151, '43757', '5', 'Yep - looks like we aren\'t counting commented out lines correctly during\ngeneration. Thanks for the test case - I\'ll take a look.\n\nUpdating properties accordingly.', 'Mark Thomas', '2007-10-31 20:52:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2152, '43757', '6', 'On inspection this wasn\'t an SMAP problem with comments but an issue with how we\nwere finding the right JSP line given the Java line.\n\nI have fixed it in trunk and proposed it for backport to 6.0.x and 5.5.x', 'Mark Thomas', '2007-11-29 14:34:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2153, '43893', '1', 'Created  attachment 21143   [details] \nminimal webapp demonstrating the bug', 'Ivan Todoroski', '2007-11-18 00:05:40 UTC', 'tomcat_attachment/attachment 21143');
INSERT INTO `tomcatbeforefixcomments` VALUES (2154, '43893', '2', 'Created  attachment 21144   [details] \nsimple patch that fixes the problem\n\nIt seems the call to request.getServletPath() is superfluous in this context,\nas the \'path\' variable already contains the path of the resource relative to\nthe servlet context path (i.e. it includes getServletPath() already), so simply\nomitting getServletPath() solves the issue.', 'Ivan Todoroski', '2007-11-18 00:08:20 UTC', 'tomcat_attachment/attachment 21144.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2155, '43893', '3', 'There are a few subtle differences if you map to \'/\' rather than \'/*\'. There\nmight other slight difference is you map to /edit/*. I\'ll work on getting these\nfixed.\n\nThe patch you suggests breaks the ability to have different urls for editing and\nviewing by mapping to /edit/* or similar.\n\nI am unable to reproduce the duplicate file name you show in your report. I\'m\nnot sure why. I also don\'t get the <getcontentlength>, <getcontenttype> and\n<getetag> tags. Could you confirm this result with your provided test case?\n\nThanks,\n\nMark', 'Mark Thomas', '2007-11-19 15:29:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2156, '43893', '4', 'Hello Mark, thanks for looking into this.\n\nYou are absolutely right, it does work fine when the servlet is mapped with /*, \nit only fails with / mapping. The reason I used / is because I do want the \nredirects to be generated, but I can use /* as a workaround for now, thanks!\n\nI\'m surprised though that you can\'t reproduce it with the / mapping. I can \nreliably reproduce it here every time, I just tried again to make sure, here is \na transcript of the steps:\n\n<unpack freshly downloaded apache-tomcat-6.0.14.tar.gz into c: apache-\ntomcat-6.0.14, and download webdav.war from this bug report to C: webdav.war>\n\nC: >set CATALINA_HOME=c: apache-tomcat-6.0.14\n\nC: >copy webdav.war %CATALINA_HOME% webapps\n        1 file(s) copied.\n\nC: >%CATALINA_HOME% bin catalina.bat start\nUsing CATALINA_BASE:   c: apache-tomcat-6.0.14\nUsing CATALINA_HOME:   c: apache-tomcat-6.0.14\nUsing CATALINA_TMPDIR: c: apache-tomcat-6.0.14 temp\nUsing JRE_HOME:        c: Java jdk-1.6.0\n\nC: >nc localhost 8080\nPROPFIND /webdav/file.txt HTTP/1.1\nContent-Type: text/xml; charset=utf-8\nUser-Agent: Jakarta Commons-HttpClient/3.0\nHost: localhost:8080\nDepth: 0\n\nHTTP/1.1 207 Multi-Status\nServer: Apache-Coyote/1.1\nContent-Type: text/xml;charset=UTF-8\nContent-Length: 732\nDate: Tue, 20 Nov 2007 07:45:33 GMT\n\n<?xml version=\'1.0\' encoding=\'utf-8\' ?>\n<multistatus xmlns=\'DAV:\'><response><href>/webdav/file.txt/file.txt</href>\n<propstat><prop><creationdate>2007-11-18T07:42:14Z</creationdate>\n<displayname><![CDATA[file.txt]]></displayname>\n<getlastmodified>Sun, 18 Nov 2007 07:42:14 GMT</getlastmodified>\n<getcontentlength>0</getcontentlength>\n<getcontenttype>text/plain</getcontenttype>\n<getetag>W/\'0-1195371734000\'</getetag>\n<resourcetype/><source></source>\n<supportedlock><lockentry><lockscope><exclusive/></lockscope><locktype><write/\n></locktype></lockentry><lockentry><lockscope><share\nd/></lockscope><locktype><write/></locktype></lockentry></supportedlock>\n</prop>\n<status>HTTP/1.1 200 OK</status>\n</propstat>\n</response>\n</multistatus>\n\n\nThat \'nc\' command above is netcat from Cygwin, which I have in the PATH.\n\nEven though the attached patch turned out to be too naive, it does show the \nexact line in the code where I observed the path duplication with a debugger, \nwhen WebdavServlet is mapped to / url prefix.\n', 'Ivan Todoroski', '2007-11-20 00:09:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2157, '43893', '5', '(In reply to  comment #3 )\n> The patch you suggests breaks the ability to have different urls for editing \nand\n> viewing by mapping to /edit/* or similar.\n\nFor what its worth, I\'ve since discovered that the patch also broke even basic \nfunctionality, like deleting files with the Microsoft Web Folders client, so it \nwas definitely wrong.\n', 'Ivan Todoroski', '2007-11-20 06:45:13 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2158, '43893', '6', 'How much of an issue is it if you have to map to \'/*\' rather than \'/\' ?\n\nThe way WebDAV is coded at the minute I can\'t see an easy to get it to work\ncorrectly with a mapping of \'/\'. I am tempted to just amend the docs accordingly. \n\nTo get the correct behaviour the servlet needs to know how it is mapped and\nthere is no easy way to get this. It is available in the Tomcat internals but I\nreally don\'t want to go down that road.', 'Mark Thomas', '2007-11-21 15:54:14 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2159, '43893', '7', 'Oh, not a big issue at all, don\'t bother with it if it\'s not trivial to fix, it \nnow works great for my purposes. The real issue I guess is that I didn\'t even \nknow it was supposed to be mapped to /*, I simply mapped it to / as usual for \nother servlets, so as you said it just needs to be documented better. Feel free \nto WONTFIX this bug.\n', 'Ivan Todoroski', '2007-11-21 23:34:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2160, '43356', '1', 'Oops pasted wrong exception. Here is the correct one:\n\n-----\n[] 2007-09-11 14:38:19,406 ERROR \norg.apache.catalina.startup.Catalina.load(520) | Catalina.start\nLifecycleException:  Protocol handler initialization failed: \njava.io.FileNotFoundException: conf dev.keystore (The system cannot find the \npath specified)\n        at \norg.apache.catalina.connector.Connector.initialize(Connector.java:1061)\n        at \norg.apache.catalina.core.StandardService.initialize(StandardService.java:677)\n        at \norg.apache.catalina.core.StandardServer.initialize(StandardServer.java:792)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:518)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:538)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at \nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at \nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:412)', 'Peter Lynch', '2007-09-11 20:42:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2161, '43356', '2', 'thanks for reporting it, I will get that taken care of', 'Filip Hanik', '2007-09-12 17:13:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2162, '43356', '3', 'see also  bug 27050  ', 'Ralf Hauser', '2008-05-11 06:19:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2163, '30949', '1', 'Ok. Since I don\'t want to use a finally for that (as the exception is rethrown \nin invoke), I think moving the unwrapping in the invoke method (before the \ncode which rethrows the exception) would be appropriate.', 'Remy Maucherat', '2004-08-31 00:29:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2164, '30949', '2', 'That seems like a reasonable solution.', 'Scott Goldstein', '2004-09-08 05:26:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2165, '30949', '3', 'OK, I\'ve moved the ApplicationDispatcher unwrap requests to the invoke method \nas Remy suggested.  Done on both the Tomcat 5.0 and 5.5 CVS branches.', 'Yoav Shapira', '2004-09-28 13:34:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2166, '30949', '4', 'I detect a similar problem with wrapped request at ApplicationDispatcher.forward und include.\nThe wrapped request are not recylced after an exceptions. Arrg!\n\n- With STRICT_SERVLET_COMPLAINS this means we have still a HTTPSession memory leak\n- and at cluster crossContext session replication are not triggered.\n\nCurrently the only chance I see, is a double try/catch implementation. Look at my checkin at tomcat \n5.5.24  revision  545127 .\n\nBut I don\'t really like the double try/catch for wrapped request!\n\nPeter', 'Peter Rossbach', '2007-06-07 02:36:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2167, '30949', '5', 'I\'m running into an issue that I think is a side effect of this patch. When\nforward() calls invoke() the request object now gets unwrapped. Then the forward\nmethod again tries to unwrap the already unwrapped request. As a result I am\ngetting a ClassCastException in unwrapRequest (ApplicationDispatcher.java:814).\nIt seems like unwrapRequest should be setting wrappedRequest to null before\nexiting so subsequent calls to the method don\'t do anything. Does this seem\nreasonable?', 'Mike Calmus', '2007-07-24 13:04:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2168, '30949', '6', 'Mike - having stepped through the code, I don\'t see the problem you are\ndescribing. If you still see the issue, please open a new Bugzilla item and\nprovide the steps to reproduce and/or a simple test war.', 'Mark Thomas', '2007-09-03 18:35:16 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2169, '42753', '1', 'available() does not make any socket access to see if bytes have arrived, so the\nscenario you describe cannot happen (if available returns 0, it will continue\nreturning 0 until the next read event). If the message you saw is logged,\nCometAdapter.event will return false, which will lead to closing the connection,\nnot causing a loop.\n\nMy only theory is that you\'re doing asynchronous reads, which is not allowed,\nand you\'ll need to look into this further.\n\nWhat does \'(no 6.0.13 available in the version field)\' mean ?', 'Remy Maucherat', '2007-06-27 11:00:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2170, '42753', '2', 'I have very explicit logging and I\'m 100% certain that I\'m not doing any async\nreads. In fact, from the log I sent to the user list before reporting this as a\nbug you can see that everything is happening in 1 thread, namely http-8080-exec-4:\n\n2007-06-26 14:37:08,427 DEBUG [http-8080-exec-4]\ncom.sebster.myservlet.TomcatCometServlet - BEGIN event for request\norg.apache.catalina.connector.RequestFacade@d47c99\n2007-06-26 14:37:08,427 DEBUG [http-8080-exec-4]\ncom.sebster.myservlet.TomcatCometServlet - 127.0.0.1:60578 POST /mycometservlet\n2007-06-26 14:37:08,432 DEBUG [http-8080-exec-4]\ncom.sebster.myservlet.TomcatCometServlet -\n[24224039-a37e-40d0-a076-89d1df363390] read loop in BEGIN event, input stream\ndata available: 1\n2007-06-26 14:37:08,438 DEBUG [http-8080-exec-4]\ncom.sebster.myservlet.TomcatCometServlet -\n[24224039-a37e-40d0-a076-89d1df363390] read loop done, input stream data\navailable: 0\n2007-06-26 2:37:08.MD org.apache.catalina.connector.CoyoteAdapter event\nSEVERE: The servlet did not read all available bytes during the processing of\nthe read event\n\nNote that I\'m not implying that available() does a socket access; what I saw was\nthat when the loop I described in the original post ended the condition\n\'available() == 0\' was true, and when it got to CatalinaAdapter the condition\nRequest.getAvailable() was true.\n\nFuthermore, I really am seeing the loop without the connection being closed,\nboth on the windows platform and on the Linux platform. I\'m happy to help debug\nthis further, but I\'m not making it up: I have a breakpoint in my\nCometProcessor.event() method, I see the Poller thread spin like crazy, and when\nI set a break point in the Poller the CPU load goes away. I can step through it\nand see that the connection stays open, it sets the event type to END on the\ncomet event, but it never reaches my CometProcessor.event() method.\n\nFinally, what I mean with \'no 6.0.13 available in the version field\' is the\ndropdown box in which to mark the Tomcat version in the bugzilla bug form. It\ngoes up to and including 6.0.11.\n\nRegards,\nSebastiaan\n', 'Sebastiaan van Erk', '2007-06-27 12:35:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2171, '42753', '3', 'Since you\'re apparently not willing to write things that make sense, I will\nignore your report.', 'Remy Maucherat', '2007-06-27 14:47:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2172, '42753', '4', '(In reply to  comment #3 )\n> Since you\'re apparently not willing to write things that make sense, I will\n> ignore your report.\n\nI am getting really exasperated by your replies. You give me no hint at what it\nis you want or what you think is not making sense. I will test your theory more\nby writing a wrapper around the input stream to log the thread of every read\nthat happens just to make sure tomorrow.\n\nIn either case, after I got the error the Poller went into a busy loop. I\'m not\nsmoking pot and I saw what I saw. Ok, maybe there\'s a bug somewhere in my code\nand I\'m doing something wrong, I certainly don\'t want to exclude that\npossibility. But I saw the Poller go into an infinite loop (not caused by the\nNIO bug I was talking about previously (which is Linux only)). It did NOT close\nthe channel. It did NOT call my event method with a READ, ERROR or END event\n(which I know because I have a log.debug on enter, AND a break point set). This\nhappened directly AFTER I got the SEVERE log message. I got this on Windows and\nLinux. Note that I\'m not theorizing now, these are the raw observations.', 'Sebastiaan van Erk', '2007-06-27 15:33:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2173, '42753', '5', 'If you follow the code logic, if the error happens, where available() returns >0\nafter a READ has been invoked, the connection is never marked as a comet, so you\nwill not get the ERROR/END events invoked. so the connection goes into the\npoller for the next request.\nCould you see if you can work up a reproducible scenario, and we can take it\nfrom there.\n\n', 'Filip Hanik', '2007-06-27 16:04:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2174, '42753', '6', '(In reply to  comment #5 )\n> If you follow the code logic, if the error happens, where available() returns >0\n> after a READ has been invoked, the connection is never marked as a comet, so you\n> will not get the ERROR/END events invoked. so the connection goes into the\n> poller for the next request.\n> Could you see if you can work up a reproducible scenario, and we can take it\n> from there.\n\nWhen I look in the code I see the following:\n\n                if (response.isClosed() || !request.isComet()) {\n                    res.action(ActionCode.ACTION_COMET_END, null);\n                } else if (!error && read && request.getAvailable()) {\n                    // If this was a read and not all bytes have been read, or\nif no data\n                    // was read from the connector, then it is an error\n                    error = true;\n                    log.error(sm.getString(\'coyoteAdapter.read\'));\n                }\n                return (!error);\n\nSo when you get the error, the condition response.isClosed() ||\n!request.isComet() must evaluate to false, which means that !response.isClosed()\n&& request.isComet(). So for me to get the error it seems the request must\nalready be marked as a comet request.\n\nI am not able to give you a small test case. The problem is that I have two\ndifferent products that start an embedded tomcat using exactly the same class,\nand in one it consistently works (no errors whatsoever), and in the other it\nconsistently fails. I have not seen this issue before (and I have already done a\nlot of testing in different situations), and I have no idea what the\nprecondition is for this issue to manifest itself.\n\nHowever, I added extra debugging information, and I did find something strange.\nI do the following logging FIRST thing in my Comet processor and I wrapped the\ninput stream to log which thread does the reading:\n\n  final EventType eventType = event.getEventType();\n  if (Debug.ENABLED && logger.isDebugEnabled()) {\n    try {\n      final Field field = request.getClass().getDeclaredField(\'request\');\n//$NON-NLS-1$\n      field.setAccessible(true);\n      final Request internalRequest = (Request) field.get(request);\n      logger.debug(\'{} event for request facade {}, request {}\', new Object[] {\neventType, request, internalRequest }); //$NON-NLS-1$\n    } catch (final Exception e) {\n      logger.debug(\'{} event for request facade {}\', eventType, request);\n//$NON-NLS-1$\n      logger.debug(\'failed to get request\', e); //$NON-NLS-1$\n    }\n  }\n\nI set a breakpoint in the CoyoteAdapter where it gives the SEVERE error, looked\nat the id of the request object, and checked my log what events I got for that\nobject.\n\nMy results where as follows:\n\n2007-06-28 11:16:00,021 DEBUG [http-8080-exec-4]\ncom.sebster.myservlet.MyCometServlet - BEGIN event for request facade\norg.apache.catalina.connector.RequestFacade@1dc696e, request\norg.apache.catalina.connector.Request@18dbef1\n\nThis was the ONLY line in the log with Request@18dbef1. All the reads in this\nBEGIN event happen on the http-8080-exec-4 thread. After returning from the read\n(due to available() == 0), it immediately stops in my breakpoint in\nCoyoteAdapter to log the SEVERE error. Note that I first set the break point to\nfind the id of the Request object to look for in the log.\n\nThe strange thing is, that the breakpoint happens in the http-8080-exec-5\nthread. The comet field in the Request@1dc696e object is set to true, and\nrequest.getAvailable() also returns true.\n\nThese are my observations so far. Note that I am no expert on Tomcat internals,\nbut I am very willing to spend time on this issue to resolve it, so any tips,\nsuggestions, questions, or assignments :-) are welcome!\n\nTo summarize:\n1) I get a BEGIN event for Request@1dc696e in http-8080-exec-4\n2) I read until available() == 0 in http-8080-exec-4\n3) I return from the event() method in http-8080-exec-4\n4) Tomcat logs a SEVERE error stating that I have not read all data\n     * The request object is Request@1dc696e\n     * request.isComet() == true\n     * request.getAvailable() == true\n     * the thread is http-8080-exec-5\n     * at this point there are zero log lines for thread http-8080-exec-5\n\nRegards,\nSebastiaan\n\n\n\n\n\n\n', 'Sebastiaan van Erk', '2007-06-28 02:47:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2175, '42753', '7', 'I did some additional debugging on the Poller loop that occurs after the SEVERE\nerror. This is what happens:\n\n1) the CoyoteAdapter.event() method gets called.\n2) request.read() returns false\n3) the condition status == SocketStatus.STOP evaluates to true\n4) the following statements are executed\n    request.getEvent().setEventType(CometEvent.EventType.END);\n    request.getEvent().setEventSubType(CometEvent.EventSubType.SERVER_SHUTDOWN);\n5) in the following statement getFirst() returns the \'basic\' field, a\nStandardEngineValve:\n    connector.getContainer().getPipeline().getFirst().event(request, response,\nrequest.getEvent());\n6) my CometProcessor.event() method is NOT called\n7) error = false, and the event() method returns true\n\nThis loop repeats ad infinitum, and consumes 100% CPU. Note that no code of my\nown is called in this sequence.\n\nRegards,\nSebastiaan\n', 'Sebastiaan van Erk', '2007-06-28 03:20:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2176, '42753', '8', 'I just wrote a simple test client that doesn\'t read the contents and I\nexperienced no loop. END nor ERROR got called, so there is a problem here, the\ncontainer should call one of those methods.\nare you able to test your solution against the latest\ntc6.0.x branch as well as the trunk branch?', 'Filip Hanik', '2007-06-28 11:34:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2177, '42753', '9', '(In reply to  comment #8 )\n> I just wrote a simple test client that doesn\'t read the contents and I\n> experienced no loop. END nor ERROR got called, so there is a problem here, the\n> container should call one of those methods.\n> are you able to test your solution against the latest\n> tc6.0.x branch as well as the trunk branch?\n\nA patch for the END/ERROR never being called has been submitted to both 6.0.x\nand trunk. This should at least give you a chance to cleanup, \n\nyour original problem of available()==0 but there yet being data, causing an\ninfinite loop is to me non reproducible.\n\nI\'ll wait for your feedback before marking this fixed.\n', 'Filip Hanik', '2007-06-28 11:46:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2178, '42753', '10', '(In reply to  comment #9 )\n\n> A patch for the END/ERROR never being called has been submitted to both 6.0.x\n> and trunk. This should at least give you a chance to cleanup, \n\nThanks :-), I will test this ASAP.\n\n> your original problem of available()==0 but there yet being data, causing an\n> infinite loop is to me non reproducible.\n\nThe main clue (as far as I can tell) of something going wrong is the fact that\nthe BEGIN event + read loop is in 1 thread, and the error in happens another\n(see the summary of  comment 6 ). Do you not agree that this should not happen? If\nyou agree that this is wrong (whatever the cause, Tomcat or my code), I can try\nand debug what causes this to happen.\n\nRegards,\nSebastiaan\n\n', 'Sebastiaan van Erk', '2007-06-28 12:11:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2179, '42753', '11', 'Once the socket goes back to the poller, and the poller dispatches it again,\nthen that can be on a different thread, as tomcat uses a thread pool, so there\nis no guarantee what thread the poller dispatches too', 'Filip Hanik', '2007-06-28 12:32:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2180, '42753', '12', '(In reply to  comment #11 )\n> Once the socket goes back to the poller, and the poller dispatches it again,\n> then that can be on a different thread, as tomcat uses a thread pool, so there\n> is no guarantee what thread the poller dispatches too\n\nYes I understand that, but for the specific Request object instance I get only 1\ncomet event, in thread http-8080-exec-4 and the check of Request.getAvailable()\nto see if I read everything happens in http-8080-exec-5 (with no other comet\nevents in between - I ONLY get the BEGIN event for this Request instance). Is\nthis not strange? Should the check not be performed in the same thread before\nthe socket goes back to the poller?', 'Sebastiaan van Erk', '2007-06-28 12:56:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2181, '42753', '13', 'not really, getAvailable() is only called if read() returned true.\nin your case, the following might happen\n1. HTTP request comes in, no body\n2. You get BEGIN event, no additional data on the socket\n3. read() returns false, so you dont get an immediate READ event,\n\n\n\n', 'Filip Hanik', '2007-06-28 13:37:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2182, '42753', '14', 'I have found the cause of the problem.\n\nThe code place where it goes wrong is ApplicationFilterFactory line 126:\n\n            Request req = (Request) request;\n            if (Globals.IS_SECURITY_ENABLED) {\n                // Security: Do not recycle\n                filterChain = new ApplicationFilterChain();\n            } else {\n                filterChain = (ApplicationFilterChain) req.getFilterChain();\n                if (filterChain == null) {\n                    filterChain = new ApplicationFilterChain();\n                    req.setFilterChain(filterChain);\n                }\n            }\n            comet = req.isComet();\n\nWhen a security manager is installed the filter chain is not set on the request.\n\nOn subsequent Comet events, since the filter chain is null, the event is not\nhandled properly and the poller goes into a busy loop.\n\n\n\n', 'Sebastiaan van Erk', '2007-06-29 03:13:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2183, '42753', '15', 'Excellent, we will fix this!', 'Filip Hanik', '2007-06-29 06:05:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2184, '42753', '16', 'The \'issue\' in this bug report is that the user claims that the value of\n\'available()\' randomly changes. This minor glitch is unrelated.', 'Remy Maucherat', '2007-06-29 06:10:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2185, '42753', '17', '(In reply to  comment #16 )\n> The \'issue\' in this bug report is that the user claims that the value of\n> \'available()\' randomly changes. This minor glitch is unrelated.\n\nThe issue was that Tomcat reported that I had not read all available bytes even\nthough I did. The reason turns out to be because Tomcat was not calling the\nevent method of my comet processor, which entails that indeed bytes were not\nbeing read.\n\nMy original issue is thereby resolved and the summary of this bug turns out to\nbe wrong. It just looked to me like there was a race condition, since I had a\nbreakpoint in event() and it was not being called anymore, so I thought\n(erroneously) that it was complaining at the end of the BEGIN event.\n\nSo, as far as I\'m concerned this issue can be closed. I don\'t care if you mark\nit INVALID if that\'s what you want because the summary turns out to be\nincorrect; that\'s fine by me.\n\nI\'m happy that the issue is resolved and the bug is fixed. :-)\n', 'Sebastiaan van Erk', '2007-06-29 06:25:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2186, '42753', '18', '(In reply to  comment #15 )\n> Excellent, we will fix this!\n\nThanks a lot. :-) Sorry for my initially incorrect analysis of the problem. I\nshould stick to reporting observed behavior instead of theorizing.\n', 'Sebastiaan van Erk', '2007-06-29 06:27:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2187, '42314', '1', 'Created  attachment 20085   [details] \nPatch for Jasper to output details of the compile error.', 'Suzuki Yuichiro', '2007-05-02 01:15:54 UTC', 'tomcat_attachment/attachment 20085.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2188, '42314', '2', 'The patch corrects Jasper to output error details.\nAnd it also fixes a bug that the InputStream was not closed.', 'Suzuki Yuichiro', '2007-05-02 01:30:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2189, '42314', '3', 'Created  attachment 20140   [details] \nfix previous patch\'s bug\n\nThe following problem of the previous patch were corrected:\nWhen the exception is generated when calling the jsp servlet after the\ncompilation of JSP succeeds, details (information of the JSP source) become\nnull.', 'Suzuki Yuichiro', '2007-05-07 05:32:51 UTC', 'tomcat_attachment/attachment 20140.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2190, '42314', '4', '***  Bug 42435  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2007-05-16 15:38:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2191, '42547', '1', 'More info on having duplicate names in the following scenarios\n\nweb.xml           context descriptor       winner\n------------      --------------------     ------------\nno entry          <Environment>            <Environment>\n<env-entry>       <Environment>            <env-entry>\n<env-entry>       no entry                 <env-entry>\nno entry          <ResourceLink>           <ResourceLink>\n<env-entry>       <ResourceLink>           blows up', 'John Hutchnson', '2007-05-30 11:36:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2192, '42547', '2', 'Created  attachment 20291   [details] \nDemonstrates the issue\n\nZip contains war and an external context descriptor. The configuration as it is\nwill genreate the issue. Assumes:\n\n- war is exploded to c:/dev/sandbox/tomcat_bug_test/exploded\n- The following is in <GlobalNamingResources> in conf/server.xml   \n<Environment name=\'testIt\'\n	     value=\'GlobalNamingResources\'\n	     type=\'java.lang.String\'/>\n\nThe war has only a web.xml and a jsp with a scriptlet to do a lookup on\njava:comp/env/testIt.', 'John Hutchnson', '2007-05-30 11:46:21 UTC', 'tomcat_attachment/attachment 20291.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (2193, '42547', '3', '(In reply to  comment #1 )\n> More info on having duplicate names in the following scenarios\n> \n> web.xml           context descriptor       winner\n> ------------      --------------------     ------------\n> no entry          <Environment>            <Environment>\n> <env-entry>       <Environment>            <env-entry>\n> <env-entry>       no entry                 <env-entry>\n> no entry          <ResourceLink>           <ResourceLink>\n> <env-entry>       <ResourceLink>           blows up\n\nThis needs to be updated slightly to take into account the override property of\nthe <Enviroment> tag in the context descriptor. \n\nweb.xml           context descriptor            winner\n------------      --------------------          ------------\nno entry          <Environment>                  <Environment>\n<env-entry>       <Environment>                  <env-entry>     \n<env-entry>       <Environment override=\'true\'>  <env-entry>   (same as previous)\n<env-entry>       <Environment override=\'false\'> <Environment>\n<env-entry>       no entry                       <env-entry>\nno entry          <ResourceLink>                 <ResourceLink>\n<env-entry>       <ResourceLink>                 blows up', 'John Hutchnson', '2007-05-31 08:33:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2194, '42547', '4', 'This is related to a change made to fix the following bug:\n\n http://issues.apache.org/bugzilla/show_bug.cgi?id=29727 \n\nFirst, it appears that contrary to the documentation (located at\n http://tomcat.apache.org/tomcat-5.5-doc/config/globalresources.html#Enviroment%20Entries ),\nsetting the \'override\' attribute of a <Enviroment> tag inside\n<GlobalNameingResources> to \'true\' will never be (and perhaps never was) obeyed. \n\nAllowing <env-entry> overrides of global <Enviroment> entries (through\n<ResourceLinks> in the context descriptor) may, it could be argued, be illegal\n(not the mention confusing). The current behavior, with the NPE, makes it\nillegal (intentional or not).\n\nHowever, it could also be argued that, with an external context descriptor, you\nshould be able to override anything set via <env-entry> in web.xml if you wanted\nto (and this is what the documentation seems to indicate). \n\nFinally, there\'s restoring the previous behavior, which never allows any\noverriding and always (silently) takes the global value, regardless of any\ncorresponding <env-entry>s or any reloading.\n\nEssentially, you can a) make it work as described by the documentation, b) blow\nup, or c) silently take the global values on load (or reload) always. \n\nIf b, I recommend blowing up with something more descriptive than the NPE we\nhave now and changing the doco.\n\nIf c, you could just check if (in\norg.apache.catalina.deploy.NamingResources.java, line 188), findEnviroment()\nretuns null. If it does, log a warning and return. If not, do the getOverride()\nif. You should also update the doco in this case too.\n\n    if (entries.containsKey(environment.getName())) {\n	ContextEnvironment ce = findEnvironment(environment.getName());\n	if (ce == null) {\n	    // Log a warning: \n	    return;\n	}\n        if (findEnvironment(environment.getName()).getOverride()) {\n            removeEnvironment(environment.getName());\n        } else {\n            return;\n        }\n    }\n', 'John Hutchnson', '2007-05-31 09:12:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2195, '42497', '1', 'Created  attachment 20251   [details] \nRequest and response headers showing the problem\n\nI have attached a log file from Firefix LiveHTTPHeaders showing the problem.\nA static file is requested twice. The first response is a 200 with an ETag\nheader,\nthe second response is a 304 without an ETag header.', 'Len Popp', '2007-05-23 09:03:45 UTC', 'tomcat_attachment/attachment 20251.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2196, '42497', '2', 'I see how to fix this, but I\'m not set up to compile Tomcat so someone else will\nhave to make the change and test it.\n\nIn org.apache.catalina.servlets.DefaultServlet, the serveResource method sets an\nETag header when it serves a file with a 200 or 206 response. To get it to add\nthe ETag to 304 responses, this needs to be added:\n response.setHeader(\'ETag\', getETag(resourceAttributes));\nin two places where a a status of 304 (SC_NOT_MODIFIED) is set, in the methods\ncheckIfModifiedSince and checkIfNoneMatch.', 'Len Popp', '2007-06-01 07:43:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2197, '42497', '3', '(I\'ve changed the Component to \'Catalina\' because none of the more specific\nComponents seem appropriate. If that\'s wrong, please correct it.)', 'Len Popp', '2007-06-01 07:45:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2198, '42438', '1', 'FWIW, I have built my own custom jasper-compiler.jar with the two patches I\nmentioned, and it definitively solved my use case.', 'Brian Lenz', '2007-05-16 18:14:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2199, '42438', '2', 'I\'ve checked the Tomcat 5.5.23 code, and it looks like it exhibits the exact\nsame problem.  I believe that the two patches I listed would solve the problem\nin 5.5.23, as well.', 'Brian Lenz', '2007-05-18 08:49:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2200, '42438', '3', 'This works for me using the latest 5.5.x code either with Tomcat compiling on\nthe fly or using JspC.\n\nIf you still see this issue, please attach a test WAR file (including source)\nthat demonstrates this issue with a clean 5.5.23 installation.', 'Mark Thomas', '2007-05-19 10:29:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2201, '42438', '4', 'Created  attachment 20224   [details] \nTest case WAR\n\nHere is a test case exhibiting the bug.  You need to make sure that the\ntest.tag file is compiled as part of the test.jsp file compilation.  If\ntest.tag is compiled independently first, then the problem will not occur.  The\neasiest way to make sure this is the case is to just clean out your work\ndirectory before loading test.jsp.', 'Brian Lenz', '2007-05-21 08:17:07 UTC', 'tomcat_attachment/attachment 20224');
INSERT INTO `tomcatbeforefixcomments` VALUES (2202, '42438', '5', 'Is it possible you weren\'t using the If tag plugin I specified?  Or is it\npossible that you had precompiled the test.tag file?  The problem only occurs\nwhen you are compiling test.jsp, which in turn results in compilation of\ntest.tag and you are using the If tag plugin.  This is definitely still a bug in\nTomcat 5.5.23.\n\nNote that this is just one example exhibiting the problem.  There are a\nmultitude of other scenarios where this exact same problem can crop up (as it is\nhappening in our production JSP compilation).  I\'ve just simplified the code\ndown to a very easy to trace test case to show exactly where the problem is\nhappening.\n\nIf you have any further questions on how to reproduce the bug, let me know.', 'Brian Lenz', '2007-05-21 08:20:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2203, '42361', '1', 'Created  attachment 20152   [details] \nMultipart POST test case WAR\n\nTo reproduce the bug:\n- Browse to the data entry page, e.g.  http://localhost:8080/multipartposttest/ \n- Fill in some values (fields may be left blank, don\'t make file too big)\n- Press \'send this\' button to submit form\n- A redirect to the login page will occur.  Expects a user that has \'manager\'\nrole.\n- Results page shows some header values and request contents.  Note the content\ntype is \'application/x-www-form-urlencoded\' which is incorrect - should be\nmultipart/form-data encoding.  Everything else seems correct.\n- Go back to first data entry page using back button on browser and resubmit\nform.  Because already logged in you will go directly to results page.\n- Note content type is now correct, e.g. \'multipart/form-data;\nboundary=---------------------------187161971819895\'.', 'Peter Runge', '2007-05-08 16:17:52 UTC', 'tomcat_attachment/attachment 20152');
INSERT INTO `tomcatbeforefixcomments` VALUES (2204, '42361', '2', 'Created  attachment 20153   [details] \nPatch for org/apache/catalina/authenticator/FormAuthenticator.java', 'Peter Runge', '2007-05-08 16:22:20 UTC', 'tomcat_attachment/attachment 20153.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2205, '42361', '3', 'Created  attachment 20154   [details] \nPatch for org/apache/catalina/authenticator/SavedRequest.java', 'Peter Runge', '2007-05-08 16:23:19 UTC', 'tomcat_attachment/attachment 20154.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2206, '42361', '4', 'Looks like the cause could be due to\norg.apache.catalina.authenticator.FormAuthenticator class hardcoding the content\ntype when restoring POST requests:\n\nL431: contentType.setString(\'application/x-www-form-urlencoded\');\n\nCreated patch that saves the content type to the SavedRequest object and\nrestores it when needed.  This seems to fix the issue.', 'Peter Runge', '2007-05-08 16:28:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2207, '42202', '1', 'Created  attachment 20023   [details] \na patch that fixes this bug', 'Rodrigo Urubatan', '2007-04-23 14:08:36 UTC', 'tomcat_attachment/attachment 20023.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2208, '42202', '2', 'If you could explain how this patch is a good idea and solves something, I would\nbe interested :)', 'Remy Maucherat', '2007-04-23 14:22:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2209, '42202', '3', 'in the current code tomcat gets all the URLs from the URLClassloader, and call\nthe getFile() method to get the file name, after it creates a File object and\ngets the CanonicalName to create the final File object that will be used later ...\nbut the CanonicalName when it is running on windows and has spaces on the name,\nis some thing like:\nProgram%20Files/...\nwhen the file object is created, and the exists method is called it returns\nfalse because the File object does not know how to convert %20 to \' \' ...\nif you look at the code in the patch, instead of calling the getFile, creating a\nFile object, getCanonicalName, create another File object that does not know how\nto handle %20 ...\n\nI just take the original URL object, call the toURI method and pass it to the\napropriate File constructor that will handle the %20 correctly ...\n\nwith this patch it works fine, and loads the TLDs from the applications that are\nin directories with spaces in the names ...', 'Rodrigo Urubatan', '2007-04-23 15:43:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2210, '42202', '4', 'Ok, but your patch was not good (not all URLs are %xx encoded).', 'Remy Maucherat', '2007-04-24 06:42:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2211, '42202', '5', 'but the URI class understand all URI formats, being it %xx encoded or not ...', 'Rodrigo Urubatan', '2007-04-24 07:17:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2212, '42202', '6', 'How about stopping using \'...\' ?\nThe issue has been fixed in the 6 branch, but not using your patch.', 'Remy Maucherat', '2007-04-24 07:44:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2213, '42202', '7', 'Ok, I\'ll not use \'...\' \nthe fix is already in the trunk? I have just tested it and it still not working', 'Rodrigo Urubatan', '2007-04-24 08:02:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2214, '42202', '8', 'testes in tomcat 6 trunk and the bug still there.', 'Rodrigo Urubatan', '2007-04-25 07:37:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2215, '42071', '1', 'Created  attachment 19924   [details] \nAn IllegalStateException does not occurred with this patch.\n\nAn IllegalStateException does not occurred with this patch.', 'kawasima', '2007-04-08 18:01:24 UTC', 'tomcat_attachment/attachment 19924.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2216, '42071', '2', 'I don\'t see an ISE with the latest source from svn.\n\nIf you still see the ISE with the latest svn source, please re-open this issue\nand attach your JSP that shows the ISE.', 'Mark Thomas', '2007-04-14 17:45:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2217, '42071', '3', 'Created  attachment 19974   [details] \nreappearance jsp\n\nreappearance jsp', 'kawasima', '2007-04-17 00:40:41 UTC', 'tomcat_attachment/attachment 19974.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2218, '42071', '4', 'I see the ISE with the latest svn source.\n\nIt reappears in the following procedure.\n\nfirst request:\n/test.jsp?exp=true\n\nsecond request:\n/test.jsp?exp=true\n\n[JSP]\n<%@ page contentType=\'text/plain\' %>\n<%\n    String exp = request.getParameter(\'exp\');\n    if(\'true\'.equalsIgnoreCase(exp)) {\n        throw new UnavailableException(\'error!!!\');\n    }\n    System.out.println(\'done!\');\n%>\ndone!\n', 'kawasima', '2007-04-17 00:48:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2219, '42085', '1', 'java.util.logging.FileHandler extends java.util.logging.StreamHandler. The\nno-args constructors for these two classes both make a call to the configure()\nmethod, which is why you see two TivoliFormatters created when the tivoli\nhandler is set up. This shouldn\'t cause duplication, though; the first formatter\nto be created is simply discarded, and only the second is used.\n\nCould you give more information about your setup? I can\'t duplicate this\nproblem. Is that your entire logging.properties file? How does your code use the\nlogger?\n\nIf I put these lines into a test servlet:\n\n    Logger logger = Logger.getLogger(\'\');\n    logger.severe(\'Handlers: \' + Arrays.asList(logger.getHandlers()));\n\nand make a request to it (using your logging.properties file), the console shows\nthat the root logger has two handlers (both FileHandlers).\n', 'Richard Fearn', '2007-04-11 12:13:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2220, '42085', '2', 'More Infos:\n* The bug does not appear when all our classes are in the bootclasspath\n  (as we do for testing via eclipse)\n  but only when deployed as war/jar\n\n* We use a root context and deploy it as ROOT.war\n  (although this is not really documented as beeing supported this way)\n\n* The TivoliFormatter has only a default Constructor\n\nThe first usage that was duplicated works as follows:\n\npublic class ProductContextListener implements ServletContextListener {\n\n  private static Logger log = Logger.getLogger(ProductContextListener\n.class.getName());\n\n  ...\n  public void contextInitialized(ServletContextEvent anEvent) {\n    ...\n    log.info(\'Starting Product Version \' + version);\n    ...\n  }\n}\n\nOur global logging.properties is as follows:\n\n--------------%<---------------%<-----------------\nhandlers = 1catalina.java.util.logging.FileHandler\n\n# Handlers for the root logger\n.handlers = 1catalina.java.util.logging.FileHandler\n\n1catalina.java.util.logging.FileHandler.level = INFO\n1catalina.java.util.logging.FileHandler.pattern = /var/log/ucs/catalina%g.log\n# limit Output to 1MB\n1catalina.java.util.logging.FileHandler.limit=1048576\n# Limit rotation to 10 Logs ...\n1catalina.java.util.logging.FileHandler.count=10\n# 1catalina.java.util.logging.FileHandler.append=true\n1catalina.java.util.logging.FileHandler.formatter=java.util.logging.SimpleFormatter\n--------------%<---------------%<-----------------\n\nOur server XML is as follows:\n\n--------------%<---------------%<-----------------\n<Server port=\'8005\' shutdown=\'****\'>\n  <!-- server.xml for deployed tomcat 5 -->\n  <Service name=\'Product\'>\n 	<Connector port=\'8080\' \n		       maxKeepAliveRequests=\'100000\'\n               maxThreads=\'200\' minSpareThreads=\'20\' maxSpareThreads=\'100\'\n               enableLookups=\'false\'  acceptCount=\'20\' />\n    <Engine name=\'Product\' defaultHost=\'localhost\'>\n      <Host name=\'localhost\' appBase=\'webapps\' >\n        <Context path=\'\'\n                 cookies=\'false\'\n                 docBase=\'ROOT.war\'\n                 cachingAllowed=\'false\'\n                 processTlds=\'false\'\n                 unpackWAR=\'true\'\n                 reloadable=\'false\'>\n             <Manager pathname=\'\' />\n         </Context>\n      </Host>\n    </Engine>\n  </Service>\n</Server>\n\n--------------%<---------------%<-----------------\n\nHmm, perhaps the Problem happens when using a \nROOT <Context path=\'\' ../> only ?\n\nweb.xml was copied from tomcat 5.5.20\n\nWe use the following properties (in eclipse)\nto start tomcat. \n\n---------------%<-----------------%<-----------------------\n-Dcatalina.home=\'${TOMCAT5}\'\n-Dcatalina.base=\'${workspace_loc:de.customer.product}/ext/tomcat5\' \n-Djava.endorsed.dirs=\'${TOMCAT5}}/common/endorsed\'\n-Djava.io.tmpdir=\'${TOMCAT5}/temp\'\n-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager\n-Djava.util.logging.config.file=\'${workspace_loc:de.customer.product}/ext/tomcat5/conf/logging.properties\'\n---------------%<-----------------%<-----------------------\n\nOn linux we use a similar init.d script:\n\n---------------%<-----------------%<-----------------------\n\nOn linux we use a similar init.d script:\n\n#!/bin/sh\n#\n# Startup script for product UserConfigurationSystem\n# $Id: product,v 1.7 2007/04/10 08:53:50 kha Exp $\n#          \n# /etc/init.d/product\n#\n### BEGIN INIT INFO\n# Provides:          product\n# Required-Start:    mysql\n# Default-Start:     3 5\n# Default-Stop:      0 1 2 6\n# Short-Description: product - Our super duper product\n# Description:       A Small tomcat based web-app as XML-RPCProvider\n# 	against a fat MySQL Database\n### END INIT INFO\n# \n# Check for missing binaries (stale symlinks should not happen)\n# Note: Special treatment of stop for LSB conformance\nCATALINA_HOME=/opt/app/product/apache-tomcat\nCATALINA_BASE=/opt/app/product/service\nCATALINA_BIN=$CATALINA_HOME/bin/catalina.sh\ntest -x $FOO_BIN || { echo \'$CATALINA_BIN not installed\'; \n	if [ \'$1\' = \'stop\' ]; then exit 0;\n	else exit 5; fi; }\n\nJAVA_HOME=/usr/java/jdk1.5.0_11\nJRE_HOME=$JAVA_HOME/jre\nCATALINA_OPTS=\nUSER=product\nCATALINA_OPTS=-Dde.customer.product.confDir=/etc/product\nCATALINA_OPTS=\'$CATALINA_OPTS\n-Xbootclasspath/a:/opt/app/product/service/lib/product-tivoli.jar\'\n# CATALINA_OPTS=\'$CATALINA_OPTS -ea -esa -Xdebug\n-Xrunjdwp:transport=dt_socket,address=9099,server=y,suspend=n\'\nCATALINA_TMPDIR=/var/opt/app/product/tmp\n\nsu - $USER -c \'export JAVA_HOME=$JAVA_HOME; \n	       export JRE_HOME=$JRE_HOME; \n	       export CATALINA_OPTS=\'$CATALINA_OPTS\'; \n	       export JAVA_OPTS=\'$JAVA_OPTS\'; \n	       export CATALINA_HOME=$CATALINA_HOME; \n	       export CATALINA_BASE=$CATALINA_BASE; \n	       export CATALINA_TMPDIR=$CATALINA_TMPDIR; \n	       $CATALINA_HOME/bin/catalina.sh $1\'\n---------------%<-----------------%<-----------------------\n\nThats all I can give you so far, as we must \ndeliver the product next week ;-)\n\n\n\n\n\n    ', 'Klaus Halfmann', '2007-04-11 23:19:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2221, '42085', '3', 'The problem was trivial (handlers for the root logger are added twice if they\nare specified using .handlers). Workaround: remove .handlers (what\'s the purpose\nexactly if it\'s the same as handlers; of course, I suppose it has the same\npurpose as that Context element in the server.xml).', 'Remy Maucherat', '2007-04-12 08:38:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2222, '42085', '4', 'Thanks for the Workaround:\n\nAs I Understand it:\n\nhandlers - configures all availeable Handlers\n.handlers - are the Handlers for the root-logger\n\ne.g.\norg.apache.tomcat.handlers \n  - would be handlers for theses packages only\n\nFeels like the root context is silently used\nas parking area for the handlers ;-)\n\nThanks again', 'Klaus Halfmann', '2007-04-13 00:17:42 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2223, '41289', '1', 'I got the same problem,\nthen I submited in: \n http://issues.apache.org/bugzilla/show_bug.cgi?id=42041 \n\n', 'lizongbo', '2007-04-04 00:05:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2224, '41289', '2', 'Could reproduce the problem even with /tc6.0.x/trunk/ build. \n\nTried deploying \'sample.war\'\n( http://tomcat.apache.org/tomcat-6.0-doc/appdev/sample/sample.war ) through the\nManager web-application, by executing the following URL from Browser:\n\n http://localhost:8080/manager/deploy?path=/Shiva&config=file:/c:/tomcat/examples/myContext.xml \n\nwhere, \'c:/tomcat/examples/myContext.xml\' file contains the following contents:\n\n<?xml version=\'1.0\' encoding=\'UTF-8\'?>\n<Context path=\'/WebApplication1\' docBase=\'c: tomcat examples sample.war\' />\n\nDeploy failed with following return message:\n  FAIL - Failed to deploy application at context path /Shiva\n\nand log file shows:\nINFO: Manager: install: Installing context configuration at\n\'file:/c:/tomcat/examples/myContext.xml\'\njava.io.FileNotFoundException:\nC: tomcat trunk60 output build conf Catalina localhost Shiva.xml (The system\ncannot find the path specified)\n	at java.io.FileOutputStream.open(Native Method)\n	at java.io.FileOutputStream.<init>(FileOutputStream.java:179)\n	at java.io.FileOutputStream.<init>(FileOutputStream.java:131)\n	at\norg.apache.catalina.manager.ManagerServlet.copyInternal(ManagerServlet.java:1570)\n...\n\nCreated <conf-path> Catalina localhost manually and tried deploying again and it\nis successful this time.\n\nWill create a fix for this.', 'Shiva Kumar H R', '2007-04-05 05:45:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2225, '41289', '3', '***  Bug 42041  has been marked as a duplicate of this bug. ***', 'Shiva Kumar H R', '2007-04-05 05:57:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2226, '41289', '4', 'Created  attachment 19917   [details] \njust a single line of fix', 'Shiva Kumar H R', '2007-04-05 06:07:42 UTC', 'tomcat_attachment/attachment 19917.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2227, '40150', '1', 'Created  attachment 18668   [details] \nProposed fixed version of JAASRealm.\n\nThis version of JAASRealm validates the class names for setUserClassNames and\nsetRoleClassNames. It verifies if the class exists, and if it implements\njava.security.Principal. If not, it logs a message (severe), that allows users\nto detect the incorrect class name.\n\nIt might even be better if it threw an exception.\n\nI\'ve also restructured the code to parse the comma-delimited class name string,\nas it was rather inefficient. It uses a StringTokenizer now.', 'Tom', '2006-08-01 09:00:04 UTC', 'tomcat_attachment/attachment 18668');
INSERT INTO `tomcatbeforefixcomments` VALUES (2228, '40150', '2', 'Created  attachment 18669   [details] \nImproved version of the patch\n\nNo longer using StringTokenizer, but String.split, as StringTokenizer is\nconsidered legacy. Thanks to Sameer Acharya.', 'Tom', '2006-08-01 11:28:27 UTC', 'tomcat_attachment/attachment 18669');
INSERT INTO `tomcatbeforefixcomments` VALUES (2229, '40150', '3', 'This looks like a good idea to enhance.  However, please submit your patch in\ndiff  format rather than the whole file, that would make its review and\napplication much faster:  http://www.apache.org/dev/contributors.html#patches \nprovides more details.', 'Yoav Shapira', '2006-12-26 05:24:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2230, '40150', '4', 'Created  attachment 19306   [details] \nPatch of JAASRealm.java (in diff format)', 'Tom', '2006-12-27 00:54:31 UTC', 'tomcat_attachment/attachment 19306.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2231, '40150', '5', 'Tom, thanks for providing this patch in diff form.  I\'ve applied it to the\nTomcat 5.5 and 6.0 trunks, I really like it.  Sorry it took so long.', 'Yoav Shapira', '2007-03-25 14:42:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2232, '40150', '6', 'While this patch might have improved feedback when an incorrect classnames are\nprovided, it actually fully *breaks* JAASRealm usage when correct classnames are\nprovided but need to be accessed through a ContextClassLoader.\n\nWe at Apache Jetspeed-2 use the useContextClassLoader=true setting for hooking\nup our own custom Principal classes as these are provided through the portal\napplication itself, not from a common/shared classloader.\n\nBecause the new parseClassNames only does a simple Class.forName() check this\nnow fails to validate our classnames for Tomcat 5.5.24 and later and thereby\nbreaking our JAAS based security :(\n\nI suggest this to be solved by either:\n- reverting the patch\n- keep the current patch but *ignore* a ClassNotFoundException except for\nlogging that it happened\n- run this method in the appropriate ContextClassLoader for the web app if possible\n\nFYI: we have a Jetspeed JIRA issue opened on this bug with some additional\ninformation:  https://issues.apache.org/jira/browse/JS2-828 \n\nHopefully this issue can be resolved quickly as right now we cannot run Jetspeed\non Tomcat >= 5.5.24\n\nRegards, Ate', 'Ate Douma', '2007-12-13 06:13:55 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2233, '40150', '7', 'See  http://issues.apache.org/bugzilla/show_bug.cgi?id=44084  for the Tomcat 6\nversion of this issue.  This has been fixed in the Tomcat SVN trunk, and should\nbe integrated into the next 5.5 and 6 releases.\n\n', 'Yoav Shapira', '2007-12-27 14:33:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2234, '40820', '1', 'Created  attachment 19042   [details] \nThis zip file contains the WAR in the ELResolverTest dist directory; and the source and build scripts are provided as well.\n\nThis zip file contains the WAR in the ELResolverTest dist directory; and the\nsource and build scripts are provided as well.', 'Scott Johnson', '2006-10-26 07:54:16 UTC', 'tomcat_attachment/attachment 19042.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (2235, '40820', '2', 'This issue is impacting the JSF 1.2 RI as well.  We use the JspFactory when\ninitializing the runtime.  The first application that uses Faces will hit this\nissue, all other subsequent applications initialize fine.', 'Ryan Lubke', '2006-11-27 16:25:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2236, '40820', '3', 'Is this issue still valid? \n\nI cannot reproduce with the war file. I am guessing this was fixed w/out the bug\nbeing updated.', 'Tim Funk', '2007-01-02 07:34:12 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2237, '40820', '4', 'Tim, this does still appear to be a problem with the latest TC 6 code.  Let\'s\nmake sure we\'re on the same page:\n(1) Tomcat has to be stopped\n(2) Drop ELResolverTest.war into the webapps directory\n(3) Start Tomcat\n(4) In the localhost log you will see:\nJan 2, 2007 11:13:15 AM org.apache.catalina.core.StandardContext listenerStart\nSEVERE: Exception sending context initialized event to listener instance of\nclass eltest.ChipsListener\njava.lang.NullPointerException\n	at eltest.ChipsListener.contextInitialized(ChipsListener.java:18)\n	at\norg.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3827)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:4336)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:760)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:740)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:525)\n	at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:825)\n	at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:714)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:490)\n	at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)\n	at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)\n	at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)\n	at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)\n	at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:451)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:552)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:585)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\nJan 2, 2007 11:13:17 AM org.apache.catalina.core.ApplicationContext log\nINFO: ContextListener: contextInitialized()\nJan 2, 2007 11:13:17 AM org.apache.catalina.core.ApplicationContext log\nINFO: SessionListener: contextInitialized()\n\n\n(5) in the command window you\'ll see:\nE: eclipseWorkspace TC6 tomcat6 output build bin>catalina run\nUsing CATALINA_BASE:   E: eclipseWorkspace TC6 tomcat6 output build\nUsing CATALINA_HOME:   E: eclipseWorkspace TC6 tomcat6 output build\nUsing CATALINA_TMPDIR: E: eclipseWorkspace TC6 tomcat6 output build temp\nUsing JRE_HOME:        C: jdk1.5.0_06 jre\nJan 2, 2007 11:13:08 AM org.apache.catalina.core.AprLifecycleListener init\nINFO: The Apache Tomcat Native library which allows optimal performance in\nproduction environments was not found on the java.library.path:\nC: jdk1.5.0_06 jre bin;.;C: WINNT system32;C: WINNT;C: jdk1.5.0_06 bin;E: temp apache-ant-1.6.5 bin\nJan 2, 2007 11:13:11 AM org.apache.coyote.http11.Http11Protocol init\nINFO: Initializing Coyote HTTP/1.1 on http-8080\nJan 2, 2007 11:13:11 AM org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 5625 ms\nJan 2, 2007 11:13:11 AM org.apache.catalina.core.StandardService start\nINFO: Starting service Catalina\nJan 2, 2007 11:13:11 AM org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.0-dev\nJan 2, 2007 11:13:11 AM org.apache.catalina.core.StandardHost start\nINFO: XML validation disabled\nJan 2, 2007 11:13:11 AM org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive ELResolverTest.war\nChipsListener.contextInitialized  evt=\njavax.servlet.ServletContextEvent[source=org.apache.catalina.core.ApplicationContextFacade@872380]\nChipsListener.contextInitialized  context=\norg.apache.catalina.core.ApplicationContextFacade@872380\nChipsListener.contextInitialized  JspFactory.getDefaultFactory()= null\nJan 2, 2007 11:13:15 AM org.apache.catalina.core.StandardContext start\nSEVERE: Error listenerStart\nJan 2, 2007 11:13:15 AM org.apache.catalina.core.StandardContext start\nSEVERE: Context [/ELResolverTest] startup failed due to previous errors\nJan 2, 2007 11:13:19 AM org.apache.coyote.http11.Http11Protocol start\nINFO: Starting Coyote HTTP/1.1 on http-8080\nJan 2, 2007 11:13:19 AM org.apache.jk.common.ChannelSocket init\nINFO: JK: ajp13 listening on /0.0.0.0:8009\nJan 2, 2007 11:13:19 AM org.apache.jk.server.JkMain start\nINFO: Jk running ID=0 time=0/328  config=null\nJan 2, 2007 11:13:19 AM org.apache.catalina.startup.Catalina start\nINFO: Server startup in 8485 ms\n\n\n(6) The cause is what I described earlier.\n\n\n\n\n\n\n\n\n\n', 'Scott Johnson', '2007-01-02 08:21:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2238, '40820', '5', 'I was able to reproduce. To reproduce, I did the following:\n1) Use the WAR previously attached.\n2) Edit conf/web.xml and comment OUT any reference to\norg.apache.jasper.servlet.JspServlet\n\nLeaving jasper\'s JspServlet intact in the out of the box tomcat config allowed\nthe example to work fine. \n\nAt this point - I don\'t know if this should remain closed or open given the\nsimple solution and the need for the jsp servlet to exist for pages which use jsp. \n\n', 'Tim Funk', '2007-01-02 09:33:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2239, '40820', '6', 'Created  attachment 19341   [details] \nconf and logs directories zipped up', 'Scott Johnson', '2007-01-02 09:57:37 UTC', 'tomcat_attachment/attachment 19341.zip');
INSERT INTO `tomcatbeforefixcomments` VALUES (2240, '40820', '7', 'Hmmm... I\'m using an out of the box tomcat config.  I\'ve attached my logs and\nconf directories. Please take a peek.', 'Scott Johnson', '2007-01-02 09:58:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2241, '40820', '8', 'FWIW: Unable to reproduce with Windows XP pro  & jdk1.5.0_07\n\nBut I\'m in luck - I was able to reproduce with Fedora Core release 5 - 1.5.0_10-\nb0\n\n', 'Tim Funk', '2007-01-02 11:11:45 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2242, '41057', '1', 'Created  attachment 19184   [details] \nsome JRockit Memory Leak Detector pictures and the script to send data', 'vilks56', '2006-11-28 10:13:01 UTC', 'tomcat_attachment/attachment 19184.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2243, '41057', '2', 'You seem to be in a hurry. You did not seem to notice it, but the cache is\nbounded and also configurable. Using the Servlet API provided methods for\nparameters handling with very large POSTs is inefficient and will lead to large\namounts of garbage collections.\n\nIf you\'d like me to look into adjusting the defaults or some of the behavior of\nthe cache, you should send me an explanation I can understand (unlike these\nscripts).', 'Remy Maucherat', '2006-11-28 15:46:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2244, '41057', '3', 'Ok, I understand the script I think. The first one generate a:\n\'firstname=xxxxxxx[long]xxxxxxxx\' line. The second makes a number of requests\nwhile appending a number to it. Solution: the string cache is useful, but\nthere\'s little point caching large strings.', 'Remy Maucherat', '2006-11-28 16:06:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2245, '41057', '4', '(In reply to  comment #3 )\n> Ok, I understand the script I think. \n\nYes, the script works exactly how You said. I created it just to isolate the\nproblem from my real app where I need to POST many large Strings (could be\nmegabytes). \n\nFirst, I don\'t understand why there is a need to cache request parameters for a\nlonger duration than it takes to process the request. It would be useful only in\nvery rare cases: if clients would make the exact same request many times.\n\nSecond, I could not confgure the cahce in a useful way. These are default \nStringCache settings in catalina.properties:\n\n# String cache configuration.\ntomcat.util.buf.StringCache.byte.enabled=true\n#tomcat.util.buf.StringCache.char.enabled=true\n#tomcat.util.buf.StringCache.trainThreshold=500000\n#tomcat.util.buf.StringCache.cacheSize=5000\n\nThe byte cahce is enabled by default and the memrory leak occurs.\n\nI tried to avoid the leak by trying different configurations and here is what I\ndiscovered:\n\n1) The leak does not appear if the byte cache is disabled\n(...StringCache.byte.enabled=false). But disabled cache can\'t be useful at all.\n\n2) I don\'t know what is the purpose of trainTreshold property, but that is the\nonly property that can help: setting it low enough (even extremely low) avoids\nthe leak. For example, lowering trainTreshold to 100 for 10kB requests avoids\nthe leak, but isn\'t that the same as disabling the cache?\n\n3) Limiting the cache size does not work as expected - for example, with\ncacheSize=1 the large requests still lead to exhaustion of heap memory. Digging\nwith Memory Leak Detector shows that _all_ the request parameters still stay in\nheap, referenced by a static field in org.apache.tomcat.util.buf.StringCache.\n', 'vilks56', '2006-11-29 06:36:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2246, '41057', '5', 'This cache caches the result of the conversion of byte[] to String. This is an\nexpensive operation since it includes many allocations and B2C  operations(which\nmakes the cache lookup cost insignificant as long as no sync occurs), and it\'s a\nbit of an experiment.\n\nThe way the cache works is that it looks for a while at the strings the webapp\nis using, build usage data (for example, the attributes names, etc, are going to\nbe used oftem), and then generates a static cache out of that.\n\nThe cache is supposed to be relatively small, however, so if it can get too big\nit\'s bug. I added a limit on the String size in the code along with a new system\nproperty, which should be all that is needed.', 'Remy Maucherat', '2006-11-29 08:21:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2247, '40901', '1', 'Created  attachment 19093   [details] \nPatch to DefaultServlet.java that HTML-encodes filenames for directory indexing', 'Chris Halstead', '2006-11-06 14:04:19 UTC', 'tomcat_attachment/attachment 19093.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2248, '40901', '2', 'Confirmed on Linux as well.  I\'m attaching a simple patch that incorporates\nbasic HTML encoding into o.a.catalina.servlets.DefaultServlet when outputting a\ndirectory index (whether as HTML or XML).  The method in question is basically\nthe same as used in o.a.catalina.util.DOMWriter and in HTMLFilter.java in the\nJSR152/154 examples.', 'Chris Halstead', '2006-11-06 14:04:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2249, '40901', '3', 'Thanks Chris!\n\nBTW: the file/directory names should be \'<b>xxx<b>\', \'<i>yyy<i>\' to get the HTML\ncode interpreted by the browser. Somehow I lost the end tags in my posting.\n\nI tried jarring them up and unjarring them to Windows to see if I could\nreproduce it there. Alas, IOExc during unjarring.', 'Dies Koper', '2006-11-06 16:07:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2250, '37509', '1', 'I\'m not sure our goal is to provide identical behavior to Sun\'s log manager. \nRelying on whitespace is fragile anyways.  I won\'t close this item, in case\nother people have different opinions, but it doesn\'t seem worthwhile to me.', 'Yoav Shapira', '2006-04-13 19:45:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2251, '37509', '2', '(In reply to  comment #1 ) ...Relying on whitespace is fragile anyways...\n\nEven if whitespace are \'fragile\', tomcat shall handle properties values\naccording to properties file specification or not use a properties file.\n\nThe goal is to addapt LogManager to the container environnement and to offer\nsome new facilities. But, in my opinion, logging utilities (Handler, Formatter)\ndevlopped for J2SE shall usable in a webapp environment without re-writting\ntheir properties handling code.\n', 'Franck Hamelin', '2006-04-13 23:27:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2252, '37509', '3', 'Ok, you have your fix and you can use it, rejoice :) Tomcat will not integrate\nyour fix, however.', 'Remy Maucherat', '2006-04-13 23:31:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2253, '37509', '4', 'The current behavior does not follow the file properties specification see\n http://java.sun.com/j2se/1.5.0/docs/api/java/util/Properties.html#load(java.io.InputStream )\n\nbut claims it does.\n\nin org.apache.juli.ClassLoaderLogManager \n...\n    /**\n     * Get the value of the specified property in the classloader local\n     * configuration.\n     * \n     * @param name The property name\n     */    \n    public String getProperty(String name) {\n...\n\nThis requires a correction either in the documentation, to explain the specific\nbehavior, or in the code to follow file properties specification.\n\nI fully agree that this is neither critical nor urgent. Priority or resource\nmight impose to postpone the fix. Or compatibility with the buggy behavior might\nbe preferred to a code fix. That\'s no trouble, but transition to \'Resolved won\'t\nfix\' when the specification contract is broken cannot be a good practice.\n', 'Franck Hamelin', '2006-04-14 21:05:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2254, '34956', '1', 'How does Tomcat not enforce this?  Please provide a test case or steps to\nreproduce the bug.', 'Yoav Shapira', '2005-06-01 04:38:53 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2255, '34956', '2', 'I\'ve also noticed this issue specifically with the implementation of\nthe RequestDispatcher forward and handling a ServletRequestWrapper.\nSeems to modify the value of the javax.servlet.forward.request_uri\nrequest attribute incorrectly, according to servlet spec SRV.8.4.2.\n\nHere are some specifics, at least with version 5.0.28.\n\nStepping through the Tomcat source in the debugger, it\nappears that the request\'s requestURI field gets stomped\non in the forward method of the RequestDispatcher\n(ApplicationDispatcher). I\'m not sure Tomcat is handling\na ServletRequestWrapper correctly.\n\nI gather the servlet spec says that users may wrap the\nrequest/response objects with their own implementation.\n\nTomcat\'s ApplicationDispatcher gets the request from\nthe outer request (the ServletRequestWrapper), trying to\nkeep track of the previous wrapper and current wrapper\n(or request) as it loops through to get the real request.\nWith a single wrapper, the value of \'previous\' is the\nsame as the original outer request. Then Tomcat calls...\n\n((ServletRequestWrapper) previous).setRequest(wrapper);\n\nwhich is the same as calling setRequest(wrapper) on the\nincoming request. Tomcat does not get and save the value\nof the original request URI. It calls setRequestURI(path)\non the wrapper, effectively changing the request URI of the\noriginal incoming request to the path of the forward.\n\nThen Tomcat sets the javax.servlet.forward.request_uri\nattribute by calling getRequestURI() from the original\nrequest... but that just got modified. Implying the\njavax.servlet.forward.request_uri attribute is going to\nget the value of the path for the forward.\n\nYou can test this on Tomcat by using a couple JSP to. Use\na HttpServletRequestWrapper in one JSP for the forward.\n\nFirst create \'result.jsp\' to display the desired request attribute...\n\n<%@ page language=\'java\' contentType=\'text/html;charset=UTF-8\'%>\n<html>\n    <head>\n        <title>RequestDispatcher Test</title>\n    </head>\n    <body>\n        <h1>Forward Request URI</h1>\n        javax.servlet.forward.request_uri =\n        <%= request.getAttribute(\'javax.servlet.forward.request_uri\') %>\n    </body>\n</html>\n\nCreate a JSP to forward without using a wrapper, \'forward.jsp\'...\n\n<%\n    javax.servlet.RequestDispatcher rd =\n        request.getRequestDispatcher(\'result.jsp\');\n    rd.forward(request, response);\n%>\n\nand a second forward using HttpServletRequestWrapper, \'wrapperforward.jsp\'...\n\n<%\n    HttpServletRequestWrapper wrapper = new HttpServletRequestWrapper(request);\n    javax.servlet.RequestDispatcher rd =\n        wrapper.getRequestDispatcher(\'result.jsp\');\n    rd.forward(wrapper, response);\n%>\n\nWhen you hit forward.jsp, the result page displays \'/some-context/forward.jsp\'\nfor the javax.servlet.forward.request_uri request attribute.\nHowever, hit wrapperforward.jsp and the result page displays\n\'/some-context/result.jsp\'. From looking at the spec, I\'d expect this \nshould be \'/some-context/wrapperforward.jsp\'.\n\nI could probably create a patch for this specific case if you\'d like.\nLet me know.', 'Carlin Rogers', '2005-06-08 08:32:32 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2256, '34956', '3', 'Try to write less headache inducing comments in the future, as I didn\'t make it\nto the end.\n\nWhat I see is that: we wrap, we call wrequest.setRequestURI(requestURI) on *our*\nApplicationHttpRequest, and then after processing we discard that wrapper. What\nyou wrote does not make sense to me.', 'Remy Maucherat', '2005-06-08 11:06:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2257, '34956', '4', 'I\'m experiencing the same problem that Carlin describes on Tomcat 5.0.28 as \nwell.  The javax.servlet.forward.request_uri attribute is definitely NOT being \nset correctly when forwarding with a wrapped request.  Carlin\'s test case \ndemonstrates the problem pretty clearly.', 'Brian DeHamer', '2005-06-08 15:03:48 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2258, '34956', '5', 'I would say what Carlin describes is a different bug and is not what the\noriginal request is about. I propose to open a new bug for this. \n\nHere a clarification what this bug is about:\n\nTomcat allows to do sth like that:\n\na)  create a own implementaion of javax.servlet.http.HttpServletRequest\npublic class MyRequestImpl implements javax.servlet.http.HttpServletRequest {\n....\n}\n\nb) use that request objectt in a forward call\n    javax.servlet.RequestDispatcher rd =\n        wrapper.getRequestDispatcher(\'somepage.jsp\');\n    \n    MyRequestImpl myRequest=new MyRequestImpl();\n    rd.forward(myRequest, response);\n\nThis is against the spec, which clearly says either the original request or\nHttpServletRequestWrapper has to be used.\n\nYou can find a real live example for this in the cocoon code. Sepcifically in\norg.apache.cocoon.components.jsp.JSPEngineImplNamedDispatcherInclude from cocoon\n 2.0.4.\n\nThanks', 'christian.buchegger', '2005-06-08 15:53:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2259, '34956', '6', 'Christian, thanks for the clarification. My apologies for causing any\nconfusion here. I\'ve opened a new Tomcat bug, 35270, for my specific\nissue with regards to servlet spec SRV.8.4.2. Please disregard my\nearlier comment in this bug.', 'Carlin Rogers', '2005-06-08 17:38:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2260, '34956', '7', 'Still confused. Marking as NEEDINFO. Requesting a war file to demonstrate the\nbug if there still is one after wading through the converstation. (since a new\nbug seemed to be open)', 'Tim Funk', '2005-07-27 14:52:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2261, '34956', '8', 'The quote from the spec is:\n<quote>\nThe parameters to these methods can be either...\n</quote>\n\nCan is not the same as must. The language as currently written does not mean\nthat the only permitted parameters are the original request/response or the\nwrapped request/response. The example given in  comment 5  is perfectly valid for\nthe current spec language.', 'Mark Thomas', '2006-09-29 18:38:23 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2262, '34956', '9', '(In reply to  comment #8 )\n> The quote from the spec is:\n> <quote>\n> The parameters to these methods can be either...\n> </quote>\n> Can is not the same as must. The language as currently written does not mean\n> that the only permitted parameters are the original request/response or the\n> wrapped request/response. The example given in  comment 5  is perfectly valid \nfor\n> the current spec language.\n\nYou are so wrong here:\n<spec-quote version=\'2.4\' section=\'14.2.5.1\'>\nThe request and response parameters must be either the same objects as were\npassed to the calling servlet’s service method or be subclasses of the\nServletRequestWrapper or ServletResponseWrapper classes that wrap\nthem.\n</spec-quote>\n\nThat means you can use the Request/Response that Tomcat passes in, or a \nHttpServletRequest/ResponseWrapper that wraps the Request/Response that Tomcat \npasses in. And that is it.  The example in #5 isn\'t valid wrt the spec.\n', 'william.barker', '2006-09-29 19:41:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2263, '34956', '10', 'The spec is inconsistent. I was reading section 8.4.2 which uses \'can\', rather\nthan 14.2.5.1 which uses \'must\'. I\'ll send an e-mail to the spec team.\n\nIn the meantime which do we apply? My guess is that 14.2.5.1 was the real\nintention. Thoughts?', 'Mark Thomas', '2006-09-29 19:55:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2264, '34956', '11', '(In reply to  comment #10 )\n> The spec is inconsistent. I was reading section 8.4.2 which uses \'can\', rather\n> than 14.2.5.1 which uses \'must\'. I\'ll send an e-mail to the spec team.\n> \n> In the meantime which do we apply? My guess is that 14.2.5.1 was the real\n> intention. Thoughts?\n\nSorry, that should have be 8.2 not 8.4.2', 'Mark Thomas', '2006-09-30 14:42:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2265, '34956', '12', 'If you add support for this \'feature\', don\'t forget to use\nGlobals.STRICT_SERVLET_COMPLIANCE, because besides annoying some people, this\nwon\'t have any real value.', 'Remy Maucherat', '2006-10-01 03:12:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2266, '40817', '1', 'Created  attachment 19040   [details] \nversion of CGIServlet.java that doesn\'t have the out-of-bounds bug', 'Gene Hardesty', '2006-10-25 20:06:18 UTC', 'tomcat_attachment/attachment 19040.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2267, '40817', '2', 'This is likely a configuration issue.  Make sure that you aren\'t defining the\nCGIServlet init-param cgiPathPrefix as \'/\' in your CGI servlet definition. \nRemove the cgiPathPrefix init-param and it should work as expected.  Setting\ncgiPathPrefix to \'/\' was the only way that I could repro this issue.  By having\nthat set you are unneccessarily adding an extra \'/\' to the path:\n\nINFO http-8080-Processor25\norg.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/cgi-test] - cgi:\nfindCGI: path=/test.pl, /home/chris/apache-tomcat-5.5.20/webapps/cgi-test//\n\nThe CGIServlet is already set up to trim any trailing file seperator from the\nwebAppRootDir, but it only trims one:\n\n    if ((webAppRootDir != null)\n        && (webAppRootDir.lastIndexOf(File.separator) ==\n            (webAppRootDir.length() - 1))) {\n            //strip the trailing \'/\' from the webAppRootDir\n            webAppRootDir =\n            webAppRootDir.substring(0, (webAppRootDir.length() - 1));\n    }\n\nA possibly more appropriate patch would trim an arbitrary number of file\nseperators from webAppRootDir, though right now I can\'t think of another case\nwhere that would be needed.', 'Chris Halstead', '2006-10-26 12:59:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2268, '40817', '3', 'Well, I double-check the init-param but it doesn\'t have a \'/\'\nIt\'s \'blank\'\n          <param-name>cgiPathPrefix</param-name>\n          <param-value></param-value>\n(also though it\'s a different issue, I found that \'SCRIPT_NAME\' was wrong\ntoo...it was returning \'/test.pltest.pl\' or \'/test/test.pltest/test.pl\'...fixed\nit in the if statement a few lines down...scriptname = cginame and scriptname =\ncontextpath + cginame, respectively but that\'s another issue).\n\nwait....I see....line 918 adds an extra \'/\' if the pathprefix setting is null.\n\nanyways, \'cginame = (currentLocation.getParent() +\nFile.separator).substring(webAppRootDir.length()) + name;\' seems to work.\n\n\nbtw, how do I submit a feature request? (I added it myself as I was having\nproblems with PHP CGI....I made it so under certain circumstances, it will use\n\'php\' instead of \'perl\' as the cgiexecutable and lo-and-behold, it\nworks...though I also had to add the env \'SCRIPT_FILENAME\' [which is just a\nexact copy of \'X_TOMCAT_SCRIPT_PATH\'] ).  I plan to make the php \'enhancement\'\nas a part of the init-param so it can be turned on or off as need be (as well as\nbe able to define what constitutes \'PHP\' mode...as right now, it\'s hard-coded to\nlook for commands that end with \'.php\' \'.php3\' \'.php4\' \'.phps\')\n\nanyways..maybe a regex for removing the trailing \'/\' might do...\n\n(In reply to  comment #2 )\n> This is likely a configuration issue.  Make sure that you aren\'t defining the\n> CGIServlet init-param cgiPathPrefix as \'/\' in your CGI servlet definition. \n> Remove the cgiPathPrefix init-param and it should work as expected.  Setting\n> cgiPathPrefix to \'/\' was the only way that I could repro this issue.  By having\n> that set you are unneccessarily adding an extra \'/\' to the path:\n> \n> INFO http-8080-Processor25\n> org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/cgi-test] - cgi:\n> findCGI: path=/test.pl, /home/chris/apache-tomcat-5.5.20/webapps/cgi-test//\n> \n> The CGIServlet is already set up to trim any trailing file seperator from the\n> webAppRootDir, but it only trims one:\n> \n>     if ((webAppRootDir != null)\n>         && (webAppRootDir.lastIndexOf(File.separator) ==\n>             (webAppRootDir.length() - 1))) {\n>             //strip the trailing \'/\' from the webAppRootDir\n>             webAppRootDir =\n>             webAppRootDir.substring(0, (webAppRootDir.length() - 1));\n>     }\n> \n> A possibly more appropriate patch would trim an arbitrary number of file\n> seperators from webAppRootDir, though right now I can\'t think of another case\n> where that would be needed.', 'Gene Hardesty', '2006-10-26 14:08:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2269, '37458', '1', 'Suggested fix?', 'Yoav Shapira', '2005-11-27 23:06:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2270, '37458', '2', '(In reply to  comment #1 )\n> Suggested fix?\n\nThis is one possible scence to cause an exeption: suppose two threads t1 and t2,\nboth are trying to load a same new class. t1 goes first and hit the line 1630,\ndefinePackage(packageName, entry.manifest, entry.codeBase), and stops before the\nmethod call. Then t2 goes ahead and it can hit the same method call too since\nthe entry.manifest is still not null at that time. And then t2 or t1 continues\nand loads the class and sets entry.manifest at the end. After this, when the\nother thread tries to finish the call to definePackage, an exception will be\nthrown since entry.manifest and entry.codebase have become null now.\n\nI haven\'t got any good solution so far. One could use a huge sync block to\nprotect the test on entry.manifest and the corresponding later change, but that\nwould make it inefficient. Another alternative is to catch the nullpointer\nexception thrown by definePackage and ignore it if possible.', 'Feng Chen', '2005-12-15 06:34:46 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2271, '37458', '3', 'Fixed in SVN and will be included in 5.5.21 onwards.', 'Mark Thomas', '2006-10-30 19:52:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2272, '37458', '4', 'Is it possible that the fix has been regressed by the modifications in  revision 510801 , as the block is now synchronised on \'this\' rather than \'entry\'?\n\nWe have seen what appears to be the same bug occur when using version 5.5.23. The start of the stacktrace we see is\n\njava.lang.NullPointerException\n        at java.lang.Package.isSealed(Package.java:179)\n        at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1800)\n        at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:869)\n        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1322)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:299)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:251)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n        at java.lang.Class.forName0(Native Method)\n        at java.lang.Class.forName(Class.java:242)\n        at sun.rmi.server.LoaderHandler.loadClass(LoaderHandler.java:430)\n        at sun.rmi.server.LoaderHandler.loadClass(LoaderHandler.java:165)\n        at java.rmi.server.RMIClassLoader$2.loadClass(RMIClassLoader.java:620)\n        at org.objectweb.jonas.server.RemoteClassLoaderSpi.loadClass(RemoteClassLoaderSpi.java:75)\n        at java.rmi.server.RMIClassLoader.loadClass(RMIClassLoader.java:247)\n        at sun.rmi.server.MarshalInputStream.resolveClass(MarshalInputStream.java:197)\n        at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1544)\n        at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1466)\n ...', 'Dave McIntyre', '2008-03-26 20:37:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2273, '37458', '5', 'Re-opening so I remember to look at this.', 'Mark Thomas', '2008-03-27 06:40:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2274, '37458', '6', 'There are a couple of odd things about your stack trace.\n\n1. For 5.5.23, line 1800 of WebappClassLoader doesn\'t call Package.isSealed(). It is around 30 lines later.\n\n2. I don\'t understand why the NPE is thrown from within java.lang.Package. If pkg was null, I\'d expect to see the NPE in WebappClassLoader\n\n3. I have checked the source for 1.4, 1.5 and 1.6 and don\'t see how Package.isSealed() could throw a NPE.\n\nI have reviewed the patch you referred to and I do not see a code path by which this bug could re-appear.\n\nYou may have found a new bug, in which case a new issue is in order, but the oddities above make me think that the root cause is more likely some other factor in your configuration.\n\nThe best place to get help on this is the users list. Before posting please try a clean 5.5.26 build and also post the OS and JDK you are using. If the discussion there concludes there is a bug, please create a new issue to track it.', 'Mark Thomas', '2008-03-27 16:13:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2275, '37458', '7', '(In reply to  comment #6 )\n> There are a couple of odd things about your stack trace.\n> \n> 1. For 5.5.23, line 1800 of WebappClassLoader doesn\'t call Package.isSealed().\n> It is around 30 lines later.\n> \nI agree that this seems odd.  I installed a fresh download of 5.5.23 and it started reporting the error as \njava.lang.NullPointerException\n        at java.lang.Package.isSealed(Package.java:179)\n        at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1833)\n        at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:873)\n        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1326)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:299)\n...\n\nI also tried a fresh install of 5.5.26 and the line numbers changed to \njava.lang.NullPointerException\n        at java.lang.Package.isSealed(Package.java:179)\n        at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1839)\n        at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:875)\n        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1330)\n\n\n> 2. I don\'t understand why the NPE is thrown from within java.lang.Package. If\n> pkg was null, I\'d expect to see the NPE in WebappClassLoader\n> \nIt\'s not pkg that is null, it is entry.codeBase which is null. My fault for posting incorrect line numbers.\n\n> 3. I have checked the source for 1.4, 1.5 and 1.6 and don\'t see how\n> Package.isSealed() could throw a NPE.\n> \nIt is not the call to Package.isSealed() but the call to Package.isSealed(URL url) which causes the problem: it throws an NPE trying to return \'url.equals(sealBase)\'.\n\n> I have reviewed the patch you referred to and I do not see a code path by which\n> this bug could re-appear.\n> \nIn the initial fix for this bug ( revision 469360 ), this section of code was included in a block which was synchronised on \'entry\' which contained a smaller block synchronised on \'this\'.  In  revision 510801  the synchronisation was changed to synchronise the outer block on \'this\', with no synchronisation on \'entry\'.  The problem seems to me to be that although \'entry\' is a local variable, the object it references is obtained externally so two different threads are able to access the same object, and thus one thread is able to set entry.codeBase to null (at line 1853 in 5.5.23) after the other thread has entered the block and committed itself to calling pkg.isSealed(entry.codeBase).\n\n> The best place to get help on this is the users list. Before posting please try\n> a clean 5.5.26 build and also post the OS and JDK you are using. If the\n> discussion there concludes there is a bug, please create a new issue to track\n> it.\n> \nSorry for replying directly here but I thought it was appropriate to reply directly to your comments.  As I say, I see this with a clean 5.5.26 build, running in CentOS release 4.6 (Final) under Java HotSpot(TM) Client VM (build 1.5.0_14-b03, mixed mode, sharing).\n\n', 'Dave McIntyre', '2008-04-16 22:52:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2276, '37458', '8', 'I\'ve looked at the WebappClassLoader source and I can\'t see how one thread could set entry.codeBase to null whilst another thread calls Package.isSealed since both calls are inside the sync block.\n\nThe only way I could see entry.codeBase being null was if getCanonicalFile() throws an IOE (line 2230 in the latest 5.5.x code).\n\nI notice you are using RMI. I wonder if this is a factor since there does not appear to be any other reports of this issue. I have a vague recollection of issues with RMI and Tomcat installed in a path with spaces. Might this be affecting you?\n\nHow repeatable is this? A simple test case that demonstrates the issue would help significantly.\n\nFinally, where does JOnAS fit in to all of this. Given the lack of duplicate reports, I wonder if this might be an integration issue of some sort?', 'Mark Thomas', '2009-01-01 16:25:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2277, '37458', '9', 'Created  attachment 23066   [details] \npatch for WebappClassLoader class of tc6.0.x\n\nI think the issue is caused by missing (entry.loadedClass == null) inside the synchronized block. (Remember the double-checked locking pattern?)\n\nI also wonder if there is a cause for (entry.loadedClass == null) check later in the synchronized block (line 1845, i.e. before calling defineClass()) other than this very bug.\n\nThus the patch. It is against tc6.0.x\n\nI do not remember whether pointer assignments are atomic in current Java, and thus whether it is safe to test for (entry.loadedClass) elsewhere in the code.', 'Konstantin Kolinko', '2009-01-01 18:44:06 UTC', 'tomcat_attachment/attachment 23066.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2278, '37458', '10', 'Huh, I now have a TestCase that reproduces the issue. I see the same exception as in  comment #4 .\n\nNo wonder, that it is rare. To encounter this the following conditions must be met:\n1. A SecurityManager should be present\n2. The class that you are loading has to be in a sealed package.\n3. It is a race condition. Several iterations in the TestCase are required.', 'Konstantin Kolinko', '2009-01-01 21:17:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2279, '37458', '11', 'Created  attachment 23067   [details] \nTest case file 1: TestWebappClassLoader class.', 'Konstantin Kolinko', '2009-01-01 21:59:39 UTC', 'tomcat_attachment/attachment 23067.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2280, '37458', '12', 'Created  attachment 23068   [details] \nTest case file 2: sealed.jar resource file.', 'Konstantin Kolinko', '2009-01-01 22:00:16 UTC', 'tomcat_attachment/attachment 23068');
INSERT INTO `tomcatbeforefixcomments` VALUES (2281, '37458', '13', 'To reproduce:\n1. Place TestWebappClassLoader.java and sealed.jar into package org.apache.catalina.loader of TC 6.0 test sources.\n\n2. Use JUnit to run the test case.\n\n3. The following exception is observed:\n\n...\nCaused by: java.lang.NullPointerException\n	at java.lang.Package.isSealed(Package.java:181)\n	at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1832)\n	at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:890)\n	at org.apache.catalina.loader.TestWebappClassLoader$FindClassThread.run(TestWebappClassLoader.java:48)\n', 'Konstantin Kolinko', '2009-01-01 22:07:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2282, '37458', '14', 'Thanks for the patch and your analysis. That makes perfect sense.\n\nI have applied your patch to trunk and proposed it for 6.0.x and 5.5.x.\n\nThanks again.', 'Mark Thomas', '2009-01-02 06:32:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2283, '37458', '15', 'This has been fixed in 6.0.x and will be included in 6.0.19 onwards.', 'Mark Thomas', '2009-01-14 16:26:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2284, '39724', '1', 'Created  attachment 18402   [details] \nThe patch on the removeValve Method', 'David Gagnon', '2006-06-05 14:03:30 UTC', 'tomcat_attachment/attachment 18402.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2285, '39724', '2', 'Seems like a good suggestion: can you please submit your patch in diff -u\nformat?  Thank you.', 'Yoav Shapira', '2006-06-15 19:09:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2286, '39724', '3', 'Hi,\n  Here is the diff.  My patch had a little type by the way i.e.: == instead of =\n\nAnyway the following works\n\nRegards\n/David\n\n\ndiff -u StandardPipeline.java StandardPipelinePatched.java\n--- StandardPipeline.java       2006-06-15 15:31:12.637965896 -0400\n+++ StandardPipelinePatched.java        2006-06-15 15:30:45.894031592 -0400\n@@ -530,6 +530,9 @@\n             current = current.getNext();\n         }\n\n+        // PATCH: Empty the pipeline if only the basic valve is there\n+        if (first == basic) first = null;\n+\n         if (valve instanceof Contained)\n             ((Contained) valve).setContainer(null);\n', 'David Gagnon', '2006-06-15 19:32:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2287, '39724', '4', '***  Bug 35914  has been marked as a duplicate of this bug. ***', 'Mark Thomas', '2006-10-02 18:02:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2288, '29727', '1', 'The JNDI context is discarded between restarts, so I doubt that this is the\ncase. I recommend you investigate the issue further.', 'Remy Maucherat', '2004-06-22 08:09:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2289, '29727', '2', 'as I said, the application works correctly (i.e. the new value is picked up) \nwhen the environment value is changed via the Tomcat Admin interface, but does \nnot work when the value is changed by manually editting the web.xml and \nstop/start the application.\n\nSo how can this be an application level problem?\n\nThe only thing I can thing of is that it is somehow related to a Classloader \nissue??? But I am not sure why it would work with the Admin interface then.\n\n\n', 'robert engels', '2004-06-22 14:17:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2290, '29727', '3', 'also, I found someone else reported the same issue on the mailing list...\n\n http://archives.real-time.com/pipermail/tomcat-users/2003-March/103584.html ', 'robert engels', '2004-06-22 14:21:24 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2291, '29727', '4', 'The code as posted can\'t be compiled: what\'s the \'jndi\' variable?\n\nIf you post a complete test case, i.e. a WAR file that I can drop into my \nTomcat installation to reproduce your problem, I\'ll be glad to look at it.\n\nIn addition, can you please test 5.0.28, the latest stable Tomcat 5.0 release \nat the time of this writing?', 'Yoav Shapira', '2004-09-20 15:41:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2292, '29727', '5', 'Created  attachment 12809   [details] \nwar file to demonstrate env-entry problem', 'robert engels', '2004-09-20 19:46:34 UTC', 'tomcat_attachment/attachment 12809');
INSERT INTO `tomcatbeforefixcomments` VALUES (2293, '29727', '6', 'I have posted the war file. I ran the test against 5.0.28 - no change, problem \nstill exists. Thanks for looking into this.\n\nTo test:\n\ninstall war in server\n\nbrowse to <webserver>/<context>/listenv.jsp\n\n-  the current value of the env-entry should be displayed\n\nchange the web.xml env-entry using some text editor.\n\nreload the context, or allow tomcat to auto reload on change.\n\nbrowse to <webserver>/<context>/listenv.jsp (refresh needs to be performed)\n\n-  the OLD value is still displayed\n\nchange the env-entry using the tomcat \'admin\' web interface. post changes.\n\nbrowse to <webserver>/<context>/listenv.jsp (refresh needs to be performed)\n\n-  the NEW value is still displayed\n', 'robert engels', '2004-09-20 19:51:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2294, '29727', '7', 'Could you please consider the following modification of\norg.apache.catalina.core.NamingContextListener class:\n\nit was:\n\npublic void lifecycleEvent(LifecycleEvent event) {\n...\n            // Binding the naming context to the class loader\n            if (container instanceof Context) {\n                // Setting the context in read only mode\n                ContextAccessController.setReadOnly(getName());\n                try {\n                    ContextBindings.bindClassLoader\n                        (container, container,\n                         ((Container)\ncontainer).getLoader().getClassLoader());\n                } catch (NamingException e) {\n                    log(sm.getString(\'naming.bindFailed\', e));\n                }\n            }\n...\n}\n\nI think, it should be:\n\n\npublic void lifecycleEvent(LifecycleEvent event) {\n...\n            // Binding the naming context to the class loader\n            if (container instanceof Context) {\n\n\n\n               namingResources.addPropertyChangeListener(this);\n\n\n\n                // Setting the context in read only mode\n                ContextAccessController.setReadOnly(getName());\n                try {\n                    ContextBindings.bindClassLoader\n                        (container, container,\n                         ((Container)\ncontainer).getLoader().getClassLoader());\n                } catch (NamingException e) {\n                    log(sm.getString(\'naming.bindFailed\', e));\n                }\n            }\n...\n}\n\n\nThank you,\nIgor', 'Igor', '2004-10-30 06:03:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2295, '29727', '8', 'Created  attachment 13292   [details] \nIf Environment entry is changed using admin app, the change is not visisble in JNDI. Patch to solve this problem', 'Igor', '2004-11-01 14:53:13 UTC', 'tomcat_attachment/attachment 13292.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2296, '29727', '9', 'Sorry, this patch is wrong :-( Please do not apply it', 'Igor', '2004-11-01 15:35:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2297, '29727', '10', 'The comments from Igor are not correct. It works ok if you change the variable\nvia the admin interface - it does not work if you manually change the web.xml,\nand stop/restart the web application.', 'robert engels', '2004-11-01 16:05:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2298, '29727', '11', 'Updating version to 5.0.28.', 'Yoav Shapira', '2004-11-22 17:37:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2299, '29727', '12', 'The chances of this getting fixes in Tomcat 5.0.x are now slim.  Can either or\nboth of you test with 5.5.7 (or 5.5.9 which will be out in a couple of days) and\nlet us know if it works or not?  That would be great...', 'Yoav Shapira', '2005-03-26 04:23:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2300, '29727', '13', 'I did a simple test with tomcat 5.5.9. Environment entries are reloaded when \ncontext is reloaded.\n\nBut if I change environment entry in admin application, it is not reloaded. To \nforce application to see new entries user will have to reload context, which is \ndangerous operation.\n\nIt would be great if application would see new value after changing it in admin \napplication too.\n\n(In reply to  comment #12 )\n> The chances of this getting fixes in Tomcat 5.0.x are now slim.  Can either or\n> both of you test with 5.5.7 (or 5.5.9 which will be out in a couple of days) \nand\n> let us know if it works or not?  That would be great...\n\n', 'Igor', '2005-07-22 07:32:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2301, '29727', '14', 'That\'s pointless: accessing JNDI is costly, and is supposed to be read only in\nthe first place. As a result, webapps should be reading values, etc, in init,\nand that\'s it.', 'Remy Maucherat', '2005-07-22 07:59:47 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2302, '29727', '15', 'My original bug, is that if the web.xml file is modified (via text editor, etc.)\nwhile the context is running, and the context is restarted, the container is\nsupposed to detect this and load the new JNDI values.\n\nThis is according to the J2EE specification.\n\nThis does not occur in 5.0. I have not yet tested with the 5.5 release, but\nbased on the fact that nothing has been posted as a direct fix for this, I am\nfairly certain the problem still exists.', 'robert engels', '2005-07-22 08:18:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2303, '29727', '16', 'As a developer I want to have possiblity to change environment entries without \nrestarting, reloading ... My application should work 24/7 and I do not want to \nrestart or reload application because of I need to change only one parameter.\n\nEnvironment entries are very convinient to store init parameters. And I do not \nwant to change parameters too often. But it would be nice if I could change \nsomething in application parameters without restart.\n\nI can \'change\' environment entries in admin application. What is this feature \nfor, if it do not do anything, just changes value in admin?', 'Igor', '2005-07-22 15:22:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2304, '29727', '17', 'This can be done via JMX. Assume you have a webapp called /myapp with a JNDI\nenvironment string called i/need. It can be queried via the JMPXproxy in the\nmanager app. Here\'s the ouput example:\n\nName:\nCatalina:type=Environment,resourcetype=Context,path=/myapp,host=localhost,name=i/need\nmodelerType: org.apache.catalina.mbeans.ContextEnvironmentMBean\nclassName: org.apache.catalina.deploy.ContextEnvironment\nname: i/need\noverride: false\ntype: java.lang.String\nvalue: less cowbell\n\nSo your search URL would be (unescaped for readability ...)\n http://localhost/manager/jmxproxy?qry=Catalina:type=Environment,resourcetype=Context,path=/myapp,host=localhost,name=i/need \n\nAnd can be set via\n http://localhost/manager/jmxproxy?set=Catalina:type=Environment,resourcetype=Context,path=/myapp,host=localhost,name=i/need&att=value&val=more+cowbell \n\nMore information:\n http://jakarta.apache.org/tomcat/tomcat-5.0-doc/manager-howto.html#What%20is%20JMX%20Proxy%20Servlet \n', 'Tim Funk', '2005-07-22 16:09:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2305, '29727', '18', 'Reopening bug. you cannot close as won\'t fix. your solution is not related to\nthis bug. This is a different bug, in that manual changes made to a web.xml\nfile, are not seen in the JNDI environment after a context restart. This is not\nadhering to the J2EE specification.', 'robert engels', '2005-07-22 16:18:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2306, '29727', '19', 'Sure I can close the bug ;) This will not be fixed.', 'Remy Maucherat', '2005-07-22 16:24:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2307, '29727', '20', 'Sorry, but you are an idiot, or have very little reading comprehension skills.\n\nThis bug needs to be fixed, it is not J2EE compliant. You do not need to fix the\nrequest in  comment #13 , that changes are visible in the JNDI context without a\nreload when changes are made via the admin interface. There is not in J2EE that\nstates that a container must update the JNDI context in real-time, but not sure\nthat the feature wouldn\'t be helpful as Igor has pointed out.', 'robert engels', '2005-07-22 16:34:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2308, '29727', '21', '(In reply to  comment #20 )\n> Sorry, but you are an idiot\n\nThat sounds good to me :)\n\nTo translate since you apparently have very little general comprehension skills,\nthis minor issue will not be fixed in the 5.0.x branch.', 'Remy Maucherat', '2005-07-22 16:45:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2309, '29727', '22', 'How is it a minor issue? Do you run any large, multiple server, sites at all? It\nis fairly common to update deployed application by copying new web.xml files to\nthe deployment directories, and then use the Tomcat weburl to restart the context.\n', 'robert engels', '2005-07-22 16:59:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2310, '29727', '23', 'Why is this bug not moved to the 5.5 branch then?\n\nThe J2EE specification states that the JNDI variables for an application are\nreloaded during a CONTEXT RESTART. This is the only way for init() methods in a\nservlet to retrieve any changed values.\n\nThis bug is NOT related to Igor\'s comments where he wants JNDI changes to be\nvisible as they are made.\n\nFor what it is worth, I tested this behavior with Jetty and it works as expected.', 'robert engels', '2006-09-19 17:53:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2311, '29727', '24', 'Tested against 5.5.x and is still present. I am working on a fix...\n\nNote, I am only considering the original bug report.', 'Mark Thomas', '2006-09-20 01:52:52 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2312, '34399', '1', 'One more thing, this works for Tomcat 5.0.x. ', 'sherold', '2005-04-11 16:33:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2313, '34399', '2', 'In 5.5, the manager will only handle contexts deployed by the autodeployer.\nPlease don\'t insist for it to behave in a different way, it will not happen. The\nother part of the bug has been fixed already.', 'Remy Maucherat', '2005-04-11 16:42:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2314, '34399', '3', 'So you claim that it is \'as designed\' to restrict undeploy by manager of\nautodeployed applications? (I\'m OK with that)\nBut why the report is: \'OK - Undeployed\', if it is not true! I\'d expect\ndifferent result message at least (it could be probably downgraded).', 'Karel Zikmund', '2005-04-11 16:51:00 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2315, '34399', '4', 'Hacking in contexts using server.xml is not recommended. I do not see any reason\nto address this non issue.', 'Remy Maucherat', '2005-04-11 16:55:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2316, '34399', '5', 'I\'m OK with not recommend using server.xml, but it is still part of product,\ntherefore valid issue, although with lower priority.', 'Karel Zikmund', '2005-04-11 17:36:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2317, '34399', '6', 'I do not insist on this being considered as a serious issue, especially if the  \nstopping has been fixed. However, I do not agree it is a \'non issue\'. Defining  \ncontext in the server.xml is a valid usecase, although not recommended and  \nugly, but it is still valid.  \n  \nI would expect the Tomcat Manager to behave reasonably which is returning  \nsomething like \'FAIL - Application cannot be undeployed...\' and not claiming  \nit was undeployed successfully, if it was not.  \n  \nRemy, please note that I\'ve filed this issue in attempt to improve the Tomcat  \nuser experience. This usecase is not what I would personally do. However,  \nusers who are upgrading from erlier versions (3.x.x or 4.x.x) are often used  \nto it and they would surely consider this as an issue. \n \nBtw, if this issue should be closed, it should be cloased as WONTFIX and not \nas INVALID. \n \nAnyway, thanks Remy for fixing the other issue! ', 'sherold', '2005-04-11 17:53:07 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2318, '34509', '1', 'I see the JSP spec uses j2ee:tld-canonical-nameType, which says it\'s the same as\nxsd:nmtoken, which according to\n http://www.w3.org/TR/2000/WD-xml-2e-20000814#NT-Nmtoken  should allow these\nvarious characters.  So this does seem to be a real issue, but I don\'t have the\ntime to fix it right now, and I think the magnitude of the patch required might\nbe big...', 'Yoav Shapira', '2005-07-22 16:24:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2319, '34509', '2', 'This has been fixed in svn and will be included in 5.5.20 onwards', 'Mark Thomas', '2006-09-15 02:55:15 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2320, '34509', '3', 'HTTP Status 500 - \n\n--------------------------------------------------------------------------------\n\ntype Exception report\n\nmessage \n\ndescription The server encountered an internal error () that prevented it from \nfulfilling this request.\n\nexception \n\njavax.servlet.ServletException: fiid is null in html_header.jsp\n	org.apache.jsp.jsp.displaycriticalerror_jsp._jspService\n(org.apache.jsp.jsp.displaycriticalerror_jsp:274)\n	org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n	org.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:322)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:291)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n	com.premier.ofa.servlets.LoggedHttpServlet.forwardToPage\n(LoggedHttpServlet.java:399)\n	com.premier.ofa.servlets.TransactionProcessorServlet.forwardToErrorPage\n(TransactionProcessorServlet.java:1137)\n	com.premier.ofa.servlets.TransactionProcessorServlet.forwardToErrorPage\n(TransactionProcessorServlet.java:1124)\n	com.premier.ofa.servlets.TransactionProcessorServlet.doGet\n(TransactionProcessorServlet.java:687)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n	com.premier.ofa.servlets.LoggedHttpServlet.service\n(LoggedHttpServlet.java:157)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\n\nnote The full stack trace of the root cause is available in the Apache \nTomcat/5.5.9 logs.\n\n\n--------------------------------------------------------------------------------\n\nApache Tomcat/5.5.9', 'Randa Perry', '2007-05-09 04:40:43 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2321, '31804', '1', 'I may misunderstand your problem entirely, but I believe the behaviour you are\nseeing is expected. \n\nAccording to javax.servlet.jsp.tagext.Tag.setParent() javadocs:\n\n     * Set the parent (closest enclosing tag handler) of this tag handler.\n     * Invoked by the JSP page implementation object prior to doStartTag().\n     *\n     * @param t The parent tag, or null.\n\nSince <custom:submit> is not nested inside any custom tag invocation in your\n.tagx snippet, NULL is passed to your tag handler\'s setParent().\n\nLikewise, javax.servlet.jsp.tagext.SimpleTag.setParent() has this:\n\n     * Sets the parent of this tag, for collaboration purposes.\n     * <p>\n     * The container invokes this method only if this tag invocation is \n     * nested within another tag invocation.\n     *\n     * @param parent the tag that encloses this tag\n\nSince your SimpleTag isn\'t nested, the container does not call its setParent()\nmethod at all.\n\n> I would expect a reference to something, representing translated class of Tag \n> File (submit.tagx) is passed.\n\nYour expectation is wrong. You should expect setParent() to be called on your\ntag handler, and a non-null argument passed to it, only if your custom tag is\nnested inside another custom tag.', 'Jan Luehe', '2004-10-20 22:55:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2322, '31804', '2', '> Your expectation is wrong. You should expect setParent() to be called on your\n> tag handler, and a non-null argument passed to it, only if your custom tag is\n> nested inside another custom tag.\n\nShouldn\'t we expect setParent() to be called on <custom:submit> tag handler with\nthis.getParent() of .tagx file handler? I mean if our .tagx snippet in its term\nwill ever be nested inside another custom tag at some other place, then\nsetParent() will be called with this.getParent(), which was set to point to real\nparent tag handler in that case.', 'Dmitri Blinov', '2004-11-17 15:32:21 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2323, '31804', '3', '> Your expectation is wrong. You should expect setParent() to be called on your\n> tag handler, and a non-null argument passed to it, only if your custom tag is\n> nested inside another custom tag.\n\nShouldn\'t we expect setParent() to be called on <custom:submit> tag handler with\nthis.getParent() of .tagx file handler? I mean if our .tagx snippet in its term\nwill ever be nested inside another custom tag at some other place, then\nsetParent() will be called with this.getParent(), which was set to point to real\nparent tag handler in that case.\n\nFor example I have batch.tag file with the number of <sql:update> tags. Now I\nwant that those statements would run in the context of <sql:transaction>. If I\nsimply put \n\n<sql:transaction>\n  <my:batch />\n</sql:transaction>\n\nthen <sql:update> statements won\'t be connected with the tag invocation tree\nthat includes <sql:transaction>.\n\nI do not see any particular reason why enclosed <sql:update> invocations should\nbe isolated from their enclosing enviromnent... ', 'Dmitri Blinov', '2004-11-18 15:35:56 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2324, '31804', '4', ' http://issues.apache.org/bugzilla/show_bug.cgi?id=31804 \n \nCould someone please advise me on whether this Bug is fixed?\nBugzilla shows this bug to be filed under Tomcat 4.0 I am using Tomcat 5.0.28 \nand am having problems when using the jsp:param tag. I get tons of deprecation \nerrors.\n \nMy IDE is jbuilder 2005 and am using :\njava version \'1.4.2_05\'\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.4.2_05-b04) Java \nHotSpot(TM) Client VM (build 1.4.2_05-b04, mixed mode)\n\n \nany tips on whether this bugID is fixed for Tomcat 5.0.28 (or how could it be \nfixed OR a workaround ) would be greatly appreciated.\n ', 'Rohan Pinto', '2005-01-14 00:05:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2325, '31804', '5', 'Rohan, I would guess this \'bug\' is not fixed, assuming it\'s a bug at all.  We\'re\nnormally pretty good about closing bugzilla item as resolved/fixed once we\ncommit the fix to CVS.', 'Yoav Shapira', '2005-03-25 04:18:36 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2326, '31804', '6', 'The only case where setParent() will be invoked in when its tag is nested in\nanother tag, such as\n\n<nested:form action=\'/Action\'>\n   <ctrl:submit action=\'save\' label=\'Save\'/>\n</nested:form>\n\nIn this case, setParent() will be invoked for <ctrl:sumit> but not\n<nested:form>.  This can be easily verified by examining the generated java\nfiles, as I have done for 5.x.  It doen\'t matter if <ctrl:submit> is a tag file\nor not.', 'Kin-Man Chung', '2005-12-10 01:56:50 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2327, '31804', '7', 'This isn\'t working correctly.  However I think the examples given so far have been incomplete.  I will try \nto give a full example.\n\nLets suppose we have two traditional custom tags, for this example I\'m going to use the Spring 2.0 \nform tag libraries as they are the ones that led me here.\n\nThe first tag is form:form tag, which sets up context to be accessed by nested tags via the setParent \nmechanism.\n\nThe second tag is form:label tag, which makes use of the context created by the form:form tag and only \nfunctions properly when nested within a form:form tag.\n\nSo we might have an example jsp as follows.\n\n<form:form> \n  <form:label>hello</form:label>\n</form:form>\n\nthe generated java file for this jsp would invoke setParent(null) on the form:form tag and would invoke \nsetParent([reference to the form tag]) on the label tag.  This would be correct.\n\nNow let us assume that we create a tag file which makes use of the form:label tag because we tired of \ntyping \'Hello\' everywhere.\n\nOur tag file might look like this.\n\n<form:label>Hello</form:label>\n\nand our revised jsp page would look like this.\n\n<form:form>\n  <mycustumtag/>\n</form:form>\n\nIn this case the form:form tag would again get a setParent invoked with null, (still correct) and \nmycustomtag would get it\'s setParent invoked with the reference to the form:form tag, (also still \ncorrect), but the form:label tag inside of mycustomtag would get it\'s setParent method invoked with \n\'null\'.  This is \'Not Correct\'.  The label tag is nested inside of an outer tag and should have it\'s \nsetParent method invoked with the reference to that outer tag.\n\nHere is the logic I would propose for this section of code.\n\nif (myParent == null) {\n  // set parent of any top level tags used in tag file to null\n} else {\n  // set parent of any top level tags used in tag file to \'this\'\n}\n', 'roy Wells', '2006-08-29 23:24:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2328, '38713', '1', 'For more info:\nGot same error on Tomcat 5.5.15. Using JDK 1.5.0_06.\n\nApparently other people have seen this bug before (but on another JVM):\n\n http://mail-archives.apache.org/mod_mbox/tomcat-dev/200403.mbox/%3C406AADCC.7020003@ruc.dk%3E ', 'Eric', '2006-02-22 20:19:01 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2329, '38713', '2', 'We have the same problem. I think I managed to find out the cause: it only\nhappens if the JSP itself throws FileNotFoundException. So in order to\nreproduce: have only one JSP in your Webapp like so:\n\n<%!\n  java.util.Random r = new java.util.Random();\n%><% if(r.nextInt(10) > 0) throw new java.io.FileNotFoundException(); %>\n\nand put some concurrent load on that JSP.\n\nEvaluation: Jasper has a rather big catch block in JspServletWrapper.java and\nwill interpret any FNFE as an indication that the JSP itself has disappeared. It\nwill remove the JspServletWrapper which triggers a recompilation.\n\nI\'m pretty sure there is a race condition in that recompilation code that causes\ntwo concurrent compilations for the same file. These two compilations would\nfight over the generated files and lead to the observed bug. See the thread dump\nbelow (taken after SDEInstaller hit a breakpoint in the offending line): two\ncompilations with different OIDs for JSPServletWrapper although the webapp has\nonly one JSP.\n\n\n\'http-16001-Processor22\' daemon prio=10 tid=0x00764340 nid=0x23 waiting on\ncondition [0xedb7e000..0xedb7f9f0]\n        at java.io.IOException.<init>(IOException.java:40)\n        at java.io.FileNotFoundException.<init>(FileNotFoundException.java:46)\n        at\norg.apache.jasper.compiler.SmapUtil$SDEInstaller.<init>(SmapUtil.java:248)\n        at\norg.apache.jasper.compiler.SmapUtil$SDEInstaller.install(SmapUtil.java:236)\n        at org.apache.jasper.compiler.SmapUtil.installSmap(SmapUtil.java:163)\n        at org.apache.jasper.compiler.Compiler.generateClass(Compiler.java:429)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:472)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:451)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:439)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:511)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:295)\n        - locked <0xf1320090> (a org.apache.jasper.servlet.JspServletWrapper)\n\n\n\'http-16001-Processor25\' daemon prio=10 tid=0x00767a50 nid=0x26 runnable\n[0xed87d000..0xed87fc70]\n        at java.net.URLStreamHandler.setURL(URLStreamHandler.java:505)\n        at java.net.URLStreamHandler.parseURL(URLStreamHandler.java:283)\n        at sun.net.www.protocol.file.Handler.parseURL(Handler.java:50)\n        at java.net.URL.<init>(URL.java:596)\n        at java.net.URL.<init>(URL.java:464)\n        at java.net.URL.<init>(URL.java:413)\n        at java.net.JarURLConnection.parseSpecs(JarURLConnection.java:161)\n        at java.net.JarURLConnection.<init>(JarURLConnection.java:144)\n        at\nsun.net.www.protocol.jar.JarURLConnection.<init>(JarURLConnection.java:61)\n        at sun.net.www.protocol.jar.Handler.openConnection(Handler.java:24)\n        at java.net.URL.openConnection(URL.java:943)\n        at java.net.URL.openStream(URL.java:1007)\n        at\norg.apache.catalina.loader.StandardClassLoader.getResourceAsStream(StandardClassLoader.java:679)\n        at java.lang.Class.getResourceAsStream(Class.java:1998)\n        at org.apache.tools.ant.ComponentHelper.initTypes(ComponentHelper.java:741)\n        at\norg.apache.tools.ant.ComponentHelper.initDefaultDefinitions(ComponentHelper.java:247)\n        at org.apache.tools.ant.Project.init(Project.java:262)\n        at org.apache.jasper.compiler.Compiler.getProject(Compiler.java:116)\n        at org.apache.jasper.compiler.Compiler.generateClass(Compiler.java:320)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:472)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:451)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:439)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:511)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:295)\n        - locked <0xf0c4d448> (a org.apache.jasper.servlet.JspServletWrapper)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:292)', 'Matthias Ernst', '2006-03-10 11:58:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2330, '38713', '3', 'Also found this problem with Tomcat 5.5.4 on Windows 2000 Professional.', 'Phil Shaw', '2006-04-01 13:01:02 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2331, '38713', '4', '(In reply to  comment #2 )\n> We have the same problem. I think I managed to find out the cause: it only\n> happens if the JSP itself throws FileNotFoundException. So in order to\n> reproduce: have only one JSP in your Webapp like so:\n> \n> <%!\n>   java.util.Random r = new java.util.Random();\n> %><% if(r.nextInt(10) > 0) throw new java.io.FileNotFoundException(); %>\n> \n> and put some concurrent load on that JSP.\n> \n\nI have seen this problem where the jsp does NOT have any code that throws a\nFileNotFoundException. I do not believe this is the source of the problem.\n\nI\'ve seen the problem with Tomcat 5.0.28 with j2sdk1.4.2_05.\n\nNot that a browser refresh allows the JSP to compile correctly.', 'Brett Shelton', '2006-04-26 14:46:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2332, '38713', '5', 'I tend to believe the race condition theory put forth by Matthias.  If one of\nyou wants to submit a patch for fix it, that\'d be awesome.  Thanks.', 'Yoav Shapira', '2006-06-15 19:25:26 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2333, '38713', '6', 'I have also found this to occur in Tomcat 5.5.17 on both Windows XP and Windows\n2003 Server. This causes some concern for my boss, and I\'m not sure what to tell\nhim. Please fix this ASAP.', 'Tom Harris', '2006-06-18 23:41:51 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2334, '38713', '7', 'This bug is related to bad version of jstl.jar (for example old jstl and new\nstandard.jar)', 'mariuszs', '2006-07-13 20:02:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2335, '38713', '8', 'This bug took a while to track down. I ended up changing the \'fork\' parameter to\ntrue in the web.xml under Jasper <servlet-name>jsp</servlet-name> for Apache\nTomcat 5.5.17. My best guess is the problem must occur by sharing the JVM. When\nthe JVM is forked into two processes we no longer have the problem of sharing\nfiles (ie, trying to rename a file while it\'s in use). I hope this helps someone\nelse because I stared at this for quite some time.\n\nThanks,\n  Ron Ledwich', 'Ron Ledwich', '2006-07-13 21:52:04 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2336, '38713', '9', 'Thanks very much Ron Ledwich!  Your advice worked and saved me a lot of time!\n\nSincerely,\nJava Man\n\n(In reply to  comment #8 )\n> This bug took a while to track down. I ended up changing the \'fork\' parameter to\n> true in the web.xml under Jasper <servlet-name>jsp</servlet-name> for Apache\n> Tomcat 5.5.17. My best guess is the problem must occur by sharing the JVM. When\n> the JVM is forked into two processes we no longer have the problem of sharing\n> files (ie, trying to rename a file while it\'s in use). I hope this helps someone\n> else because I stared at this for quite some time.\n> \n> Thanks,\n>   Ron Ledwich\n\n', 'bugmenot', '2006-09-01 23:37:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2337, '38713', '10', 'I have the same problem using tomcat bundled with JBoss 4.0.4. fork=true did not\nsolve the problem for me.', 'bugmenot', '2006-09-05 10:54:57 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2338, '38713', '11', '(In reply to  comment #4 )\n\n> I have seen this problem where the jsp does NOT have any code that throws a\n> FileNotFoundException. I do not believe this is the source of the problem.\n\nIt may not be obvious. Our code would include markup from a different server via\nHTTPUrlConnection. A 404 on the target is translated into a\nFileNotFoundException. 404s, FNF and compilation problems are clearly correlated\nin our case.\n\nI\'ve looked at the synchronization code for JSP compilation before and a small\npatch won\'t do, I\'m afraid.', 'Matthias Ernst', '2006-09-21 07:21:58 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2339, '38713', '12', 'Updating version to 5.5.17, the latest reported, and severity to normal.  If\nanyone can post attach a simple test WAR file to this Bugzilla page that will\nlet us reproduce the issue, that\'d be awesome.', 'Yoav Shapira', '2006-12-26 06:49:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2340, '38713', '13', 'It happens also in 5.5.20\nIn our case it happens with jsp:include though I am not sure it is related.', 'danny', '2007-01-31 08:45:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2341, '38713', '14', 'Hi all - in XP the reason this was happening for us was because the overall file\npath of the file with an extension of .classtmp was > 256 characters long and\nthe rename would not work. We had the problem in tomcat within jboss, so\nrenaming the location of the jboss server to give us a filepath of <256 fixed\nthe problem.\n\n', 'Mark Baker', '2007-03-26 17:58:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2342, '38713', '15', '(In reply to  comment #14 )\n> Hi all - in XP the reason this was happening for us was because the overall file\n> path of the file with an extension of .classtmp was > 256 characters long and\n> the rename would not work. We had the problem in tomcat within jboss, so\n> renaming the location of the jboss server to give us a filepath of <256 fixed\n> the problem.\n> \n> \nThis was the solution for me running Tomcat 5.5.12 on WinXp with java 1.4.2_09\n\n', 'Olivier Vit', '2007-07-09 12:45:30 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2343, '38713', '16', 'I\'ve seen this sporadically over the years. Most recently with 5.5.23 on Win XP.\nIt\'s not readily reproducable at will, as it seems to depend on the timing of\nthings. My most recent cases were when my computer was responding very\nsluggishly due to having a lot of applications running sucking up lots of system\nresources (and probably a bit of page thrashing). The race condition during\ncompiling sounds convincing to me. FWIW, here\'s a portion of my stacktrace:\n\njava.io.IOException: tmpFile.renameTo(classFile) failed\n	at org.apache.jasper.compiler.SmapUtil$SDEInstaller.install(SmapUtil.java:246)\n	at org.apache.jasper.compiler.SmapUtil.installSmap(SmapUtil.java:165)\n	at org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:450)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:298)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)\n	at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n	at\norg.apache.jasper.servlet.JspServletWrapper.loadTagFile(JspServletWrapper.java:204)\n	at\norg.apache.jasper.compiler.TagFileProcessor.loadTagFile(TagFileProcessor.java:516)\n	at org.apache.jasper.compiler.TagFileProcessor.access$000(TagFileProcessor.java:49)\n	at\norg.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:567)\n	at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1442)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2164)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2214)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2325)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1186)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2164)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2214)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2325)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1186)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2164)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2214)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2325)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1186)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2164)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2214)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2325)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1186)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2164)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2214)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2345)\n	at org.apache.jasper.compiler.Node$JspBody.accept(Node.java:1896)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2164)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2214)\n	at\norg.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:571)\n	at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1442)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2164)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2214)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2225)\n	at org.apache.jasper.compiler.Node$JspRoot.accept(Node.java:526)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2164)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2214)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2220)\n	at org.apache.jasper.compiler.Node$Root.accept(Node.java:457)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2164)\n	at\norg.apache.jasper.compiler.TagFileProcessor.loadTagFiles(TagFileProcessor.java:585)\n	at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:179)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:296)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)\n	at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:299)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)', 'Eric J Schwarzenbach', '2007-08-24 14:47:17 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2344, '38713', '17', 'See  http://issues.apache.org/bugzilla/show_bug.cgi?id=2500 . \nDoes the fixing of  bug 2500  make this problem go away?', 'Jonathan Leech', '2008-01-29 09:08:11 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2345, '38713', '18', 'Hi,\nWe are getting the same error in our Web app which runs on sun one 7.0 web \nserver.\n\nIn our case, we have a jsp file that has a <%@include file= .. > to another \njsp file.\n\nWe can see the .classtmp file for this jsp in the web server. \nNone of the solutions given in this post have worked for us so far.\n\nHas anyone faced a similar situation with sun one before? Please suggest a way \nforward.', 'Ajit Pattanaik', '2008-02-19 02:56:08 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2346, '38713', '19', 'We are running on Windows but had the same scenario: a jsp file that has a\n<%@include file= .. > to another jsp file.\n\nIt seemed that one possibility was the JSPs being compiled in the wrong order.\nSo we created an ANT task that we run when we deploy the web app to the server.\nThe ANT task compiles all the .jsp files, except those included ones.\n\nFor the included files, we renamed them to a different extension .jspinc and\nthese are not precompiled individually, but they do get compiled inline with the\nfiles that include them.\n\n', 'Brian Campbell', '2008-02-19 08:48:20 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2347, '38713', '20', 'Hi Brian,\nThanks for replying.\nAs far as I can understand, you are precompiling the jsps before deploying. \nBut we depend on the server to compile them at run time. \nAlso, while looking into this issue, we found that when ever this error \noccurs, a file with an extension .classtmp exists in the work folder. \n\nAnd we have also found that when ever the size of the compiled servlet is \nbelow a particualr limit which is around 32KBs it is fine. But when the size \nexceeds this limit, we get the error.\n\nIs there any such limit to the sizes of the class files? if so, how can we \nremove this constraint? or is there any other way out? Will <%jsp:include> tag \nhelp?\n\n(In reply to  comment #19 )\n> We are running on Windows but had the same scenario: a jsp file that has a\n> <%@include file= .. > to another jsp file.\n> It seemed that one possibility was the JSPs being compiled in the wrong \norder.\n> So we created an ANT task that we run when we deploy the web app to the \nserver.\n> The ANT task compiles all the .jsp files, except those included ones.\n> For the included files, we renamed them to a different extension .jspinc and\n> these are not precompiled individually, but they do get compiled inline with \nthe\n> files that include them.\n\n', 'Ajit Pattanaik', '2008-02-19 21:32:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2348, '40306', '1', 'I\'ve also seen the following warning occasionaly showing up in catalina.out,\nhowever I do not know if it is related:\n\nWARN (org.apache.jk.core.MsgContext:295) - Error sending end packet\njava.net.SocketException: Broken pipe\n        at java.net.SocketOutputStream.socketWrite0(Native Method)\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n        at org.apache.jk.common.ChannelSocket.send(ChannelSocket.java:518)\n        at org.apache.jk.common.JkInputStream.endMessage(JkInputStream.java:112)\n        at org.apache.jk.core.MsgContext.action(MsgContext.java:293)\n        at org.apache.coyote.Response.action(Response.java:182)\n        at org.apache.coyote.Response.finish(Response.java:304)\n        at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:204)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:282)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:754)\n        at\norg.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:684)\n        at\norg.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:876)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)', 'Aaron Loucks', '2006-08-25 18:39:22 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2349, '40306', '2', 'After going over this again, body.toString() wasn\'t returning null after all,\nbut the POST parameter values were still missing. I debugged the coyoteRequest\nand noticed that the contentLength was equal to -1 upon entering the\nrestoreRequest() method of FormAuthenticator when going over the http connector\n(8080). When going over AJP it was set to 0. \n\nThis causes a problem in\norg.apache.catalina.connector.Request.parseParameters(). Before attempting to to\nfind POST parameters, it calls org.apache.coyote.Request.getContentLength()\nwhich doesn\'t look at the content-length header when the current value of\ncontentLength > -1. Being that the current value equals 0, no parameters were\nparsed.  \n\nAt any rate, the following code fixes the problem.\n\norg.apache.coyote.ajp.AjpAprProcessor.java (5.5.16), starting at line 579:\n\n        } else if (actionCode == ActionCode.ACTION_REQ_SET_BODY_REPLAY) {\n\n            // Reset the content length on the saved request.\n            request.setContentLength(-1);\n            // Set the given bytes as the content\n            ByteChunk bc = (ByteChunk) param;\n            bodyBytes.setBytes(bc.getBytes(), bc.getStart(), bc.getLength());\n            first = false;\n            empty = false;\n            replay = true;\n\n        }\n \nI would greatly appreciate it if a commiter would take a look at this.', 'Aaron Loucks', '2006-08-27 05:14:49 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2350, '40306', '3', 'Created  attachment 18755   [details] \najp/jk connector patch\n\nResets the contentLength to -1 on the request so that future calls to\nRequest.getContentLengthLong() will examine the \'content-length\' header and\nreturn the actual content length. \n\nThis occurs when a SavedRequest is restored\n(ActionCode.ACTION_REQ_SET_BODY_REPLAY). \n\nWithout resetting this value, the current contentLength equals 0 and POST\nparameters are never parsed on the restored SavedRequest.\n\nconnectors/jk/java/org/apache/jk/core/MsgContext.java\nconnectors/jk/java/org/apache/coyote/ajp/AjpAprProcessor.java', 'Aaron Loucks', '2006-08-27 21:30:18 UTC', 'tomcat_attachment/attachment 18755.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2351, '40306', '4', 'Comment on  attachment 18755   [details] \najp/jk connector patch\n\nthe patch was created using the SVN trunk.', 'Aaron Loucks', '2006-08-27 21:32:28 UTC', 'tomcat_attachment/attachment 18755.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2352, '40306', '5', 'Actually, the HTTP connector sets the content length of the request to the saved\nbody length (which is the right thing to do), although it is a bit hidden.', 'Remy Maucherat', '2006-08-28 00:32:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2353, '34801', '1', 'Created  attachment 14964   [details] \nThis patch adds IOException trapping to CGIServlet, to ensure process termination. It also adds a watchdog timer to kill off the CGI Process after a configurable timeout.', 'chris_j_davey', '2005-05-08 06:49:21 UTC', 'tomcat_attachment/attachment 14964.txt');
INSERT INTO `tomcatbeforefixcomments` VALUES (2354, '34801', '2', 'changing component.', 'william.barker', '2006-04-17 01:13:54 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2355, '34801', '3', 'I have applied the IOException part of the patch but left the watchdog element\nfor future consideration. I have changed the severity and summary accordingly.\n', 'Mark Thomas', '2006-07-22 00:35:25 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2356, '34801', '4', 'My vote is -0 on the timeout.  Mark, if you feel like doing this, great, I won\'t\nstand in the way.  But if not, let\'s close this Bugzilla issue.', 'Yoav Shapira', '2007-03-25 13:52:29 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2357, '39699', '1', 'same here for me with 5.5.17 on Linux. Same setup on the webapp side used to\nwork find in 5.5.12.', 'Haroon Rafique', '2006-06-01 19:30:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2358, '39699', '2', '(In reply to  comment #1 )\n> same here for me with 5.5.17 on Linux. Same setup on the webapp side used to\n> work find in 5.5.12.\n\ndid you tried with 5.5.16 ?', 'Christophe Yayon', '2006-06-02 05:48:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2359, '39699', '3', 'It seems that you have a log4j classloader issuse.\n\nI hope you only have a log4j jar and commons-logging inside you app and not at common/lib.\n\nTest it with 5.5.17 again.', 'Peter Rossbach', '2006-06-02 06:12:28 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2360, '39699', '4', '(In reply to  comment #3 )\n> It seems that you have a log4j classloader issuse.\n> \n> I hope you only have a log4j jar and commons-logging inside you app and not at\ncommon/lib.\n> \n> Test it with 5.5.17 again.\n\nsame isusue after removing commons-logging and log4j (renamed log4j.jar ->\nlog4j.jar.not and the same for commons-logging.jar) in common/lib (i use log4j\nto log tomcat message, not only in webapps...\n\nany idea ?', 'Christophe Yayon', '2006-06-02 08:20:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2361, '39699', '5', '(In reply to  comment #2 )\n\n> \n> did you tried with 5.5.16 ?\n\n\nno, I haven\'t.', 'Haroon Rafique', '2006-06-02 11:24:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2362, '39699', '6', '(In reply to  comment #3 )\n> It seems that you have a log4j classloader issuse.\n> \n> I hope you only have a log4j jar and commons-logging inside you app and not at\ncommon/lib.\n> \n> Test it with 5.5.17 again.\n\nJust as  comment 4 , I as well took out log4j and commons-logging from  common/lib\nand got the same behavior as before. As Christophe mentioned in  comment 0 , the\nredeploy works fine if the <Cluster> element is commented out.', 'Haroon Rafique', '2006-06-02 11:26:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2363, '39699', '7', '(In reply to  comment #4 )\n\n> \n> i use log4j to log tomcat message, not only in webapps...\n> \n\nI use log4j for the same purpose.\n', 'Haroon Rafique', '2006-06-02 11:27:59 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2364, '39699', '8', '(In reply to  comment #7 )\n> (In reply to  comment #4 )\n> \n> > \n> > i use log4j to log tomcat message, not only in webapps...\n> > \n> \n> I use log4j for the same purpose.\n> \n\ngot the same in 5.5.16...\ndo you know where can i found 5.5.12 ?\n\nthanks in advance.', 'Christophe Yayon', '2006-06-02 12:07:33 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2365, '39699', '9', '(In reply to  comment #8 )\n> \n> got the same in 5.5.16...\n> do you know where can i found 5.5.12 ?\n> \n> thanks in advance.\n\nTry:\n http://archive.apache.org/dist/jakarta/tomcat-5/v5.5.12/bin/ ', 'Haroon Rafique', '2006-06-02 12:12:39 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2366, '39699', '10', '(In reply to  comment #9 )\n> (In reply to  comment #8 )\n> > \n> > got the same in 5.5.16...\n> > do you know where can i found 5.5.12 ?\n> > \n> > thanks in advance.\n> \n> Try:\n>  http://archive.apache.org/dist/jakarta/tomcat-5/v5.5.12/bin/ \nthanks.\n\nOk, i just tried with 5.5.12 it\'s ok, no issue...\ni have also tried with others versions :\n\n5.5.12 : ok\n5.5.13 : BUG\n5.5.16 : BUG\n5.5.17 : BUG \n\nit appears that there was a change from 5.5.13 ...\n', 'Christophe Yayon', '2006-06-02 13:24:34 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2367, '39699', '11', '(In reply to  comment #10 )\n> \n> Ok, i just tried with 5.5.12 it\'s ok, no issue...\n> i have also tried with others versions :\n> \n> 5.5.12 : ok\n> 5.5.13 : BUG\n> 5.5.16 : BUG\n> 5.5.17 : BUG \n> \n> it appears that there was a change from 5.5.13 ...\n> \n\nI have 5.5.12 in production with no problems. And yes, 5.5.13 causes the bug to\nappear for me as well. So, something changed from 5.5.12 -> 5.5.13. Time to look\nat the changelog for 5.5.13.', 'Haroon Rafique', '2006-06-02 13:48:37 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2368, '39699', '12', '(In reply to  comment #11 )\n> \n> I have 5.5.12 in production with no problems. And yes, 5.5.13 causes the bug to\n> appear for me as well. So, something changed from 5.5.12 -> 5.5.13. Time to look\n> at the changelog for 5.5.13.\n\nI didn\'t see anything in the 5.5.13 changelog (with my untrained eye). However,\nthis discussion seems to be similar.\n\n http://www.nabble.com/RE%3A-Tomcat-5.5.15-Context-Reloading-issue-t1123634.html#a3010048 \n\nRémy?\n\nIn that thread Rémy says:\n\n    I added some code to null out certain instances, and your shared log4j\n    setup doesn\'t like it (at least it\'s a likely possibility). Try to use\n    a JNDI based log4j setup (or similar, using one logging namespace for\n    all webapps is not clean), or don\'t share it. \n\nWould it be possible to see where is the code which nulls out certain instances??\n\nThe precursor the above thread is at:\n http://www.nabble.com/Tomcat-5.5.15-Context-Reloading-issue-t1076386.html#a2955863 \n\nBe aware that in  comment 4  and  comment 6 , both Christophe and I have reported\nthat even with nothing in common/lib (no log4j.jar, no commons-logging.jar), we\nstill get the bug. The only log4j.jar and commons-logging.jar is the one present\nin WEB-INF/lib of the webapp. So, more than likely the \'shared log4j\' setup is\nnot the culprit.', 'Haroon Rafique', '2006-06-02 14:15:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2369, '39699', '13', '(In reply to  comment #12 )\n> (In reply to  comment #11 )\n> > \n> > I have 5.5.12 in production with no problems. And yes, 5.5.13 causes the bug to\n> > appear for me as well. So, something changed from 5.5.12 -> 5.5.13. Time to look\n> > at the changelog for 5.5.13.\n> \n> I didn\'t see anything in the 5.5.13 changelog (with my untrained eye). However,\n> this discussion seems to be similar.\n> \n>\n http://www.nabble.com/RE%3A-Tomcat-5.5.15-Context-Reloading-issue-t1123634.html#a3010048 \n> \n> Rémy?\n> \n> In that thread Rémy says:\n> \n>     I added some code to null out certain instances, and your shared log4j\n>     setup doesn\'t like it (at least it\'s a likely possibility). Try to use\n>     a JNDI based log4j setup (or similar, using one logging namespace for\n>     all webapps is not clean), or don\'t share it. \n> \n> Would it be possible to see where is the code which nulls out certain instances??\n> \n> The precursor the above thread is at:\n>  http://www.nabble.com/Tomcat-5.5.15-Context-Reloading-issue-t1076386.html#a2955863 \n> \n> Be aware that in  comment 4  and  comment 6 , both Christophe and I have reported\n> that even with nothing in common/lib (no log4j.jar, no commons-logging.jar), we\n> still get the bug. The only log4j.jar and commons-logging.jar is the one present\n> in WEB-INF/lib of the webapp. So, more than likely the \'shared log4j\' setup is\n> not the culprit.\n\n\n\nin 5.5.12, deploy is ok, but i get this recurrent error in log :\n----------------------\n ERROR org.apache.catalina.cluster.tcp.TcpReplicationThread[3]\norg.apache.catalina.cluster.tcp.TcpReplicationThread -\n TCP Worker thread in cluster caught \'java.io.IOException: Connection reset by\npeer\' closing channel\n java.io.IOException: Connection reset by peer\n        at sun.nio.ch.FileDispatcher.read0(Native Method)\n        at sun.nio.ch.SocketDispatcher.read(Unknown Source)\n        at sun.nio.ch.IOUtil.readIntoNativeBuffer(Unknown Source)\n        at sun.nio.ch.IOUtil.read(Unknown Source)\n        at sun.nio.ch.SocketChannelImpl.read(Unknown Source)\n        at\norg.apache.catalina.cluster.tcp.TcpReplicationThread.drainChannel(TcpReplicationThread.java:125)\n        at\norg.apache.catalina.cluster.tcp.TcpReplicationThread.run(TcpReplicationThread.java:69)\nERROR org.apache.catalina.cluster.tcp.TcpReplicationThread[3]\norg.apache.catalina.cluster.tcp.TcpReplicationThread -\nTCP Worker thread in cluster caught \'java.io.IOException: Connection reset by\npeer\' closing channel\n java.io.IOException: Connection reset by peer\n        at sun.nio.ch.FileDispatcher.read0(Native Method)\n        at sun.nio.ch.SocketDispatcher.read(Unknown Source)\n        at sun.nio.ch.IOUtil.readIntoNativeBuffer(Unknown Source)\n        at sun.nio.ch.IOUtil.read(Unknown Source)\n        at sun.nio.ch.SocketChannelImpl.read(Unknown Source)\n        at\norg.apache.catalina.cluster.tcp.TcpReplicationThread.drainChannel(TcpReplicationThread.java:125)\n        at\norg.apache.catalina.cluster.tcp.TcpReplicationThread.run(TcpReplicationThread.java:69)\n--------------------', 'Christophe Yayon', '2006-06-02 14:25:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2370, '39699', '14', '(In reply to  comment #13 )\n> \n> \n> in 5.5.12, deploy is ok, but i get this recurrent error in log :\n>\n\nThat looks like  bug 38788 , so its a separate issue.', 'Haroon Rafique', '2006-06-02 14:42:40 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2371, '39699', '15', '(In reply to  comment #14 )\n> (In reply to  comment #13 )\n> > \n> > \n> > in 5.5.12, deploy is ok, but i get this recurrent error in log :\n> >\n> \n> That looks like  bug 38788 , so its a separate issue.\n\nok...\ni didn\'t know...', 'Christophe Yayon', '2006-06-02 18:24:31 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2372, '39699', '16', 'please attach a test case, that way we can get the facts and fix it more promptly.', 'Filip Hanik', '2006-06-02 21:55:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2373, '39699', '17', '(In reply to  comment #16 )\n> please attach a test case, that way we can get the facts and fix it more promptly.\n\nsorry, but what do you mean with a \'test case\'?\n\nYou can reproduce the problem with the server.xml in my first post (a simple\ncluster configuration is sufficient (<SimpleTcpCluster line only is sufficient)\nand try to deploy with html manager or copy a war to your webapps (with\nautodeploy enabled of course). \n\n', 'Christophe Yayon', '2006-06-03 07:39:18 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2374, '39699', '18', 'test case, meaning maybe a zip containing your config files, any modifications\nthat you have made two tomcat, ie, added in log4j etc.\n\nie, can you get us detailed instructions on how to exactly reproduce your\nproblem. just saying that deploy an app and it breaks, it simply not sufficient,\nas our apps are deploying.', 'Filip Hanik', '2006-06-03 15:42:03 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2375, '39699', '19', '(In reply to  comment #18 )\n> test case, meaning maybe a zip containing your config files, any modifications\n> that you have made two tomcat, ie, added in log4j etc.\n> \n> ie, can you get us detailed instructions on how to exactly reproduce your\n> problem. just saying that deploy an app and it breaks, it simply not sufficient,\n> as our apps are deploying.\n\nI have made some progress with a \'simple\' test case. Here are the steps:\n\n1) download vanilla tomcat .tar.gz (5.5.17)\n2) tar xzvf /home/haroon/src/dist/apache-tomcat-5.5.17.tar.gz\n3) cd apache-tomcat-5.5.17/conf/\n4) edit server.xml to uncomment the <Cluster> config (leave everything else as is)\n5) edit tomcat-users.xml so that you have a username/password with role \'manager\'\n6) cd ../bin\n7) ./startup.sh\n8) After tomcat starts up, deploy testcase by copying\nservlets-examples-cluster-node1.war to ../webapps (I will attach .war file in\nnext comment)\n9) context deploys fine\n10) go to  http://localhost:8080/manager/html/list  in your browser\n11) Watch your catalina.out as you click on Reload for\nservlets-examples-cluster-node1 and get the error.\n\nQuestions?\n', 'Haroon Rafique', '2006-06-05 20:57:19 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2376, '39699', '20', 'Created  attachment 18406   [details] \ntestcase describing cluster related reload of distributable webapps which contain log4j', 'Haroon Rafique', '2006-06-05 20:58:49 UTC', 'tomcat_attachment/attachment 18406');
INSERT INTO `tomcatbeforefixcomments` VALUES (2377, '39699', '21', '(In reply to  comment #20 )\n\n> testcase describing cluster related reload of distributable webapps which\n> contain log4j\n> \n\nTo give you some information about how I created this \'sample testcase\' app.\n\n* I obtained the file from\n http://opensource.atlassian.com/confluence/oss/pages/viewpageattachments.action?pageId=2578 \nwhich is a page for listing the attachments for the wiki article at:\n http://opensource.atlassian.com/confluence/oss/display/GERONIMO/Geronimo+Clustering+Example \n\n* After that I added a simple log4j.properties in WEB-INF/classes\n\n---begin-----\n# This is the configuration for logging displayed in the Application Server\nlog4j.rootLogger=INFO, stdout\n\nlog4j.appender.stdout=org.apache.log4j.ConsoleAppender\nlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout\n\n# Pattern to output the caller\'s file name and line number.\nlog4j.appender.stdout.layout.ConversionPattern=%d{ISO8601} %p [%t] %C{1}.%M(%L)\n|%m%n\n-----cut-----\n\n* copied commons-logging.jar (I think 1.0.4) and log4j-1.2.13.jar in WEB-INF/lib\n\nThat is the exact jar that you see in the attachment in the previous comment.', 'Haroon Rafique', '2006-06-05 21:03:10 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2378, '39699', '22', '(In reply to  comment #21 )\n> \n> That is the exact jar that you see in the attachment in the previous comment.\n\noops... meant to say war file (instead of jar)', 'Haroon Rafique', '2006-06-05 21:04:06 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2379, '39699', '23', 'The issue is fairly obvious: the class uses a static logger (initialized with a\nrandom context class loader set) which is never reset, while it should be\nlogging to the log field inherited from ManagerBase.\n\n-> the solution is to remove:\n    public static org.apache.commons.logging.Log log =\norg.apache.commons.logging.LogFactory\n            .getLog(DeltaManager.class);\n', 'Remy Maucherat', '2006-06-08 12:35:44 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2380, '39699', '24', '(In reply to  comment #23 )\n> The issue is fairly obvious: the class uses a static logger (initialized with a\n> random context class loader set) which is never reset, while it should be\n> logging to the log field inherited from ManagerBase.\n> \n> -> the solution is to remove:\n>     public static org.apache.commons.logging.Log log =\n> org.apache.commons.logging.LogFactory\n>             .getLog(DeltaManager.class);\n> \n\nI tried that. The problem did not go away. Same as before:\n\nlog4j:ERROR Error occured while converting date.\njava.lang.NullPointerException\n    at java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:488)\n    at java.lang.StringBuffer.append(StringBuffer.java:302)\n    at org.apache.log4j.helpers.ISO8601DateFormat.format(ISO8601DateFormat.java:132)\n    at java.text.DateFormat.format(DateFormat.java:314)\n    at\norg.apache.log4j.helpers.PatternParser$DatePatternConverter.convert(PatternParser.java:444)\n    at org.apache.log4j.helpers.PatternConverter.format(PatternConverter.java:64)\n    at org.apache.log4j.PatternLayout.format(PatternLayout.java:503)\n    at org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:301)\n    at org.apache.log4j.WriterAppender.append(WriterAppender.java:159)\n    at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:230)\n    at\norg.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:65)\n    at org.apache.log4j.Category.callAppenders(Category.java:203)\n    at org.apache.log4j.Category.forcedLog(Category.java:388)\n    at org.apache.log4j.Category.log(Category.java:853)\n    at org.apache.commons.logging.impl.Log4JLogger.info(Log4JLogger.java:133)\n    at org.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:975)\n    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4137)\n    at org.apache.catalina.core.StandardContext.reload(StandardContext.java:2990)\n    at org.apache.catalina.manager.ManagerServlet.reload(ManagerServlet.java:906)\n    at\norg.apache.catalina.manager.HTMLManagerServlet.reload(HTMLManagerServlet.java:473)\n    at\norg.apache.catalina.manager.HTMLManagerServlet.doGet(HTMLManagerServlet.java:98)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n    at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n    at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n    at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n    at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n    at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:524)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n    at\norg.apache.catalina.cluster.tcp.ReplicationValve.invoke(ReplicationValve.java:346)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n    at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n    at\norg.apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:833)\n    at\norg.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:639)\n    at org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1285)\n    at java.lang.Thread.run(Thread.java:595)\nJun 8, 2006 9:55:08 AM org.apache.catalina.loader.WebappClassLoader loadClass\nINFO: Illegal access: this web application instance has been stopped already. \nCould not load org.apache.log4j.spi.VectorWriter.  The eventual following stack\ntrace is caused by an error thrown for debugging purposes as well as to attempt\nto terminate the thread which caused the illegal access, and has no functional\nimpact.\njava.lang.IllegalStateException\n    at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1238)\n    at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1198)\n    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n    at org.apache.log4j.spi.LoggingEvent.<init>(LoggingEvent.java:154)\n    at org.apache.log4j.Category.forcedLog(Category.java:388)\n    at org.apache.log4j.Category.log(Category.java:853)\n    at org.apache.commons.logging.impl.Log4JLogger.error(Log4JLogger.java:193)\n    at org.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:989)\n    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4137)\n    at org.apache.catalina.core.StandardContext.reload(StandardContext.java:2990)\n    at org.apache.catalina.manager.ManagerServlet.reload(ManagerServlet.java:906)\n    at\norg.apache.catalina.manager.HTMLManagerServlet.reload(HTMLManagerServlet.java:473)\n    at\norg.apache.catalina.manager.HTMLManagerServlet.doGet(HTMLManagerServlet.java:98)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n    at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n    at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n    at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n    at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n    at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:524)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n    at\norg.apache.catalina.cluster.tcp.ReplicationValve.invoke(ReplicationValve.java:346)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n    at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n    at\norg.apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:833)\n    at\norg.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:639)\n    at org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1285)\n    at java.lang.Thread.run(Thread.java:595)\nJun 8, 2006 9:55:08 AM org.apache.commons.modeler.Registry registerComponent\nSEVERE: Null component\nCatalina:type=JspMonitor,name=jsp,WebModule=//localhost/servlets-examples-cluster-node1,J2EEApplication=none,J2EEServer=none\n', 'Haroon Rafique', '2006-06-08 14:14:27 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2381, '39699', '25', '(In reply to  comment #24 )\n> \n> I tried that. The problem did not go away. Same as before:\n> \n\nPlease also remember that the first error talks about Error occured while\nconverting date and my log4j.appender.stdout.layout.ConversionPattern does have\n%d{ISO8601}. Is that date not available or null?', 'Haroon Rafique', '2006-06-08 14:16:38 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2382, '39699', '26', 'Ok, I just told that to help, and beyond that I don\'t care at all. My workaround\nmay not work for a simple reload, though.', 'Remy Maucherat', '2006-06-08 14:38:35 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2383, '39699', '27', 'I\'ll look into it today', 'Filip Hanik', '2006-06-08 14:59:05 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2384, '39699', '28', 'Ok, so my most likely better but still very similar workaround is to instantiate\nthe manager earlier.', 'Remy Maucherat', '2006-06-08 15:00:41 UTC', NULL);
INSERT INTO `tomcatbeforefixcomments` VALUES (2385, '39699', '29', 'Created  attachment 18431   [details] \nPatched version of 5.5.17 catalina-cluster.jar', 'Filip Hanik', '2006-06-08 16:54:54 UTC', 'tomcat_attachment/attachment 18431');

-- ----------------------------
-- Table structure for tomcatbody
-- ----------------------------
DROP TABLE IF EXISTS `tomcatbody`;
CREATE TABLE `tomcatbody`  (
  `id` int(0) NOT NULL AUTO_INCREMENT,
  `bug_id` char(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `Summary` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  `description` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  `description_name` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  `description_time` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  `attachment` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1056 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of tomcatbody
-- ----------------------------
INSERT INTO `tomcatbody` VALUES (1, '56029', 'Bug 56029 Ternary operator doesn\'t work as expected inside attributes in jspx pages', 'The following JSPX file worked upto Tomcat 7.0.47:\n\n<?xml version=\'1.0\' encoding=\'UTF-8\'?>\n<jsp:root xmlns:jsp=\' http://java.sun.com/JSP/Page \' version=\'2.1\'\n	xmlns:c=\' http://java.sun.com/jsp/jstl/core \' \n	xmlns:fmt=\' http://java.sun.com/jsp/jstl/fmt \'	\n>\n	<jsp:directive.page contentType=\'text/html; charset=utf-8\'  pageEncoding=\'UTF-8\' />\n	<jsp:directive.page session=\'false\' />\n	<jsp:output omit-xml-declaration=\'true\' />\n	<div>	\n		<span id=\'mainNavNews\' class=\'${currentController eq \'News\' ? \'selectedItem\' : \'\'}\'>foobar</span>	\n	</div>	\n</jsp:root>\n\nWith tomcat 7.0.50 it fails with the following exception:\n\norg.apache.jasper.JasperException: /WEB-INF/views/layouts/mainNavigation.jspx (line: 10, column: 87) \'${currentController eq \'News\' ? \'selectedItem\' : \'\'}\' contains invalid expression(s): javax.el.ELException: Failed to parse the expression [${currentControllereq\'News\'?\'selectedItem\':\'\'}]\n	at org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:42)\n	at org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:443)\n	at org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:199)\n	at org.apache.jasper.compiler.Validator$ValidateVisitor.getJspAttribute(Validator.java:1399)\n	at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:772)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1251)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2375)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2427)\n	at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:779)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1251)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2375)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2427)\n	at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:529)\n	at org.apache.jasper.compiler.Node$JspRoot.accept(Node.java:564)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2375)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2427)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2433)\n	at org.apache.jasper.compiler.Node$Root.accept(Node.java:474)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2375)\n	at org.apache.jasper.compiler.Validator.validateExDirectives(Validator.java:1817)\n	at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:217)\n	at org.apache.jasper.compiler.Compiler.__compile(Compiler.java:373)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:353)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:340)\n	at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:657)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:357)\n	at org.apache.jasper.servlet.JspServlet._serviceJspFile(JspServlet.java:390)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)\n\nIt works when the ternary operation doesn\'t appear inside an attribute or instead of eq \'==\' is used.', 'Michael Simons', '2014-01-18 12:42:47 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (2, '55943', 'Bug 55943 Provide a way prevent  looking at the System classloader before the webapp classloaders', 'I would like a way to prevent Tomcat from checking the System classloader before the webapp classloaders.  This would be useful when using the embedded Tomact API to produce isolated servlet containers.  \n\nI ran in to some difficulty with this when I was adding Tomcat support to the SBT (Simple Build Tool) plugin:  https://github.com/JamesEarlDouglas/xsbt-web-plugin \n\nIn particular I had an issue where SBT includes a version of the Scala standard library, on the system classpath, that has been run through Proguard.  This  was conflicting with web applications that were including their own version of the Scala standard library.  I was eventually able to work around this using this hack:  https://github.com/JamesEarlDouglas/xsbt-web-plugin/commit/f8a9b149f0c7c87d7b6e8f862c493841d82ad90a  However, it would be nice if there was a way to accomplish this that didn\'t involve such a hack.\n\nI would be happy to submit a patch for this.  However, I would like some guidence on how the API should be changed to accomplish this.  Perhaps a new flag on the WebappLoader class?\n\nThanks', 'chris.dow8', '2014-01-01 10:02:46 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (3, '55995', 'Bug 55995 java.lang.NullPointerException at org.apache.jasper.servlet.JspCServletContext.getResource(JspCServletContext.java:344)', 'Null pointer exception when running JSPC from a Shell Script.\n\nJspCServletContext.java:344\n    /**\n     * Return a URL object of a resource that is mapped to the\n     * specified context-relative path.\n     *\n     * @param path Context-relative path of the desired resource\n     *\n     * @exception MalformedURLException if the resource path is\n     *  not properly formed\n     */\n    @Override\n    public URL getResource(String path) throws MalformedURLException {\n\n        if (!path.startsWith(\'/\'))\n            throw new MalformedURLException(\'Path \'\' + path +\n                                            \'\' does not start with \'/\'\');\n\nTldCache.java:124\n\n    private long[] getLastModified(TldResourcePath tldResourcePath) {\n        long[] result = new long[2];\n        result[0] = -1;\n        result[1] = -1;\n        try {\n            URL url = servletContext.getResource(tldResourcePath.getWebappPath());\n\n\n/usr/java/jdk1.7.0_45/bin/java -classpath :/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-storeconfig.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-websocket.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-i18n-es.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-tribes.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-ha.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-i18n-ja.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/jsp-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-util.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-jni.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/jasper.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/websocket-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/ecj-4.3.1.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-i18n-fr.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-coyote.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/servlet-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/jasper-el.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-dbcp.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-jdbc.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/annotations-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-util-scan.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-ant.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/el-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-spdy.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/bin/tomcat-juli.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/bin/bootstrap.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/bin/commons-daemon.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/webapps/examples/WEB-INF/lib/jstl.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/webapps/examples/WEB-INF/lib/standard.jar:/home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/lib/ant-1.6.5.jar org.apache.jasper.JspC 	-d /home/java/source/HEAD/work/tomcat80 	-v 	-l 	-uriroot /home/java/source/HEAD/work/jsp_compile_shared /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/dialog/qbAxesDlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/dialog/qbManualGecodingDlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/fmtdlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/index.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/joindlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/producer.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/simplefilter.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/selectvaluedlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/binddowsTestView.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/variableeditordlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/filterprompteditor.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/ajax_response.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/fontdlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/join_fields.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/tree_component.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/waiting_banner.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/folderblock/BID_FolderBlockInit.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/folderblock/BID_FolderBlockBoot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/BID_EmptyContent.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_UrlProperties.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_IBFSpathToHrefs.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_xmlresponse.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_statusResponse.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_favorites_tree.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_FavoritesBlockBoot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_FavoritesBlockInit.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_favorites_tree_boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/index.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_InternalPage.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SearchTree_Boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SATree_Boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_BiFrame.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_initView.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_ShowToolbar.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_ExternalPage.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SATreeBiFrame.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_initBindows.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SearchTreeBiFrame.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/recents/BID_recents_tree_boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/recents/BID_recents_tree.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/recents/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/error.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/groups/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/search/BID_searchListToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/search/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_MrPropertiesToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_flatListToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_PlainText.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_listToXML.jsp	  2>&1\n	\n	\nException in thread \'main\' java.lang.NullPointerException\n	at org.apache.jasper.servlet.JspCServletContext.getResource(JspCServletContext.java:344)\n	at org.apache.jasper.compiler.TldCache.getLastModified(TldCache.java:124)\n	at org.apache.jasper.compiler.TldCache.<init>(TldCache.java:70)\n	at org.apache.jasper.JspC.initServletContext(JspC.java:1468)\n	at org.apache.jasper.JspC.execute(JspC.java:1321)\n	at org.apache.jasper.JspC.main(JspC.java:269)', 'Peter Lenahan', '2014-01-13 05:55:30 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (4, '55976', 'Bug 55976 Broken response from NIO connector in Tomcat 7.0.50', 'Tomcat 7.0.50 (proposed for voting at the time of submitting this issue) with Oracle Java 1.7.0_40 on Win7 64-bit, sometimes returns incorrect response when NIO connector is used.\n\nStart of the report, and steps to reproduce the problem are in this thread:\n\n   http://www.mail-archive.com/dev@tomcat.apache.org/msg80175.html \n\n-Ognjen', 'Ognjen Blagojevic', '2014-01-08 09:52:04 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (5, '55958', 'Bug 55958 Tomcat tries to deploy dir as zip archive even when it is a directory if the name ends with .war', 'Webapp deployment fails if the dirname ends with .war because it is automatically considered as zip archive.', 'Radim Hatlapatka', '2014-01-06 09:28:12 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (6, '55937', 'Bug 55937 Tomcat auto deployer not working for ROOT applications', 'Created  attachment 31162   [details] \ncatalina and localhost logs\n\nI am trying to deploy a web app as the ROOT application for Tomcat 7, running on Ubuntu 12 with Amazon EC2. I experienced the problem with 7.0.35, 7.0.42, and 7.0.49.\n\n1) When I use auto-deploy using the Tomcat Deployer \'deploy\' ant task to a non-ROOT context name, such as /360Site, everything works as expected - war file is uploaded, decompressed to directory, and is immediately available.\n\n2) When I use the manager HTML interface to upload the ROOT.war file by clicking the \'Select WAR file to upload\' and then clicking \'deploy\', everything works as expected.\n\nHowever, 3) When I do exactly the same thing as #1 (tomcat auto deploy) but just change the \'path\' variable from /360Store to /ROOT, here is what happens:\n* WAR file appears in the webapps directory, but does not get expanded.\n* The webapp is not running (I get a blank page when I go to the URL in the browser)\n* I see these entries in the catalina.<date>.log (after doing the auto-deploy:\n\n\nDec 27, 2013 3:34:03 PM org.apache.catalina.startup.HostConfig deleteRedeployResources\nINFO: Undeploying context []\nDec 27, 2013 3:34:03 PM org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc\nSEVERE: The web application [] registered the JDBC driver [com.mysql.jdbc.Driver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered.\nDec 27, 2013 3:34:03 PM org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive /var/lib/tomcat7/webapps/ROOT.war\nDec 27, 2013 3:34:04 PM org.apache.catalina.startup.ContextConfig init\nSEVERE: Exception fixing docBase for context []\njava.util.zip.ZipException: error in opening zip file\n	at java.util.zip.ZipFile.open(Native Method)\n	at java.util.zip.ZipFile.<init>(ZipFile.java:215)\n	at java.util.zip.ZipFile.<init>(ZipFile.java:145)\n	at java.util.jar.JarFile.<init>(JarFile.java:153)\n	at java.util.jar.JarFile.<init>(JarFile.java:90)\n	at sun.net.www.protocol.jar.URLJarFile.<init>(URLJarFile.java:93)\n	at sun.net.www.protocol.jar.URLJarFile.getJarFile(URLJarFile.java:69)\n	at sun.net.www.protocol.jar.JarFileFactory.get(JarFileFactory.java:88)\n	at sun.net.www.protocol.jar.JarURLConnection.connect(JarURLConnection.java:122)\n	at sun.net.www.protocol.jar.JarURLConnection.getJarFile(JarURLConnection.java:89)\n	at org.apache.catalina.startup.ExpandWar.expand(ExpandWar.java:113)\n	at org.apache.catalina.startup.ContextConfig.fixDocBase(ContextConfig.java:722)\n	at org.apache.catalina.startup.ContextConfig.init(ContextConfig.java:843)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:387)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n	at org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:402)\n	at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:110)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:139)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n	at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:983)\n	at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1660)\n	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n	at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:724)\n\nDec 27, 2013 3:34:04 PM org.apache.catalina.core.StandardContext resourcesStart\nSEVERE: Error starting static Resources\njava.lang.IllegalArgumentException: Invalid or unreadable WAR file : error in opening zip file\n	at org.apache.naming.resources.WARDirContext.setDocBase(WARDirContext.java:138)\n	at org.apache.catalina.core.StandardContext.resourcesStart(StandardContext.java:5055)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5235)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n	at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:983)\n	at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1660)\n	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n	at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:724)\n\nDec 27, 2013 3:34:04 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Error in resourceStart()\nDec 27, 2013 3:34:04 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Error getConfigured\nDec 27, 2013 3:34:04 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Context [] startup failed due to previous errors\nDec 27, 2013 3:34:14 PM org.apache.catalina.startup.HostConfig deleteRedeployResources\nINFO: Undeploying context []\nDec 27, 2013 3:34:14 PM org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive /var/lib/tomcat7/webapps/ROOT.war\nDec 27, 2013 3:34:14 PM org.apache.catalina.startup.ContextConfig init\nSEVERE: Exception fixing docBase for context []\njava.util.zip.ZipException: error in opening zip file\n	at java.util.zip.ZipFile.open(Native Method)\n	at java.util.zip.ZipFile.<init>(ZipFile.java:215)\n	at java.util.zip.ZipFile.<init>(ZipFile.java:145)\n	at java.util.jar.JarFile.<init>(JarFile.java:153)\n	at java.util.jar.JarFile.<init>(JarFile.java:90)\n	at sun.net.www.protocol.jar.URLJarFile.<init>(URLJarFile.java:93)\n	at sun.net.www.protocol.jar.URLJarFile.getJarFile(URLJarFile.java:69)\n	at sun.net.www.protocol.jar.JarFileFactory.get(JarFileFactory.java:88)\n	at sun.net.www.protocol.jar.JarURLConnection.connect(JarURLConnection.java:122)\n	at sun.net.www.protocol.jar.JarURLConnection.getJarFile(JarURLConnection.java:89)\n	at org.apache.catalina.startup.ExpandWar.expand(ExpandWar.java:113)\n	at org.apache.catalina.startup.ContextConfig.fixDocBase(ContextConfig.java:722)\n	at org.apache.catalina.startup.ContextConfig.init(ContextConfig.java:843)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:387)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n	at org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:402)\n	at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:110)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:139)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n	at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:983)\n	at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1660)\n	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n	at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:724)\n\nDec 27, 2013 3:34:14 PM org.apache.catalina.core.StandardContext resourcesStart\nSEVERE: Error starting static Resources\njava.lang.IllegalArgumentException: Invalid or unreadable WAR file : error in opening zip file\n	at org.apache.naming.resources.WARDirContext.setDocBase(WARDirContext.java:138)\n	at org.apache.catalina.core.StandardContext.resourcesStart(StandardContext.java:5055)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5235)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n	at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:983)\n	at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1660)\n	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n	at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:724)\n\nDec 27, 2013 3:34:14 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Error in resourceStart()\nDec 27, 2013 3:34:14 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Error getConfigured\nDec 27, 2013 3:34:14 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Context [] startup failed due to previous errors\nDec 27, 2013 3:34:21 PM org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive /var/lib/tomcat7/webapps/ROOT.war\nDec 27, 2013 3:34:21 PM org.apache.catalina.startup.HostConfig deployWAR\nSEVERE: Error deploying web application archive /var/lib/tomcat7/webapps/ROOT.war\njava.lang.IllegalArgumentException: addChild:  Child name \'\' is not unique\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:887)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n	at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:983)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:548)\n	at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1468)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:606)\n	at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:801)\n	at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1447)\n	at org.apache.catalina.manager.ManagerServlet.deploy(ManagerServlet.java:679)\n	at org.apache.catalina.manager.ManagerServlet.doPut(ManagerServlet.java:437)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:650)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:611)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:953)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1041)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:603)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:724)\n\n\n\n\n\n* After the auto-deploy fails, I can go into the HTML manager page and click the \'start\' button, and the webapp does successfully start (tested the URL in the browser), but the WAR file still does not get unpacked into a directory.\n\n\nDoing the exact same thing to a different server running Tomcat 6.0.24 works correctly as expected.\n\nAny ideas here? Here is what I\'ve ruled out so far:\n* I don\'t think it\'s a file permission issue (tomcat7 is the owner of the webapps directory, and everything works fine when run through the manager HTML interface).\n* The \'Child name \'\' is not unique\' sounded promising, but I could not find any duplicate ROOT webapps - there is no ROOT.war file or directory in the webapps directory prior to running the auto-deploy; there is no ROOT.xml file in the conf/Catalina/localhost directory, nor are there any context elements defined in the server.xml file.\n* I don\'t think that the .war file is corrupt - I can manually unzip the .war file in the webapps from the command line using the \'unzip\' command, and as I pointed out in #2 above, everything works fine when it is uploaded using the manager HTML interface.\n\nIf it would help to spin up a temporary new Ubuntu deployment and provide credentials to reproduce the problem, I\'d be happy to do that.', 'Jesse Barnum', '2013-12-27 15:41:22 UTC', 'tomcat_attachment/attachment 31162.zip');
INSERT INTO `tomcatbody` VALUES (7, '55884', 'Bug 55884 JSPs no longer compile in Java 8', 'I would normally message the list first, but I am fairly certain this is a Tomcat bug, and I can\'t attach anything to the list.\n\nI have attached a WAR file with a simple application in it, compiled for Java 7. A few months ago this application ran fine on Tomcat 8.0 with Tomcat configured to compile JSPs using Ant and source/target 1.8. Now it doesn\'t.\n\nWith Tomcat trunk and the standard JSP compilation configuration (Eclipse), the application runs fine. Go to  http://localhost:8080/messaging1  and the JSP compiles and displays fine. However, if I add the following setenv.bat to the bin directory:\n\nset \'CLASSPATH=C: Program Files Java jdk8 lib tools.jar;C: Program Files Apache Software Foundation Ant lib ant.jar;C: Program Files Apache Software Foundation Ant lib ant-launcher.jar\'\n\nThen reconfigure the JspServlet like so:\n\n    <servlet>\n        <servlet-name>jsp</servlet-name>\n        <servlet-class>org.apache.jasper.servlet.JspServlet</servlet-class>\n        <init-param>\n            <param-name>fork</param-name>\n            <param-value>false</param-value>\n        </init-param>\n        <init-param>\n            <param-name>xpoweredBy</param-name>\n            <param-value>false</param-value>\n        </init-param>\n        <init-param>\n            <param-name>compiler</param-name>\n            <param-value>modern</param-value>\n        </init-param>\n        <init-param>\n            <param-name>compilerSourceVM</param-name>\n            <param-value>1.8</param-value>\n        </init-param>\n        <init-param>\n            <param-name>compilerTargetVM</param-name>\n            <param-value>1.8</param-value>\n        </init-param>\n        <load-on-startup>3</load-on-startup>\n    </servlet>\n\nAnd finally test the application again, JSPs no longer compile. Instead, I get the following error in catalina.*.log. Again, this exact application worked in Tomcat 8.0 with the same JSP compilation configuration just a few months ago. I recently got and compiled the latest trunk to obtain a bug fix, and now this doesn\'t work.\n\n14-Dec-2013 10:54:14.432 SEVERE [http-nio-8080-exec-4] org.apache.jasper.compiler.AntCompiler.generateClass Javac exception\n Compile failed; see the compiler error output for details.\n	at org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:1174)\n	at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:930)\n	at org.apache.jasper.compiler.AntCompiler.generateClass(AntCompiler.java:234)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:380)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:355)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:342)\n	at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:357)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:403)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:347)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\n	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\n	at org.apache.logging.log4j.core.web.Log4jServletFilter.doFilter(Log4jServletFilter.java:59)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:729)\n	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:467)\n	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:392)\n	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:319)\n	at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:209)\n	at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:266)\n	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1225)\n	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1012)\n	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:959)\n	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:876)\n	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:931)\n	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:822)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)\n	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:807)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\n	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\n	at org.apache.logging.log4j.core.web.Log4jServletFilter.doFilter(Log4jServletFilter.java:66)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:107)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:76)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:934)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:90)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:522)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1015)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:646)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1597)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1555)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n	at java.lang.Thread.run(Thread.java:744)\n\n14-Dec-2013 10:54:14.432 SEVERE [http-nio-8080-exec-4] org.apache.jasper.compiler.AntCompiler.generateClass Environment:Compile: javaFileName=C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost messaging1 org apache jsp WEB_002dINF jsp view login_jsp.java\n    classpath=/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/classes/;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/aopalliance-1.0.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/classmate-0.8.0.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/commons-lang3-3.1.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/commons-logging-1.1.1.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/hibernate-validator-5.1.0.Alpha1.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/jackson-annotations-2.3.0.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/jackson-core-2.3.0.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/jackson-databind-2.3.0.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/jackson-datatype-jsr310-2.3.0-rc1.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/javax.annotation-api-1.2.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/javax.inject-1.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/javax.servlet.jsp.jstl-1.2.2.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/javax.servlet.jsp.jstl-api-1.2.1.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/jboss-logging-3.1.3.GA.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/log4j-api-2.0-beta9.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/log4j-core-2.0-beta9.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/log4j-jcl-2.0-beta9.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/log4j-slf4j-impl-2.0-beta9.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/log4j-taglib-2.0-beta9.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/slf4j-api-1.7.5.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/spring-aop-4.0.0.RELEASE.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/spring-beans-4.0.0.RELEASE.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/spring-context-4.0.0.RELEASE.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/spring-core-4.0.0.RELEASE.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/spring-expression-4.0.0.RELEASE.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/spring-oxm-4.0.0.RELEASE.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/spring-web-4.0.0.RELEASE.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/spring-webmvc-4.0.0.RELEASE.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/spring-websocket-4.0.0.RELEASE.jar;/C:/Program%20Files/Apache%20Software%20Foundation/Tomcat%208.0/webapps/messaging1/WEB-INF/lib/validation-api-1.1.0.Final.jar;C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost messaging1;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/annotations-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina-ant.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina-ha.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina-storeconfig.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina-tribes.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/catalina.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/ecj-4.3.1.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/el-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/jasper-el.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/jasper.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/jsp-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/servlet-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-api.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-coyote.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-dbcp.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-i18n-es.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-i18n-fr.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-i18n-ja.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-jdbc.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-jni.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-spdy.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-util-scan.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-util.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/tomcat-websocket.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/lib/websocket-api.jar;/C:/Program Files/Java/jdk8/lib/tools.jar;/C:/Program Files/Apache Software Foundation/Ant/lib/ant.jar;/C:/Program Files/Apache Software Foundation/Ant/lib/ant-launcher.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/bin/bootstrap.jar;/C:/Program Files/Apache Software Foundation/Tomcat 8.0/bin/tomcat-juli.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/access-bridge-64.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/cldrdata.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/dnsns.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/jaccess.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/jfxrt.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/localedata.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/nashorn.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/sunec.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/sunjce_provider.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/sunmscapi.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/sunpkcs11.jar;/C:/Program Files/Java/jdk8/jre/lib/ext/zipfs.jar\n    cp=C: Program Files Java jdk8 lib tools.jar;C: Program Files Apache Software Foundation Ant lib ant.jar;C: Program Files Apache Software Foundation Ant lib ant-launcher.jar;C: Program Files Apache Software Foundation Tomcat 8.0 bin bootstrap.jar;C: Program Files Apache Software Foundation Tomcat 8.0 bin tomcat-juli.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF classes\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib aopalliance-1.0.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib classmate-0.8.0.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib commons-lang3-3.1.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib commons-logging-1.1.1.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib hibernate-validator-5.1.0.Alpha1.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib jackson-annotations-2.3.0.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib jackson-core-2.3.0.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib jackson-databind-2.3.0.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib jackson-datatype-jsr310-2.3.0-rc1.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib javax.annotation-api-1.2.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib javax.inject-1.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib javax.servlet.jsp.jstl-1.2.2.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib javax.servlet.jsp.jstl-api-1.2.1.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib jboss-logging-3.1.3.GA.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib log4j-api-2.0-beta9.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib log4j-core-2.0-beta9.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib log4j-jcl-2.0-beta9.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib log4j-slf4j-impl-2.0-beta9.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib log4j-taglib-2.0-beta9.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib slf4j-api-1.7.5.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib spring-aop-4.0.0.RELEASE.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib spring-beans-4.0.0.RELEASE.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib spring-context-4.0.0.RELEASE.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib spring-core-4.0.0.RELEASE.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib spring-expression-4.0.0.RELEASE.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib spring-oxm-4.0.0.RELEASE.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib spring-web-4.0.0.RELEASE.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib spring-webmvc-4.0.0.RELEASE.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib spring-websocket-4.0.0.RELEASE.jar\n    cp=C: Program%20Files Apache%20Software%20Foundation Tomcat%208.0 webapps messaging1 WEB-INF lib validation-api-1.1.0.Final.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost messaging1\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib annotations-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina-ant.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina-ha.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina-storeconfig.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina-tribes.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib catalina.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib ecj-4.3.1.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib el-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib jasper-el.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib jasper.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib jsp-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib servlet-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-api.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-coyote.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-dbcp.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-i18n-es.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-i18n-fr.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-i18n-ja.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-jdbc.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-jni.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-spdy.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-util-scan.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-util.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib tomcat-websocket.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 lib websocket-api.jar\n    cp=C: Program Files Java jdk8 lib tools.jar\n    cp=C: Program Files Apache Software Foundation Ant lib ant.jar\n    cp=C: Program Files Apache Software Foundation Ant lib ant-launcher.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 bin bootstrap.jar\n    cp=C: Program Files Apache Software Foundation Tomcat 8.0 bin tomcat-juli.jar\n    cp=C: Program Files Java jdk8 jre lib ext access-bridge-64.jar\n    cp=C: Program Files Java jdk8 jre lib ext cldrdata.jar\n    cp=C: Program Files Java jdk8 jre lib ext dnsns.jar\n    cp=C: Program Files Java jdk8 jre lib ext jaccess.jar\n    cp=C: Program Files Java jdk8 jre lib ext jfxrt.jar\n    cp=C: Program Files Java jdk8 jre lib ext localedata.jar\n    cp=C: Program Files Java jdk8 jre lib ext nashorn.jar\n    cp=C: Program Files Java jdk8 jre lib ext sunec.jar\n    cp=C: Program Files Java jdk8 jre lib ext sunjce_provider.jar\n    cp=C: Program Files Java jdk8 jre lib ext sunmscapi.jar\n    cp=C: Program Files Java jdk8 jre lib ext sunpkcs11.jar\n    cp=C: Program Files Java jdk8 jre lib ext zipfs.jar\n    work dir=C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost messaging1\n    extension dir=C: Program Files Java jdk8 jre lib ext;C: Windows Sun Java lib ext\n    srcDir=C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost messaging1\n    compiler=modern\n   compilerTargetVM=1.8\n   compilerSourceVM=1.8\n    include=org/apache/jsp/WEB_002dINF/jsp/view/login_jsp.java\n\n14-Dec-2013 10:54:14.448 SEVERE [http-nio-8080-exec-4] org.apache.jasper.compiler.AntCompiler.generateClass Error compiling file: C: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost messaging1 org apache jsp WEB_002dINF jsp view login_jsp.java     [javac] warning: \'includeantruntime\' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds\n    [javac] Compiling 1 source file\n\nC: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost messaging1 org apache jsp WEB_002dINF jsp view login_jsp.java:108: error: package org.apache.taglibs.standard.tag.rt.core does not exist\n    org.apache.taglibs.standard.tag.rt.core.UrlTag _jspx_th_c_005furl_005f0 = (org.apache.taglibs.standard.tag.rt.core.UrlTag) _005fjspx_005ftagPool_005fc_005furl_0026_005fvalue_005fnobody.get(org.apache.taglibs.standard.tag.rt.core.UrlTag.class);\n                                           ^\nC: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost messaging1 org apache jsp WEB_002dINF jsp view login_jsp.java:108: error: package org.apache.taglibs.standard.tag.rt.core does not exist\n    org.apache.taglibs.standard.tag.rt.core.UrlTag _jspx_th_c_005furl_005f0 = (org.apache.taglibs.standard.tag.rt.core.UrlTag) _005fjspx_005ftagPool_005fc_005furl_0026_005fvalue_005fnobody.get(org.apache.taglibs.standard.tag.rt.core.UrlTag.class);\n                                                                                                                      ^\nC: Program Files Apache Software Foundation Tomcat 8.0 work Catalina localhost messaging1 org apache jsp WEB_002dINF jsp view login_jsp.java:108: error: package org.apache.taglibs.standard.tag.rt.core does not exist\n    org.apache.taglibs.standard.tag.rt.core.UrlTag _jspx_th_c_005furl_005f0 = (org.apache.taglibs.standard.tag.rt.core.UrlTag) _005fjspx_005ftagPool_005fc_005furl_0026_005fvalue_005fnobody.get(org.apache.taglibs.standard.tag.rt.core.UrlTag.class);\n                                                                                                                                                                                                                                        ^\n3 errors', 'Nick Williams', '2013-12-14 17:03:59 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (8, '55801', 'Bug 55801 Add ability to provide custom SSLContext for websocket client', 'Created  attachment 31059   [details] \nProposed patch\n\nCurrently the only available customisation is setting trust store via SSL_TRUSTSTORE_PROPERTY. This is not enough in situations where custom trust manager has to be used. The most trivial example I can think of is accepting all certificates.\n\nMy proposition is to use new property to pass SSLContext using user properties of ClientEndpointConfig.\n\nAttached is a proposed patch to add this capability.', 'Maciej Lypik', '2013-11-20 09:57:24 UTC', 'tomcat_attachment/attachment 31059.txt');
INSERT INTO `tomcatbody` VALUES (9, '55842', 'Bug 55842 response.setBufferSize() does not seem to work properly', 'I found a problem with setting the buffer size for the ServletResponse. \nIf I call \'response.setBufferSize(1,000,000);\' and send about 20,000 characters, the response will be chunked even though it should not.\nThe response is sent in several chunks and contains the \'Transfer-Encoding: chunked\' response header.\nIn my understanding in this case the response should be fully buffered on the server and then sent as a whole containing the Content-Length-header.\n\nThis causes a problem in my application because I want to use a larger buffer to be able to redirect to an error page if an error occurs during rendering the response. \n\nI was able to reproduce this on Tomcat 7.0.39, 7.0.40, 7.0.42, 7.0.47. Tomcat 7.0.37 works fine and as expected.\n\nThis is easily reproducable by using a JSP as follows:\n<%\nresponse.setBufferSize(1000*1000);\nfor (int i = 0; i < 100; i++) {\n	for (int j = 0; j < 100; j++) {\n		response.getWriter().write(\'X\');\n	}\n    response.getWriter().write(\'<br />\');\n}\n%>', 'Martin Maier-Moessner', '2013-12-04 15:56:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (10, '55837', 'Bug 55837 ServletContext.getRealPath() returns null', '[code]\nString path = servletContext.getRealPath(\'/test\');\n\nif no file or folder named \'/test\' exist in webroot \nthen path return null\n\nbut int tomcat 5 6 7, it will return the correct value , ex /data/oschina/webapp/test', 'oschina.net', '2013-12-03 08:03:13 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (11, '55804', 'Bug 55804 SPNEGOAUTHENTICATOR - GSSCredential does not get renewed after RemainingLifeTime is less than zero', 'In SpnegoAuthenticator, we check for request.getUserPrincipal() if it returns a prinicpal we do not do a fresh authentication. This happens even when the GSSCredential returned by GenericPrincipal has remainingLife time less than zero. This causes issues in delegating the credential as the credential is not valid any more.\n\nCan we add additional check to reauthenticate when the credental has expired and put GSSCredential in the same session?', 'Sachin Kumar', '2013-11-20 19:23:11 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (12, '55798', 'Bug 55798 Enabling Manager App - process and description is inadequate', '', 'BJ Chippindale', '2013-11-19 23:03:23 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (13, '55776', 'Bug 55776 if path include relative char, eg: ../, classloader will not find zhe file', 'I use ibatis in my project, config file path include \'..\', tomcat can not find the file, command line show:\nCould not find resource ../ibatis/code/sendType.xml', 'LabnizDirac', '2013-11-14 06:14:50 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (14, '55760', 'Bug 55760 Tomcat SPNEGO authenticator incompatible with IBM JDK in case of Keytab based initiate and accept authentication', 'Hi\n\nOur company has a use case in which our domain is a tomcat process. In our code, we support a parallel protocol which uses In memory based jaas configuration - \n\npublic class OurLoginConfiguration extends Configuration\n\nIn IBM JDK 7, we need to initiate using keytab which needs the system property javax.security.auth.useSubjectCredsOnly to be set to true for it to work. However Tomcat sets it in  \n\nInside SpnegoAuthenticator:-\n\n protected void initInternal() throws LifecycleException {\n        super.initInternal();\n\n        // Kerberos configuration file location\n        String krb5Conf = System.getProperty(Constants.KRB5_CONF_PROPERTY);\n        if (krb5Conf == null) {\n            // System property not set, use the Tomcat default\n            File krb5ConfFile = new File(Bootstrap.getCatalinaBase(),\n                    Constants.DEFAULT_KRB5_CONF);\n            System.setProperty(Constants.KRB5_CONF_PROPERTY,\n                    krb5ConfFile.getAbsolutePath());\n        }\n\n        // JAAS configuration file location\n        String jaasConf = System.getProperty(Constants.JAAS_CONF_PROPERTY);\n        if (jaasConf == null) {\n            // System property not set, use the Tomcat default\n            File jaasConfFile = new File(Bootstrap.getCatalinaBase(),\n                    Constants.DEFAULT_JAAS_CONF);\n            System.setProperty(Constants.JAAS_CONF_PROPERTY,\n                    jaasConfFile.getAbsolutePath());\n        }\n        \n        // This property must be false for SPNEGO to work\n        System.setProperty(Constants.USE_SUBJECT_CREDS_ONLY_PROPERTY, \'false\');\n    }\n\nas false in the last line which causes havoc in the code. A multithreaded startup causes a breakdown in further authentication for keytab based logging.\n\n\nNow a little more investigation revealed that tomcat acts only as an acceptor. Now this property need not necessarily be set to false for it to work(in both IBM and SUN JDK). \n\nSource of claim -  http://cr.openjdk.java.net/~weijun/special/krb5winguide-2/raw_files/new/kwin \n\nExcerpt:-\n 2. Direct JGSS:\n\n      /* JGSS-API calls... */\n\n       In this case, the JAAS config file\'s entry name MUST be the\n       standard entry name (com.sun.security.jgss.krb5.initiate), and you\n       must set -Djavax.security.auth.useSubjectCredsOnly=false on the\n       Java command line. Read\n       [26] http://java.sun.com/javase/6/docs/technotes/guides/security/jgs \n       s/tutorials/BasicClientServer.html for details.\nWhich means only initiate based auth needs the system property.\n\nThis is also confirmed in IBM with a sample program.\n\nPROPOSED FIX: COMMENT LAST LINE OF initInternal WHICH SETS THE SYSTEM PROPERTY IN THE FIRST PLACE AS FALSE.', 'Arunav Sanyal', '2013-11-08 11:48:18 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (15, '55735', 'Bug 55735 Additional quote entity in html element attribute evaluated in tagx if attribute contains EL expression', 'Well, after fix for  Bug 55198 , if a tag file contains\n<a href=\'#\' onclick=\'window.alert(&quot;${text}&quot;)\'>foobar</a>\nIt can now be correctly rendered as (if text=\'foobar\')\n<a href=\'#\' onclick=\'window.alert(&quot;foobar&quot;)\'>foobar</a>\n\nBut, It is rendered completely wrongly as ***** IF text=\'&amp;foobar\' *****\n<a href=\'#\' onclick=\'window.alert(&quot;&amp;amp;foobar&quot;)\'>foobar</a>\n\nThe EL expression ${text} should be rendered without any escape, but now it is\nescaped just as other literal part in the attribute.\n\nGenerally, a tagx file\'s compiler must not make any assumption that it\'s output is a well-formed XML or not, it should just keep the literal atrribute or text as is, and output any EL expression directly. It\'s the tagx file\'s author\'s reponsibility to determine whether a text variable should be escaped, e.g.:\n<a href=\'#\' onclick=\'window.alert(&quot;${fn:escape(text)}&quot;)\'>foobar</a>\n\nSuppose we have:\nrequest.setAttribute(\'text\', \'2 &gt; 1\');\nAnd in a tagx file:\n<div title=\'&quot;${text}&quot;\'>&quot;${text}&quot;</div>\n\nThe correct output could be:\n<div title=\'&quot;2 &gt; 1&quot;\'>&quot;2 &gt; 1&quot;</div>\n\nBut neither\n<div title=\'&quot;2 &amp;gt; 1&quot;\'>&quot;2 &gt; 1&quot;</div>\n\nnor\n<div title=\'\'2 > 1\'\'>&quot;2 &gt; 1&quot;</div>', 'azuo.lee', '2013-11-02 06:14:56 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (16, '55684', 'Bug 55684 WebappClassLoader.getThread want an access to root ThreadGroup', 'Tomcat may not have all permissions granted.\nThe method WebappClassLoader.getThread try to access the root ThreadGroup in order to list all threads.\nYou should either manage SecurityException or avoid to access the parent ThreadGroup of the thread which start Tomcat.', 'Gael Lalire', '2013-10-21 16:30:04 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (17, '55691', 'Bug 55691 javax.el.ArrayELResolver.setValue not supporting arrays of primitives', 'was working in tomcat 6.0.20\n\nERROR javax.faces.context.ExceptionHandlerWrapper - javax.faces.component.UpdateModelException: java.lang.ClassCastException: Unable to add an object of type [java.lang.Integer] to an array of objects of type [int]\njava.lang.ClassCastException: Unable to add an object of type [java.lang.Integer] to an array of objects of type [int]\n	at javax.el.ArrayELResolver.setValue(ArrayELResolver.java:94)\n	at com.sun.faces.el.DemuxCompositeELResolver._setValue(DemuxCompositeELResolver.java:255)\n	at com.sun.faces.el.DemuxCompositeELResolver.setValue(DemuxCompositeELResolver.java:281)\n	at org.apache.el.parser.AstValue.setValue(AstValue.java:158)\n	at org.apache.el.ValueExpressionImpl.setValue(ValueExpressionImpl.java:249)\n	at com.sun.faces.facelets.el.TagValueExpression.setValue(TagValueExpression.java:131)\n	at javax.faces.component.UIInput.updateModel(UIInput.java:818)\n	at javax.faces.component.UIInput.processUpdates(UIInput.java:735)\n	at javax.faces.component.UIData.iterate(UIData.java:2001)\n	at javax.faces.component.UIData.processUpdates(UIData.java:1253)\n	at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)\n	at javax.faces.component.UIForm.processUpdates(UIForm.java:281)\n	at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)\n	at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)\n	at javax.faces.component.UIViewRoot.processUpdates(UIViewRoot.java:1231)\n	at com.sun.faces.lifecycle.UpdateModelValuesPhase.execute(UpdateModelValuesPhase.java:78)\n	at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)\n	at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)\n	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)', 'taly', '2013-10-22 23:05:42 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (18, '55317', 'Bug 55317 Facilitate weaving by allowing ClassFileTransformer to be added to WebppClassLoader', 'Most application servers provide a mechanism whereby web applications can instrument class bytecode. This is normally in the form of two or three instrumentation methods on the ClassLoader implementation responsible for web application class loading. Spring Framework, for example, provides a way to automatically detect and use the various instrumentable ClassLoaders provided by different application servers. However, since Tomcat\'s o.a.catalina.loader.WebappClassLoader is not instrumentable, Spring cannot use it directly. Instead, it provides a class that extends WebappClassLoader to implement the instrumentation. Users must place this special spring-instrument-tomcat.jar file in $TOMCAT_HOME/lib and put a loader declaration in META-INF/context.xml in order to get this to work--rather a pain in the rear.\n\nSpring\'s changes in the extended WebappClassLoader are really very trivial and involve only 2 classes: a helper class called WeavingTransformer [1] and the extended TomcatInstrumentableClassLoader [2]. I intend to port these changes to Tomcat for Tomcat 7 and 8 and submit a patch.\n\nHowever, before I get started I needed to get two answers from the community:\n\n1) Is there any objection to such a simple addition to WebappClassLoader? I think it would be an easy-but-big improvement to Tomcat.\n\n2) What steps do I need to take to get this Spring code officially \'donated\' to Tomcat so that all legal requirements are met? The code is licensed Apache 2.0, so that at least should make it easier.\n\n[1]  https://github.com/SpringSource/spring-framework/blob/master/spring-instrument-tomcat/src/main/java/org/springframework/instrument/classloading/WeavingTransformer.java \n[2]  https://github.com/SpringSource/spring-framework/blob/master/spring-instrument-tomcat/src/main/java/org/springframework/instrument/classloading/tomcat/TomcatInstrumentableClassLoader.java ', 'Nick Williams', '2013-07-28 07:17:28 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (19, '55576', 'Bug 55576 Order of ServletRequest parameters is not preserved', 'The ServletRequest interface provides two methods to iterate through request parameters:\n\nEnumeration<String> getParameterNames(), and\nMap<String, String[]> getParameterMap()\n\nUnfortunately, the underlying implementation in Tomcat is a HashMap, which fails to preserve the order of parameters as they are specified in the request.\n\nAn alternate implementation should be used to preserve request order.  LinkedHashMap, for example, is capable of preserving insertion order.\n\nThe Servlet Specification (v3.0) speaks only to the relative ordering of query string data and post body data. However, section 17.13.3 of the HTML specification (v4.01) titled \'Processing form data\', clearly states that \'control names/values are listed in the order they appear in the document.\'\n\nTherefore, I do not see a valid interpretation of either specification to rationalize Tomcat\'s implementation. To receive a request with an ordered list of parameters and represent them in an implementation that is guaranteed not to preserve this order is difficult to rationalize.', 'corythearchitect', '2013-09-20 21:14:32 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (20, '54693', 'Bug 54693 Add a validationQueryTimeout property', 'While it\'s possible to set the query timeout using the QueryTimeoutInterceptor, this will set the same timeout for all queries.  It would be nice to be able to set an independent timeout for the validation query.\n\nIn addition, DBCP supports this feature [1], so it would be nice to have this feature for compatibility / migration purposes.\n\n[1] -  https://issues.apache.org/jira/browse/DBCP-226 \n\nThanks', 'Daniel Mikusa', '2013-03-13 20:04:20 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (21, '55494', 'Bug 55494 JNDIRealm throws exception after timeout / Connection reset', 'Our tomcat is configured to use Windows 2012 AD with JNDI-Realm\nWhen the application is running for some hours, the Tomcat logs exceptions because of timeouts.\n\nHere is a stacktrace:\n\nWARNING: Exception performing authentication\njavax.naming.CommunicationException: Connection reset [Root exception is java.net.SocketException: Connection reset]; remaining name \'xxx\'\n	at com.sun.jndi.ldap.LdapCtx.doSearch(Unknown Source)\n	at com.sun.jndi.ldap.LdapCtx.searchAux(Unknown Source)\n	at com.sun.jndi.ldap.LdapCtx.c_search(Unknown Source)\n	at com.sun.jndi.toolkit.ctx.ComponentDirContext.p_search(Unknown Source)\n	at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.search(Unknown Source)\n	at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.search(Unknown Source)\n	at javax.naming.directory.InitialDirContext.search(Unknown Source)\n	at org.apache.catalina.realm.JNDIRealm.getUserBySearch(JNDIRealm.java:1438)\n	at org.apache.catalina.realm.JNDIRealm.getUser(JNDIRealm.java:1289)\n	at org.apache.catalina.realm.JNDIRealm.getUser(JNDIRealm.java:1225)\n	at org.apache.catalina.realm.JNDIRealm.getPrincipal(JNDIRealm.java:2086)\n	at org.apache.catalina.realm.JNDIRealm.getPrincipal(JNDIRealm.java:2005)\n	at org.apache.catalina.realm.RealmBase.authenticate(RealmBase.java:523)\n	at org.apache.catalina.realm.CombinedRealm.authenticate(CombinedRealm.java:295)\n	at org.apache.catalina.realm.LockOutRealm.authenticate(LockOutRealm.java:249)\n	at org.apache.catalina.authenticator.SpnegoAuthenticator.authenticate(SpnegoAuthenticator.java:250)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:544)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:953)\n	at org.apache.catalina.authenticator.SingleSignOn.invoke(SingleSignOn.java:341)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)\n	at org.apache.coyote.ajp.AjpAprProcessor.process(AjpAprProcessor.java:197)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)\n	at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1852)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n	at java.lang.Thread.run(Unknown Source)\nCaused by: java.net.SocketException: Connection reset\n	at java.net.SocketInputStream.read(Unknown Source)\n	at java.net.SocketInputStream.read(Unknown Source)\n	at java.io.BufferedInputStream.fill(Unknown Source)\n	at java.io.BufferedInputStream.read1(Unknown Source)\n	at java.io.BufferedInputStream.read(Unknown Source)\n	at com.sun.jndi.ldap.Connection.run(Unknown Source)\n	... 1 more\n\nIt seems that the LDAP-Lookup tries to search for the user within LDAP but the server already closed the Connection.\n\nLooks like this cause:\n http://stackoverflow.com/questions/10911897/tomcat-7-0-14-ldap-authentication ', 'Thomas Hoffmann', '2013-08-28 12:54:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (22, '55454', 'Bug 55454 NullPointerException caused by invalid contentType, e.g. trailing semicolon', 'possible related to 53353\n\nWhen having an invalid contenttype like:\n<jsp:directive.page language=\'java\' contentType=\'text/html;\'/>\n(note the trailing \';\') Tomcat throws a NullPointerException like this:\n\njava.lang.NullPointerException\n	org.apache.tomcat.util.http.parser.HttpParser.parseMediaType(HttpParser.java:217)\n	org.apache.tomcat.util.http.parser.MediaTypeCache.parse(MediaTypeCache.java:54)\n	org.apache.catalina.connector.Response.setContentType(Response.java:805)\n	org.apache.catalina.connector.ResponseFacade.setContentType(ResponseFacade.java:245)\n	javax.servlet.ServletResponseWrapper.setContentType(ServletResponseWrapper.java:123)\n\nAfter removing the extra \';\' or entering a charset like this:\n<jsp:directive.page language=\'java\' contentType=\'text/html; charset=UTF-8\'/>\nit works as expected.\n\nMy desired behaviour would be:\nDon\'t crash with a NPE.\nOther Tomcat versions seem to handly this different.', 'Christian', '2013-08-20 09:30:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (23, '55404', 'Bug 55404 ContextConfig#validateSecurityRoles emits three info log messages which contain a warning', 'ContextConfig#validateSecurityRoles emits three info log messages but the messages start with \'WARNING:\'. This is quite irrtating.\n\n> contextConfig.role.auth=WARNING: Security role name {0} used in an <auth-constraint> without being defined in a <security-role>\n> contextConfig.role.link=WARNING: Security role name {0} used in a <role-link> without being defined in a <security-role>\n> contextConfig.role.runas=WARNING: Security role name {0} used in a <run-as> without being defined in a <security-role>\n\nRemove the warning and set the log level from info to warning.', 'Michael Osipov', '2013-08-12 13:09:52 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (24, '55312', 'Bug 55312 No SCI scan in embedded Tomcat', 'I like the fact that SCI scanning is off by default in a Tomcat embedded instance, but I\'d lik eto be able to switch it on. It might even be possible already, but the API is non-obvious.  Maybe a method in Tomcat or associated friendly helper?\n\nWould also be nice in Tomcat 7.', 'Dave Syer', '2013-07-26 15:37:46 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (25, '55267', 'Bug 55267 NIO thread locked', 'Did some load test and thread got stuck, see dump.\n\nBasically I just simulate 100 users that connect and disconnect.', 'Pavel', '2013-07-15 11:38:25 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (26, '55259', 'Bug 55259 Unnecessary work in JspConfig', 'JspProperty is the same for all url patterns in a group; the current code creates a new one each iteration', 'Jeremy Boynes', '2013-07-13 04:34:34 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (27, '55245', 'Bug 55245 Add test cases for JspC', 'The test suite should include tests for the JspC Ant task', 'Jeremy Boynes', '2013-07-12 02:05:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (28, '55238', 'Bug 55238 [websocket] NPE in clearHandler(WsRemoteEndpointImplServer.java:156)', '', 'Niki Dokovski', '2013-07-11 08:11:07 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (29, '55228', 'Bug 55228 AbstractHttp11Processor overwrites Date header, even when set by application', 'If the application sets the Date header, then it is most likely for caching purposes and Tomcat needs to return it as is.\n\n\n\nA consistent Date header is very important for proper Age/Max-Age calculations.\n\n http://www.w3.org/Protocols/HTTP/Issues/add-age.html ', 'fern&#64;alum.mit.edu', '2013-07-10 00:35:33 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (30, '55231', 'Bug 55231 NPE and incorrect version detection in JspC', 'JspC\'s JspConfig now reads version and jsp-config information from the ServletContext. \n\nIt uses getMajorVersion() which returns the maximum version supported by the container. It should use getEffectiveVersion() to use the version of the web application.\n\nServletContext.getJspConfigDescriptor() can return null if there is no <jsp-config> in the web.xml. JspConfig does not allow for this and will throw a NPE e.g. if there is no web.xml in the application.', 'Jeremy Boynes', '2013-07-10 04:10:10 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (31, '55166', 'Bug 55166 schemaLocation references between servlet and jsp XSDs are invalid', 'The javax/servlet/resources package does not contain the JSP specification XSDs. These are referenced from the web-app or web-common xsds and define elements like <jsp-config>.', 'Jeremy Boynes', '2013-06-30 20:03:24 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (32, '53777', 'Bug 53777 Ability to bundle JAAS Configuration in Webappp', 'I would like to let JAASRealm to load JAAS Configuration from a .properties file bundled in a web application (either in WEB-INF/classes or in any JAR on the classpath of the context)\n\nActually (7.0.29) JAASRealm creates a LoginContext using the 2-args constructor\nloginContext = new LoginContext(appName, callbackHandler); \n\nI propose to add a new configuration parameter on JAASRealm to let it load a javax.security.auth.login.Configuration from the ContextClassLoader\n\nthis new Configuration has to be passed to the 4-args constructor\nloginContext = new LoginContext(appName, subject, callbackHandler, configuration); \n\n http://docs.oracle.com/javase/6/docs/api/javax/security/auth/login/LoginContext.html#LoginContext%28java.lang.String,%20javax.security.auth.Subject,%20javax.security.auth.callback.CallbackHandler,%20javax.security.auth.login.Configuration%29 ', 'eolivelli', '2012-08-24 13:50:52 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (33, '55160', 'Bug 55160 NIO connectionUploadTimeout can\'t work', 'when i configure disableUploadTimeout=\'false\' and connectionTimeout=\'20000\' ,connectionUploadTimeout=\'30000\' .\nI found the connectionUploadTimeout doesn\'t work, because the code in internalNioInputBuffer.readSocket():\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\ntry {\n                NioEndpoint.KeyAttachment att = (NioEndpoint.KeyAttachment)socket.getAttachment(false);\n                if ( att == null ) throw new IOException(\'Key must be cancelled.\');\n                nRead = pool.read(socket.getBufHandler().getReadBuffer(),socket,selector,att.getTimeout());\n            } catch ( EOFException eof ) {\n                nRead = -1;\n            } finally { \n                if ( selector != null ) pool.put(selector);\n            }\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\natt.getTimeout() is the connectionTimeout ,not the connectionUploadTimeout.\nso , in NioBlockingSelector.read(), the readTimeout is connectionTimeout', 'Roger Wang', '2013-06-29 21:35:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (34, '55017', 'Bug 55017 Ability to configure RMI bind address', 'Created  attachment 30319   [details] \nPatch to provider bind rmi bind address setup ability\n\nThere is a patch which adds rmiBindAddress property to JmxRemoteLifecycleListener, which allows to bind RMI server to specific interface instead of 0.0.0.0.\n\nIt may useful for binding RMI to localhost and avoiding firewall configuration (and then monitoring through SSH tunnel).\n\nUnfortunatly using of rmiBindAddress incompatible with rmiSSL, but i think it\'s not an issue because of rarely intersecting use cases.', 'Alexey Noskov', '2013-05-24 14:50:10 UTC', 'tomcat_attachment/attachment 30319.txt');
INSERT INTO `tomcatbody` VALUES (35, '55102', 'Bug 55102 Add ability to report time taken to prepare response', 'Created  attachment 30438   [details] \nPatch against trunk@ r1493385  to record and output time to commit\n\nTomcat\'s AccessLogValve is able to report the time taken to send an entire request using %D. This is the total processing time and may be affected by network conditions. It is sometimes useful to be able to record the time taken by the server to prepare the response and send the first content to the client.\n\nAttached is a patch that records the time the response is committed and then allows that to be reported in the access log using a \'%F\' pattern (which is the same as used by the mod-log-firstbyte module for HTTPD).', 'Jeremy Boynes', '2013-06-15 17:09:47 UTC', 'tomcat_attachment/attachment 30438.txt');
INSERT INTO `tomcatbody` VALUES (36, '55046', 'Bug 55046 CORS Filter', 'Created  attachment 30363   [details] \nA patch file containing CORS filter source code, units tests, and changes to tomcat documentation\'s filter.xml.\n\nCORS Filter implementation\n\nThis is an enhancement request to include CORS Filter as one of Tomcat\'s container provided filters.\n\nCORS (Cross Origin Resource Sharing) is a W3C specification ( http://www.w3.org/TR/cors/ ) that defines a mechanism to enable cross origin requests. This is a Java Servlet Filter implementation of server-side CORS.\n\nHere are few reasons that makes this implementation is a good fit:\n* Implements all required sections of the spec for servers. Handles simple/actual and pre-flight requests as per the specification.\n* Written specifically to fit well with Tomcat\'s source, and is formatted the same as Tomcat\'s source.\n* Filter implementation is just one class and is well Javadoc\'d\n* Includes ample unit tests to validate the implementation against the spec\n* Simple to configure minimally and use\n* Easy to override default configuration, if required\n* Protects against CRLF injection / response splitting attacks.\n\nWe(eBay) would like to contribute this implementation to Apache Software\nFoundation, to be included in Tomcat 8. And, I would also like to maintain and develop it, going forward. \n\nIt\'s true that as a Servlet Filter, any webapp developer may add it to their app whether Tomcat includes it or not, but we believe that this is fundamental server behavior that should be present and easy to enable in the server, as it is in some other servers.', 'Mohit Soni', '2013-06-02 00:48:49 UTC', 'tomcat_attachment/attachment 30363.txt');
INSERT INTO `tomcatbody` VALUES (37, '54971', 'Bug 54971 javax.servlet.http.Part.write(String fileName) is not properly implemented', '1. fileName parameter / relative vs absolute\nfilaName parameter specification in\n<1><JSR-000315 Java Servlet 3.0 Final Release javadocs>\nis different from the <2><javax API tomcat refers to>.\n\n<1> <JSR-000315 Java Servlet 3.0 Final Release javadocs>\n\nParameters:fileName - the name of the file to which the stream will be written. The file is created relative to the location as specified in the MultipartConfig\n\n<2> javax. API tomcat refers to\n\n * @param fileName  The location into which the uploaded part should be\n     *                  stored. Relative locations are relative to {@link\n     *                  javax.servlet.MultipartConfigElement#getLocation()}\n\n\nTomcat is implemented as specified in <2> so that it can process \'absolute path\',\nbut it should only accept \'relative path\' as specified in <1>\n<JSR-000315 Java Servlet 3.0 Final Release javadocs>\n\n2.\nIf MultiPartConfig.location is not set,\nwrite( String relative path ) throws FileNotFound Exception.\nA default location needs to be set in order to avoid such exception.\n\nexample) os: windows8\n\npart.write(\'/test\');\n\njava.io.IOException: java.io.FileNotFoundException:  test (Access is denied)\n	at org.apache.catalina.core.ApplicationPart.write(ApplicationPart.java:123)\n	at servlet.multipart.MultipleUploadServlet.doPost(MultipleUploadServlet.java:76)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:947)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1009)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)\n	at java.lang.Thread.run(Thread.java:662)', 'Daniel Koh', '2013-05-15 02:16:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (38, '54947', 'Bug 54947 Http11NioProtocol generates HTTP 505 responses on valid requests if request is split across multiple packets', 'If an HTTP request is broken up across multiple packets *and* the first packet contains a GET request up to \' r\' AND the \' n\' terminating the first line of the request is included in the next packet Tomcat incorrectly throws an HTTP \'505 Version Not Supported\' response.  This is with the Http11NioProtocol connector only - the default HTTP/1.1 connector does not exhibit this problem.\n\nAn example request:\nPacket 1: GET / HTTP/1.1 r\nPacket 2:  nHost: localhost r n\nPacket 3: Connection: Close r n r n\n\nResponse:\nHTTP/1.1 505 HTTP Version Not Supported\nServer: Apache-Coyote/1.1\nDate: Thu, 09 May 2013 20:23:58 GMT\nConnection: close\n\nThe following Python program reproduces the problem for me in both Tomcat 6.0.37 and Tomcat 7.0.39:\n\'\'\'\n#!/usr/bin/python\n\nimport socket\nimport time\n\ns = socket.socket()\ns.connect((\'localhost\',8080))\ns.sendall(\'GET / HTTP/1.1 r\')\ntime.sleep(1.5) # make sure the above goes out in its own packet\ns.sendall(\' nHost: localhost r n\')\ns.sendall(\'Connection: close r n r n\')\nprint s.makefile().read()\n\'\'\'\n\nMoving the \' n\' to from the second sendall to the end of the first sendall causes Tomcat to respond correctly.', 'Greg Harris', '2013-05-09 20:27:01 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (39, '54984', 'Bug 54984 multipart/form-data is not always read with correct encoding', 'The bug occurs when form data is posted as multipart/form-data and using Servlet 3 API to get posted files.\nIn a servlet, if we set the encoding:\n\nrequest.setCharacterEncoding(\'UTF-8\');\n\nThen invoke:\n\nrequest.getParts()\n\nAnd then invoke:\n\nString text = request.getParameter(\'sometextfield\');\n\nUTF-8 characters in the text have been garbled.\n\nOrder of method calls are significant, if a getParameter is called before getParts, the correct encoding will be used.\nHowever, the order which you invoke the methods should not matter.', 'Per Holmberg', '2013-05-16 11:15:20 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (40, '54928', 'Bug 54928 IllegalStateException: Calling [asyncError()] is not valid for a request with Async state [COMPLETING]', 'In an async scenario (request.startAsync), when the client goes away, trying to write to the response raises an IOException. If I then call asyncContext.complete() in order to finalize and clean up the request, soon after the following exception occurs:\n\njava.lang.IllegalStateException: Calling [asyncError()] is not valid for a request with Async state [COMPLETING]\n        at org.apache.coyote.AsyncStateMachine.asyncError(AsyncStateMachine.java:304)\n        at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:793)\n        at org.apache.coyote.Request.action(Request.java:373)\n        at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:441)\n        at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:312)\n        at org.apache.coyote.http11.AbstractHttp11Processor.asyncDispatch(AbstractHttp11Processor.java:1509)\n        at org.apache.coyote.http11.Http11NioProcessor.asyncDispatch(Http11NioProcessor.java:221)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:619)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1581)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1540)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n        at java.lang.Thread.run(Thread.java:722)\n\nIt looks like an attempt to maybe to send an error event to AsyncListener\'s but asyncContext.complete has already been called.\n\nIs calling asyncContext.complete() a reasonable way to handle an IOException from the response in order to finalize the request and release any resorces associated with it?', 'Rossen Stoyanchev', '2013-05-04 12:41:30 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (41, '54703', 'Bug 54703 Nullpointer exception in HttpParser.parseMediaType', 'input for parseMediaType() is\n\n----------\nmultipart/signed; protocol=\'application/pkcs7-signature\'; micalg=sha-256; \n	boundary=\'----=_Part_121_929034657.1363355797756\'\n----------\n\nexception trace\n\njava.lang.NullPointerException\n        at org.apache.tomcat.util.http.parser.HttpParser.parseMediaType(HttpParser.java:215)\n        at org.apache.tomcat.util.http.parser.MediaTypeCache.parse(MediaTypeCache.java:54)\n        at org.apache.catalina.connector.Response.setContentType(Response.java:806)\n        at org.apache.catalina.connector.Response.checkSpecialHeader(Response.java:1119)\n        at org.apache.catalina.connector.Response.setHeader(Response.java:1446)\n        at org.apache.catalina.connector.ResponseFacade.setHeader(ResponseFacade.java:535)', 'Sandy Meier', '2013-03-15 14:09:19 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (42, '54801', 'Bug 54801 EL-like expressions in jsp:scriptlet break compilation of JSP XML documents', 'Created  attachment 30152   [details] \nhelloWorld.tagx\n\nSteps to reproduce:\n\n1. Go to  webapps examples WEB-INF tags \n2. Delete \'helloWorld.tag\' file and put there \'helloWorld.tagx\' file attached to this issue.\nThe file contains the following plus AL header:\n\n<?xml version=\'1.0\' encoding=\'utf-8\' ?>\n<jsp:root xmlns:jsp=\' http://java.sun.com/JSP/Page \' version=\'2.0\'>\n<jsp:scriptlet><![CDATA[//\n  // ${foo}\n  out.println(\'Hello, world!!\');\n]]></jsp:scriptlet>\n</jsp:root>\n\n3. Start Tomcat and try to open the following page in a browser:\n http://localhost:8080/examples/jsp/jsp2/tagfiles/hello.jsp \n\nACTUAL result:\nin current TC8 trunk:\norg.xml.sax.SAXException: Body of scriptlet element must not contain any XML elements\n  org.apache.jasper.compiler.JspDocumentParser.checkScriptingBody(JspDocumentParser.java:1332)\n  org.apache.jasper.compiler.JspDocumentParser.endElement(JspDocumentParser.java:650)\n	\n\nThis behaviour is caused by \'${foo}\' being present inside the scriptlet. If I remove that line, the page is displayed successfully.\n\nEXPECTED RESULT\nI think EL expressions should not be recognized inside of jsp:scriptlet, jsp:declaration or jsp:expression and should not trigger such an error.\n\nAs a confirmation, the following \'helloWorld.tag\' in JSP syntax compiles and executes successfully. Thus this issue is with XML syntax only,\n\n<%\n  // ${foo}\n%>\nHello, world!++\n\n\nAlternative solution could be to change the error message, but I think it is not the issue here,\ns/ any XML elements / any XML elements or EL expressions/', 'Konstantin Kolinko', '2013-04-04 22:24:00 UTC', 'tomcat_attachment/attachment 30152.txt');
INSERT INTO `tomcatbody` VALUES (43, '54178', 'Bug 54178 [CVE-2013-2071] runtime exception in onComplete of AsyncListener, will make org.apache.catalina.connector.Request not recycled (orginally reported MESSAGE POST to tomcat, but it called doGet)', 'one HTTP request use POST method, but in tomcat it calls doGet() what is really strage.\n\nas I only tested in 7.0.23, and 7.0.32. in 7.0.32, 7.0.32 is more reproduceable than 7.0.23.\n\nI know it must be a very strange issue, as tomcat has so many release. I can\'t believe it if I didn\'t see it with my own eyes.\n\nso I attache the image.', 'wan_jm', '2012-11-21 08:22:00 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (44, '54781', 'Bug 54781 NPE in WsServerContainer if there is no matching path', 'Created  attachment 30129   [details] \nA proposed fix\n\nWsServerContainer.findMapping fails with a NullPointerException if there is no matching WsMappingResult. Also WsFilter needs a conditional clause to let the request through if there is no matching mapping.\n\nAttached is a patch.', 'Rossen Stoyanchev', '2013-04-01 19:32:18 UTC', 'tomcat_attachment/attachment 30129.txt');
INSERT INTO `tomcatbody` VALUES (45, '54800', 'Bug 54800 Possible thread/memory leak with use of WebSocketContainer', 'Whenever WebSocketContainer is used to connect to a server endpoint, the following message appears when Tomcat shuts down:\n\nSEVERE: The web application [/websocket-test] appears to have started a thread named [Thread-4] but has failed to stop it. This is very likely to create a memory leak.\n\nThe message is repeated for 6 different threads. I don\'t have proof this is caused by the use of WebSocketContainer but the messages don\'t appear when it isn\'t used.\n\nThe Endpoint used to connect is very simple. It sends a message when the session is opened to the EchoEndpoint on the server side, and prints the response and closes when the message is echoed back.', 'Rossen Stoyanchev', '2013-04-04 21:47:00 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (46, '54724', 'Bug 54724 WsSession does not throw IllegalStateException if closed when methods on it are called', 'Spec JavaDoc says:\n\n\'Once the session is closed, it is no longer valid for use by applications. Calling any of its methods once the session has been closed will result in an IllegalStateException being thrown. Developers should retrieve any information from the session during the Endpoint.onClose(Session, CloseReason) method.\'\n\nOf course, the rules of Closeable also apply here, and calling Session#close(...) more than once should have no effect subsequent times.\n\nThere are actually three problems here:\n\n1) None of the methods throw IllegalStateException if the session is closed. Instead, they return things (like the basic remote, for example), and some methods in the endpoint implementation will not notice concurrent exceptions from the socket and then block forever waiting four the Countdown to clear.\n\n2) The Session#state is never actually changed to State.CLOSED unless Session#onClose is called. However, Session#onClose is never actually called that I can find (though I will look harder before I make changes).\n\n3) Even in Session#onClose, the state is incorrectly changed to State.CLOSED BEFORE Endpoint#onClose is called, when it should be changed AFTER.\n\nI\'m working on a patch for this.', 'Nick Williams', '2013-03-19 13:22:56 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (47, '54702', 'Bug 54702 File descriptor leak at web.xml loading', 'Hello\n\nI think I\'ve found a file descriptor leak in file /tomcat/trunk/java/org/apache/catalina/startup/ContextConfig.java (method getGlobalWebXmlSource).\n\nA stream is from file \'web.xml\' is not closed.\n\nprivate WebXml getDefaultWebXmlFragment() {\n... \n\n1284	        InputSource globalWebXml = getGlobalWebXmlSource();\n...\n1337	            // Parse global web.xml if present\n1338	            if (globalWebXml == null) {\n1339	                // This is unusual enough to log\n1340	                log.info(sm.getString(\'contextConfig.defaultMissing\'));\n1341	            } else {\n1342	                parseWebXml(globalWebXml, webXmlDefaultFragment, false);\n1343	            }\n\nHere is the full stack trace\n\n[java.io.FileInputStream.<init>(FileInputStream.java:109)] [org.apache.catalina.startup.ContextConfig.getWebXmlSource(ContextConfig.java:1837)] [org.apache.catalina.startup.ContextConfig.getGlobalWebXmlSource(ContextConfig.java:1744)] [org.apache.catalina.startup.ContextConfig.getDefaultWebXmlFragment(ContextConfig.java:1417)] [org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1253)] [org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:878)] [org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:369)] [org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)] [org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)] [org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)] [org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)] [org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)] [org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)] [org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)] [org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:977)] [org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:542)] [org.apache.catalina.startup.HostConfig.check(HostConfig.java:1462)] [sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)] [sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)] [sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)] [java.lang.reflect.Method.invoke(Method.java:597)] [org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)] [com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)] [com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)] [org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1445)] [org.apache.catalina.manager.HTMLManagerServlet.upload(HTMLManagerServlet.java:301)] [org.apache.catalina.manager.HTMLManagerServlet.doPost(HTMLManagerServlet.java:208)] [javax.servlet.http.HttpServlet.service(HttpServlet.java:647)] [javax.servlet.http.HttpServlet.service(HttpServlet.java:728)] [org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)] [org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)] [org.apache.catalina.filters.CsrfPreventionFilter.doFilter(CsrfPreventionFilter.java:213)] [org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)] [org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)] [org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108)] [org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)] [org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)] [org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)] [org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)] [org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:581)] [org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)] [org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)] [org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:931)] [org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)] [org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)] [org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)] [org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)] [org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1822)] [java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)] [java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)] [java.lang.Thread.run(Thread.java:662)]', 'Jean-Marie LAMARE', '2013-03-15 08:53:36 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (48, '54690', 'Bug 54690 HTTPS BIO/NIO connector does not enable TLS 1.1 and TLS 1.2 by default', 'As users already noted [1], default HTTPS BIO/NIO connector in Tomcat 7.0.37 enables only SSLv3 and TLSv1, while Tomcat 6.0.36 enables SSLv3, TLSv1, TLSv1.1 and TLSv1.2.\n\nThe reason for this change of behavior is that:\n\n1. Tomcat 6, with default HTTPS connector configuration, does not call socket.setEnabledProtocols, thus enabling SSLv3, TLSv1, TLSv1.1 and TLSv1.2, while\n\n2. Tomcat 7, with default HTTPS connector configuration, calls socket.setEnabledProtocols(enabledProtocols), where enabledProtocols is obtained with: context.getDefaultSSLParameters().getProtocols(). This, contrary to not calling setEnabledProtocols at all, results in enabling only SSLv3 and TLSv1.\n\n\nI propose that Tomcat 7 mimics Tomcat 6 behavior, and if attribute sslEnabledProtocols (in HTTPS connector in server.xml) is not set, then method socket.setEnabledProtocols is not invoked.\n\nEverything is tested with Oracle JDK 1.7.0_15.\n\nMore details on post on Tomcat dev list [2].\n\n[1]  https://twitter.com/ivanristic/status/303798231920431104 \n[2]  http://www.mail-archive.com/dev@tomcat.apache.org/msg71522.html ', 'Ognjen Blagojevic', '2013-03-13 17:07:20 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (49, '54602', 'Bug 54602 B2CConverter character decode underflow leaves bytes in buffer', 'If a request contains a uri that ends in a multi byte character which is missing a byte the extra bytes are left in a buffer which is reused by a future request.\n\nThe problem comes from two different things:\n1) If B2CConverter tries to convert a ByteChunk which ends in a character underflow it does not convert that last character and it is left in a buffer in B2CConver.\n\n2) The B2CConverter in org.apache.catalina.connector.Request is not recycled with the rest of the objects. It looks like this is done intentionally based on the comment above it\'s declaration.\n\nThe issue with B2CConverter can be demonstrated with the code below, which is a simplification of what is done inside of CoyoteAdapter.convertURI():\n\n<code>\nB2CConverter conv = new B2CConverter(\'UTF-8\');\nByteChunk bc = new ByteChunk();\nCharChunk cc = new CharChunk();\nbyte[] bytes = { 0x61, 0x62, 0x63, 0x64, -8, -69, -73, -77 };\n\nbc.append(bytes, 0, bytes.length);\ncc.allocate(bc.getLength(), -1);\nconv.convert(bc, cc, cc.getBuffer().length - cc.getEnd());\nSystem.out.println(cc);\n\ncc.recycle();\nbc.recycle();\n\nbc.append(bytes, 0, bytes.length);\ncc.allocate(bc.getLength(), -1);\nconv.convert(bc, cc, cc.getBuffer().length - cc.getEnd());\nSystem.out.println(cc);\n</code>\n\nIf the B2CConverter was recycled with everything else in Request this would prevent a previous request from corrupting the next request but it doesn\'t fix the issue that a character is dropped from the initial decode.\n\nI tried playing with B2CConverter and the only way I could get the convert to get everything was by ignoring the limit argument and reading to the end of the stream. It looks like tomcat8 is moving in this direction with the move to NIO, however I tried playing with the latest B2CConverter and was still seeing issues with the given byte sequence.', 'Nate Clark', '2013-02-22 20:06:36 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (50, '54552', 'Bug 54552 Completed Servlet 3.1 spec for changeSessionId, HttpSessionIdListener', 'Created  attachment 29940   [details] \nPatch to apply changes\n\nSee attached diff and provide feedback, please. This should complete HttpServletRequest#changeSessionId(), HttpSessionIdListener.', 'Nick Williams', '2013-02-12 13:56:32 UTC', 'tomcat_attachment/attachment 29940.txt');
INSERT INTO `tomcatbody` VALUES (51, '54536', 'Bug 54536 ErrorReportValve doesn\'t respect HttpServletResponse.sendError(int sc, String msg)', 'The changes of the ErrorSupportValve introduced in catalina-v7.0.30 does not respect HttpServletResponse.sendError(int sc, String msg)  because when a msg is provided with a status which is not present in the LocalStrings.properties of the \'org.apache.catalina.valves\' package, the error page won\'t be forwarded to the response body.\n\nThis issue was triggered due to the following change which was performed at  revision 1348777 :\n\nThe change of the             \n   report = sm.getString(\'http.\' + statusCode, message);\nto\n   report = sm.getString(\'http.\' + statusCode);\n\nresults in \'report==null\' for custom status codes returning a response without the error page body.\n\n        if (report == null) {\n            return;\n        }', 'Yannis Thanasoulas', '2013-02-07 12:33:41 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (52, '54239', 'Bug 54239 Extensible EL Interpreter', 'Created  attachment 29684   [details] \nInterface of ELInterpreter\n\nIn some cases, applications need doing code generation for EL to make EL evaluation more faster.\n\nIt\'s better for tomcat to provide an extensible EL Interpreter. So application can inject it\'s own ELInterpreter to replace the default JspUtil.interpreterCall.\n\nAttached an implementation.', 'Sheldon Shao', '2012-12-04 06:56:18 UTC', 'tomcat_attachment/attachment 29684.txt');
INSERT INTO `tomcatbody` VALUES (53, '54456', 'Bug 54456 ChunkedInputFilter returning EOF when client closes connection without sending end chunk', 'Created  attachment 29874   [details] \nPatch to fix the bug\n\nIn my case client is processing user\'s InputStream and then sending data in chunks to server. At server end I read till EOF.\nClient can be simple Java program or a web application. \n\nI am facing issue when client gets error on user\'s InputStream and closes connection with server. In that case ChunkedInputFilter is returning -1.\nI have added logs and confirmed that endChunk is false.\nIssue was fixed after I added following just before \'return result;\'\n\nif (result == -1 && !endChunk)\n			throw new EOFException(\'Unexpected end of stream while reading chunk body\');\n\nI think ChunkedInputFilter should return -1 only when it gets endChunk.\n\nAlso, from client end I am always sending complete chunk. So, in ChunkedInputFilter I should get EOF from socket stream while reading next chunk header (which is handled properly in ChunkedInputFilter) but that is not happening.\n\nI have attached patch. Patch was generated against tomcat/tc7.0.x/trunk', 'Sudhan Moghe', '2013-01-21 16:45:51 UTC', 'tomcat_attachment/attachment 29874.txt');
INSERT INTO `tomcatbody` VALUES (54, '54513', 'Bug 54513 NullPointerException in AprEndpoint$Poller.run', 'Trunk at  r1441188 , running the test suite with APR connector, Native 1.1.26 Windows 32-bit with JDK 7u11.\n\nI encountered the following when running org.apache.catalina.loader.TestVirtualContext test\n\nOn second re-run of the test the same issue happened, so it is as if there is something specific here. I have not encountered the issue with the rest of testsuite yet.\n\n[[[\nFeb 01, 2013 2:07:26 AM org.apache.tomcat.util.net.AprEndpoint$Poller run\nWARNING: Unexpected poller error\njava.lang.NullPointerException\n	at org.apache.tomcat.util.net.AprEndpoint$AprSocketWrapper.access$200(AprEndpoint.java:2198)\n	at org.apache.tomcat.util.net.AprEndpoint$Poller.run(AprEndpoint.java:1632)\n	at java.lang.Thread.run(Thread.java:722)\n]]]\n\nThe code at AprEndpoint$Poller.run(AprEndpoint.java:1632) is\n\n1628 for (int n = 0; n < rv; n++) {\n1629  timeouts.remove(desc[n*2+1]);\n1630  AprSocketWrapper wrapper = connections.get(\n1631          Long.valueOf(desc[n*2+1]));\n1632  wrapper.pollerFlags = wrapper.pollerFlags & ~((int) desc[n*2]);\n\nI suspect that \'wrapper\' is null here.\n\nThe above code is specific to Tomcat trunk and is not present in 7.0.x.\n\n\nWhen this happened, the test hung for 15 minutes (1000 secs) waiting on a socket read. When time out passed, it continued to run all the other tests.\n\n[[[\nTestcase: testAdditionalWebInfClassesPaths took 1 006,735 sec\n	Caused an ERROR\nRead timed out\njava.net.SocketTimeoutException: Read timed out\n	at java.net.SocketInputStream.socketRead0(Native Method)\n	at java.net.SocketInputStream.read(SocketInputStream.java:150)\n	at java.net.SocketInputStream.read(SocketInputStream.java:121)\n	at java.io.BufferedInputStream.fill(BufferedInputStream.java:235)\n	at java.io.BufferedInputStream.read1(BufferedInputStream.java:275)\n	at java.io.BufferedInputStream.read(BufferedInputStream.java:334)\n	at sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:633)\n	at sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:579)\n	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1322)\n	at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:468)\n	at org.apache.catalina.startup.TomcatBaseTest.methodUrl(TomcatBaseTest.java:247)\n	at org.apache.catalina.startup.TomcatBaseTest.getUrl(TomcatBaseTest.java:219)\n	at org.apache.catalina.startup.TomcatBaseTest.getUrl(TomcatBaseTest.java:213)\n	at org.apache.catalina.startup.TomcatBaseTest.getUrl(TomcatBaseTest.java:202)\n	at org.apache.catalina.loader.TestVirtualContext.assertPageContains(TestVirtualContext.java:326)\n	at org.apache.catalina.loader.TestVirtualContext.assertPageContains(TestVirtualContext.java:320)\n	at org.apache.catalina.loader.TestVirtualContext.testAdditionalWebInfClassesPaths(TestVirtualContext.java:311)\n]]]', 'Konstantin Kolinko', '2013-01-31 23:15:59 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (55, '53869', 'Bug 53869 Performance tuning solution to resolve too many cascaded JspContextWrapper issue', 'Created  attachment 29372   [details] \nPatch for JspContextWrapper.java\n\nJspContextWrapper.getServletContext, JspContextWrapper.findAttribute and JspContextWrapper.getELContext take much time because there are many cascaded tag files. \n\nFor example:\n <tag1>\n <tag2>\n <tag3>\n <tag4/>\n </tag3>\n </tag2>\n </tag1>\n\nWhen calling JspContextWrapper(tag4).getServletContext from tag4, it will call JspContextWrapper(tag3).getServletContext --> JspContextWrapper(tag2).getServletContext --> JspContextWrapper(tag1).getServletContext --> PageContext.getServletContext.\n\nIf the root PageContext can be held in JspConextWrapper, those page,session,application scopes calling can go directy to this root PageContext.\n\nPlease check out the attached diff file (JspContextWrapper.diff) to get more detail about this change.', 'Sheldon Shao', '2012-09-13 13:56:24 UTC', 'tomcat_attachment/attachment 29372.txt');
INSERT INTO `tomcatbody` VALUES (56, '54324', 'Bug 54324 Support is required to disable TLS compression to prevent against CRIME attacks', 'Support is required to disable TLS compression to prevent against CRIME attacks. \n\nPlease see:  https://community.qualys.com/blogs/securitylabs/2012/09/14/crime-information-leakage-attack-against-ssltls \n\nThis security issue is flagged for Tomcat during PCI compliance scan.', 'Maik Hemani', '2012-12-18 21:51:15 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (57, '54379', 'Bug 54379 Implement support for post-construct and pre-destroy elements in web.xml', 'There appears to be a feature that web[-fragment].xml file can contain such elements as <post-construct> and <pre-destroy>, and they are treated as equivalents to @PostConstruct and @PreDestroy annotations being present on the classes mentioned in them.\n\nThis feature is\n1. mentioned in the Java EE 6 Platform Specification, chapter \'EE.5.2.5 Annotations and Injection\' [1]\n2. mentioned in chapter \'8.2.3 Assembling the descriptor from web.xml, webfragment.xml and annotations\',\nsee points \'k.\' and \'l.\' on page 81 (103/230) of servlet-3_0-mrel-spec.pdf\n\n[1] javaee_platform-6_0-fr-spec.pdf\n http://jcp.org/aboutJava/communityprocess/final/jsr316/index.html \n\nAn example can be found in Jetty wiki:\n http://wiki.eclipse.org/Jetty/Feature/Annotations#Lifecycle_callbacks:_PostConstruct_PreDestroy \n\nSearching by the tag names, I do not see any code in the current trunk that processes those XML elements.', 'Konstantin Kolinko', '2013-01-07 04:07:15 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (58, '54377', 'Bug 54377 RemoteIpFilter does not correctly set request attributes for AccessLog', 'In RemoteIpFilter class, there is code that publishes the new request attributes to AccessLog (see below).\n\n821             if (requestAttributesEnabled) {\n822                 request.setAttribute(AccessLog.REMOTE_ADDR_ATTRIBUTE,\n823                         request.getRemoteAddr());\n824                 request.setAttribute(AccessLog.REMOTE_HOST_ATTRIBUTE,\n825                         request.getRemoteHost());\n826                 request.setAttribute(AccessLog.PROTOCOL_ATTRIBUTE,\n827                         request.getProtocol());\n828                 request.setAttribute(AccessLog.SERVER_PORT_ATTRIBUTE,\n829                         Integer.valueOf(request.getServerPort()));\n830             }\n\nThe problem is that the source values should come from xRequest, e.g. xRequest.getRemoteAddr() and xRequest.getRemoteHost(), etc.\n\nAs it is written above, RemoteIpFilter simply republishes the current values, and AccessLog therefore does not display the correct values.', 'Greg Arakelian', '2013-01-05 23:52:37 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (59, '54284', 'Bug 54284 Util.objectNameValueNeedsQuote throws NPE for anonymous Filters', 'How to reproduce?\n\nFrom inside the contextInitialized-Method of an ServletContextListener instance, call\n\ncontext.addFilter(null,\n      new ArbitraryFilter(pathPrefix)).addMappingForUrlPatterns(null, false, pathPrefix);\n\nWhat happens?\n\nDec 12, 2012 3:59:03 PM org.apache.catalina.core.StandardContext filterStart\nSEVERE: Exception starting filter null\njava.lang.NullPointerException\n        at org.apache.tomcat.util.modeler.Util.objectNameValueNeedsQuote(Util.java:26)\n        at org.apache.catalina.core.ApplicationFilterConfig.registerJMX(ApplicationFilterConfig.java:421)\n        at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:282)\n        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:108)\n        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4650)\n        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5306)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n        at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:657)\n        at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1637)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n        at java.lang.Thread.run(Thread.java:722)\n\nDec 12, 2012 3:59:03 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Error filterStart\nDec 12, 2012 3:59:03 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Context [] startup failed due to previous errors\n\n\nWhat should happen?\nEither - if null is not an allowed filter name, throw a IllegalArgumentException on context.addFilter(...)\nOr, if it is an allowed filter name, handle null-values gracefully', 'benjamin.gehrels_external', '2012-12-12 15:51:40 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (60, '54262', 'Bug 54262 An empty <absolute-ordering /> should turn off all web-fragments', 'The use of an <absolute-ordering> element does disable ServletContainerInitializer classpath scanning as discussed also in issue 53619. However, it does seem to require having at least one web-fragment name to be listed. In other words I would this:\n\n<absolute-ordering />\n\nTo turn off all web-fragments since none are named. A workaround is to list a web-fragment even if it doesn\'t exist but that shouldn\'t be necessary.', 'Rossen Stoyanchev', '2012-12-07 22:00:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (61, '54241', 'Bug 54241 NPE in BodyContentImpl', 'Created  attachment 29688   [details] \nPatch for BodyContentImpl.java\n\nSimilar as  BUG 35410 , there is a NPE when calling BodyContentImpl#write(String) if the String is NULL.', 'Sheldon Shao', '2012-12-04 07:53:25 UTC', 'tomcat_attachment/attachment 29688.txt');
INSERT INTO `tomcatbody` VALUES (62, '54220', 'Bug 54220 ErrorReportValve invoked on non-error responses too', 'If you issue a response.setStatus(404) from a servlet, you expect as per spec that the response is left untouched. No error page written. There is sendError for that.\n\nUnfortunately, ErrorReportValve reacts on line 158\n> if ((statusCode < 400) || (response.getContentCount() > 0))\n>            return;\n\nIf you take a look at the StandardHostValve, it invokes error handling on line 316\n> if (!response.isError())\n>            return;\nOn errors only (correct behavior).\n\nThe ErrorReportValve must react on response.isError() == true only. Regardless of the status code or the content count.\nThe Javadoc does not limit this to status codes >= 400 but is says that reponse.sendError() has to clears buffers. As far I understand that, regardless of the response body is disposed and the error reponse is always written.', 'Michael Osipov', '2012-11-28 20:19:49 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (63, '54217', 'Bug 54217 JDBC connection pool runs out of connections when Context reload=“true” is enabled in Tomcat', 'Created  attachment 29646   [details] \nException stack trace\n\nI am developing a Java EE web application in Eclipse Juno. I have configured Tomcat to use JDBC connection pool (org.apache.tomcat.jdbc.pool) along with PostgreSQL database. Here are the configurations in my project\'s META-INF/context.xml:\n\n<?xml version=\'1.0\' encoding=\'UTF-8\'?>\n<Context>\n    <!-- Configuration for the Tomcat JDBC Connection Pool -->\n    <Resource name=\'jdbc/someDB\'\n        type=\'javax.sql.DataSource\'\n        auth=\'Container\'\n        factory=\'org.apache.tomcat.jdbc.pool.DataSourceFactory\'\n        driverClassName=\'org.postgresql.Driver\'\n        url=\'jdbc:postgresql://localhost:5432/somedb\'\n        username=\'postgres\'\n        password=\'12345\'\n        maxActive=\'100\'\n        minIdle=\'10\'\n        initialSize=\'10\'\n        validatonQuery=\'SELECT 1\'\n        validationInterval=\'30000\'\n        removeAbandoned=\'true\'\n        removeAbandonedTimeout=\'60\'\n        abandonWhenPercentageFull=\'50\' />\n</Context>\n\nMy application is deployed to Tomcat using Eclipse, and in Tomcat\'s context.xml an attribute reloadable is set to \'true\' to automatically reload the web application if a change is detected:\n\n<Context reloadable=\'true\'>\n\nI have noticed that every time the above mentioned automatic reload is happening 10 more connections to PostgreSQL db is reserved (because in webapp\'s context.xml initialSize=\'10\'). So after 10 changes a PSQLException is thrown:\n\norg.postgresql.util.PSQLException: FATAL: sorry, too many clients already\n...\n(full stack in attachment)\n\nIf I manually restart Tomcat - everything is fine and just 10 connections are reserved. And I am closing all ResultSets, Statements/PrepareStatements, Connections in the finally block.\n\nWould be great if this issue could be fixed, so that it could be possible to develop with reloadable set to \'true\' and not cause pooling more connections every time the context is reloaded.\n\nP.S.\nApache Tomcat 7.0.32\nJava(TM) SE Runtime Environment (build 1.7.0_09-b05)\nEclipse Juno Service Release 1\nPostgreSQL version 9.1\nDB driver: postgresql-9.1-902.jdbc4.jar', 'Levan', '2012-11-28 10:35:43 UTC', 'tomcat_attachment/attachment 29646');
INSERT INTO `tomcatbody` VALUES (64, '54144', 'Bug 54144 Processing of java.io.Reader in \'Out\' tagplugin', 'Reviewing  r1401816  I see two issues in tagplugin o.a.jasper.tagplugins.jstl.core.Out:\n\nThe code that the plugin generates calls value.toString(), default.toString() and passes these String values to the static method Out.output(...). This new method was added in  r1401816 .\n\nI think the output() method should accept Objects instead of Strings, because the following is wrong:\n\n1. The evaluation of default.toString() is not needed at all if the default is not used.\n\n2. The JSTL spec (1.1, 1.2) says that there is special processing if value is java.io.Reader. There is no such processing in the current code. (It seems that this feature was added in JSTL 1.1).\n\n[quote]\nIf the result of the evaluation is not a java.io.Reader object, then it is coerced to\na String and is subsequently emitted into the current JspWriter object.\n\nIf the result of the evaluation is a java.io.Reader object, data is first read from the\nReader object and then written into the current JspWriter object.\n[/quote]\n\nThese two issues are not new - they existed before the recent changes.', 'Konstantin Kolinko', '2012-11-14 08:38:29 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (65, '54087', 'Bug 54087 HTTP Connector incorrectly throws Exception on Invalid If-Modified-Since Header', 'Given this request:\n\nFrame 6: 988 bytes on wire (7904 bits), 988 bytes captured (7904 bits)\nEthernet II, Src: Adtran_16:34:e9 (00:a0:c8:16:34:e9), Dst: Supermic_34:fe:a8 (00:30:48:34:fe:a8)\nInternet Protocol Version 4, Src: 198.58.103.28 (198.58.103.28), Dst: 216.17.130.68 (216.17.130.68)\nTransmission Control Protocol, Src Port: 37483 (37483), Dst Port: http (80), Seq: 1449, Ack: 1, Len: 922\n[2 Reassembled TCP Segments (2370 bytes): #4(1448), #6(922)]\nHypertext Transfer Protocol\n    GET /rss/calendar_id/2.xml HTTP/1.1 r n\n    Accept: application/atom+xml,application/rdf+xml,application/rss+xml,application/xml,text/xml,*/* r n\n    Connection: close r n\n    Accept-Encoding: gzip,deflate r n\n    User-Agent: Superfeedr bot/2.0  http://superfeedr.com  - Please get in touch if we are polling too hard. r n\n    X-Superfeedr-Url:  http://startupia.mhsoftware.com/rss/calendar_id/2.xml r n \n    If-None-Match: \'1351656000000\' r n\n    If-Modified-Since: 2012-10-31 04:00:00 +0000 r n\n    host: startupia.mhsoftware.com r n\nofu.dpn=ffffffffc3a03c0245525d5f4f58455e445a4a4236\n     r n\n    [Full request URI:  http://startupia.mhsoftware.com/rss/calendar_id/2.xml ]\n~                                                                               \n\nTomcat Throws the Exception:\n\n2012-10-31 15:47:15,381 [http-80-46] ERROR org.apache.catalina.core.ContainerBase.[Catalina].[startupia.mhsoftware.com].[/].[RSSProcessor]- Servlet.service() for servlet RSSProcessor threw exception\njava.lang.IllegalArgumentException: 2012-10-31 04:00:00 +0000\n        at org.apache.catalina.connector.Request.getDateHeader(Request.java:1924)\n        at org.apache.catalina.connector.RequestFacade.getDateHeader(RequestFacade.java:632)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:619)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n\nThis is because the date for the If-Modified-Since Header (2012-10-31 04:00:00 +0000) is not in the format specified by RFC-2616 Section 3.3.1. However, the RFC states in section 14.25a:\n\nif the passed If-Modified-Since date is invalid, the response is exactly the same as for a normal GET. A date which is later than the server\'s current time is invalid.\n\nTomcat is not complying with this aspect of the specification because it throws a 500 rather than processing it as described by the specification.', 'George Sexton', '2012-11-01 16:10:42 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (66, '54076', 'Bug 54076 SPNEGO authenticator\'s stateless-ness incompatible with stateful clients', 'At the moment, Tomcat is not able to store connection-level information to support stateful authentication mechanisms. This has been confirmed on the mailinglist:  http://www.mail-archive.com/users@tomcat.apache.org/msg102169.html \n\nUnfortunately, a client which observes that, like Apache HTTPComponents or libserf (used in Apache Subversion) with authenticate only the first the request and expect the server to cache that for the connection. Subsequent comm will end in an endless loop. See here  http://serf.googlecode.com/issues/attachment?aid=770006001&name=tomcat-serf-spnego-response.png&token=GDWvY5f7eMDzDGwtg1tD5N_MUXY%3A1351604707042&inline=1  and here  http://serf.googlecode.com/issues/attachment?aid=770006002&name=serf-endless-loop.png&token=cHvvfubJuAHDuTMjG_OHOaps5hQ%3A1351604707042&inline=1 \n\nA simple hint can tell the client that the server does not support stateful auth on a connection-level. Add here  http://svn.apache.org/viewvc/tomcat/tc7.0.x/trunk/java/org/apache/catalina/authenticator/SpnegoAuthenticator.java?view=markup#l272  before line 272 \'response.addHeader(\'Connection\', \'close\');\' and the client will open a new connection and reauth further requests.\n\nNot doing so makes the Tomcat server vulnerable to DoS as you can see in the second screenshot.', 'Michael Osipov', '2012-10-30 13:49:27 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (67, '53867', 'Bug 53867 Performance tuning solution for PageContextImpl.XmlEscape', 'Created  attachment 29369   [details] \nPatch for PageContextImpl.java\n\nXmlEscape is used to do escape special characters for EL result.\n Currently it gets characters from String one by one and check whether the char is special character or not, than put the char into a StringBuilder.\n\nMost cases the string has no such special characters, However, it always creates a new StringBuilder than do such iteration.\n\nIt\'s better to check whether there is any special characters first.\n If there is special character, then do create a StringBuilder and put those characters in front of te special character into the StringBuilder. \nAgain, check the string by character one by one similar as the original logic.\n\n\n\nHere is the result of comparison testing between the two methods.\n\nOld escape:1610\nNew escape:1050\nOld escape:1566\nNew escape:873\nOld escape:1437\nNew escape:905\nOld escape:1590\nNew escape:890\nOld escape:1452\nNew escape:889\nOld escape:1547\nNew escape:889\nOld escape:1467\nNew escape:889\nOld escape:1575\nNew escape:930\nOld escape:1479\nNew escape:874\nOld escape:1517\nNew escape:970', 'Sheldon Shao', '2012-09-13 13:33:48 UTC', 'tomcat_attachment/attachment 29369.txt');
INSERT INTO `tomcatbody` VALUES (68, '54012', 'Bug 54012 No \'pageContext\' in tag files\' generated java code when using code generation by JSTL tagplugin \'Set\'', 'Created  attachment 29485   [details] \nPatch for org.apache.jasper.tagplugins.jstl.core.Set.java\n\nThe code generated by the following code from \' org.apache.jasper.tagplugins.jstl.core.Set\' can\'t work in Tag Files.\n\nThere is no \'PageContext\' in tag file. So this should check \'isTagFile\'.\n\n            String strVar = ctxt.getConstantAttribute(\'var\');\n            ctxt.generateJavaSource(\'if(null != \' + resultName + \'){\');\n            ctxt.generateJavaSource(\'    pageContext.setAttribute( \'\' + strVar + \' \',\' + resultName + \',\' + iScope + \');\');\n            ctxt.generateJavaSource(\'} else {\');\n            if(hasScope){\n                ctxt.generateJavaSource(\'    pageContext.removeAttribute( \'\' + strVar + \' \',\' + iScope + \');\');\n            }else{\n                ctxt.generateJavaSource(\'    pageContext.removeAttribute( \'\' + strVar + \' \');\');\n            }\n            ctxt.generateJavaSource(\'}\');', 'Sheldon Shao', '2012-10-16 09:01:56 UTC', 'tomcat_attachment/attachment 29485.txt');
INSERT INTO `tomcatbody` VALUES (69, '53986', 'Bug 53986 Comment end tag preceded directly by a dash causes JSP fail compilation', 'Created  attachment 29466   [details] \nJSP file to reproduce compilation error\n\nI have a JSP file that contained a comment line as follows:\n<%--- comment ---%>\n\nSuch a JSP compiles in Tomcat 7.0.30, but it does not compile in 7.0.32.  I’ve attached a copy of a test file, which compiles in 7.0.30, but not in 7.0.32.  The only related change I see in the release notes is  https://issues.apache.org/bugzilla/show_bug.cgi?id=53713 .  \n\nFrom reading the JSP 2.2 spec, it appears that absent a specific comment about whitespace, the rules of XML shall apply, which effectively means whitespace is ignored.  This would seem to indicate this could be a regression introduced in 7.0.32, but since the spec is somewhat vague in the section about comments, \n\nERROR 09 Oct 2012 11:15:25,190 [http-bio-8080-exec-8] [com.liferay.portal.log.Co\nmmonsLogImpl.error(52)] org.apache.jasper.JasperException: /html/portal/layout/v\niew/portlet.jsp (line: 48, column: 6) Unterminated &lt;%-- tag\n        at org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorH\nandler.java:42)\n        at org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.j\nava:408)\n        at org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.j\nava:133)\n        at org.apache.jasper.compiler.Parser.parseComment(Parser.java:615)\n        at org.apache.jasper.compiler.Parser.parseElements(Parser.java:1425)\n        at org.apache.jasper.compiler.Parser.parse(Parser.java:138)\n        at org.apache.jasper.compiler.ParserController.doParse(ParserController.\njava:242)\n        at org.apache.jasper.compiler.ParserController.parse(ParserController.ja\nva:102)\n        at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:198)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:373)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:353)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:340)\n        at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext\n.java:646)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper\n.java:357)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:3\n90)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl\nicationFilterChain.java:305)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF\nilterChain.java:210)\n        at com.liferay.filters.strip.StripFilter.doFilter(StripFilter.java:260)', 'Steve Ratay', '2012-10-09 18:40:08 UTC', 'tomcat_attachment/attachment 29466.txt');
INSERT INTO `tomcatbody` VALUES (70, '53854', 'Bug 53854 DefaultServlet directory listings for aliased directories do not seem to work', 'The following situation does not seem to work.\n\n1.) In a Context, add an alias to a directory.\n2.) Enable directory listings on the DefaultServlet.\n3.) Try to view the directory listing of the alias directory.\n\nExample:\n\nconf/context.xml:\n\n  <Context aliases=\'/files=/my/downloads\'>\n  ...\n  </Context>\n\nconf/web.xml:\n\n    ...\n    <servlet>\n        <servlet-name>default</servlet-name>\n        <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n        <init-param>\n            <param-name>debug</param-name>\n            <param-value>0</param-value>\n        </init-param>\n        <init-param>\n            <param-name>listings</param-name>\n            <param-value>true</param-value>\n        </init-param>\n        <load-on-startup>1</load-on-startup>\n    </servlet>\n    ...\n\ncontents of the directory \'/my/downloads\':\n\n  -rw-r--r--@ 1 daniel  staff  8156824 Sep 10 09:15 apache-tomcat-7.0.30.zip\n\nURL works:\n\n http://localhost:8080/files/apache-tomcat-7.0.30.zip \n\nURL does not work:\n\n http://localhost:8080/files/ \n\nThe URL that does not work fails with the error:\n\nSEVERE: Servlet.service() for servlet [default] in context with path [/] threw exception [Error accessing resource] with root cause\njavax.naming.NameNotFoundException: Resource /files/ not found\n	at org.apache.naming.resources.FileDirContext.list(FileDirContext.java:303)\n	at org.apache.naming.resources.ProxyDirContext.list(ProxyDirContext.java:512)\n	at org.apache.catalina.servlets.DefaultServlet.renderHtml(DefaultServlet.java:1458)\n	at org.apache.catalina.servlets.DefaultServlet.render(DefaultServlet.java:1254)\n	at org.apache.catalina.servlets.DefaultServlet.serveResource(DefaultServlet.java:951)\n	at org.apache.catalina.servlets.DefaultServlet.doGet(DefaultServlet.java:412)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:680)', 'Daniel Mikusa', '2012-09-11 20:28:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (71, '53713', 'Bug 53713 Performance tuning solution for JspReader', 'Created  attachment 29223   [details] \npatch for JspReader.java\n\nmark() is called so many times when doing JSP or tag files compilation.\nThis can be reduced by a little bit code changes.\n\nAttached files contain this solution.', 'Sheldon Shao', '2012-08-14 06:28:58 UTC', 'tomcat_attachment/attachment 29223.txt');
INSERT INTO `tomcatbody` VALUES (72, '53793', 'Bug 53793 Change webapp links in Manager to point to /appname/ instead of /appname', 'The first column of the table that lists Web Applications in Tomcat Manager webapp contains links to those applications, e.g.\n\n  <a href=\'/examples\'>/examples</a>\n\nWhen the link is clicked and browser navigates to \'/examples\', it results in 302 redirect to \'/examples/\'.\n\nIt would be better to change that link to point directly to \'/examples/\'.\n\n  <a href=\'/examples/\'>/examples</a>\n\nI am changing the link address only, but not the text on it. That is because the \'Path\' of the web application displayed in that column (and used in Manager commands elsewhere) does not have the additional \'/\'.', 'Konstantin Kolinko', '2012-08-28 21:50:21 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (73, '42181', 'Bug 42181 ArrayIndexOutOfBoundsException in parseChunkHeader', 'Apr 22, 2007 11:53:32 AM org.apache.coyote.http11.Http11Processor process\nSEVERE: Error finishing request\njava.lang.ArrayIndexOutOfBoundsException: -28\n        at\norg.apache.coyote.http11.filters.ChunkedInputFilter.parseChunkHeader(ChunkedInputFilter.java:256)\n        at\norg.apache.coyote.http11.filters.ChunkedInputFilter.doRead(ChunkedInputFilter.java:129)\n        at\norg.apache.coyote.http11.filters.ChunkedInputFilter.end(ChunkedInputFilter.java:179)\n        at\norg.apache.coyote.http11.InternalInputBuffer.endRequest(InternalInputBuffer.java:368)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:894)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)', 'Nana', '2007-04-21 22:48:21 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (74, '53783', 'Bug 53783 Static resources and jsp files under WEB-INF/lib/*.jar!/META-INF/resources are not found', 'Created  attachment 29283   [details] \nExample\n\nHi,\n\nAccording to Servlet Specification, Servlet container should serve static resources and jsp files, located in META-INF/resources in any jar file under WEB-INF/lib.\n\n\'\n10.5  Directory Structure\nA Web application exists as a structured hierarchy of directories. The root of this hierarchy serves as the document root for files that are part of the application. For example, for a Web application with the context path /catalog in a Web container, the index.html file at the base of the Web application hierarchy or in a JAR file inside WEB-INF/lib that includes the index.html under META-INF/resources directory can be served to satisfy a request from /catalog/index.html. If an index.html is present both in the root context and in the META-INF/resources directory of a JAR file in the WEB-INF/lib directory of the application, then the file that is available in the root context MUST be used.\n\'\n\nWhen requesting such static resource/jsp file, Tomcat returns 404 Not Found.\n\nExample is attached.\nRequest:\n http://localhost:8080/test-meta-inf-resources/test.jsp \n http://localhost:8080/test-meta-inf-resources/meta_inf_resource.jsp \n\nAfter investigating the issue I think that the problem is in the following code:\norg.apache.catalina.startup.ContextConfig\nprotected void processResourceJARs(Set<WebXml> fragments) {\n...\n    if (jar.entryExists(\'META-INF/resources/\')) {\n        context.addResourceJarUrl(url);\n...\n}\n\nWhen I list the entries in jar, I receive:\nINFO: Deploying web application archive C: apache-tomcat-7.0.29 webapps test-met\na-inf-resources.war\n META-INF/MANIFEST.MF\n META-INF/resources/meta_inf_resource.jsp\n\nThere is no entry \'META-INF/resources/\'\n\nI would like to propose a patch (attached) with which the request URLs above are working as expected.\n\nBest Regards\nVioleta Georgieva', 'Violeta Georgieva', '2012-08-27 13:32:16 UTC', 'tomcat_attachment/attachment 29283.zip');
INSERT INTO `tomcatbody` VALUES (75, '53725', 'Bug 53725 Some GZipped responses result in java.io.IOException: Corrupt GZIP trailer during gunzip.', 'Created  attachment 29238   [details] \nPlease see description for purpose of attachment.\n\nFlushableGZIPOutputStream gives corrupt output in rare circumstances.  Tomcat 7 encounters this bug when compression is turned on.\n\nPlease see the attachment:  Compile and run ErrorCase.java which uses FlushableGZIPOutputStream to GZIP the contents of data.bin (included in the attachment) and then uses GZIPInputStream to gunzip the output of FlushableGZIPOutputStream, resulting in java.io.IOException: Corrupt GZIP trailer.', 'kevin.l.stern', '2012-08-15 18:28:36 UTC', 'tomcat_attachment/attachment 29238.zip');
INSERT INTO `tomcatbody` VALUES (76, '53697', 'Bug 53697 java.lang.NullPointerException at org.apache.coyote.http11.Http11AprProcessor.actionInternal(Http11AprProcessor.java:277)', 'I hit tomcat with ~20 different urls in ~2 seconds, test some functionality, wait ~3 minutes, then do it again and I always get this exception and then I get (intermitent) connection interrupted messages in the browser.  Here\'s the full trace:\n\nAug 10, 2012 6:33:14 PM org.apache.catalina.connector.CoyoteAdapter event\nSEVERE: null\nAug 10, 2012 6:33:14 PM org.apache.catalina.connector.CoyoteAdapter event\njava.lang.NullPointerException\n	at org.apache.coyote.http11.Http11AprProcessor.actionInternal(Http11AprProcessor.java:277)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:846)\n	at org.apache.coyote.Response.action(Response.java:172)\n	at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:229)\n	at org.apache.coyote.http11.Http11AprProcessor.event(Http11AprProcessor.java:133)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:581)\n	at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1770)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\n\nAug 10, 2012 6:33:14 PM org.apache.coyote.http11.Http11AprProcessor event\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.coyote.http11.Http11AprProcessor.actionInternal(Http11AprProcessor.java:277)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:846)\n	at org.apache.coyote.Request.action(Request.java:346)\n	at org.apache.catalina.connector.Request.getRemoteAddr(Request.java:1281)\n	at org.apache.catalina.connector.Request.getRemoteHost(Request.java:1296)\n	at org.apache.catalina.valves.AccessLogValve$HostElement.addElement(AccessLogValve.java:1327)\n	at org.apache.catalina.valves.AccessLogValve.log(AccessLogValve.java:953)\n	at org.apache.catalina.core.AccessLogAdapter.log(AccessLogAdapter.java:51)\n	at org.apache.catalina.core.ContainerBase.logAccess(ContainerBase.java:1263)\n	at org.apache.catalina.core.ContainerBase.logAccess(ContainerBase.java:1270)\n	at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:250)\n	at org.apache.coyote.http11.Http11AprProcessor.event(Http11AprProcessor.java:133)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:581)\n	at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1770)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\n\nAdditional information:\n - hp Proliant DL360 with two 3ghz processors\n - CentOS 6.3\n - One app runs websockets under bleading edge Atmosphere and Grails\n - the 20 urls come from chrome and firefox, simulatneously', 'lacycb', '2012-08-11 08:33:54 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (77, '53654', 'Bug 53654 JSP file is always recompiled for using file based TLD URL', 'Now, in Jasper codes, it only supports jar URL and relative URL, that may be enough for common web applications. While, it is possible that the third-party uses other protocol URL, like file: protocol based URL. So, the JSP files will be always recompiled for each access for the target page.\nThe codes are located in Compiler.isOutDated() method.\nIs it possible to provide more generic handlering for the URL ?', 'Ivan', '2012-08-05 14:47:43 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (78, '53545', 'Bug 53545 jsp:forward action to static resources causes IllegalStateException when inside classic custom tag', 'If we have a JSP like the one below we get java.lang.IllegalStateException: getOutputStream() has already been called for this response:\n\nNotes:\n1. the jsp:forward is inside classic custom tag ( extends BodyTagSupport).\n2. if I put a dynamic resource everything is fine (ex. redirect.jsp)\n3. I think that the response gets flushed if jsp:forward redirects to a static resource and that\'s why the exception is trown.\n\n\n\ntest.jsp\n\n<%@ page language=\'java\' contentType=\'text/html; charset=ISO-8859-1\' pageEncoding=\'ISO-8859-1\'%>\n<%@ taglib prefix=\'t\' uri=\'test\' %> \n\n<t:do>  \n  \n<jsp:forward page=\'redirect.html\'/>\n   \n   \n<!DOCTYPE html PUBLIC \'-//W3C//DTD HTML 4.01 Transitional//EN\' \' http://www.w3.org/TR/html4/loose.dtd \'>\n<html>\n<head>\n<meta http-equiv=\'Content-Type\' content=\'text/html; charset=ISO-8859-1\'>\n<title>Insert title here</title>\n</head>\n<body>\n</body>\n</html>\n\n</t:do>', 'Radu Gancea', '2012-07-13 07:53:20 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (79, '53481', 'Bug 53481 Support SSL_OP_CIPHER_SERVER_PREFERENCE / SSLHonorCipherOrder', 'Currently, Tomcat Native does not have an equivalent of the mod_ssl SSLHonorCipherOrder directive and is thus vulnerable to the SSL BEAST attack.\n\nSee  http://httpd.apache.org/docs/current/mod/mod_ssl.html#sslhonorcipherorder  for the docs on this directive, and  https://community.qualys.com/blogs/securitylabs/2011/10/17/mitigating-the-beast-attack-on-tls  on why and how it mitigates the BEAST attack.\n\nPlease incorporate an option named SSLHonorCipherOrder that sets the OpenSSL option SSL_OP_CIPHER_SERVER_PREFERENCE\n\nP.S., not sure whether to qualify this as bug or enhancement, but since it concerns a security issue I filed it as a bug.\n\nP.S.2, I\'m willing to create a patch myself, but since I don\'t have an Tomcat Native build env that will probably take some time... It\'s a really small change.', 'Mike Noordermeer', '2012-06-28 14:27:30 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (80, '53606', 'Bug 53606 NullPointerException in TcpPingInterceptor', 'start(int) method initializes failureDetector (resp. staticMembers) only if TcpFailureDetector (resp. StaticMembershipInterceptor) was found in channel interceptors stack.\n\nWithout TcpFailureDetector (resp. StaticMembershipInterceptor), futur calls to sendPing() will fail because failureDetector (resp. staticMembers) wasn\'t initialized at least to new WeakReference<StaticMembershipInterceptor>(null).\n\nFix:\nv1) initializes weak references containers:\nReplace:\n    WeakReference<TcpFailureDetector> failureDetector = null;\n    WeakReference<StaticMembershipInterceptor> staticMembers = null;\nfor:\n    WeakReference<TcpFailureDetector> failureDetector = new WeakReference<TcpFailureDetector>();\n    WeakReference<StaticMembershipInterceptor> staticMembers = new WeakReference<StaticMembershipInterceptor>();\n\nv2) checks field before dereferencing it:\nsendPing becomes:\n    protected void sendPing() {\n        if (failureDetector!=null && failureDetector.get()!=null) {\n            //we have a reference to the failure detector\n            //piggy back on that dude\n            failureDetector.get().checkMembers(true);\n        }else {\n            if (staticOnly && staticMembers!=null && staticMembers.get()!=null) {\n                sendPingMessage(staticMembers.get().getMembers());\n            } else {\n                sendPingMessage(getMembers());\n            }\n        }\n    }\n\n\n\naffect also tomcat 6\nregards\nfred arnoud', 'F.Arnoud', '2012-07-26 16:15:05 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (81, '53535', 'Bug 53535 Out of memory while performing ContextConfig.webConfig', 'Created  attachment 29047   [details] \nSuggested solution to improve ContextConfig\n\nJavaClassCacheEntry objects are using too much memory causing eventually (all kinds of) out of memory errors during container startup. There is no need to save whole JavaClass in cache since only superclass name and interface names are needed in later processing.\n\nSuggested solution is attached.', 'Cedomir Igaly', '2012-07-11 10:29:10 UTC', 'tomcat_attachment/attachment 29047');
INSERT INTO `tomcatbody` VALUES (82, '53469', 'Bug 53469 possible bug in Response.normalize(CharChunk cc)', 'The Response.normalize(CharChunk cc) introduced in 7.0.28 introduced a bug.\nSee Bug ID 53062\n\nThe URL that is being encoded is:\n../../resources/org.apache.wicket.markup.html.WicketEventReference/wicket-event.js?w:lm=1340711670\nwhich causes a IllegalArgumentException in this method\n\njava.lang.IllegalArgumentException\n	at org.apache.catalina.connector.Response.normalize(Response.java:1799)\n	at org.apache.catalina.connector.Response.toAbsolute(Response.java:1732)\n	at org.apache.catalina.connector.Response.encodeURL(Response.java:1242)\n	at org.apache.catalina.connector.ResponseFacade.encodeURL(ResponseFacade.java:406)\n	at org.apache.wicket.protocol.http.WebResponse.encodeURL(WebResponse.java:149)\n	at org.apache.wicket.protocol.http.request.WebRequestCodingStrategy.encode(WebRequestCodingStrategy.java:387)\n\nRunning the same application in tomcat 7.0.27 and 6.0.18 works without issue', 'Thyzz', '2012-06-26 12:45:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (83, '53513', 'Bug 53513 Race condition / out of order operation in session replication at node startup', 'My configuration:\n\n2 nodes running Tomcat 7.0.26\nUsing a custom session manager, which extends the DeltaManager\n\nMy startInternal() method first calls super.startInternal(), then performs a few additional initializations.\n\nI reviewed the code of DeltaManager.startInternal(), and it calls getAllClusterSessions() which in turn calls waitForSendAllSessions(), which requires either getStateTransfered() to return true, or a timeout.\n\nSo by this, I should be able to trust that as the second node starts, the initial sync up of all session data from the first node has completed prior to the startInternal() method exiting (and thus prior to my initializations).\n\nThis is, however, not the case!  I can confirm this by repeatedly logging the value of findSessions().length during my inializations, and see that number going up!\n\nThere appears to be a race condition between the processing of the message containing the actual session data & the \'transfer complete\' message.  After tracing this through a little further, I see the stateTransfered is set to true in the handleALL_SESSION_TRANSFERCOMPLETE() callback method.  And that callback is being called PRIOR to the session data itself even being received!\n\nHere is the debug logging output (slightly scrubbed) which shows this out of order messaging:\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager getAllClusterSessions\nINFO: Manager [wwwtest#], requesting session state from org.apache.catalina.tribes.membership.MemberImpl[...].\nThis operation will timeout if no session state has been received within 60 seconds.\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager messageReceived\nFINE: Manager [wwwtest#]: Received SessionMessage of type=(SESSION-STATE-TRANSFERED) from [org.apache.catalina.tribes.membership.MemberImpl[...]\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager handleALL_SESSION_TRANSFERCOMPLETE\nFINE: Manager [wwwtest#] received from node [[B@6789b939:4,000] session state transfered.\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager messageReceived\nFINE: Manager [wwwtest#]: Received SessionMessage of type=(ALL-SESSION-DATA) from [org.apache.catalina.tribes.membership.MemberImpl[...]\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager handleALL_SESSION_DATA\nFINE: Manager [wwwtest#]: received session state data', 'David Johle', '2012-07-05 21:56:22 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (84, '52135', 'Bug 52135 Global error page is not handled', 'The new Servlet 3.0 global error page\n\n    <error-page>\n        <location>/error.jsp</location>\n    </error-page>\n\nis not handled in Tomcat 7.\n\nOn Glassfish 3 for example, it works fine.', 'balusc', '2011-11-04 14:15:58 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (85, '53416', 'Bug 53416 Two datasources with the same name in different web applications results in javax.management.InstanceAlreadyExistsException', 'Deploy two different web applications onto Tomcat.\n\nEach web application has a resource that:\n\n* uses the Use Tomcat JDBC Connection Pool\n* has an identical name to the other one\n\n<Resource name=\'jdbc/collision\' factory=\'org.apache.tomcat.jdbc.pool.DataSourceFactory\' ... />\n\nWhen starting the server you get a non fatal error in the logs InstanceAlreadyExistsException.  Both applications appear to still work OK\n\nERROR org.apache.tomcat.jdbc.pool.DataSource - Unable to register JDBC pool with JMX\njavax.management.InstanceAlreadyExistsException: tomcat.jdbc:name=\'jdbc/soscvuk\',context=/,type=ConnectionPool,host=localhost,class=org.apache.tomcat.jdbc.pool.\nDataSource\n	at com.sun.jmx.mbeanserver.Repository.addMBean(Repository.java:453) ~[na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.internal_addObject(DefaultMBeanServerInterceptor.java:1484) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerDynamicMBean(DefaultMBeanServerInterceptor.java:963) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerObject(DefaultMBeanServerInterceptor.java:917) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:312) [na:1.6.0_32]\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:482) [na:1.6.0_32]\n	at org.apache.tomcat.jdbc.pool.DataSource.registerJmx(DataSource.java:135) [tomcat-jdbc.jar:na]\n	at org.apache.tomcat.jdbc.pool.DataSource.preRegister(DataSource.java:102) [tomcat-jdbc.jar:na]\n	at org.apache.tomcat.util.modeler.BaseModelMBean.preRegister(BaseModelMBean.java:1132) [tomcat-coyote.jar:7.0.27]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.preRegisterInvoke(DefaultMBeanServerInterceptor.java:1010) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerDynamicMBean(DefaultMBeanServerInterceptor.java:938) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerObject(DefaultMBeanServerInterceptor.java:917) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:312) [na:1.6.0_32]\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:482) [na:1.6.0_32]\n	at org.apache.tomcat.util.modeler.Registry.registerComponent(Registry.java:742) [tomcat-coyote.jar:7.0.27]\n	at org.apache.catalina.core.NamingContextListener.addResource(NamingContextListener.java:1062) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.NamingContextListener.createNamingContext(NamingContextListener.java:671) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.NamingContextListener.lifecycleEvent(NamingContextListener.java:270) [catalina.jar:7.0.27]\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) [catalina.jar:7.0.27]\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5161) [catalina.jar:7.0.27]\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615) [catalina.jar:7.0.27]\n	at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:649) [catalina.jar:7.0.27]\n	at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1585) [catalina.jar:7.0.27]\n	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441) [na:1.6.0_32]\n	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303) [na:1.6.0_32]\n	at java.util.concurrent.FutureTask.run(FutureTask.java:138) [na:1.6.0_32]\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [na:1.6.0_32]\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [na:1.6.0_32]\n	at java.lang.Thread.run(Thread.java:662) [na:1.6.0_32]', 'Anthony Gerrard', '2012-06-14 13:37:06 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (86, '53406', 'Bug 53406 Stack overflow in connector', 'found against trunk on Jun 18, 2012\n\nSEVERE:\njava.lang.StackOverflowError\n        at org.apache.catalina.core.StandardContextValve.event(StandardContextValve.java:128)\n        at org.apache.catalina.valves.ValveBase.event(ValveBase.java:204)\n        at org.apache.catalina.core.StandardHostValve.event(StandardHostValve.java:223)\n        at org.apache.catalina.valves.ValveBase.event(ValveBase.java:204)\n        at org.apache.catalina.valves.ValveBase.event(ValveBase.java:204)\n        at org.apache.catalina.core.StandardEngineValve.event(StandardEngineValve.java:110)\n        at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:209)\n        at org.apache.coyote.http11.Http11NioProcessor.event(Http11NioProcessor.java:124)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:569)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)', 'Filip Hanik', '2012-06-13 03:51:40 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (87, '53374', 'Bug 53374 DataSourceFactory does not support commitOnReturn property', 'DataSourceFactory does not support commitOnReturn property.\nDataSourceFactory.ALL_PROPERTIES and DataSourceFactory.parsePoolProperties() omit commitOnReturn property.', 'Suresh Avadhanula', '2012-06-06 20:56:47 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (88, '53367', 'Bug 53367 Database failure may cause pool to hang', 'during the \n con.connect(); \ncall in the method \n\nprotected PooledConnection borrowConnection(long now, PooledConnection con, String username, String password) in ConnectionPool.java\n\nThere is no counting down the size of the pool. This means, if a connection failure happens here, the pool size remains the same. This means that \'size\' will show the pool as full, but in reality the pool is empty', 'Filip Hanik', '2012-06-06 01:01:10 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (89, '53032', 'Bug 53032 Ant Jasper task fails to run when using XML namespaces; no output; no errors', 'One way to use bulk task definitions in Ant is to use XML namespaces:\n\n\n<project name=\'teamcity\'\n         xmlns:tomcat6=\' http://tomcat.apache.org/ant/tomcat/6 \'>\n\n...\n\n\n    <path id=\'tomcat.6.ant.classpath\'>\n        <fileset dir=\'${my.path.library.build}/tomcat-6.0.35\'>\n            <include name=\'*.jar\' />\n        </fileset>\n        <path refid=\'my.path.compile.jsp\' />\n    </path>\n\n    <typedef resource=\'org/apache/catalina/ant/antlib.xml\'\n             uri=\' http://tomcat.apache.org/ant/tomcat/6 \'\n             classpathref=\'tomcat.6.ant.classpath\' />\n\n...\n\n    <target>\n        <tomcat6:list ... />\n        <tomcat6:deploy ... />\n    </target>\n\n...\n</project>\n\nThis works great for list, deploy, etc. In fact, it works great for every other Ant task as far as I can tell. But it doesn\'t work for the jasper/jasper2 tasks (which both point to the same class).\n\n<tomcat6:jasper ... />\n\nThis does nothing. And by “nothing” I mean that I use `ant -verbose` when running Ant, verbose=”1” within the Jasper task, and there’s no output from the Jasper task, not a single line of output/logging, and the build completes in 0 seconds with no compiled JSPs output.\n\nHowever, if I define the Jasper task explicitly, using the exact same paths (as you can clearly see):\n \n    <taskdef classname=\'org.apache.jasper.JspC\' name=\'tomcat6-jsp-compile\'>\n        <classpath>\n            <path refid=\'tomcat.6.ant.classpath\' />\n        </classpath>\n    </taskdef>\n \nAnd call the Jasper task using the exact same options:\n \n<tomcat6-jsp-compile ... />\n \nEverything works. It compiles 2,487 JSPs in 275s, and outputs exactly what I expect, including 2,487 compiled JSPs and two logging messages. From what I understand about Ant, there should be absolutely no difference, and yet there apparently is, because they behave differently.\n\nThe jasper task should support namespaces like the other Tomcat Ant tasks, and like other Ant tasks in general.\n\n(Note: I have confirmed at  http://ant.apache.org/faq.html  that a separate classloader IS used for the taskdef, and that Jspc will not have access to conflicting classes loaded by other namespaces.)', 'Nick Williams', '2012-04-03 21:41:35 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (90, '53337', 'Bug 53337 IllegalStateException when trying to render a JSP after startAsync', 'The scenario involves:\n\n1. ServletA forwards to Servlet B\n2. ServletB calls request.startAsync and starts thread\n3. New thread attempts to render a JSP\n\nI\'ve tried JSP rendering via asyncContext.dispatch(\'\') and via request.getRequestDispatcher(\'\') plus forward or include.\n\nWhen using a RequestDispatcher, calling ServletA fails while calling ServletB directly succeeds. \n\nWhen using AsyncContext.dispatch, both ServletA and ServletB fail.\n\nThe exception is always the same (while attempting to render the JSP):\n\njava.lang.IllegalStateException: Cannot create a session after the response has been committed\n\nI\'ve created a project at:\n https://github.com/rstoyanchev/dispatch-test \n\nThe project page contains instructions and attached is a .war although you might want to check the source out in order to try a couple of variations.\n\nBeyond the specifics of the bug, the more general question is whether it is ok to use request.getRequestDispatcher from an async thread? That seems to be the case in Tomcat, aside from this bug, but in other containers (Jetty in particular) it\'s clearly not recommended. \n\nServlet Spec discussion on this question: \n http://java.net/projects/servlet-spec/lists/users/archive/2012-05/message/10 .', 'Rossen Stoyanchev', '2012-05-31 17:06:36 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (91, '53301', 'Bug 53301 Servlet init method called twice with embedded Tomcat', 'When using embedded Tomcat, the servlet init method is called twice by the container. This has been seen with an Apache DirectMemory unit test. I have checked with a normal Tomcat launched by the Tomcat Maven plugin (mvn tomcat7:run) and in this case, the init method is correctly called once.', 'Jeff MAURY', '2012-05-26 21:36:56 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (92, '53074', 'Bug 53074 [websocket] java.net.SocketTimeoutException: Read timed caused by server.xml\' connectTimeout', 'The default connectTimeout value is set to 20000 and cause issue with WebSocket connection\n\njava.net.SocketTimeoutException: Read timed out\n    at java.net.SocketInputStream.socketRead0(Native Method)\n    at java.net.SocketInputStream.read(SocketInputStream.java:129)\n    at org.apache.coyote.http11.upgrade.UpgradeBioProcessor.read(UpgradeBioProcessor.java:75)\n    at org.apache.catalina.websocket.WsFrame.nextFrame(WsFrame.java:213)\n    at org.apache.catalina.websocket.WsInputStream.nextFrame(WsInputStream.java:68)\n    at org.apache.catalina.websocket.StreamInbound.onData(StreamInbound.java:143)\n    at org.apache.coyote.http11.upgrade.UpgradeProcessor.upgradeDispatch(UpgradeProcessor.java:83)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:563)\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:680)\n\nIncreasing the value delay the issue (but the timeout should not occurs)', 'Jean-Francois Arcand', '2012-04-13 13:45:11 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (93, '50864', 'Bug 50864 Reconfigure pool on the fly using JMX', 'Provide a way to reconfigure the jdbc-pool using JMX and have it take effect when changes are submitted.\n http://markmail.org/message/x6wem3zkxl4ps7ki ', 'Filip Hanik', '2011-03-03 11:15:31 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (94, '53001', 'Bug 53001 Behaviour of ResourceBundleELResolver', 'I have discovered the the ResourceBundleELResolver from the tomcat el-api.jar behaves differently then the one from standard el-api.\n\nThe difference lays in the handling of missing properties. The tomcat version will not set the resolved property to true such that evaluation continues and finally an exception is thrown. This causes pages to crash if a property can not be found (which I think is kind of unacceptable for production sites).\n\nThe bahaviour was changed due to  https://issues.apache.org/bugzilla/show_bug.cgi?id=46915 .\n\nI think that changing the standard behaviour of \'resolving\' an unbound property by just returning its key is to throwing an exception was a strong decision. I would strongly recommend of reintroducing the old bahviour and fixing the issue 46915 in a different way. If someone can point my to the requirements and corner cases related to 46915, I will gladly provide an implementation.\n\nUntil then, a workaround for everybody using jsf: Subclass the ResourceBundleELResolver and override its getValue(...) method. Change it such that it sets the PropertyResolved attribute to true before any exception might occur. Register this custom resolver in the faces-config.xml with <el-resolver>', 'b.diedrichsen', '2012-03-29 09:41:39 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (95, '52833', 'Bug 52833 NPE with 7.0.26', 'Upgrading the maven plugin 7.0.26, the goal which runs tomcat with a conf dir (not the embed version) generate the following NPE \nLog:\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:236)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:141)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:645)\n	at org.apache.tomcat.maven.plugin.tomcat7.run.AbstractRunMojo.startContainer(AbstractRunMojo.java:679)\n	at org.apache.tomcat.maven.plugin.tomcat7.run.AbstractRunMojo.execute(AbstractRunMojo.java:365)\n	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)\n	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)\n	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)\n	at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)\n	at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)\n	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)\n	at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)\n	at org.apache.maven.cli.MavenCli.execute(MavenCli.java:544)\n	at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:197)\n	at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)', 'olamy', '2012-03-05 23:28:06 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (96, '52066', 'Bug 52066 ConnectionPool.borrowConnection swallows interrupt state.', 'In this code snippet starting on line 6.15 of ConnectionPool.java version 7.0.22\n\n    try {\n        //retrieve an existing connection\n        con = idle.poll(timetowait, TimeUnit.MILLISECONDS);\n    } catch (InterruptedException ex) {\n        Thread.interrupted();//clear the flag, and bail out\n        SQLException sx = new SQLException(\'Pool wait interrupted.\');\n        sx.initCause(ex);\n        throw sx;\n    } finally {\n        waitcount.decrementAndGet();\n    }\n\nThe line marked \'//clear the flag, and bail out\' is wrong, because after that there is no way for calling code to find out that the thread has been interrupted.\n\nThe correct behavior should be\n\n    Thread.currentThread( ).interrupt( );\n\nHere is the excerpt from the Biran Goetz\'s \'Java Concurrency in Practice\' chapter 5.4.\n\n<!START QUOTATION>\nFor library code there are basically two choices:\n\n-- Propagate the InterruptedException. This is often the most sensible policy if you can get away with it -- just propagate the InterruptedException to your caller.  This could involve not catching InterruptedException, or catching it and throwing it again after performing some brief activity-specific cleanup. \n\n-- Restore the interrupt. Sometimes you cannot throw InterruptedException, for instance when your code is part of a Runnable. In these situations, you must catch InterruptedException and restore the interrupted status by calling interrupt on the current thread, so that code higher up the call stack can see that an interrupt was issued.\n<!END QUOTATION>\n\nIn the case of borrowConnection, #1 is not really a choice, as it is running in the confines of JDBC interface.  But it can definitely restore the interrupt status of the thread.', 'Alexander Pogrebnyak', '2011-10-20 19:28:24 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (97, '52850', 'Bug 52850 Various miscellaneous fixes to Tomcat Memory Leak Detection code', 'Problem Description - \n----------------------\nTomcat memory leak detection has the following issues\n- Most of the detection and fixing code has been tested ONLY on Sun JVMs. A lot of  the reflection based code does not work with the IBM JDK. \n- Tests in tomcat7.source test org apache catalina loader do not seem to run successfully and are incomplete for all the protection that Tomcat provides for classloader memory leaks.\n- For some categories of threadlocal memory leaks the key and value are not displayed correctly in the warning messages; particularly ones dealing with indirect references to threadlocals\n-  org.apache.catalina.loader.WebappClassLoader.loadedByThisOrChild(Object) incorrectly traverses the object classloader hierarchy instead of the current (this) classloader hierarchy\n\nProblem Conclusion - \n--------------------\n- After extensive testing with the IBM JDKs, I have cleaned up and sanitized some of the reflection code to stop executors, timers, threads etc on the IBM JDK\n- Added new tests for detecting threadlocal leaks and thread leaks\n- Better ThreadLocal leak reporting with corrected loadedByThisOrChild method and addition of expungeStaleEntries method\n- Make code more resilient in certain leak detection scenarios.', 'Rohit Kelapure', '2012-03-07 14:57:15 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (98, '52500', 'Bug 52500 Improve client certificate authentication', '', 'Michael', '2012-01-23 13:02:04 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (99, '52792', 'Bug 52792 Incomplete error message when lookup a resource that is not bound in the naming', 'Created  attachment 28401   [details] \nPatch proposal\n\nHi,\n\nI have a servlet that specifies @Resource on a field level. (see attached sample application)\nWhen a request comes for this servlet, Tomcat tries to inject this resource and to instantiate the servlet. If the resource is not found, 500 ISE is returned as a response code. In the error message returned in the error page, it is not specified the full composite name that Tomcat tries to lookup, but only the first part (the context) (see incorrect.png). Thus the end user cannot understand which is the resource that causes the problem, but only the context that cannot be found.\n\nI would like to propose a patch (attached). A screenshot (correct.png) with corrected error message is also attached.\n\nThanks in advance.\nRegards,\nVioleta Georgieva', 'Violeta Georgieva', '2012-02-28 20:30:12 UTC', 'tomcat_attachment/attachment 28401.txt');
INSERT INTO `tomcatbody` VALUES (100, '52669', 'Bug 52669 Annotation processing, in WEB-INF/classes, for Servlets/Listeners/Filters is skipped when the web app is not extracted, classes do not have packages and for some embedded scenarios', 'Hi,\n\nAnnotation processing for Servlets/Listeners/Filters is skipped when:\n- the web app is not extracted (screenshot1), \n- classes do not have packages (screenshot2),\n- for some embedded scenarios (running Tomcat in OSGI environment - screenshot3)\n\nA test web application is attached - test-web-app.war.\n\nI followed the history and the change that introduces that behaviour is made with  revision 1210012 .\n\n\n\norg.apache.catalina.startup.ContextConfig\n\nThe annotations are processed correctly in all use cases when we have:\n\n1199    URL webinfClasses;\n1200    try {\n1201        webinfClasses = context.getServletContext().getResource(\n1202                                \'/WEB-INF/classes\');\n1203        processAnnotationsUrl(webinfClasses, webXml);\n1204    } catch (MalformedURLException e) {\n1205        log.error(sm.getString(\n1206                                \'contextConfig.webinfClassesUrl\'), e);\n1207    }\n\n\nThe way how they are processed now is assuming that we will have FirDirContext always.\n\n1196    try {\n1197        NamingEnumeration<Binding> listBindings =\n1198                    context.getResources().listBindings(\'/WEB-INF/classes\');\n1199        while (listBindings.hasMoreElements()) {\n1200            Binding binding = listBindings.nextElement();\n1201            if (binding.getObject() instanceof FileDirContext) {\n1202               File webInfCLassDir =\n1203                     new File(\n1204                       ((FileDirContext) binding.getObject()).getDocBase());\n1205               processAnnotationsFile(webInfCLassDir, webXml);\n1206            }\n1207        }\n1208    } catch (NamingException e) {\n1209        log.error(sm.getString(\n1210                            \'contextConfig.webinfClassesUrl\'), e);\n1211    }\n\n\nRegards\nVioleta Georgieva', 'Violeta Georgieva', '2012-02-14 21:39:46 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (101, '52444', 'Bug 52444 Classloading-based ServletContainerInitializer @HandlesTypes processing can result in long startup times', 'See 52326 for background, noting particularly the following:\n\n\'As long as SCI processing involves expensive classloading, larger applications will suffer from long startup times and thus be encouraged to \'shut off\' this functionality via metadata-complete=\'true\'.\'\n\nThis issue, then, is intended to address classloading-based approach to @HandlesTypes processing by replacing it with something faster and generally less problematic.  ASM would be one way to get it done.', 'Chris Beams', '2012-01-09 17:11:12 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (102, '52543', 'Bug 52543 Exception', 'SEVERE: Error finishing response\njava.lang.ArrayIndexOutOfBoundsException\n	at java.lang.System.arraycopy(Native Method)\n	at org.apache.coyote.http11.AbstractOutputBuffer.write(AbstractOutputBuffer.java:495)\n	at org.apache.coyote.http11.AbstractOutputBuffer.sendStatus(AbstractOutputBuffer.java:337)\n	at org.apache.coyote.http11.AbstractHttp11Processor.prepareResponse(AbstractHttp11Processor.java:1418)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:756)\n	at org.apache.coyote.Response.action(Response.java:168)\n	at org.apache.coyote.http11.AbstractOutputBuffer.endRequest(AbstractOutputBuffer.java:310)\n	at org.apache.coyote.http11.InternalOutputBuffer.endRequest(InternalOutputBuffer.java:158)\n	at org.apache.coyote.http11.AbstractHttp11Processor.endRequest(AbstractHttp11Processor.java:1586)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1022)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\n\nbig application i dont know why its happens\nmay be due to the fact that twice as add some cookie', 'Evgeny', '2012-01-27 11:18:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (103, '52511', 'Bug 52511 Exception logged in annotation scanning for web apps without /WEB-INF/classes', 'Created  attachment 28196   [details] \nerror and exception trace\n\nAny web app not containing a /WEB-INF/classes directory appears to cause an error and exception trace to be logged during web app startup.  This is new Tomcat 7.0.25 (or 7.0.24) and did not occur in 7.0.23.', 'Jess Holle', '2012-01-23 21:02:08 UTC', 'tomcat_attachment/attachment 28196.txt');
INSERT INTO `tomcatbody` VALUES (104, '52474', 'Bug 52474 Do not load listeners declared with blank spaces on tld file.', 'Created  attachment 28163   [details] \ndebugging tomcat source\n\nDo not load listeners declared with blank spaces on tld file.\nRemoving blank spaces the application run.', 'Helio Frota', '2012-01-17 05:41:49 UTC', 'tomcat_attachment/attachment 28163.png');
INSERT INTO `tomcatbody` VALUES (105, '51408', 'Bug 51408 String.getBytes() and new String(byte[]) use default charset - may cause problems in some Locales', 'There seem to be rather a lot of instances where Strings and bytes are cconverted using the default charset.\n\nSince the default charset is unknown, its behaviour cannot be relied on.', 'Sebb', '2011-06-21 15:47:16 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (106, '38216', 'Bug 38216 Extend Jmxproxy to allow call of MBean Operations', 'Currently one can only query Beans or set/get Attributes of them. It would be\ngood if a certain operation of a MBean could be called by the Jmxproxy Servlet.', 'Christopher Hlubek', '2006-01-10 18:01:22 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (107, '52245', 'Bug 52245 Add detection of EL Jar to WebappClassLoader', 'The EL API is not currently detected by the code in WebappClassLoader.\nApplications containing el-api.jar will not start.\n\n(patch to follow).', 'Pid', '2011-11-25 15:13:41 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (108, '52440', 'Bug 52440 Wrong getValueReference behaviour with Facelets parameter expressions', 'ValueExpression method getValueReference should return base object and property. But it returns null if ValueExpression is Facelets parameter.\nExample:\n\nsomeVar = #{concreteObject.property}\n\nValueExpression for #{someVar} return null from method getValueReference (guess because it is simple expression #{someVar}), but logicaly it should return parent expressions ValueReference (need hierachical ValueReference lookup).\n\nI made workaround with Java Reflect API in my code and it illustrates problem:\n\nELContext elContext = FacesContext.getCurrentInstance().getELContext();\nValueReference reference = exp.getValueReference(elContext);\n        \nif (reference == null && exp instanceof TagValueExpressionUEL) {\n	ValueExpressionImpl origExp = (ValueExpressionImpl) ((TagValueExpressionUEL) exp).getWrapped();\n            \n	// TODO: JR: find better way to get base and property. ! Code is not portable because uses Tomcat EL implementation details. ! \n	Field field = ReflectionUtils.findField(origExp.getClass(), EL_IMPL_VAR_PROPERTY);\n	field.setAccessible(true);\n	VariableMapper varMapper = (VariableMapper) ReflectionUtils.getField(field, origExp);\n    field = ReflectionUtils.findField(origExp.getClass(), EL_IMPL_NODE_PROPERTY);\n    field.setAccessible(true);\n    SimpleNode node = (SimpleNode) ReflectionUtils.getField(field, origExp);\n\n    if (varMapper != null && node != null) {\n		ValueExpression parentExp = varMapper.resolveVariable(node.getImage());\n        if (parentExp != null) {\n			try {\n				reference = parentExp.getValueReference(elContext);\n\n                if (reference == null) {\n					reference = getValueReference(parentExp);\n                }\n            } catch (PropertyNotFoundException e) {\n				LOG.warn(\'Property not found: \' + e.getMessage());\n            }\n        }\n    }\n}', 'JustasR', '2012-01-09 09:11:20 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (109, '52328', 'Bug 52328 Massive garbage production observed when using the response writer', 'In our application we used to use Tomcat 5, by writing our content directly to the response writer in our servlet:\n\nWriter w = response.getWriter();\nw.append(...)\n\n\nWe have regularly measured performance of our application under stress with multiple simultaneous requests per second.\n\nWe recently upgraded to Tomcat 7, and immediately observed a performance degradation of 10% on the request roundtrip on the same machine and the same tests, compared to our application deployed on Tomcat 5.\n\nProfiling with JProfiler showed that we got massive amount of transient objects {{java.nio.HeapCharBuffer}} produced - 400Mb+ within a few minutes.\n\nThe way we are writing the response is by multiple statements of {{append}} of small strings or single chars, which used to work properly. For experiment, we wrapped the response writer with a {{BufferedWriter}} with a buffer of 64k. This brought our application\'s performance back to normal.\n\nWe see this as either a:\n- anti-pattern usage since Tomcat 6/7, in which case please provide some documentation about that.\n- bug in the C2BConverter that is applied per every call to the CoyoteWriter write methods, which generates the garbage buffers per every call.\n\nWe know that the response stream has a 8k buffer by default. Nevertheless, this buffer comes after the encoding step and as such it is too late to help with the garbage. Perhaps Tomcat can buffer before it encodes?\n\nStill, so much transient objects for just a pattern of eligible use of the servlet API seems a bug to me.', 'Nikolay Diakov', '2011-12-14 11:03:38 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (110, '52293', 'Bug 52293 antiResourceLocking and unpackWARs', 'Created  attachment 28034   [details] \nContextConfig.java\n\nIt appears that Tomcat is attempting to copy the WAR from the $CATALINA_HOME/webapps directory to the $CATALINA_HOME/temp directory without the .war extension (e.g., original docBase is $CATALINA_HOME/webapps/example.war and a new docBase of $CATALINA_HOME/temp/1-example ).  I think that line 973 in ContextConfig.java method antiLocking never evaluates correctly because the docBase gets set to the value of path on line 969, which removes the .war extension so the file ends up being $CATALINA_HOME/temp/1-example instead of 1-example.war.  \n \nAdditionally, applications with sub-context paths (e.g., foo#bar.war) never get deployed to temp correctly with antiResourceLocking=\'true\' regardless of the unpackWARs setting because of the above scenario and because the docBase gets set to the context path in the antiLocking method which converts the # separator to /.  There appears to be a fix on line 882 of fixDocBase that converts the / character to # in the path but that doesn\'t make it to the antiLocking method.\n\nBoth 6.0.35 and 7.0.23 exhibit the same behaviour.  In 7.0.23, the docBase is changed back to the context path via the ContextName now instead of the context.getPath() but the result is the same.  Interestingly enough, there is a comment in the 7.0.23 source on line 750 that suggests the code to copy the .war file is never reached and that it\'s possibly a bug.  This code is never reached because the docBase is changed to the path without the .war extension.', 'Justin Miller', '2011-12-06 18:54:27 UTC', 'tomcat_attachment/attachment 28034.txt');
INSERT INTO `tomcatbody` VALUES (111, '52225', 'Bug 52225 Adding Alias for existing host on running Tomcat causes ClassCastException', 'There is an error in the fix for  Bug 42707 \n(\'add host alias using jmx doesn\'t take affect until restart\')\n\nIn Mapper#addHostAlias(String name, String alias)\nthe following line:\n   newHost.object = realHost;\n\nshould be replaced with the following one:\n   newHost.object = realHost.object;\n\nThat was  r712467  (3 years ago). The issue affects current 5.5.x and 6.0.x as well.\n\nThe issue manifests itself only if addAlias() is called on an existing Host in embedded scenario or through JMX. The usual workflow of configuring aliases in server.xml is not affected.\n\n\n\nThe issue was reported on the dev@ list,\n http://tomcat.markmail.org/thread/sskxor4a3xtrjmk3 \n\'Multiple Aliases Problem\'\n\nReproduction recipe #1, as reported on dev@:\n\n<quote>\n  I created a Host instance with the localhost1 domain name.\n\n  Host host = new StandardHost();\n  host.setAppBase(CATALINA_HOSTS_HOME);\n  host.setName(\'localhost1\');\n  host.setDeployOnStartup(false);\n  host.setBackgroundProcessorDelay(5);\n  host.setAutoDeploy(false);\n  host.setRealm(engine.getRealm());\n  engine.addChild(host);\n\n  Then I added the localhost2 as a alias.\n\n  host.addAlias(\'localhost2\');\n\n  If I entered localhost1 at a browser then it works fine but if I entered localhost2 at the browser then I got an error:\n\nNov 21, 2011 1:29:26 PM org.apache.coyote.http11.AbstractHttp11Processor process SEVERE: Error processing request java.lang.ClassCastException:\n  org.apache.tomcat.util.http.mapper.Mapper$Host\n  cannot be cast to org.apache.catalina.Host\nat org.apache.catalina.connector.Request.getHost(Request.java:631)\nat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:105) \n</quote>\n\nA workaround for the embedded scenario should be to reorder the calls as following:\n  host.addAlias(\'localhost2\');\n  engine.addChild(host);\n\nThat will call Mapper.addHost(String name, String[] aliases, Object host) which processes aliases correctly.\n\n\nReproduction recipe #2, using JMX:\n\n1. In standard server.xml replace\n <Engine defaultHost=\'localhost\' with <Engine defaultHost=\'foohost\'\n <Host name=\'localhost\' with <Host name=\'foohost\'\n2. Start Tomcat\n3. Open  http://localhost:8080/   It opens correctly\n4. Start JConsole and connect to Tomcat\n5. In Catalina -> Host -> foohost -> Operations\ncall addAlias(localhost)\n6. Refresh  http://localhost:8080/   Expected result: It opens correctly\nActual result:\n- Blank page\n- Exception in the logs,\n[[[\n22.11.2011 10:08:41 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.ClassCastException: org.apache.tomcat.util.http.mapper.Mapper$Host can\nnot be cast to org.apache.catalina.Host\n        at org.apache.catalina.connector.Request.getHost(Request.java:623)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineVal\nve.java:77)\n]]]', 'Konstantin Kolinko', '2011-11-22 07:14:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (112, '50570', 'Bug 50570 Allow explicit use of FIPS mode in APR lifecycle listener', 'Both OpenSSL and JSSE allow themselves to be put into FIPS mode, and we should allow SSL connectors to request it (and have them fail if FIPS mode can\'t be set).\n\nOpenSSL:\n http://www.mail-archive.com/openssl-dev@openssl.org/msg20882.html ', 'Christopher Schultz', '2011-01-11 12:27:44 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (113, '52009', 'Bug 52009 NPE exception in org.apache.catalina.connector.CoyoteAdapter.service', '1. I copied activemq-all-5.4.2.jar, commons-logging-1.1.jar to tomcat lib folder\n2. Edit tomcat-user.xml, context.xml, server.xml as below:\n\nChanges  in server.xml:\n\n<Resource  name=\'jms/broker\' auth=\'Container\' \n        type=\'org.apache.activemq.ActiveMQConnectionFactory\' description=\'JMS Connection Factory\'\n        factory=\'org.apache.activemq.jndi.JNDIReferenceFactory\' brokerURL=\'tcp://localhost:61616\' brokerName=\'ActiveMQBroker\' useEmbeddedBroker=\'false\' />\n        \n    <Resource name=\'jms/topic/MyTopic\' auth=\'Container\' type=\'org.apache.activemq.command.ActiveMQTopic\' factory=\'org.apache.activemq.jndi.JNDIReferenceFactory\' physicalName=\'APP.JMS.TOPIC\' />\n\n<Resource name=\'jms/queue/MyQueue\' auth=\'Container\' type=\'org.apache.activemq.command.ActiveMQQueue\' factory=\'org.apache.activemq.jndi.JNDIReferenceFactory\' physicalName=\'APP.JMS.QUEUE\' />\n\n\n<Connector acceptorThreadPriority=\'1\' allowTrace=\'true\' asyncTimeout=\'10000\' connectionLinger=\'25\' connectionTimeout=\'60000\' name=\'NIOConnector\' pollerThreadPriority=\'1\' port=\'8888\' protocol=\'org.apache.coyote.http11.Http11NioProtocol\' redirectPort=\'8443\' tcpNoDelay=\'false\'/>\n\nChanges in context.xml\n\n<ResourceLink global=\'jms/broker\' name=\'jms/broker\' type=\'javax.jms.ConnectionFactory\'/>\n<ResourceLink global=\'jms/topic/MyTopic\' name=\'jms/topic/MyTopic\' type=\'javax.jms.Topic\'/>\n<ResourceLink global=\'jms/queue/MyQueue\' name=\'jms/queue/MyQueue\' type=\'javax.jms.Queue\'/>\n\nYou can also get these file from attached zip\n\nThen access\n http://localhost:8080/manager/text/resources , got three JMS resource i defined \n\nOK - Listed global resources of all types\njms/topic/MyTopic:org.apache.activemq.command.ActiveMQTopic\njms/queue/MyQueue:org.apache.activemq.command.ActiveMQQueue\njms/broker:org.apache.activemq.ActiveMQConnectionFactory\nUserDatabase:org.apache.catalina.users.MemoryUserDatabase\n\n3. Start apache-activemq-5.4.2, create topic APP.JMS.TOPIC, and queque: APP.JMS.QUEUE\n\n4. Put sample files QuoteStreamerApp.war as attached in webapp folder, then it will report errors, but if don\'t define NIO connector, this error doesn\'t exist\n\n2011-10-11 15:53:01 org.apache.catalina.startup.HostConfig checkResources\nINFO: Undeploying context [/QuoteStreamerApp]\n2011-10-11 15:53:11 org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive QuoteStreamerApp.war\n2011-10-11 15:53:52 com.ibm.websphere.webmsg.quotestreamer.AppInit init\nINFO: DataSimulator successfully created and set and started.\n2011-10-11 15:54:01 com.ibm.webmsg.example.StockServlet setProperties\nINFO: Configured properties for quote streamer requests.\n2011-10-11 15:54:02 com.ibm.webmsg.example.StockServlet registerURL\nINFO: Registered the URL for comet requests.\n2011-10-11 15:54:02 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n2011-10-11 15:54:02 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n2011-10-11 15:54:04 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n2011-10-11 15:54:04 org.apache.coyote.http11.AbstractHttp11Processor process\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:970)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)', 'viola.lu', '2011-10-11 08:06:49 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (114, '51972', 'Bug 51972 sendRedirect does not support protocol relative URLs', 'The following URL is a protocol relative URL: \'//server.com:8080/foo/bar/kala.html\'\nwhere as this is server relative: \'/foo/bar/kala.html\'\n\norg/apache/catalina/connector/Response.java breaks on protocol relative URLs in that toAbsolute(String) expects everything that begins with a \'/\' to be server relative. toAbsolute adds the protocol, server and port to the URL, resulting in URLs like  http://foo.com:80//server.com:8080/foo/bar/kala.html  (instead of the correct  http://server.com:8080/foo/bar/kala.html )', 'Heikki Vesalainen', '2011-10-05 21:31:50 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (115, '51952', 'Bug 51952 IllegalStateException using CompressionFilter with Tomcat 7.0.21/22', 'Created  attachment 27685   [details] \nSimple test to recreate CompressionFilter causing IllegalStateException\n\nUsing Tomcat 7.0.21 or 7.0.22 with jdk1.6.0_26 on Solaris 10, mod_ajp and Apache 2.2.21, we get the following logged exception when a sendRedirect is used in a jsp and the CompressionFilter is enabled.\n\nIt does not occur using 7.0.20.\n\nI\'ve attached a gzipped tar file containing a simple test that reproduces the problem. test.jsp just contains a sendRedirect to test2.jsp and I\'ve included the source code for the CompressionFilter and a simple web.xml file with this filter\'s entry. Hitting test.jsp logs the exception below.\n\nSEVERE: Servlet.service() for servlet [jsp] in context with path [] threw exception [java.lang.IllegalStateException: getWriter() has already been called for this response] with root cause\njava.lang.IllegalStateException: getWriter() has already been called for this response\n        at org.apache.catalina.connector.Response.getOutputStream(Response.java:594)\n        at org.apache.catalina.connector.ResponseFacade.getOutputStream(ResponseFacade.java:199)\n        at com.tirerack.filters.CompressionResponseStream.<init>(CompressionResponseStream.java:47)\n        at com.tirerack.filters.CompressionServletResponseWrapper.createOutputStream(CompressionServletResponseWrapper.java:172)\n        at com.tirerack.filters.CompressionServletResponseWrapper.getWriter(CompressionServletResponseWrapper.java:250)\n        at org.apache.jasper.runtime.JspWriterImpl.initOut(JspWriterImpl.java:125)\n        at org.apache.jasper.runtime.JspWriterImpl.flushBuffer(JspWriterImpl.java:118)\n        at org.apache.jasper.runtime.PageContextImpl.release(PageContextImpl.java:190)\n        at org.apache.jasper.runtime.JspFactoryImpl.internalReleasePageContext(JspFactoryImpl.java:123)\n        at org.apache.jasper.runtime.JspFactoryImpl.releasePageContext(JspFactoryImpl.java:80)\n        at org.apache.jsp.test_jsp._jspService(test_jsp.java:74)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:433)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n        at com.tirerack.filters.CompressionFilter.doFilter(CompressionFilter.java:194)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)\n        at org.apache.coyote.ajp.AjpProcessor.process(AjpProcessor.java:200)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:662)', 'Kari Scott', '2011-10-04 15:36:57 UTC', 'tomcat_attachment/attachment 27685.zip');
INSERT INTO `tomcatbody` VALUES (116, '51630', 'Bug 51630 java.lang.IllegalStateException: Calling [asyncComplete()]', 'example:\n\nwebapps examples WEB-INF classes async Async0.java\n\n\nlog file: logs localhost.2011-08-07.log\n=============================================\njava.lang.IllegalStateException: Calling [asyncComplete()] is not valid for a request with Async state [DISPATCHED]\n	at org.apache.coyote.AsyncStateMachine.asyncComplete(AsyncStateMachine.java:221)\n	at org.apache.coyote.http11.Http11Processor.actionInternal(Http11Processor.java:525)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:773)\n	at org.apache.coyote.Request.action(Request.java:344)\n	at org.apache.catalina.core.AsyncContextImpl.complete(AsyncContextImpl.java:89)\n	at async.Async0.service(Async0.java:42)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:593)\n	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:530)\n	at org.apache.catalina.core.AsyncContextImpl$1.run(AsyncContextImpl.java:173)\n	at org.apache.catalina.core.AsyncContextImpl.doInternalDispatch(AsyncContextImpl.java:314)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:851)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:296)\n	at org.apache.coyote.http11.AbstractHttp11Processor.asyncDispatch(AbstractHttp11Processor.java:1220)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:511)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:619)', 'zhh', '2011-08-07 02:34:08 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (117, '51872', 'Bug 51872 request.getRemoteAddr() sometimes returning IP address from the previous request', 'request.getRemoteAddr() sometimes returning IP address from the previous request.  We have compared the IP address returned from the getRemoteHost() and from the headers with getRemoteAddr() and getRemoteAddr is returning wrong IP address.  We believe that this may come from the \'pooled\' request objects where it is sometimes sees the previous value of the remote IP.  The problem doesn\'t occur all the time. \n\nWe are heavily relying on the getRemoteAddr to verify the remote client for some of our authentication.  Can this be fixed?\n\n2011-09-22 16:49:55,713 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve invoked\n2011-09-22 16:49:55,826 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getInfo(): org.apache.coyote.catalina.CoyoteRequest/1.0\n2011-09-22 16:49:56,013 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getRemoteAddr(): 98.138.85.230\n2011-09-22 16:49:56,014 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getRemoteHost(): web120016.mail.ne1.yahoo.com\n\n   [][~]$ nslookup web120016.mail.ne1.yahoo.com\n   Server:              10.72.226.8\n   Address:     10.72.226.8#53\n\n   Name:        web120016.mail.ne1.yahoo.com\n   Address: 98.138.85.143\n\n2011-09-22 16:49:56,014 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getRequestedSessionId(): null\n2011-09-22 16:49:56,015 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getHeader(): accept:*/* host:ls100.mail.vip.ne1.yahoo.com:4080 content-type:application/x-ypy\nyahoo-app-auth:v=1;a=yahoo.mail.acl.yca.lsg-prod;h=98.138.85.143;t=1319282225;\ncontent-length:574\n2011-09-22 16:49:56,015 DEBUG [yjava.filter.address.RemoteIPTranslator] THREADID:1262 Got remote address\n\'98.138.85.230\' and port \'46663\'', 'charlie', '2011-09-22 17:52:57 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (118, '51580', 'Bug 51580 Severe error deploying WAR application (ExpandWar error)', 'Created  attachment 27330   [details] \nCatalina log file with the error.\n\nWhen trying to deploy a WAR application (50MB approx) I get:\n\n\'SEVERE: Error deploying web application archive gestaoApolices.war\njava.lang.NullPointerException\'\n\nComplete stacktrace is attached.\n\nI\'ve seen in the sources that this might be related with the correction of \'Bugzilla 33636\'\n\nLet me know if the war file is needed, in case you\'re not able to reproduce the problem.', 'Cleon', '2011-07-28 22:41:57 UTC', 'tomcat_attachment/attachment 27330.txt');
INSERT INTO `tomcatbody` VALUES (119, '51687', 'Bug 51687 Improve JreMemoryLeakPreventionListener against leak caused by sun.java2d.Disposer', 'The sun.java2d.Disposer class, when loaded, starts an endless daemon thread that can inherit the WebappClassLoader as its context loader. This will cause a leak when the webapp is unloaded.\n\nIt would be useful if JreMemoryLeakPreventionListener could load this class to prevent the leak.', 'Michał Politowski', '2011-08-19 14:41:36 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (120, '51739', 'Bug 51739 If landingpage is a XHTML (JSF/CDI), nullpointer exception.', '', 'Flávio Henrique', '2011-08-29 13:47:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (121, '51558', 'Bug 51558 Tomcat Embedded: using tomcat.addWebapp always overrides programmatic context-settings with default values for the context at start of tomcat server', 'when i deploy an webapp with a tomcat server, i use the Function \'tomcat.addWebapp\'. I looked into the code of this function and it makes the following call:\n\n     ctx.addLifecycleListener(new DefaultWebXmlListener());\n\nWhen i start tomcat, this DefaultWebXmlListener is activated automatically, and always does the following code, so the manager i set for my context gets overriden with this code:\n\n     public static void initWebappDefaults(Context ctx) {\n        ...\n        // Sessions\n        ctx.setManager( new StandardManager());\n        ctx.setSessionTimeout(30);\n        ...\n     }\n\nso when i set a StandardManager programatically, it gets overriden by this code. The workaround i used, is to unregister the DefaultWebXmlListener, and than add my own context.xml specific settings, like a custom manager for deactivating session persistance:\n\n     Context warContext = tomcat.addWebapp(warContextPath, warLocation);\n    \n     LifecycleListener[] lclisteners = warContext.findLifecycleListeners();\n     LifecycleListener defaultWebXMLListener = null;\n     for (int i=0; i < lclisteners.length; i++){\n       if (lclisteners[i] instanceof DefaultWebXmlListener){\n         defaultWebXMLListener = lclisteners[i];\n       }\n     }\n     warContext.removeLifecycleListener(defaultWebXMLListener);\n     ...\n     StandardManager manager = new StandardManager();\n     manager.setPathname(null); // disable session persistance:\n     //manager.setPathname(\'SESSIONS.ser\');     \n     warContext.setCookies(true);\n     warContext.setCrossContext(true);\n     warContext.setManager(manager);\n\ni think its a bug that using the \'tomcat.addWebapp\' method makes it impossible to set context.xml specific settings programmatically, because they always get overriden by default values at the tomcat start.', 'bhuber', '2011-07-26 10:11:48 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (122, '49683', 'Bug 49683 Separate keep-alive and connection timeout with APR/native connector', 'Originally observed as part of  bug 48648 .\n\nIf a keepAliveTimeout is specified it is used for connectionTimeout as well.\n\nFixing this may require changes to the native code too.', 'Mark Thomas', '2010-08-01 15:40:53 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (123, '51588', 'Bug 51588 Change access modifiers in AccessLogValve to make it easier to extend', 'I\'m adding some fields to a subclass of org.apache.catalina.valves.AccessLogValve but createLogElements() is the closest extension point available. Rather than reimplement the functionality there it would be preferable if both of the createAccessLogElement() methods were protected rather than private then it\'s a simple method of matching the char you want to use and falling back to super.createAccessLogElement().', 'Rod', '2011-07-30 02:33:45 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (124, '51056', 'Bug 51056 Disable / drop support for SSLv2', 'Hi,\n\nSSL 2.0 support got removed from many Debian GNU/Linux (and many others linux distro) and SSL 2.0 is disabled by default in Internet Explorer 7, Mozilla Firefox 3, Opera and Safari.\n\nIt\'s use has been deprecated, because of weaknesses in the security of the protocol. For exemple,  http://www.openssl.org/news/secadv_20051011.txt \n\nI propose to simply drop any support for SSLv2 in Tomcat Native lib with the attached patch.', 'Damien Raude-Morvan', '2011-04-13 14:12:26 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (125, '49595', 'Bug 49595 Tomcat crashes in tcnative-1.dll frequently', '#\n# A fatal error has been detected by the Java Runtime Environment:\n#\n#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x485a4b16, pid=2556, tid=5112\n#\n# JRE version: 6.0_20-b02\n# Java VM: Java HotSpot(TM) Server VM (16.3-b01 mixed mode windows-x86 )\n# Problematic frame:\n# C  [tcnative-1.dll+0x4b16]\n#\n# If you would like to submit a bug report, please visit:\n#    http://java.sun.com/webapps/bugreport/crash.jsp \n# The crash happened outside the Java Virtual Machine in native code.\n# See problematic frame for where to report the bug.\n#\n\n---------------  T H R E A D  ---------------\n\nCurrent thread (0x47e3d000):  JavaThread \'ajp-8009-7\' daemon [_thread_in_native, id=5112, stack(0x4b900000,0x4b950000)]\n\nsiginfo: ExceptionCode=0xc0000005, reading address 0x00000020\n\nRegisters:\nEAX=0x00000000, EBX=0x0000200e, ECX=0x00000000, EDX=0x00000000\nESP=0x4b94e800, EBP=0x4b94e818, ESI=0x00000000, EDI=0x4ae2bfe8\nEIP=0x485a4b16, EFLAGS=0x00010246\n\nTop of Stack: (sp=0x4b94e800)\n0x4b94e800:   00000000 00000000 4b94e820 47e3d000\n0x4b94e810:   43e67730 43e67730 4b94e860 0063a484\n0x4b94e820:   0000200e 4b94e868 4ae2bfe8 00000000\n0x4b94e830:   00000000 0000200e 19872b78 4b94e83c\n0x4b94e840:   4b94e840 00000000 4b94e87c 43e683f0\n0x4b94e850:   00000000 43e67730 00000000 4b94e870\n0x4b94e860:   4b94e8a0 00632f85 43e68390 00638359\n0x4b94e870:   0000200e 00000000 4ae2bfe8 00000000 \n\nInstructions: (pc=0x485a4b16)\n0x485a4b06:   55 18 51 8d 0c 16 8b 57 10 03 ca 8b 57 0c 51 52\n0x485a4b16:   ff 50 20 85 c0 75 14 03 75 08 3b f3 72 d4 85 c0 \n\n\nStack: [0x4b900000,0x4b950000],  sp=0x4b94e800,  free space=13a4b94e33ck\nNative frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)\nC  [tcnative-1.dll+0x4b16]\nj  org.apache.tomcat.jni.Socket.sendbb(JII)I+0\nj  org.apache.coyote.ajp.AjpAprProcessor.flush()V+22\nj  org.apache.coyote.ajp.AjpAprProcessor$SocketOutputBuffer.doWrite(Lorg/apache/tomcat/util/buf/ByteChunk;Lorg/apache/coyote/Response;)I+114\nj  org.apache.coyote.Response.doWrite(Lorg/apache/tomcat/util/buf/ByteChunk;)V+6\nj  org.apache.catalina.connector.OutputBuffer.realWriteBytes([BII)V+38\nj  org.apache.tomcat.util.buf.ByteChunk.append([BII)V+202\nj  org.apache.catalina.connector.OutputBuffer.writeBytes([BII)V+15\nj  org.apache.catalina.connector.OutputBuffer.write([BII)V+12\nj  org.apache.catalina.connector.CoyoteOutputStream.write([BII)V+7\nj  org.apache.catalina.connector.CoyoteOutputStream.write([B)V+5\nj  com.fisc.ptao.common.PTNative.attachmentDataPut([BZ)V+47\nv  ~StubRoutines::call_stub\nV  [jvm.dll+0x191d0c]\nV  [jvm.dll+0x27e631]\nV  [jvm.dll+0x191d8d]\nV  [jvm.dll+0x19b68f]\nV  [jvm.dll+0x19e487]\n\nJava frames: (J=compiled Java code, j=interpreted, Vv=VM code)\nj  org.apache.tomcat.jni.Socket.sendbb(JII)I+0\nj  org.apache.coyote.ajp.AjpAprProcessor.flush()V+22\nj  org.apache.coyote.ajp.AjpAprProcessor$SocketOutputBuffer.doWrite(Lorg/apache/tomcat/util/buf/ByteChunk;Lorg/apache/coyote/Response;)I+114\nj  org.apache.coyote.Response.doWrite(Lorg/apache/tomcat/util/buf/ByteChunk;)V+6\nj  org.apache.catalina.connector.OutputBuffer.realWriteBytes([BII)V+38\nj  org.apache.tomcat.util.buf.ByteChunk.append([BII)V+202\nj  org.apache.catalina.connector.OutputBuffer.writeBytes([BII)V+15\nj  org.apache.catalina.connector.OutputBuffer.write([BII)V+12\nj  org.apache.catalina.connector.CoyoteOutputStream.write([BII)V+7\nj  org.apache.catalina.connector.CoyoteOutputStream.write([B)V+5\nj  com.fisc.ptao.common.PTNative.attachmentDataPut([BZ)V+47\nv  ~StubRoutines::call_stub\nj  com.fisc.ptao.common.PTNative.PTReadAttachment(JLjava/lang/String;II)I+0\nj  com.fisc.ptao.servlets.PTReadAttachmentServlet.doGet(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V+612\nj  javax.servlet.http.HttpServlet.service(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V+35\nj  javax.servlet.http.HttpServlet.service(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V+30\nj  org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V+376\nj  org.apache.catalina.core.ApplicationFilterChain.doFilter(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V+101\nj  com.fisc.interpost.filters.LoginFilter.doFilter(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;Ljavax/servlet/FilterChain;)V+361\nj  org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V+119\nj  org.apache.catalina.core.ApplicationFilterChain.doFilter(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V+101\nj  org.apache.catalina.core.StandardWrapperValve.invoke(Lorg/apache/catalina/connector/Request;Lorg/apache/catalina/connector/Response;)V+804\nj  org.apache.catalina.core.StandardContextValve.invoke(Lorg/apache/catalina/connector/Request;Lorg/apache/catalina/connector/Response;)V+365\nj  org.apache.catalina.core.StandardHostValve.invoke(Lorg/apache/catalina/connector/Request;Lorg/apache/catalina/connector/Response;)V+64\nj  org.apache.catalina.valves.ErrorReportValve.invoke(Lorg/apache/catalina/connector/Request;Lorg/apache/catalina/connector/Response;)V+6\nj  org.apache.catalina.core.StandardEngineValve.invoke(Lorg/apache/catalina/connector/Request;Lorg/apache/catalina/connector/Response;)V+42\nj  org.apache.catalina.connector.CoyoteAdapter.service(Lorg/apache/coyote/Request;Lorg/apache/coyote/Response;)V+158\nj  org.apache.coyote.ajp.AjpAprProcessor.process(J)Z+309\nj  org.apache.coyote.ajp.AjpAprProtocol$AjpConnectionHandler.process(J)Lorg/apache/tomcat/util/net/AprEndpoint$Handler$SocketState;+39\nj  org.apache.tomcat.util.net.AprEndpoint$Worker.run()V+147\nj  java.lang.Thread.run()V+11\nv  ~StubRoutines::call_stub\n\n---------------  P R O C E S S  ---------------\n\nJava Threads: ( => current thread )\n  0x48b16400 JavaThread \'ajp-8009-9\' daemon [_thread_blocked, id=5916, stack(0x4b9b0000,0x4ba00000)]\n  0x4989b400 JavaThread \'ajp-8009-8\' daemon [_thread_blocked, id=5848, stack(0x4b950000,0x4b9a0000)]\n=>0x47e3d000 JavaThread \'ajp-8009-7\' daemon [_thread_in_native, id=5112, stack(0x4b900000,0x4b950000)]\n  0x47e75400 JavaThread \'ajp-8009-6\' daemon [_thread_blocked, id=5564, stack(0x4b7a0000,0x4b7f0000)]\n  0x48fab400 JavaThread \'File Reaper\' daemon [_thread_blocked, id=4180, stack(0x4b750000,0x4b7a0000)]\n  0x492a4c00 JavaThread \'ajp-8009-5\' daemon [_thread_blocked, id=2648, stack(0x4b700000,0x4b750000)]\n  0x48c1a400 JavaThread \'ajp-8009-4\' daemon [_thread_in_native, id=2500, stack(0x4b660000,0x4b6b0000)]\n  0x48219000 JavaThread \'ajp-8009-3\' daemon [_thread_blocked, id=5060, stack(0x4b6b0000,0x4b700000)]\n  0x487f3400 JavaThread \'ajp-8009-2\' daemon [_thread_blocked, id=6028, stack(0x4b610000,0x4b660000)]\n  0x49498400 JavaThread \'ajp-8009-1\' daemon [_thread_in_native, id=1396, stack(0x4b4c0000,0x4b510000)]\n  0x488e5800 JavaThread \'janitorThread\' daemon [_thread_blocked, id=5976, stack(0x4b470000,0x4b4c0000)]\n  0x47fbc000 JavaThread \'ajp-8009-Acceptor-0\' daemon [_thread_in_native, id=1472, stack(0x4b420000,0x4b470000)]\n  0x488d2400 JavaThread \'ajp-8009-CometPoller-7\' daemon [_thread_blocked, id=5052, stack(0x4b3d0000,0x4b420000)]\n  0x484c8800 JavaThread \'ajp-8009-CometPoller-6\' daemon [_thread_blocked, id=4764, stack(0x4b380000,0x4b3d0000)]\n  0x48563000 JavaThread \'ajp-8009-CometPoller-5\' daemon [_thread_blocked, id=5244, stack(0x4b330000,0x4b380000)]\n  0x496ca800 JavaThread \'ajp-8009-CometPoller-4\' daemon [_thread_blocked, id=1536, stack(0x4b2e0000,0x4b330000)]\n  0x48c97800 JavaThread \'ajp-8009-CometPoller-3\' daemon [_thread_blocked, id=5904, stack(0x4b290000,0x4b2e0000)]\n  0x48b2c400 JavaThread \'ajp-8009-CometPoller-2\' daemon [_thread_blocked, id=5092, stack(0x4b240000,0x4b290000)]\n  0x4845a800 JavaThread \'ajp-8009-CometPoller-1\' daemon [_thread_blocked, id=1816, stack(0x4b1f0000,0x4b240000)]\n  0x48438800 JavaThread \'ajp-8009-CometPoller-0\' daemon [_thread_blocked, id=2436, stack(0x4b1a0000,0x4b1f0000)]\n  0x492c5800 JavaThread \'ajp-8009-Poller-7\' daemon [_thread_blocked, id=5536, stack(0x4b150000,0x4b1a0000)]\n  0x482d2800 JavaThread \'ajp-8009-Poller-6\' daemon [_thread_blocked, id=5576, stack(0x4b100000,0x4b150000)]\n  0x48c01400 JavaThread \'ajp-8009-Poller-5\' daemon [_thread_in_native, id=2456, stack(0x4b0b0000,0x4b100000)]\n  0x48380400 JavaThread \'ajp-8009-Poller-4\' daemon [_thread_in_native, id=4684, stack(0x4ac60000,0x4acb0000)]\n  0x48d07c00 JavaThread \'ajp-8009-Poller-3\' daemon [_thread_blocked, id=4288, stack(0x4ac10000,0x4ac60000)]\n  0x4886b400 JavaThread \'ajp-8009-Poller-2\' daemon [_thread_blocked, id=2908, stack(0x4abc0000,0x4ac10000)]\n  0x48be9400 JavaThread \'ajp-8009-Poller-1\' daemon [_thread_blocked, id=5208, stack(0x4ab70000,0x4abc0000)]\n  0x484f6400 JavaThread \'ajp-8009-Poller-0\' daemon [_thread_blocked, id=4956, stack(0x4ab20000,0x4ab70000)]\n  0x48304800 JavaThread \'http-8080-Acceptor-0\' daemon [_thread_in_native, id=5732, stack(0x4aad0000,0x4ab20000)]\n  0x483fe400 JavaThread \'http-8080-Sendfile-0\' daemon [_thread_blocked, id=5412, stack(0x4aa80000,0x4aad0000)]\n  0x48bb2400 JavaThread \'http-8080-CometPoller-7\' daemon [_thread_blocked, id=5056, stack(0x4aa30000,0x4aa80000)]\n  0x48331400 JavaThread \'http-8080-CometPoller-6\' daemon [_thread_blocked, id=4348, stack(0x4a9e0000,0x4aa30000)]\n  0x4835d400 JavaThread \'http-8080-CometPoller-5\' daemon [_thread_blocked, id=1168, stack(0x4a990000,0x4a9e0000)]\n  0x48b83400 JavaThread \'http-8080-CometPoller-4\' daemon [_thread_blocked, id=5936, stack(0x4a940000,0x4a990000)]\n  0x489e3800 JavaThread \'http-8080-CometPoller-3\' daemon [_thread_blocked, id=2956, stack(0x4a8f0000,0x4a940000)]\n  0x48190400 JavaThread \'http-8080-CometPoller-2\' daemon [_thread_blocked, id=1860, stack(0x4a8a0000,0x4a8f0000)]\n  0x49938400 JavaThread \'http-8080-CometPoller-1\' daemon [_thread_blocked, id=2180, stack(0x4a850000,0x4a8a0000)]\n  0x48466400 JavaThread \'http-8080-CometPoller-0\' daemon [_thread_blocked, id=4472, stack(0x4a800000,0x4a850000)]\n  0x48191400 JavaThread \'http-8080-Poller-7\' daemon [_thread_blocked, id=4952, stack(0x4a7b0000,0x4a800000)]\n  0x482d1400 JavaThread \'http-8080-Poller-6\' daemon [_thread_blocked, id=6024, stack(0x4a760000,0x4a7b0000)]\n  0x4854cc00 JavaThread \'http-8080-Poller-5\' daemon [_thread_blocked, id=1760, stack(0x4a510000,0x4a560000)]\n  0x488ec400 JavaThread \'http-8080-Poller-4\' daemon [_thread_blocked, id=536, stack(0x4a4c0000,0x4a510000)]\n  0x4857ac00 JavaThread \'http-8080-Poller-3\' daemon [_thread_blocked, id=4748, stack(0x4a470000,0x4a4c0000)]\n  0x48bb2c00 JavaThread \'http-8080-Poller-2\' daemon [_thread_blocked, id=5408, stack(0x4a420000,0x4a470000)]\n  0x4880f400 JavaThread \'http-8080-Poller-1\' daemon [_thread_blocked, id=6036, stack(0x4a3d0000,0x4a420000)]\n  0x48006400 JavaThread \'http-8080-Poller-0\' daemon [_thread_blocked, id=2596, stack(0x4a380000,0x4a3d0000)]\n  0x483a8c00 JavaThread \'ContainerBackgroundProcessor[StandardEngine[Catalina]]\' daemon [_thread_blocked, id=4516, stack(0x4a330000,0x4a380000)]\n  0x48334c00 JavaThread \'SessionWorkerThread\' daemon [_thread_blocked, id=4936, stack(0x4a2e0000,0x4a330000)]\n  0x4883bc00 JavaThread \'ConectionPoolMgrThread\' [_thread_blocked, id=2768, stack(0x4a290000,0x4a2e0000)]\n  0x48306400 JavaThread \'LogTraceThread\' daemon [_thread_blocked, id=2988, stack(0x48fd0000,0x49020000)]\n  0x48019400 JavaThread \'GC Daemon\' daemon [_thread_blocked, id=5216, stack(0x48780000,0x487d0000)]\n  0x47ec2400 JavaThread \'Thread-2\' [_thread_in_native, id=2136, stack(0x48130000,0x48180000)]\n  0x47e96400 JavaThread \'RMI TCP Accept-0\' daemon [_thread_in_native, id=716, stack(0x48090000,0x480e0000)]\n  0x47b42800 JavaThread \'Low Memory Detector\' daemon [_thread_blocked, id=2820, stack(0x47de0000,0x47e30000)]\n  0x47b40c00 JavaThread \'CompilerThread1\' daemon [_thread_blocked, id=5856, stack(0x47d90000,0x47de0000)]\n  0x47b3a800 JavaThread \'CompilerThread0\' daemon [_thread_blocked, id=4260, stack(0x47d40000,0x47d90000)]\n  0x47b39000 JavaThread \'Attach Listener\' daemon [_thread_blocked, id=5456, stack(0x47cf0000,0x47d40000)]\n  0x47b36800 JavaThread \'Signal Dispatcher\' daemon [_thread_blocked, id=4804, stack(0x47ca0000,0x47cf0000)]\n  0x47b27800 JavaThread \'Finalizer\' daemon [_thread_blocked, id=4772, stack(0x47c50000,0x47ca0000)]\n  0x47b22c00 JavaThread \'Reference Handler\' daemon [_thread_blocked, id=5340, stack(0x47c00000,0x47c50000)]\n  0x005f6c00 JavaThread \'main\' [_thread_in_native, id=1068, stack(0x00550000,0x005a0000)]\n\nOther Threads:\n  0x47b20000 VMThread [stack: 0x47bb0000,0x47c00000] [id=2580]\n  0x47b6e400 WatcherThread [stack: 0x480e0000,0x48130000] [id=1452]\n\nVM state:not at safepoint (normal execution)\n\nVM Mutex/Monitor currently owned by a thread: None\n\nHeap\n def new generation   total 39424K, used 17871K [0x036f0000, 0x061b0000, 0x18c40000)\n  eden space 35072K,  50% used [0x036f0000, 0x04863f10, 0x05930000)\n  from space 4352K,   0% used [0x05d70000, 0x05d70000, 0x061b0000)\n  to   space 4352K,   0% used [0x05930000, 0x05930000, 0x05d70000)\n tenured generation   total 87424K, used 22368K [0x18c40000, 0x1e1a0000, 0x436f0000)\n   the space 87424K,  25% used [0x18c40000, 0x1a218108, 0x1a218200, 0x1e1a0000)\n compacting perm gen  total 24064K, used 24039K [0x436f0000, 0x44e70000, 0x476f0000)\n   the space 24064K,  99% used [0x436f0000, 0x44e69c68, 0x44e69e00, 0x44e70000)\nNo shared spaces configured.\n\nDynamic libraries:\n0x00400000 - 0x0040f000 	C: apache-tomcat-6.0.26 bin tomcat6.exe\n0x7c800000 - 0x7c8c0000 	C: WINDOWS system32 ntdll.dll\n0x77e40000 - 0x77f42000 	C: WINDOWS system32 kernel32.dll\n0x77380000 - 0x77412000 	C: WINDOWS system32 USER32.dll\n0x77c00000 - 0x77c49000 	C: WINDOWS system32 GDI32.dll\n0x77f50000 - 0x77fec000 	C: WINDOWS system32 ADVAPI32.dll\n0x77c50000 - 0x77cef000 	C: WINDOWS system32 RPCRT4.dll\n0x77ba0000 - 0x77bfa000 	C: WINDOWS system32 MSVCRT.dll\n0x7c8d0000 - 0x7d0d4000 	C: WINDOWS system32 SHELL32.dll\n0x77da0000 - 0x77df2000 	C: WINDOWS system32 SHLWAPI.dll\n0x77420000 - 0x77523000 	C: WINDOWS WinSxS x86_Microsoft.Windows.Common-Controls_6595b64144ccf1df_6.0.3790.2778_x-ww_A8F04F11 comctl32.dll\n0x6db70000 - 0x6df9c000 	C: Program Files Java jdk1.6.0_20 jre bin server jvm.dll\n0x76aa0000 - 0x76acd000 	C: WINDOWS system32 WINMM.dll\n0x7c360000 - 0x7c3b6000 	C: WINDOWS system32 MSVCR71.dll\n0x6d860000 - 0x6d86c000 	C: Program Files Java jdk1.6.0_20 jre bin verify.dll\n0x6d3e0000 - 0x6d3ff000 	C: Program Files Java jdk1.6.0_20 jre bin java.dll\n0x6d340000 - 0x6d348000 	C: Program Files Java jdk1.6.0_20 jre bin hpi.dll\n0x76b70000 - 0x76b7b000 	C: WINDOWS system32 PSAPI.DLL\n0x76f50000 - 0x76f63000 	C: WINDOWS system32 Secur32.dll\n0x6d8a0000 - 0x6d8af000 	C: Program Files Java jdk1.6.0_20 jre bin zip.dll\n0x6d6c0000 - 0x6d6d3000 	C: Program Files Java jdk1.6.0_20 jre bin net.dll\n0x71c00000 - 0x71c17000 	C: WINDOWS system32 WS2_32.dll\n0x71bf0000 - 0x71bf8000 	C: WINDOWS system32 WS2HELP.dll\n0x71b20000 - 0x71b61000 	C: WINDOWS System32 mswsock.dll\n0x76ed0000 - 0x76eff000 	C: WINDOWS system32 DNSAPI.dll\n0x76f70000 - 0x76f77000 	C: WINDOWS System32 winrnr.dll\n0x76f10000 - 0x76f3e000 	C: WINDOWS system32 WLDAP32.dll\n0x76f80000 - 0x76f88000 	C: WINDOWS system32 rasadhlp.dll\n0x6d610000 - 0x6d619000 	C: Program Files Java jdk1.6.0_20 jre bin management.dll\n0x68000000 - 0x6802f000 	C: WINDOWS system32 rsaenh.dll\n0x5f270000 - 0x5f2c9000 	C: WINDOWS system32 hnetcfg.dll\n0x71ae0000 - 0x71ae8000 	C: WINDOWS System32 wshtcpip.dll\n0x485a0000 - 0x48677000 	C: apache-tomcat-6.0.26 bin tcnative-1.dll\n0x4a070000 - 0x4a0c6000 	C: Fischer InterPostExpress interpost japi japi.dll\n0x4a0d0000 - 0x4a174000 	c: Fischer InterPostExpress interpost japi tao40_32.dll\n0x71bb0000 - 0x71bb9000 	C: WINDOWS system32 WSOCK32.dll\n0x49040000 - 0x4904a000 	c: Fischer InterPostExpress interpost japi IMPLODE.DLL\n\nVM Arguments:\njvm_args: -Dcatalina.base=C: apache-tomcat-6.0.26 -Dcatalina.home=C: apache-tomcat-6.0.26 -Djava.endorsed.dirs=C: apache-tomcat-6.0.26 endorsed -Djava.io.tmpdir=C: apache-tomcat-6.0.26 temp -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.config.file=C: apache-tomcat-6.0.26 conf logging.properties -Dcom.sun.management.jmxremote vfprintf -Xms128m -Xmx1024m \njava_command: <unknown>\nLauncher Type: generic\n\nEnvironment Variables:\nJAVA_HOME=C: Program Files Java jdk1.6.0_20\nPATH=C: WINDOWS system32;C: WINDOWS;C: WINDOWS System32 Wbem;C: Program Files Diskeeper Corporation Diskeeper ;C: Program Files Java jdk1.6.0_20 bin;c: Fischer InterPostExpress interpost japi;c: Fischer InterPostExpress uninstall\nOS=Windows_NT\nPROCESSOR_IDENTIFIER=x86 Family 6 Model 15 Stepping 8, GenuineIntel\n\n\n\n---------------  S Y S T E M  ---------------\n\nOS: Windows Server 2003 family Build 3790 Service Pack 1\n\nCPU:total 1 (4 cores per cpu, 1 threads per core) family 6 model 15 stepping 7, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3\n\nMemory: 4k page, physical 3931596k(3039332k free), swap 5346784k(4717796k free)\n\nvm_info: Java HotSpot(TM) Server VM (16.3-b01) for windows-x86 JRE (1.6.0_20-b02), built on Apr 12 2010 13:46:10 by \'java_re\' with MS VC++ 7.1 (VS2003)\n\ntime: Wed Jul 14 12:43:58 2010\nelapsed time: 7651 seconds', 'Anil Saraswathy', '2010-07-15 06:34:41 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (126, '51503', 'Bug 51503 Additional error checking required for connector port attribute (e.g. for port=\'\')', 'With 7.0.18 packaged as a candidate for release and finally unreleased, when I stop the Tomcat service (only 1 war deployed), the service takes a lot of time to stop and finally was killed by system.\n\nHaving a look into the stderr log, I see it paused right after the folowing line :\n\nINFO: Stopping ProtocolHandler [http-apr-0]\n\nThen went into a slow loop and fill the log with these lines :\n\n13 juil. 2011 14:30:30 org.apache.tomcat.util.net.AprEndpoint stopInternal\nATTENTION: Acceptor thread [http-apr-0-Acceptor-0] failed to unlock. Forcing hard socket shutdown.\n13 juil. 2011 14:30:31 org.apache.tomcat.util.net.AprEndpoint stopInternal\nATTENTION: Acceptor thread [http-apr-0-Acceptor-0] failed to unlock. Forcing hard socket shutdown.\n13 juil. 2011 14:30:32 org.apache.tomcat.util.net.AprEndpoint stopInternal\nATTENTION: Acceptor thread [http-apr-0-Acceptor-0] failed to unlock. Forcing hard socket shutdown.\netc. (about 30 times before it was killed)\n\nI think there was no such issue with 7.0.16.', 'Etienne Massip', '2011-07-13 12:40:11 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (127, '51477', 'Bug 51477 Support all protocol combinations in SSLProtocol of APR Connector', 'We have used SSLProtocol=\'SSLv3+TLSv1\' with the APR connectors in 6.0.x and 7.0.x successfully to support both SSLv3 and TLSv1 protocols exclusively (no SSLv2 support).  The following openssl s_client connection tests demonstrate this functionality with 7.0.8:\n\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -tls1\nCONNECTED(00000003)\n...\nSSL handshake has read 6158 bytes and written 293 bytes\n---\nNew, TLSv1/SSLv3, Cipher is DHE-RSA-AES256-SHA\nServer public key is 2048 bit\nSecure Renegotiation IS supported\nCompression: zlib compression\nExpansion: zlib compression\nSSL-Session:\n    Protocol  : TLSv1\n...\n\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -ssl3\nCONNECTED(00000003)\n...\nSSL handshake has read 6027 bytes and written 319 bytes\n---\nNew, TLSv1/SSLv3, Cipher is DHE-RSA-AES256-SHA\nServer public key is 2048 bit\nSecure Renegotiation IS supported\nCompression: zlib compression\nExpansion: zlib compression\nSSL-Session:\n    Protocol  : SSLv3\n...\n\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -ssl2\n15389:error:140A90C4:SSL routines:SSL_CTX_new:null ssl method passed:ssl_lib.c:1453:\n\nUpon upgrading to Tomcat 7.0.16, which includes the fix for  https://issues.apache.org/bugzilla/show_bug.cgi?id=51073 , our desired protocol combination fails with the expected \'unsupported protocol\' message.  Unfortunately, none of the officially supported strings mentioned at  http://tomcat.apache.org/tomcat-7.0-doc/config/http.html#SSL%20Support  provide the desired protocol support.  In particular the protocol values are exclusive, where setting SSLProtocol=\'SSLv3\' prevents TLSv1 connections and vice versa.  The following s_client tests confirm this behavior:\n\n(7.0.16 with SSLProtocol=\'SSLv3\')\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -tls1\nCONNECTED(00000003)\n15696:error:1408F10B:SSL routines:SSL3_GET_RECORD:wrong version number:s3_pkt.c:293:\n\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -ssl3\nCONNECTED(00000003)\n...\nSSL handshake has read 6027 bytes and written 319 bytes\n---\nNew, TLSv1/SSLv3, Cipher is DHE-RSA-AES256-SHA\nServer public key is 2048 bit\nSecure Renegotiation IS supported\nCompression: zlib compression\nExpansion: zlib compression\nSSL-Session:\n    Protocol  : SSLv3\n...\n\n\n(7.0.16 with SSLProtocol=\'TLSv1\')\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -tls1\nCONNECTED(00000003)\n...\nSSL handshake has read 6158 bytes and written 293 bytes\n---\nNew, TLSv1/SSLv3, Cipher is DHE-RSA-AES256-SHA\nServer public key is 2048 bit\nSecure Renegotiation IS supported\nCompression: zlib compression\nExpansion: zlib compression\nSSL-Session:\n    Protocol  : TLSv1\n...\n\n$ openssl s_client -connect eiger.middleware.vt.edu:443 -ssl3\nCONNECTED(00000003)\n15816:error:14094410:SSL routines:SSL3_READ_BYTES:sslv3 alert handshake failure:s3_pkt.c:1102:SSL alert number 40\n15816:error:1409E0E5:SSL routines:SSL3_WRITE_BYTES:ssl handshake failure:s3_pkt.c:539:', 'Marvin Addison', '2011-07-05 16:53:25 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (128, '46252', 'Bug 46252 Tomcat access log doesn\'t support Unicode', 'AccessLogValve, which is responsible for handling the access log uses FileWriter (that doesn\'t support Unicode). I guess that instantiating the writer like this would solve the case:\n\nwriter = new PrintWriter(new OutputStreamWriter(new FileOutputStream(pathname), \'UTF-8\'), true);', 'Adam', '2008-11-20 11:18:55 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (129, '51475', 'Bug 51475 GzipInterceptor#decompress is not completly implemented', 'Created  attachment 27254   [details] \nPatch file für GzipInterceptor\n\nWhile testing the GzipInterceptor I was wondering about the strange errors: \'Unable to decompress byte contents\'. At first I thougt, I was using the interceptor in wrong order. But taking a look the source shows a TODO at method decompress: \'Fix to create an automatically growing buffer.\'\n\nBecause we have session properties which are compressed larger than 2048 bytes, the interceptor didn\'t work, in our case.\n\nI\'ve created a patch. See my attachement.', 'Christian Stöber', '2011-07-05 09:58:12 UTC', 'tomcat_attachment/attachment 27254.txt');
INSERT INTO `tomcatbody` VALUES (130, '51473', 'Bug 51473 SecurityConfig，set \'package.definition\' security property to \'nullsun.,java.,...\'', 'Created  attachment 27251   [details] \neclipse debug\n\nIn method \'org.apache.catalina.security.SecurityConfig.setSecurityProperty\'，\nwhen i enable the SecurityManager，\nif \'properties\' var equals \'package.definition\',\nSecurity.getProperty(properties) will return null,\n\nso\n\nSecurity.setProperty(properties, definition + packageList); \n\nwill be\n\nSecurity.setProperty(\'package.definition\', null + packageList); \n\nBTW:\n\n\'package.access\' security property no problem。\n\n\nmy jdk:\njava version \'1.6.0_20\'\nJava(TM) SE Runtime Environment (build 1.6.0_20-b02)\nJava HotSpot(TM) Client VM (build 16.3-b01, mixed mode, sharing)', 'zhh', '2011-07-05 05:37:09 UTC', 'tomcat_attachment/attachment 27251.png');
INSERT INTO `tomcatbody` VALUES (131, '51467', 'Bug 51467 usage of method run instead of start to start a thread', 'In StandardContext method Thread#run is used. This is most probably a mistake, since a few lines below Thread#join is called to wait for the completion of the thread.\n\nSo we could either remove the join and get rid of the thread by using just a runnable, or start the thread.', 'Felix Schumacher', '2011-07-03 10:19:46 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (132, '51088', 'Bug 51088 ArrayIndexOutOfBoundsException from org.apache.el.parser.JJTELParserState', 'I found the following ArrayIndexOutOfBoundsException in my logfile.\nIt occurred directly after login into my webApp without any further user interaction. Unfortunately it is not reproducible at all.\n\nI am not sure whether Jasper is the right component. However the class  JJTELParserState is in the jasper-el.jar.\n\nEnvironment:\nTomcat 6.0.32 \nFacelets 1.1.14\nMyfaces 1.2.9\n\nSCHWERWIEGEND: Error Rendering View[/facelets/myview.xhtml]\njava.lang.ArrayIndexOutOfBoundsException: -1\n	at java.util.ArrayList.remove(ArrayList.java:390)\n	at org.apache.el.parser.JJTELParserState.closeNodeScope(JJTELParserState.java:108)\n	at org.apache.el.parser.ELParser.CompositeExpression(ELParser.java:74)\n	at org.apache.el.lang.ExpressionBuilder.createNodeInternal(ExpressionBuilder.java:115)\n	at org.apache.el.lang.ExpressionBuilder.build(ExpressionBuilder.java:172)\n	at org.apache.el.lang.ExpressionBuilder.createValueExpression(ExpressionBuilder.java:216)\n	at org.apache.el.ExpressionFactoryImpl.createValueExpression(ExpressionFactoryImpl.java:68)\n	at com.sun.facelets.el.ELText$ELTextVariable.apply(ELText.java:161)\n	at com.sun.facelets.compiler.AttributeInstruction.apply(AttributeInstruction.java:60)\n	at com.sun.facelets.compiler.UIInstructionHandler.apply(UIInstructionHandler.java:95)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jstl.core.IfHandler.apply(IfHandler.java:54)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at org.apache.myfaces.custom.aliasbean.AliasBeansScopeTagHandler.applyNextHandler(AliasBeansScopeTagHandler.java:52)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.ui.CompositionHandler.apply(CompositionHandler.java:124)\n	at com.sun.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:49)\n	at com.sun.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:39)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:248)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:294)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:273)\n	at com.sun.facelets.impl.DefaultFaceletContext.includeFacelet(DefaultFaceletContext.java:140)\n	at com.sun.facelets.tag.ui.IncludeHandler.apply(IncludeHandler.java:66)\n	at com.sun.facelets.tag.ui.DefineHandler.applyDefinition(DefineHandler.java:64)\n	at com.sun.facelets.tag.ui.CompositionHandler.apply(CompositionHandler.java:136)\n	at com.sun.facelets.impl.DefaultFaceletContext$TemplateManager.apply(DefaultFaceletContext.java:337)\n	at com.sun.facelets.impl.DefaultFaceletContext.includeDefinition(DefaultFaceletContext.java:307)\n	at com.sun.facelets.tag.ui.InsertHandler.apply(InsertHandler.java:68)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.ui.CompositionHandler.apply(CompositionHandler.java:124)\n	at com.sun.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:49)\n	at com.sun.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:39)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:248)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:294)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:273)\n	at com.sun.facelets.impl.DefaultFaceletContext.includeFacelet(DefaultFaceletContext.java:140)\n	at com.sun.facelets.tag.ui.CompositionHandler.apply(CompositionHandler.java:116)\n	at com.sun.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:49)\n	at com.sun.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:39)\n	at com.sun.facelets.impl.DefaultFacelet.apply(DefaultFacelet.java:95)\n	at com.sun.facelets.FaceletViewHandler.buildView(FaceletViewHandler.java:596)\n	at com.sun.facelets.FaceletViewHandler.renderView(FaceletViewHandler.java:651)\n	at org.ajax4jsf.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:100)\n	at org.ajax4jsf.application.AjaxViewHandler.renderView(AjaxViewHandler.java:176)\n	at org.apache.myfaces.lifecycle.RenderResponseExecutor.execute(RenderResponseExecutor.java:41)\n	at org.apache.myfaces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:140)\n	at org.apache.myfaces.custom.ppr.PPRLifecycleWrapper.render(PPRLifecycleWrapper.java:84)\n	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:187)\n	at com.foo..client.web.servlets.FacesServletWrapper.service(FacesServletWrapper.java:125)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.ajax4jsf.webapp.BaseXMLFilter.doXmlFilter(BaseXMLFilter.java:206)\n	at org.ajax4jsf.webapp.BaseFilter.handleRequest(BaseFilter.java:290)\n	at org.ajax4jsf.webapp.BaseFilter.processUploadsAndHandleRequest(BaseFilter.java:388)\n	at org.ajax4jsf.webapp.BaseFilter.doFilter(BaseFilter.java:515)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.myfaces.webapp.filter.ExtensionsFilter.doFilter(ExtensionsFilter.java:392)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at com.foo..client.web.filters.LoginFilter.doFilter(LoginFilter.java:219)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at com.foo..client.web.filters.CacheFilter.doFilter(CacheFilter.java:110)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at com.foo..client.web.filters.EncodingFilter.doFilter(EncodingFilter.java:54)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at com.foo..client.web.filters.TimerFilter.doFilter(TimerFilter.java:80)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:470)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)\n	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n	at java.lang.Thread.run(Thread.java:662)', 'Michael Heinen', '2011-04-20 05:42:42 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (133, '50353', 'Bug 50353 Calling asyncContext.getResponse() returns null after async timeout', 'If the async thread calls asyncContext.getResponse() after the async timeout, it gets a null reference. \nIn the following example, it leads to a NPE.\n\nThe servlet spec is not very clear on the behavior to adopt after a timeout, but I don\'t think null should be returned. Maybe an IllegalStateException instead ? It seems to be the case if complete() is called after the timeout.\n\npackage test;\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\n\nimport javax.servlet.AsyncContext;\nimport javax.servlet.AsyncEvent;\nimport javax.servlet.AsyncListener;\nimport javax.servlet.ServletException;\nimport javax.servlet.ServletResponse;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n/**\n * Servlet implementation class MyServlet\n */\n@WebServlet(value = \'/MyServlet\', asyncSupported = true)\npublic class MyServlet extends HttpServlet implements AsyncListener {\n	private static final long serialVersionUID = 1L;\n\n	protected void doGet(HttpServletRequest request,\n			HttpServletResponse response) throws ServletException, IOException {\n		final AsyncContext asyncContext = request.startAsync(request, response);\n		asyncContext.addListener(this);\n		asyncContext.setTimeout(10*1000);\n\n		asyncContext.start(new Runnable() {\n\n			@Override\n			public void run() {\n				System.out.println(\'Entering async thread\');\n				try {\n					Thread.sleep(20 * 1000);\n					System.out.println(\'<Asyncthread> about to write response\');\n					ServletResponse response2 = asyncContext.getResponse();\n					PrintWriter writer = response2.getWriter();\n					writer.write(\'Hello world\');\n					System.out.println(\'<Asyncthread> about to complete\');\n					asyncContext.complete();\n				} catch (Exception e) {\n					e.printStackTrace();\n				}\n			}\n		});\n	}\n\n	@Override\n	public void onComplete(AsyncEvent evt) throws IOException {\n		System.out.println(\'onComplete \' + evt);\n	}\n\n	@Override\n	public void onError(AsyncEvent evt) throws IOException {\n		System.out.println(\'onError \' + evt);\n	}\n\n	@Override\n	public void onStartAsync(AsyncEvent evt) throws IOException {\n		System.out.println(\'onStartAsync \' + evt);\n	}\n\n	@Override\n	public void onTimeout(AsyncEvent evt) throws IOException {\n		System.out.println(\'onTimeout \' + evt);\n		evt.getAsyncContext().getResponse().getWriter().write(\'Timed out\');\n		evt.getAsyncContext().complete();\n	}\n}', 'Sylvain Laurent', '2010-11-27 17:45:41 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (134, '51396', 'Bug 51396 Embedding class cannot launch a webapp with a jsp servlet', ' https://github.com/bimargulies/Tomcat-Solr-Test-Case  is a test case. It creates an instance of Tomcat and then adds a webapp from Apache Solr. This webapp has \'jsp\' servlets.\n\nThe code crashes, because the implicit default web.xml used in this case does not include a servlet named jsp, resulting in the following backtrace.\n\n\n\n2011-06-20 12:56:24,598 [Embedded Tomcat] INFO org.apache.catalina.startup.ContextConfig - No global web.xml found\nException in thread \'Embedded Tomcat\' java.lang.NullPointerException\n	at org.apache.catalina.startup.ContextConfig.convertJsp(ContextConfig.java:1379)\n	at org.apache.catalina.startup.ContextConfig.convertJsps(ContextConfig.java:1358)\n	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1349)\n	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:881)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:316)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5103)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607)\n	at org.apache.catalina.startup.Tomcat.addWebapp(Tomcat.java:509)\n	at org.apache.catalina.startup.Tomcat.addWebapp(Tomcat.java:483)\n	at org.apache.catalina.startup.Tomcat.addWebapp(Tomcat.java:171)\n	at org.apache.tomcat.tc.solrWebapp.LaunchWithSolr.tryToAddSolr(LaunchWithSolr.java:111)\n	at org.apache.tomcat.tc.solrWebapp.LaunchWithSolr.access$1(LaunchWithSolr.java:106)\n	at org.apache.tomcat.tc.solrWebapp.LaunchWithSolr$1.run(LaunchWithSolr.java:91)', 'bmargulies', '2011-06-20 17:02:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (135, '49165', 'Bug 49165 Enhancement - Allow %{TIME_FORMAT}t As Configuration for AccessLogValve', 'AccessLogValve.DateAndTimeElement() can currently be configured only with %t which output the date/time in Common Log Format.\n\nBy adding the capability to configure with %{TIME_FORMAT}, one could override (at least) the timeFormatter property of the class ... or it could go further and allow overriding of all the [day, month, year, time]Formatter properties.\n\nJustification for enhancement:  The log currenlty provide the ability to log processing time in millis (via %T), but an accurate log of the order in which requests are received cannot be determined without the capabilities of logging a  a format with milliseconds using the %t element.', 'Jacob Zwiers', '2010-04-21 14:20:08 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (136, '48956', 'Bug 48956 SSI regular expressions not working', 'I was trying to use Tomcat SSI filter:\n\n http://tomcat.apache.org/tomcat-6.0-doc/ssi-howto.html \n\nWhile it generally works, I have discovered that SSI regular expressions are not supported.\nAs much as I can see from tomcat source code, this feature is just not implemented.\n\nFor example, those expressions always return \'did not match\':\n\n<!--#if expr=\'abc = /abc/\' -->matches<!--#else -->did not match<!--#endif -->\n\n<!--#if expr=\'abc = /[a-z]/\' -->matches<!--#else -->did not match<!--#endif -->\n\nThis bug is a showstopper for me, because in my application I need SSI regular expressions support.', 'Albert Tumanov', '2010-03-22 11:48:29 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (137, '43538', 'Bug 43538 [patch] Show the hostname and IP address in the manager webapp', 'We have an environment with a couple of load-balanced Tomcats fronted by httpd.\nIf someone accesses the manager application through the load-balancer, they will\nnot know which of the load-balanced Tomcats they end up at. In these situations,\nand others as well, it would be nice if the manager could tell the hostname and\nIP address of the machine it is running on.', 'Dennis Lundberg', '2007-10-02 14:42:39 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (138, '51306', 'Bug 51306 NPE in DeltaRequest.writeExternal(DeltaRequest.java:267) when handling remote session expiration', 'Occasionally we got errors like following:\n======\n2011-05-30 03:40:17,697 ERROR [pool-1-thread-2] (org.apache.catalina.ha.session.DeltaManager) Manager [localhost#]: Unable to receive message through TCP channel\njava.lang.NullPointerException\nat java.io.ObjectOutputStream$BlockDataOutputStream.getUTFLength(ObjectOutputStream.java:2106)\nat java.io.ObjectOutputStream$BlockDataOutputStream.writeUTF(ObjectOutputStream.java:1977)\nat java.io.ObjectOutputStream.writeUTF(ObjectOutputStream.java:849)\nat org.apache.catalina.ha.session.DeltaRequest.writeExternal(DeltaRequest.java:267)\nat org.apache.catalina.ha.session.DeltaRequest.serialize(DeltaRequest.java:287)\nat org.apache.catalina.ha.session.DeltaManager.serializeDeltaRequest(DeltaManager.java:716)\nat org.apache.catalina.ha.session.DeltaManager.requestCompleted(DeltaManager.java:1224)\nat org.apache.catalina.ha.session.DeltaSession.expire(DeltaSession.java:403)\nat org.apache.catalina.ha.session.DeltaManager.handleSESSION_EXPIRED(DeltaManager.java:1546)\nat org.apache.catalina.ha.session.DeltaManager.messageReceived(DeltaManager.java:1452)\nat org.apache.catalina.ha.session.DeltaManager.messageDataReceived(DeltaManager.java:1173)\nat org.apache.catalina.ha.session.ClusterSessionListener.messageReceived(ClusterSessionListener.java:92)\nat org.apache.catalina.ha.tcp.SimpleTcpCluster.messageReceived(SimpleTcpCluster.java:901)\nat org.apache.catalina.ha.tcp.SimpleTcpCluster.messageReceived(SimpleTcpCluster.java:882)\nat org.apache.catalina.tribes.group.GroupChannel.messageReceived(GroupChannel.java:269)\nat org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\nat org.apache.catalina.tribes.group.interceptors.TcpFailureDetector.messageReceived(TcpFailureDetector.java:110)\nat org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\nat org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\nat org.apache.catalina.tribes.group.ChannelCoordinator.messageReceived(ChannelCoordinator.java:241)\nat org.apache.catalina.tribes.transport.ReceiverBase.messageDataReceived(ReceiverBase.java:225)\nat org.apache.catalina.tribes.transport.nio.NioReplicationTask.drainChannel(NioReplicationTask.java:188)\nat org.apache.catalina.tribes.transport.nio.NioReplicationTask.run(NioReplicationTask.java:91)\nat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\nat java.lang.Thread.run(Thread.java:662) \n\nIt looks like the functionality of Tomcat is not affected by this.\n\nThe NPE comes from trying to write null sessionId, but why does Tomcat try to send something from handling received authoritative SESSION_EXPIRED message?', 'Dmitry Mikhaylov', '2011-06-01 12:21:28 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (139, '51340', 'Bug 51340 Intermittent java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence', 'An Eclipse Virgo CI build recently failed with the stack trace below. I\nhaven\'t seen the problem before, but it seems that at least\none user of vanilla Tomcat has hit the same problem, on Tomcat 6 in 2009 ([1]).\n\nI am raising this bug to get this on the record and perhaps to help identify a pattern of usage that may ultimately lead to a solution.\n\nIt is possible that the bug is in the JRE XML processing, of course.\n\nEnvironment:\n\nJava 6  R21  64 bit (Sun)\nSles 11 x86-64\nTomcat 7.0.12 embedded in development version of Eclipse Virgo 3.0\n\n[1]  http://mail-archives.apache.org/mod_mbox/tomcat-users/200902.mbox/%3C36E4692623C5974BA6661C0B18EE8EDFE4138B@MAILSERV.hcrest.com%3E \n\n[2011-06-07 11:07:17.741] ERROR start-signalling-4           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.tomcat.util.digester.Digester startElement \n[2011-06-07 11:07:17.741] ERROR start-signalling-4           System.err                                                        SEVERE: Begin event threw exception \n[2011-06-07 11:07:17.741] ERROR start-signalling-4           System.err                                                        java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        	at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        	at org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        	at org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n[2011-06-07 11:07:17.746] ERROR start-signalling-4           System.err                                                        	at java.lang.Thread.run(Thread.java:619) \n[2011-06-07 11:07:17.747] ERROR start-signalling-4           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig parseWebXml \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        SEVERE: Parse error in application web.xml file at file:/opt/users/hudsonbuild/workspace/virgo.web-server.snapshot/org.eclipse.virgo.server.smoketest/target/test-expanded/virgo-tomcat-server-3.0.0.CI-2011-06-07_11-01-11/work/org.eclipse.virgo.kernel.deployer_3.0.0.D-20110603101321/staging/global/bundle/org.eclipse.gemini.web.tomcat/2.0.0.BUILD-20110603145554/org.eclipse.gemini.web.tomcat-2.0.0.BUILD-20110603145554.jar/conf/web.xml \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2687) \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2713) \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        	at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1285) \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        	at org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        	at org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        	at org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        	at java.lang.Thread.run(Thread.java:619) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        Caused by: java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        	at org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        	at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n[2011-06-07 11:07:17.753] ERROR start-signalling-4           System.err                                                        	... 33 more \n[2011-06-07 11:07:17.753] ERROR start-signalling-4           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig parseWebXml \n[2011-06-07 11:07:17.753] ERROR start-signalling-4           System.err                                                        SEVERE: Occurred at line 468 column 21 \n[2011-06-07 11:07:17.759] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.tomcat.util.digester.Digester startElement \n[2011-06-07 11:07:17.759] ERROR start-signalling-1           System.err                                                        SEVERE: Begin event threw exception \n[2011-06-07 11:07:17.760] ERROR start-signalling-1           System.err                                                        java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.760] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n[2011-06-07 11:07:17.760] ERROR start-signalling-1           System.err                                                        	at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n[2011-06-07 11:07:17.760] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n[2011-06-07 11:07:17.761] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n[2011-06-07 11:07:17.761] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n[2011-06-07 11:07:17.762] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n[2011-06-07 11:07:17.762] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n[2011-06-07 11:07:17.763] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n[2011-06-07 11:07:17.763] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n[2011-06-07 11:07:17.763] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n[2011-06-07 11:07:17.764] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n[2011-06-07 11:07:17.764] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n[2011-06-07 11:07:17.765] ERROR start-signalling-1           System.err                                                        	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n[2011-06-07 11:07:17.765] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n[2011-06-07 11:07:17.765] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n[2011-06-07 11:07:17.766] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n[2011-06-07 11:07:17.766] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n[2011-06-07 11:07:17.766] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n[2011-06-07 11:07:17.767] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n[2011-06-07 11:07:17.767] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n[2011-06-07 11:07:17.767] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n[2011-06-07 11:07:17.768] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n[2011-06-07 11:07:17.768] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n[2011-06-07 11:07:17.769] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n[2011-06-07 11:07:17.769] ERROR start-signalling-1           System.err                                                        	at org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n[2011-06-07 11:07:17.769] ERROR start-signalling-1           System.err                                                        	at org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n[2011-06-07 11:07:17.770] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n[2011-06-07 11:07:17.770] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n[2011-06-07 11:07:17.771] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n[2011-06-07 11:07:17.771] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n[2011-06-07 11:07:17.772] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n[2011-06-07 11:07:17.772] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n[2011-06-07 11:07:17.773] ERROR start-signalling-1           System.err                                                        	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n[2011-06-07 11:07:17.773] ERROR start-signalling-1           System.err                                                        	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n[2011-06-07 11:07:17.773] ERROR start-signalling-1           System.err                                                        	at java.lang.Thread.run(Thread.java:619) \n[2011-06-07 11:07:17.775] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig parseWebXml \n[2011-06-07 11:07:17.776] ERROR start-signalling-1           System.err                                                        SEVERE: Parse error in application web.xml file at file:/opt/users/hudsonbuild/workspace/virgo.web-server.snapshot/org.eclipse.virgo.server.smoketest/target/test-expanded/virgo-tomcat-server-3.0.0.CI-2011-06-07_11-01-11/work/org.eclipse.virgo.kernel.deployer_3.0.0.D-20110603101321/staging/global/bundle/org.eclipse.gemini.web.tomcat/2.0.0.BUILD-20110603145554/org.eclipse.gemini.web.tomcat-2.0.0.BUILD-20110603145554.jar/conf/web.xml \n[2011-06-07 11:07:17.777] ERROR start-signalling-1           System.err                                                        java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.777] ERROR start-signalling-1           System.err                                                        	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2687) \n[2011-06-07 11:07:17.777] ERROR start-signalling-1           System.err                                                        	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2713) \n[2011-06-07 11:07:17.778] ERROR start-signalling-1           System.err                                                        	at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1285) \n[2011-06-07 11:07:17.778] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n[2011-06-07 11:07:17.779] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n[2011-06-07 11:07:17.779] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n[2011-06-07 11:07:17.780] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n[2011-06-07 11:07:17.780] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n[2011-06-07 11:07:17.781] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n[2011-06-07 11:07:17.781] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n[2011-06-07 11:07:17.781] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n[2011-06-07 11:07:17.782] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n[2011-06-07 11:07:17.782] ERROR start-signalling-1           System.err                                                        	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n[2011-06-07 11:07:17.782] ERROR start-signalling-1           System.err                                                        	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n[2011-06-07 11:07:17.783] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n[2011-06-07 11:07:17.783] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n[2011-06-07 11:07:17.783] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n[2011-06-07 11:07:17.784] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n[2011-06-07 11:07:17.784] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n[2011-06-07 11:07:17.785] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n[2011-06-07 11:07:17.785] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n[2011-06-07 11:07:17.785] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n[2011-06-07 11:07:17.786] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n[2011-06-07 11:07:17.786] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n[2011-06-07 11:07:17.786] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n[2011-06-07 11:07:17.787] ERROR start-signalling-1           System.err                                                        	at org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n[2011-06-07 11:07:17.787] ERROR start-signalling-1           System.err                                                        	at org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n[2011-06-07 11:07:17.788] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n[2011-06-07 11:07:17.788] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n[2011-06-07 11:07:17.789] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n[2011-06-07 11:07:17.789] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n[2011-06-07 11:07:17.790] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n[2011-06-07 11:07:17.790] ERROR start-signalling-1           System.err                                                        	at org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n[2011-06-07 11:07:17.790] ERROR start-signalling-1           System.err                                                        	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n[2011-06-07 11:07:17.791] ERROR start-signalling-1           System.err                                                        	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n[2011-06-07 11:07:17.791] ERROR start-signalling-1           System.err                                                        	at java.lang.Thread.run(Thread.java:619) \n[2011-06-07 11:07:17.791] ERROR start-signalling-1           System.err                                                        Caused by: java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.792] ERROR start-signalling-1           System.err                                                        	at org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n[2011-06-07 11:07:17.792] ERROR start-signalling-1           System.err                                                        	at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n[2011-06-07 11:07:17.792] ERROR start-signalling-1           System.err                                                        	... 33 more \n[2011-06-07 11:07:17.793] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig parseWebXml \n[2011-06-07 11:07:17.793] ERROR start-signalling-1           System.err                                                        SEVERE: Occurred at line 468 column 21 \n[2011-06-07 11:07:17.806] ERROR start-signalling-4           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig configureStart \n[2011-06-07 11:07:17.806] ERROR start-signalling-4           System.err                                                        SEVERE: Marking this application unavailable due to previous error(s) \n[2011-06-07 11:07:17.808] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig configureStart \n[2011-06-07 11:07:17.808] ERROR start-signalling-1           System.err                                                        SEVERE: Marking this application unavailable due to previous error(s) \n[2011-06-07 11:07:18.034] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:18 AM org.apache.catalina.core.StandardContext startInternal \n[2011-06-07 11:07:18.035] ERROR start-signalling-1           System.err                                                        SEVERE: Error getConfigured \n[2011-06-07 11:07:18.036] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:18 AM org.apache.catalina.core.StandardContext startInternal \n[2011-06-07 11:07:18.037] ERROR start-signalling-1           System.err                                                        SEVERE: Context [/org.eclipse.virgo.apps.repository] startup failed due to previous errors', 'Glyn Normington', '2011-06-08 13:37:25 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (140, '51276', 'Bug 51276 Startup time is too high if there are few JARs in \'lib/\' and a few webapps.', 'Startup time in tomcat 7.0.14 is 10x higher than 7.0.12, if there are a few shared JARs in tomcat/lib and a few webapps.\nThe issue is very simple to reproduce, simply add 10 empty directories in tomcat/webapps and (for example) the Metro webservices jars in tomcat/lib. On my machine the startup time increase from 0.5 secs (default installation) to 35.2 secs.\nWhen using tomcat 7.0.12 the startup time is about 3 secs on my machine in this test case.', 'Alex Dupre', '2011-05-27 11:09:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (141, '51240', 'Bug 51240 maxConnections not honors config when acceptorThreadCount > 1', 'When acceptorThreadCount > 1, maxConnections not honors config, this affects BIO & NIO connector (others don\'t know).\n\n---------- test config begin --------\n\n    <Executor name=\'tomcatThreadPool\' namePrefix=\'catalina-exec-\' \n        maxThreads=\'300\' minSpareThreads=\'4\'/>\n    \n    <Connector port=\'9993\'\n               protocol=\'org.apache.coyote.http11.Http11Protocol\'\n               URIEncoding=\'ISO-8859-1\'\n               enableLookups=\'false\'\n\n               acceptorThreadCount=\'2\'\n               executor=\'tomcatThreadPool\'\n               acceptCount=\'1\'\n               maxConnections=\'1\'\n               />\n\n    <Connector port=\'9994\'\n               protocol=\'org.apache.coyote.http11.Http11NioProtocol\'\n               URIEncoding=\'ISO-8859-1\'\n               enableLookups=\'false\'\n\n               acceptorThreadCount=\'2\'\n               executor=\'tomcatThreadPool\'\n               acceptCount=\'1\'\n               maxConnections=\'1\'\n               />\n\n---------- test config end ----------\n\n---- Test-1 (acceptorThreadCount=\'1\') --- OK ---\n  $ ab2 -n 20000 -c 1000  http://localhost:999x/ \n  $ netstat -atn | grep :999x | grep ESTABLISHED\n\n  This show range 3-5 connections (acceptable number)\n\n---- Test-2 (acceptorThreadCount=\'2\') --- KO ---\n  $ ab2 -n 20000 -c 1000  http://localhost:999x/ \n  $ netstat -atn | grep :999x | grep ESTABLISHED\n\n  This show +100 connections > \'OOPS\', too much far\n\n----\n\nLogs show traces like this when socket closes:\n----- catalina.out begin -----\nMay 22, 2011 9:10:51 PM org.apache.tomcat.util.net.AbstractEndpoint countDownConnection\nWARNING: Incorrect connection count, multiple socket.close called on the same socket.\n----- catalina.out end -------', 'Guillermo Grandes', '2011-05-22 19:22:26 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (142, '51226', 'Bug 51226 [Patch] to add FindLeaks ant task', 'There is no ant task for FindLeaks.', 'Eiji Takahashi', '2011-05-19 06:26:15 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (143, '27122', 'Bug 27122 IE plugins cannot access components through Tomcat 5 over SSL', 'SSL seems to be failing when the Content-Type header is set to \'image/svg+xml\'.\n\nI\'ve only seen this failure when SSL was running on a Solaris machine.  (uname\n-a: SunOS [hostname removed] 5.8 Generic_108528-18 sun4u sparc SUNW,Ultra-60) \nWhen attempted on Windows, we were unable to duplicate the error.  This reliably\nfails when attempted on this specific Solaris machine.  If I get a chance, I\'ll\ntry to create a test-case and see if I can reproduce this on other Solaris\nmachines.  Unfortunately, this was a show-stopper for a release that\'s being\nmade today so I\'m pressed for time.\n\nBasically, what happens is that we\'re using a JSP page to create an SVG file. \nBecause of this, we have to set the Content-Type header to \'image/svg+xml\'. \nWhen the MIME type is set to this value, the page fails to load in Internet\nExplorer 6 (SP1) with a message of \'connection failed\' or something similar. \nWhen an attempt was made in Opera, Opera responded by crashing.  Mozilla\nsuccessfully downloaded the file, though.\n\nHowever, when resetting the MIME type in the page to \'text/plain\' all three\nbrowsers can access the page without failure.  By back-revving Tomcat to version\n4.1.29, we were able to resolve this issue and access the page in all three\nbrowsers.\n\nI\'ll try and create a test-case later today and verify that it isn\'t just our\nSVG JSP that\'s failing but any that creates SVG but I\'m currently pressed for\ntime - sorry.', 'Daniel Potter', '2004-02-20 21:09:17 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (144, '51185', 'Bug 51185 Performance : DataSourceProxy#createPool should use more fine grained synchronisation', 'Hello,\nI don\'t know if this is the right component.\nMy Enhancement concerns new Tomcat JDBC POOL.\n\nLooking at code I think that DataSourceProxy#createPool should not be synchronized but use another private method that is synchronized and used only when creation is needed, something like that:\n    /**\n     * Sets up the connection pool, by creating a pooling driver.\n     * @return Driver\n     * @throws SQLException\n     */\n    public ConnectionPool createPool() throws SQLException {\n        if (pool != null) {\n            return pool;\n        } else {\n        	return pCreatePool();\n        }\n    }\n\n    /**\n     * \n     * @return\n     * @throws SQLException\n     */\n    private synchronized ConnectionPool pCreatePool() throws SQLException {\n        if (pool != null) {\n            return pool;\n        } else {\n            pool = new ConnectionPool(poolProperties);\n            return pool;\n        }\n    }\n\n\nCurrently since createPool() is called for lots of getters we get this synchro IMPACT without really needing it.\n\nRegards\nPhilippe\n http://www.ubik-ingenierie.com ', 'Philippe Mouawad', '2011-05-11 10:21:44 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (145, '35054', 'Bug 35054 warn if appBase is not existing as a File or directory', 'otherwise, it may very hard to find what is wrong', 'Ralf Hauser', '2005-05-25 10:03:08 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (146, '50950', 'Bug 50950 NotSerializableException: org.apache.catalina.realm.GenericPrincipal', 'Because this issue ( https://issues.apache.org/bugzilla/show_bug.cgi?id=47502 ) is fixed I re-enabled using the security-constraint in web.xml to protect some pages instead of using my own workaround. But now I get a somewhat similar exception.\n\nThis is running Tomcat 6.0.32 (directly from your tar.gz) on Debian 5 in a cluster of 3 nodes.\nI access my password protected pages over https.\n\n Mar 11, 2011 1:20:48 PM org.apache.catalina.ha.session.DeltaManager requestCompleted\n SEVERE: Unable to serialize delta request for sessionid [7D6D6A80C080C132F7EDCDAA3DFCEFB7]\n java.io.NotSerializableException: org.apache.catalina.realm.GenericPrincipal\n     at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1164)\n     at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:330)\n     at java.util.LinkedList.writeObject(LinkedList.java:943)\n     at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)\n     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     at java.lang.reflect.Method.invoke(Method.java:597)\n     at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n     at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1469)\n     at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\n     at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\n     at java.io.ObjectOutputStream.access$300(ObjectOutputStream.java:143)\n     at java.io.ObjectOutputStream$PutFieldImpl.writeFields(ObjectOutputStream.java:1677)\n     at java.io.ObjectOutputStream.writeFields(ObjectOutputStream.java:462)\n     at javax.security.auth.Subject$SecureSet.writeObject(Subject.java:1281)\n     at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)\n     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     at java.lang.reflect.Method.invoke(Method.java:597)\n     at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n     at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1469)\n     at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\n     at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\n     at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1518)\n     at java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:422)\n     at java.util.Collections$SynchronizedCollection.writeObject(Collections.java:1602)\n     at sun.reflect.GeneratedMethodAccessor63.invoke(Unknown Source)\n     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     at java.lang.reflect.Method.invoke(Method.java:597)\n     at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n     at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1469)', 'Ronald Klop', '2011-03-20 13:28:18 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (147, '51119', 'Bug 51119 extras - JmxRemoteLifecycleListener does not support JAAS based authentication and authorisation', '(Also true in Tomcat 7)\n\nThe JmxRemoteLifecycleListener does not support JAAS based authentication.\n\nThat is, when authentication is required, it only supports file based authentication.', 'Neil laurance', '2011-04-26 05:29:40 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (148, '51124', 'Bug 51124 ArrayIndexOutOfBoundsException after setting org.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true', 'First of all, I know that there has been a bug regarding a similar problem before and that it was fixed. But currently this bugs occurs even with tomcat version 6.0.32.\n\nWe have a problem with the tomcat runnign with the parameter org.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true.\n\nAfter the tomcat has just started, everything is fine but after one or two days a lot of ArrayIndexOutOfBoundsException occur on random pages of the application.\n\nTomcats started without this parameter don\'t seem to have that problem.\n\nUnfortunately we weren\'t able reproduce the bug locally, It appears only on our production system.\n\nCould there be a concurrency problem, that only shows if a lot it going on on the platform?\n\nI can provide two small stackstraces that can show the classes where the problem occurs:\n\n1.\n\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n        at org.apache.jasper.runtime.BodyContentImpl.write(Unknown Source)\n        at java.io.PrintWriter.write(PrintWriter.java:382)\n        at org.apache.jasper.runtime.JspWriterImpl.flushBuffer(Unknown Source)\n        at org.apache.jasper.runtime.PageContextImpl.release(Unknown Source)\n        at org.apache.jasper.runtime.JspFactoryImpl.internalReleasePageContext(Unknown Source)\n        at org.apache.jasper.runtime.JspFactoryImpl.releasePageContext(Unknown Source)\n        at org.apache.jsp.members.lists.short_.incomingShortList_jsp._jspService(incomingShortList_jsp.java:796)\n        at org.apache.jasper.runtime.HttpJspBase.service(Unknown Source)\n        at javax.servlet.http.HttpServlet.service(Unknown Source)\n\n2.\n\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n        at java.lang.String.getChars(String.java:854)\n        at org.apache.jasper.runtime.BodyContentImpl.write(Unknown Source)\n        at org.apache.jasper.runtime.BodyContentImpl.write(Unknown Source)\n        at org.apache.jasper.runtime.BodyContentImpl.print(Unknown Source)\n        at org.apache.taglibs.standard.tag.common.fmt.MessageSupport.doEndTag(MessageSupport.java:203)\n        at org.apache.jsp.members.profiles.profile_jsp._jspx_meth_fmt_005fmessage_005f2(profile_jsp.java:4897)\n        at org.apache.jsp.members.profiles.profile_jsp._jspService(profile_jsp.java:481)\n        at org.apache.jasper.runtime.HttpJspBase.service(Unknown Source)\n        at javax.servlet.http.HttpServlet.service(Unknown Source)', 'Juergen', '2011-04-27 06:31:47 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (149, '51042', 'Bug 51042 HttpSessionListener.sessionCreated() is called a second time when user is authenticated with no matching sessionDestroyed() call.', 'When my web application has a HttpSessionListener configured in its web.xml, then that classes sessionCreated() is called when a user is assigned a new session.\n\nHowever, that method is *also* called when that user authenticates itself and the session is assigned a new ID (whether or not this is actually a \'new session\' can be disputed, but that\'s not the point of this bug).\n\nWhen the session is removed (due to a timeout, for example), then a single sessionDestroyed() call is executed.\n\nWhen the HttpSessionListener manages some kind of external resource, this behaviour leads to a resource leak, because sessionCreated() is called twice, while sessionRemoved() is only called once!\n\nI\'m aware of the reason for changing the session ID and (somehow) understand why sessionCreated() is called again (after all there\'s a new session ID), but there must be *some* way for the SessionListener to be notified that the \'old session\' no longer exists.\n\nThe same behaviour is seen in Tomcat 6.0 (and probably 5.5 as well, but I didn\'t test that).', 'Joachim Sauer', '2011-04-08 05:54:06 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (150, '50887', 'Bug 50887 Enhancement to set security-provider within AjpAprProcessor', 'Created  attachment 26742   [details] \nPatches to set a securityProvider \n\nWe need support of X.509 certificates using elliptic curves for client-auth\nwithin an servlet-application.\n\nThe certificates we use are coded using DomainParameters within the\nPublicKey object. When using the sun-jdk this will\nlead to an error because the sun-jce implementation only supports elliptic\ncurves as NamedCurves.\n\nThe best way to fix this is to use another security-provider e.g.\nbouncycastle.\nFor that we need a way to configure it within tomcat.', 'pknopp', '2011-03-08 04:49:48 UTC', 'tomcat_attachment/attachment 26742');
INSERT INTO `tomcatbody` VALUES (151, '50895', 'Bug 50895 JSP compiler initializes classes during compile which can result in failures', 'The fix for  Bug 49555  adds the following code call:\n\n                clazz = Class.forName(className, true, tccl);\n\nThe 2nd argument (initialize) is set to true resulting in it attempting to initialize the class.  This can result in compilation failures if the class has ugly static initializer requirements.  It can also increases the time and memory footprint of compilation as the classes.\n\nI think for the purposes of the getCanonicalName() call, the second argument should be set to false to prevent initialization of the class in question.', 'Andy Wang', '2011-03-08 15:27:00 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (152, '25060', 'Bug 25060 Reloading context orphans currently open jndi datasource connections', 'I fiddled around with this a while and have determined to the best of my ability\nthat this is a real bug.  I have a jndi datasource connected to a postgresql\nserver.  I have two jndi resources (a reader and writer) so that later I can\nimplement a system with replication etc and deal with writes and reads to\ndifferent connections.  To summarize, after using the system, there are two\nconnections to postgres that get reused -- one reader and writer.  Under load,\nthis number increases and will slowly go back down.  I usually end up with two\nidle connections (one reader and one writer) left under no load.  If you reload\nthe context where the datasource is at (it\'s a context specific datasource), the\nnumber of connections will jump by two when used.  Each reload produces 2 more\nconnections min until I restart the server.  It appears that after a reload, the\n\'persisted connections\' get abandoned / orphaned.  Eventually, I hit my max\nconnections and cannot aquire any more and the system fails.  I have tried the\nabandond collection parameters and have added debug logging to my code to ensure\nthat I am indeed calling close on the connections I checkout, even on exceptions\nand error cases.  Under normal useage without reloads, no connection leakage\nhappens.\n\nThis is on a solaris 8 machine with the 4.1.27-hotfix-22096.tar.gz applied.  Let\nme know if more information is required.  I have this in a development\nenvironment and can let somone attach in jdb and hammer on the thing since it\'s\nnot a production system -- if that will help in getting a repro.\n\nWayne', 'Wayne Schroeder', '2003-11-27 21:15:10 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (153, '27988', 'Bug 27988 Unhelpful FileNotFoundException raised', 'org.apache.naming.resources.DirContextURLConnection raises FileNotFoundException\non lines 311, 344, 382 and 396.  It would be more helpful if these provided a\nmessage string.\n\nFor example, change line 344 to\n        throw new FileNotFoundException(getURL().getFile());\n\nThis would make it easier to diagnose mistakes in server configurations.', 'richard.beton', '2004-03-26 17:01:25 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (154, '28852', 'Bug 28852 failonerror attribute on Ant tasks', 'failonerror boolean attribute on manager Ant tasks would be a nice have to \nallow for more flexible operation within Ant build files.\n\nI will attach a patch next week that also fixes unecessary CRs during response \nread/print and missing url encoding in some tasks.', 'Stephane Bailliez', '2004-05-08 20:23:38 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (155, '31027', 'Bug 31027 major error from minor whitespace error in properties file', 'A developer accidentally placed a tab character after the port number in the\nproperties file for a tomcat instance.  This prevented tomcat from listening on\nthat port, but it was difficult to track down whether tomcat was running.  Seems\nlike the properties-file reader could easily trim excess whitespace before\ntrying to use entries.', 'Jim Eng', '2004-09-02 22:36:52 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (156, '50836', 'Bug 50836 LifecycleState#isAvailable() to be more restrictive', 'I think some of the values returned by LifecycleState#isAvailable() are wrong.\n\n1. I am certain that MUST_DESTROY should return false, because it is a state that is later than stopped.\n2. I think that STOPPING_PREP should return false, because we can get there from the FAILED state.\n3. I think that STARTING should return false, because it is too early to return true there.\n\nAs a result, the following is the complete list of states are to return true in #isAvailable():\nSTARTED, MUST_STOP', 'Konstantin Kolinko', '2011-02-26 14:05:18 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (157, '19444', 'Bug 19444 JNDI Authentication roles must be anonymous accessible', 'It appears that for the JNDIRealm to be able to locate roles, they must be \nanonymous accessible. I believe that for security purposes this should not be \nnecessary if we are validating the user by binding to the directory. In that \ncase the roles could be accessible to any bound user or that particular user. I \ndiscussed this very briefly on the Tomcat user list. It sounds like this had \nbeen discussed previously and for whatever reason, the idea rejected. Anyhow I \nsubmit that there is a bug, either in the code - which requires the roles to be \nanonymous, or in the documentation which does not make it clear that this is \nthe case (at least in \'Tomcat 4 Servlet/JSP Container - Realm Configuration HOW-\nTO). It seems reasonable to me that if we are binding to the directory to \nauthenticate, we would have that user\'s access to roles. Perhaps the \ndocumentation should more explicetly state that this is not the case.\n\nIn the hope that it would be accepted as an enhancement, I am going to attempt \nto attach a modified JNDIRealm that uses the authenticated connection to obtain \nthe roles.\n\nThank You,\nArt', 'art_w', '2003-04-29 21:58:13 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (158, '50189', 'Bug 50189 AJP connector sends GET BODY CHUNK when reading after response closed', 'If a servlet (probably incorrectly) closes the writer/outputstream of a response, and then attempts to read from the request, the AJP connector sends GET BODY CHUNK to the mod_jk worker.\n\nThis then starts a series of very confusing communication between the worker and tomcat.  The worker doesn\'t read it until it makes its next request.  After making its next request, it reads it, and then sends a response with 0 length.  At the same time, Tomcat responds to the request made by the worker with another GET BODY CHUNK, which the worker also responds with a message of 0 length.  Then the really weird thing happens, Tomcat replays the first request made by that worker.  At this point, based on what I\'m looking at with tcpdump, I get too confused to work out exactly what is happening.', 'James Roper', '2010-10-31 23:27:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (159, '50780', 'Bug 50780 AjpConnectionHandler keeps many connections causing memory leak', 'Hi,\n\nSorry for my english.\n\nI use Tomcat 7.0.6 with APR 1.1.20. \n\nI noticed (from heap dump) many org.apache.tomcat.util.net.SocketWrapper objects, which are kept by \'connections\' atribute in org.apache.coyote.ajp.AjpAprProtocol$AjpConnectionHandler object. I don\'t understand, why there are so many objects representing old connections which are not active. In my example it was 300000 objects created, after 7 days of Tomcat work. Has someone forgotten to clean this HashMap from time to time?\n\nbest regards\n\nSergiusz Brzezinski', 'Sergiusz', '2011-02-15 04:51:49 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (160, '50713', 'Bug 50713 The \'roles\' command doesn\'t work', 'Created  attachment 26601   [details] \npatch for context.xml of the Manager application\n\nThe Manager application has the \'roles\' command that list the security role names. But now this command doesn\'t work correctly.\n\nThe \'roles\' command returns following message:\n FAIL - Cannot resolve user database reference\nAnd gets Exception:\nSEVERE: Manager: java:comp/env/users\njavax.naming.NamingException: Cannot create resource instance\n        at org.apache.naming.factory.ResourceEnvFactory.getObjectInstance(ResourceEnvFactory.java:117)\n        at javax.naming.spi.NamingManager.getObjectInstance(NamingManager.java:304)\n        at org.apache.naming.NamingContext.lookup(NamingContext.java:826)\n        at org.apache.naming.NamingContext.lookup(NamingContext.java:145)\n        at org.apache.naming.NamingContext.lookup(NamingContext.java:814)\n        at org.apache.naming.NamingContext.lookup(NamingContext.java:145)\n        at org.apache.naming.NamingContext.lookup(NamingContext.java:814)\n        at org.apache.naming.NamingContext.lookup(NamingContext.java:159)\n        at org.apache.naming.SelectorContext.lookup(SelectorContext.java:158)\n        at javax.naming.InitialContext.lookup(InitialContext.java:392)\n        at org.apache.catalina.manager.ManagerServlet.roles(ManagerServlet.java:1055)\n        at org.apache.catalina.manager.ManagerServlet.doGet(ManagerServlet.java:366)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:306)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:589)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:541)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:382)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:243)\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)\n        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:288)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:619)\n\nTomcat 6.x contains same issue.\n\nThe workaround for this issue is to add <ResourceLink> to context.xml of the Manager application.\nAnd I made the patch for this issue.\n\nregards.', 'Eiji Takahashi', '2011-02-03 02:38:46 UTC', 'tomcat_attachment/attachment 26601');
INSERT INTO `tomcatbody` VALUES (161, '50700', 'Bug 50700 Context parameters are being overridden with parameters from the web application deployment descriptor', 'Context parameters are being overridden with parameters from the web application deployment descriptor even through \'override\' attribute is set to \'false\'\n\nFor example:\nlines from context file\n<Context path=\'/path\' docBase=\'/path/to/docbase\' cookies=\'true\'>\n    <Parameter name=\'parameter_name\' value=\'test1\' override=\'false\'/>\n....\n</Context>\n\nlines from web.xml\n    <context-param>\n        <description>default value for parameter_name</description>\n        <param-name>parameter_name</param-name>\n        <param-value>test2</param-value>\n    </context-param>\n\nNow servletContext.getInitParameter(\'parameter_name\') returns \'test2\'', 'Sergey', '2011-02-01 13:04:17 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (162, '50771', 'Bug 50771 HttpServletRequest#getAuthType() returns null though the request is authenticated.', 'Created  attachment 26648   [details] \nI made a patch.\n\nWhen Tomcat registers an authenticated Principal and authentication Type with current session, \nonly authenticated Principal is replicated, and authentication Type is not replicated.\nTherefore, Request#getAuthType() returns null though the request is authenticated when the node changed. \n\n\nBest Regards.', 'Keiichi Fujino', '2011-02-14 03:30:02 UTC', 'tomcat_attachment/attachment 26648.txt');
INSERT INTO `tomcatbody` VALUES (163, '50726', 'Bug 50726 Jasper can generate uncompilable source code if genStringAsCharArray is turned on', 'Our jsp pages are compiled at build time. If I turn on genStringAsCharArray optimization switch, in some cases there will be longer lines in the generated java code than the javac compiler can process. It provides the following error message:\n\n[javac] Compiling 1609 source files to d: ... jspc classes\n[javac] d: ... jspc src org apache jsp WEB_002dINF ..._005fAPP pages termsconditions TermsAndConditions_005fms_005fMY_jsp.java:96: constant string too long', 'Róbert István', '2011-02-07 08:14:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (164, '50673', 'Bug 50673 Error when stopping Tomcat using services.msc', 'When stopping Tomcat using services.msc, an error message is displayed: \'Windows could not stop the Apache Tomcat 7 service on Local Computer. Error 109: The pipe has been ended.\'\n\nDespite this error, Tomcat appears to stop normally.\n\nNo such problem was encountered in 6.0.29.', 'apache', '2011-01-27 10:09:50 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (165, '50642', 'Bug 50642 keepAliveProtection doesn\'t work', 'Created  attachment 26541   [details] \nServletContextListener that removes the leaked ClassLoader reference\n\nsun.net.www.http.HttpClient.kac.keepAliveTimer.contextClassLoader causes a memory leak as it references the webapp\'s classloader rather than Tomcat\'s.\n\nJreMemoryLeakPreventionListener claims to fix this, but only loads sun.net.www.http.HttpClient and does not create the timer thread. Thus the leak still exists.\n\nAFAICT, the attached listener does successfully prevent the leak.', 'james', '2011-01-24 10:45:14 UTC', 'tomcat_attachment/attachment 26541.txt');
INSERT INTO `tomcatbody` VALUES (166, '50646', 'Bug 50646 Tribes ByteMessage will get corrupted if message size exceeds the underlying buffer size', 'The Tribes ByteMessage class is used to transfer byte payloads in the context of the tribes communication framework.\n\nDue to how the message is deserialized, there will be data loss (and hence corruption) if the message size exceeds the underlying buffer size.\n\nThe solution is to replace an ObjectInput#read(byte[]) call by ObjectInput#readFully(byte[]).\n\nFix is attached.', 'Olivier Costet', '2011-01-25 07:08:10 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (167, '50613', 'Bug 50613 ConnectionPool.size corruption when evictions enabled:', 'When (the various forms of) eviction run on the connection pool, ConnectionPool.size goes negative.  This appears to be a concurrency problem.\n\nAttached is a unit test that illustrates the issue.', 'Jeremy Norris', '2011-01-18 17:33:53 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (168, '50582', 'Bug 50582 Small JSPs do not set Content-Length (and use chunked encoding) if AccessLogValve is configured', 'Reported in the following thread on users@:\n http://markmail.org/thread/awcu5ler2m77jjok \n\nSteps to reproduce:\n1. Create the following JSP page, simple.jsp:\n<%= \'hello!\' %>\n\n2. Send the following request:\nGET /simple.jsp HTTP/1.1\nHost: localhost\nKeep-Alive: 115\nConnection: keep-alive\n\n3. Expected response: (Tomcat 7.0.4)\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nSet-Cookie: JSESSIONID=0AFC2875C06A962DF8A02DE6A780F721; Path=/; HttpOnly\nContent-Type: text/html;charset=ISO-8859-1\nContent-Length: 6\nDate: Thu, 13 Jan 2011 21:16:23 GMT\n\nhello!\n\n4. Actual response: (Tomcat 7.0.6)\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nSet-Cookie: JSESSIONID=2C176DBAC054D5BBF3D99FBE5C026915; Path=/; HttpOnly\nContent-Type: text/html;charset=ISO-8859-1\nTransfer-Encoding: chunked\nDate: Thu, 13 Jan 2011 21:23:19 GMT\n\n6\nhello!\n0\n\n===============================================\nInvestigation.\nIf I place a breakpoint in AbstractHttp11Processor#prepareResponse() I see the following line\n long contentLength = response.getContentLengthLong();\nreturns -1 and the call stack is:\n\nDaemon Thread [\'http-bio-8080\'-exec-1] (Suspended)	\n	Response.getContentLengthLong() line: 523	\n	Http11Processor(AbstractHttp11Processor).prepareResponse() line: 887	\n	Http11Processor(AbstractHttp11Processor).action(ActionCode, Object) line: 739	\n	Response.action(ActionCode, Object) line: 170	\n	Response.sendHeaders() line: 350	\n	OutputBuffer.doFlush(boolean) line: 308	\n	OutputBuffer.flush() line: 291	\n	Response.getBytesWritten(boolean) line: 327	\n	AccessLogValve$ByteSentElement.addElement(StringBuilder, Date, Request, Response, long) line: 1052	\n	AccessLogValve.log(Request, Response, long) line: 579	\n	AccessLogValve.invoke(Request, Response) line: 562	\n	StandardEngineValve.invoke(Request, Response) line: 118	\n	CoyoteAdapter.service(Request, Response) line: 380	\n	Http11Processor.process(SocketWrapper<Socket>) line: 243	\n	Http11Protocol$Http11ConnectionHandler.process(SocketWrapper<Socket>, SocketStatus) line: 188	\n	Http11Protocol$Http11ConnectionHandler.process(SocketWrapper<Socket>) line: 166	\n	JIoEndpoint$SocketProcessor.run() line: 288	\n	ThreadPoolExecutor$Worker.runTask(Runnable) line: 886	\n	ThreadPoolExecutor$Worker.run() line: 908	\n	TaskThread(Thread).run() line: 662	\n\nNote OutputBuffer.flush() call above.\n\n\nIf I remove AccessLogValve from configuration, the response.getContentLengthLong();\ncall returns \'8\' as expected and call stack is:\n\nDaemon Thread [\'http-bio-8080\'-exec-1] (Suspended)	\n	Http11Processor(AbstractHttp11Processor).prepareResponse() line: 888	\n	Http11Processor(AbstractHttp11Processor).action(ActionCode, Object) line: 739	\n	Response.action(ActionCode, Object) line: 170	\n	Response.sendHeaders() line: 350	\n	OutputBuffer.doFlush(boolean) line: 308	\n	OutputBuffer.close() line: 275	\n	Response.finishResponse() line: 501	\n	CoyoteAdapter.service(Request, Response) line: 406	\n	Http11Processor.process(SocketWrapper<Socket>) line: 243	\n	Http11Protocol$Http11ConnectionHandler.process(SocketWrapper<Socket>, SocketStatus) line: 188	\n	Http11Protocol$Http11ConnectionHandler.process(SocketWrapper<Socket>) line: 166	\n	JIoEndpoint$SocketProcessor.run() line: 288	\n	ThreadPoolExecutor$Worker.runTask(Runnable) line: 886	\n	ThreadPoolExecutor$Worker.run() line: 908	\n	TaskThread(Thread).run() line: 662	\n\n===============================================\nThe value returned by response.getContentLengthLong() should be set explicitly (e.g. with content-length header). The second stack trace includes OutputBuffer.close() call and it sets the length value to the response:\n\n>   coyoteResponse.setContentLength(bb.getLength());\n\n\nThis regression is triggered by flushing when AccessLogValve asks for the count of bytes written and was introduced when implementing #50496.', 'Konstantin Kolinko', '2011-01-14 02:16:41 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (169, '18462', 'Bug 18462 System.err gets overriden to output to System.out', 'I am using Eclipse to do my development and I am running tomcat 4.1.24 from \nwithin eclipse. One of the nice features of eclipse is that anything you \ndisplay with System.out comes out in blue and anything you send to System.err \nis displayed in red. However when tomcat is running Catalina overrides \nSystem.err and makes it point to System.out. This is very inconvinient because \nits much harder to search for severe error messages in a list of millions of \ntrivial ones.', 'Nikolay Metchev', '2003-03-28 12:35:32 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (170, '15688', 'Bug 15688 full-qualified names instead of imports', 'Hi,\n\nJasper generated *.java-files that are compiled.\nThe template for those files is very \'unaesthetic\'.\n\nI could demonstrate nice side-effects using a simple\n  <%@ page import=\'mypackage.Jspfactory\' %>\n\nYou should use full qualified names instead of a bunch of import-staments.\nFor example\n  _jspxFactory = JspFactory.getDefaultFactory();\nwould become\n  _jspxFactory = javax.servlet.jsp.JspFactory.getDefaultFactory();\nand if you don\'t already do,\nyou should use the this-reference where possible.\n\nI don\'t know what the spec says about that conflict, but it shouldn\'t be a bad\nidea to use full-qualified names instead of imports.', 'Sven', '2002-12-27 22:30:47 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (171, '49953', 'Bug 49953 Missing @Override annotations', 'Created  attachment 26045   [details] \nAdd missing annotations', 'Sebb', '2010-09-17 14:00:04 UTC', 'tomcat_attachment/attachment 26045.txt');
INSERT INTO `tomcatbody` VALUES (172, '21157', 'Bug 21157 CookieExample is setting cookie after writing data', 'A servlet can not set the headers and cookies after writing data to the \nservlet\'s output stream. Once the servlet writes data, headers are committed. \nHowever CookieExample writes some data first before doing addCookie on the \nresponse. \n\nThe reason why this code works at all even with the above bug is: The \nCookieExample is only writing a small amount of data before doing \nresponse.addCookie. That data is still held in buffer and not yet sent over \nthe wire. Hence the headers are not yet committed. So it is pure luck that \nthis example works. \n\nYou can easily expose the bug by writing say 20K characters in this example \nbefore response.addCookie is called. You will see that the cookies that are \nadding to response are not actually sent back to client. \n\nFix is simple. Move up the response.addCookie() before response.getWriter()', 'Vishy Kasar', '2003-06-27 23:12:00 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (173, '50552', 'Bug 50552 Ant Tasks give a null pointer exception when an error occurs, masking true error', 'Created  attachment 26463   [details] \nFix to abstract catalina task class to set up redirector correctly\n\nUsing the Ant List Task with outputproperty set causes a null pointer exception in the event of any error. For example, if tomcat is not running or the url given is incorrect. Since the bug is in a base class, this probably affects all the ant tasks.\n\nThe bug is due to the fact that the code to clean up the redirector is called in the finally block, but the equivalent code to set it up is not. This problem is also present in Tomcat 6.\n\nThe attached patch fixes the problem. With the patch in place, using the list task when tomcat is down gives \'Connection refused\' instead.', 'chris.rimmer', '2011-01-06 12:39:49 UTC', 'tomcat_attachment/attachment 26463');
INSERT INTO `tomcatbody` VALUES (174, '49543', 'Bug 49543 Request for a \'shared\' datasource configuration as in DBCP', 'The ability to configure the datasource at the server level and have it shared amongst all applications on that server with each application supplying their own credentials for the datasource. This type of configuration is supported by DBCP and is called a \'shared\' datasource configuration.', 'Jason', '2010-07-02 15:07:50 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (175, '50547', 'Bug 50547 The CHANGE_SESSION_ID message that received during cluster session synchronization is dropped.', 'Neither CHANGE_SESSION_ID message nor SESSION_EXPIRED message set timestamp. \nIf these messages are received during cluster sessions synchronization in DeltaManager startup, \nbecause the timestamp is not set, they are dropped. \n\nI made a patch that add timestamp for CHANGE_SESSION_ID and SESSION_EXPIRED message.\n\nBest Regards.', 'Keiichi Fujino', '2011-01-06 03:48:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (176, '50453', 'Bug 50453 Multiple X-Forwarded-For headers not handled by RemoteIP valve', 'When a request comes in with multiple X-Forwarded-For headers the RemoteIP valve should be examining all of them in reverse order.\n\nAs defined by the standard:\n\'Multiple message-header fields with the same field-name MAY be present in a message if and only if the entire field-value for that header field is defined as a comma-separated list [i.e., #(values)]. It MUST be possible to combine the multiple header fields into one \'field-name: field-value\' pair, without changing the semantics of the message, by appending each subsequent field-value to the first, each separated by a comma. The order in which header fields with the same field-name are received is therefore significant to the interpretation of the combined field value, and thus a proxy MUST NOT change the order of these field values when a message is forwarded.\'\n\nthus:\n(a)\nX-Forwarded-For: 192.168.0.3\nX-Forwarded-For: 222.234.0.4\n\nIs semantically equivalent to:\n(b)\nX-Forwarded-For: 192.168.0.3, 222.234.0.4\n\nHowever (a) is not handled by the RemoteIP valve as it only ever looks at the first header.\n\nFor reference, this was raised on the HAproxy mailing list:\n http://www.formilux.org/archives/haproxy/1012/4122.html \nand tomcat user\'s mailing list:\n http://mail-archives.apache.org/mod_mbox/tomcat-users/201012.mbox/%3C4D022C57.1070005@apache.org%3E \n\nTomcat users suggested raising a bug. Hence this.', 'brett.dellegrazie', '2010-12-10 09:29:39 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (177, '50467', 'Bug 50467 Occasional NIO connector lockups on high load', 'We\'ve been running Tomcat 6.0.29 on FC8 2.6.21 with tens of thousands of long polling threads which usually work fine. Every few days though we will experience a sudden lockup of the NIO connector and it has to be restarted. These have been seen to be accompanied by the following stack trace:\n\nException in thread \'http-8082-ClientPoller-0\' java.lang.NullPointerException\n	at org.apache.tomcat.util.net.NioEndpoint$Poller.run(NioEndpoint.java:1620)\n	at java.lang.Thread.run(Thread.java:662)\n\nLooking at the source it seems the issue is likely to be a race condition where access() is called on a null attachment, probably while it\'s in the process of being cancelled:\n\n                    while (iterator != null && iterator.hasNext()) {\n                        SelectionKey sk = (SelectionKey) iterator.next();\n                        KeyAttachment attachment = (KeyAttachment)sk.attachment();\n/*NPE*/                 attachment.access();\n                        iterator.remove();\n                        processKey(sk, attachment);\n                    }//while', 'Steven Hugg', '2010-12-13 14:02:35 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (178, '50500', 'Bug 50500 EL evaluation of floating-point String value vs BigInteger loses precision', 'According to the EL spec ch.1.7.1,\nthe A+B,A-B,A*B expressions when A is a \'String containing ., e, or E\' and B is a BigInteger have to be evaluated as follows:\n\n\'coerce both A and B to BigDecimal and apply operator\'\n\nThe actual implementation though, instead of coercing A as String -> BigDecimal, does two coercions:  String -> Double -> BigDecimal, which produces a different result.\n\nTo reproduce, run the following JSP page:\n<%\n  pageContext.setAttribute(\'a\', \'1.1\');\n  pageContext.setAttribute(\'b\', new java.math.BigInteger(\'1000000000000000000000\'));\n  // \'c\' is used to explicitly coerce arguments to BigDecimal\n  pageContext.setAttribute(\'c\', new java.math.BigDecimal(\'0\'));\n%>${a + b}<br>\n${(a+c) + (b+c)}<br>\n${a - b}<br>\n${(a+c) - (b+c)}<br>\n${a * b}<br>\n${(a+c) * (b+c)}\n\nActual result:\n1000000000000000000001.100000000000000088817841970012523233890533447265625\n1000000000000000000001.1\n-999999999999999999998.899999999999999911182158029987476766109466552734375\n-999999999999999999998.9\n1100000000000000088817.841970012523233890533447265625000000000000000000000\n1100000000000000000000.0 \n\nExpected result:\n1000000000000000000001.1\n1000000000000000000001.1\n-999999999999999999998.9\n-999999999999999999998.9\n1100000000000000000000.0 \n1100000000000000000000.0 \n\nI think it is a minor issue, though.\nThis is reproducible in the current tc6.0.x as well.\n\nMaybe o.a.el.lang.ELArithmetic#add(Object, Object) should delegate to BIGDECIMAL instead of DOUBLE with these types of arguments.', 'Konstantin Kolinko', '2010-12-19 19:00:53 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (179, '50025', 'Bug 50025 getConnection method in class DataSourceProxy is ignoring credentials', 'See  http://forum.springsource.org/showthread.php?t=95980  for a description of the problem.', 'Tim', '2010-09-29 09:48:26 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (180, '49125', 'Bug 49125 toString on byte[] array probably is not correct', 'Two examples of using toString() on a byte[] array, which is unlikely to produce the desired output:\n\nha.deploy.FileMessageFactory.writeMessage()\nlog message uses toString on msg.getData() which is a byte[] array\n\ncoyote.ajp.AjpMessage.dump\nuse toString on \'msg\' which is of type byte[]', 'Sebb', '2010-04-14 18:54:35 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (181, '50460', 'Bug 50460 First access to a jspx page causes classloader leak in JspDocumentParser', 'Running latest 6.0.x,\n\nTo reproduce:\n1. Stop Tomcat\n2. Deploy the examples webapp\n3. Create /webapps/examples/foo.jsp file containing the following text:\n<jsp:include page=\'/jsp/jsp2/jspx/basic.jspx\'/>\n\n4. Make sure that the work folder of Tomcat is empty.\n5. Start Tomcat\n6. Go to  http://localhost:8080/examples/foo.jsp \n7. Go to the Manager web application and stop the examples webapp.\n8. Press the \'Find leaks\' button there.\nACTUAL RESULT:\nIt is reported that \'/examples\' causes a leak.\nEXPECTED RESULT:\nNo leaks.\n\nThis issue is apparently caused by an instance of org.apache.jasper.compiler.JspDocumentParser$EnableDTDValidationException\nthat is being kept in a static final field.\n\nMore discussion of such leaks can be found in thread [1] on dev@.\n\n[1]  http://tomcat.markmail.org/thread/v4xmg5v5t6oa4mrs \n http://marc.info/?l=tomcat-dev&m=129211856426188&w=2 \n\nAdditional comments:\n1) This issue affects the first request that loads the JspDocumentParser class. Subsequent requests do not cause the issue. Thus only a single webapp is affected.\n2) The issue does not happen when there is no webapp code in the call stack. I.e., it does not happen if the JSPX page was requested directly.\nThat is why the reproduction recipe uses <jsp:include/>.\n\nPossible solutions:\n1) Preload the JspDocumentParser class when Tomcat starts.\n2) Do not cache the Exception. Create a new instance each time.\n3) Override the fillInStackTrace() method, like it was done in AbstractDOMParser$Abort in Apache Xerces [2]. I do not know, whether that helps or not.\n\n[2]  http://svn.apache.org/viewvc/xerces/java/trunk/src/org/apache/xerces/parsers/AbstractDOMParser.java?annotate=782187#l162 ', 'Konstantin Kolinko', '2010-12-11 21:33:47 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (182, '48692', 'Bug 48692 Provide option to parse application/x-www-form-urlencoded PUT requests', 'Provide an option to treat application/x-www-form-urlencoded encoded parameters in a PUT request in a similar manner to application/x-www-form-urlencoded parameters in a POST request', 'Mark Thomas', '2010-02-07 02:41:33 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (183, '49142', 'Bug 49142 Missing serialVersionUIDs', 'org.apache.catalina.ha.ClusterMessageBase is Serializable; consider declaring a serialVersionUID\n\nSimilarly for:\norg.apache.catalina.ha.session.ReplicatedSession \norg.apache.catalina.ha.session.SerializablePrincipal \norg.apache.catalina.session.StandardSession \norg.apache.catalina.tribes.tipis.AbstractReplicatedMap.MapMessage\norg.apache.tomcat.util.modeler.ManagedBean', 'Sebb', '2010-04-16 21:25:34 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (184, '48837', 'Bug 48837 Memory leaks protection does not detect leaks triggered by JSP pages code', 'Created  attachment 25077   [details] \nwebapps/examples/foo.jsp\n\nThe memory leaks protection feature of TC6/TC7 is able to heal certain types of memory leaks caused by servlet code (where classes are loaded by WebappClassLoader), but does not provide a cure for ones caused by JSP code (where classes are loaded by JasperLoader).\n\nI think that is of little concern, as the code that triggers a memory leak is unlikely to be present on a JSP page or a tag file, but at least it provides us with an example to test the \'Find leaks\' diagnostics in the Manager webapp.\n\n\nTo reproduce:\n1. Place the attached foo.jsp into the examples webapp\n2. Open  http://localhost:8080/examples/foo.jsp \n3. Open the Manager web application\n4. Reload or stop/start the examples application\n5. Press the \'Find leaks\' button in the Manager\n6. The message will be displayed that \'/examples\' app triggered a memory leak.\n\nThe leak is caused by foo.jsp creating a ThreadLocal holding an instance of some inner class of that JSP. (That inner class was loaded through JasperLoader, and thus was not detected when enumerating ThreadLocals in leaks protection code.)\n\n7. Another ThreadLocal (holding a reference to some servlet) is successfully cleared by memory leak protection code when the examples application is stopped. You can see a message about that in the Tomcat logs.', 'Konstantin Kolinko', '2010-03-01 18:51:11 UTC', 'tomcat_attachment/attachment 25077');
INSERT INTO `tomcatbody` VALUES (185, '50192', 'Bug 50192 performance issue after revision 746425 ', ' Revision 746425  changed at least 2 files: ELResolverImpl and ELContextImpl.  I believe this causes an unnecessary performance regression in these two files.\n\nIn ELResolverImpl, every time that getDefaultResolver is called with security enabled, a new Object is going to be created.  It appears as if getDefaultResolver is going to be called a lot and this could significantly hurt performance.  I understand changing the DefaultResolver to be private and allowing access to it through the getter method, however, I don\'t believe a new object needs to be created every time the method is called.\n\nIn ELContextImpl, why does a new FunctionMapper need to be created for each ELContextImpl?\n\nThanks.', 'Robert Goff', '2010-11-01 15:17:42 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (186, '50168', 'Bug 50168 destory method is called twice while the child is destoryed directly', 'While calling the method destory() on the StandardContext directly, it seems that the method destoryInternal() is called twice in the LifecycleMBeanBase, the two stacktraces are below :\n    a.  LifecycleMBeanBase.unregister(ObjectName) line: 191   \n         LifecycleMBeanBase.destroyInternal() line: 73   \n         ContainerBase.destroyInternal() line: 1109   \n         StandardContext.destroyInternal() line: 5114   \n         LifecycleBase.destroy() line: 271   \n         ContainerBase.removeChild(Container) line: 963   \n         ContainerBase.destroyInternal() line: 1106   \n         StandardContext.destroyInternal() line: 5114   \n         LifecycleBase.destroy() line: 271   \n         ...\n     b. LifecycleMBeanBase.unregister(ObjectName) line: 191   \n         LifecycleMBeanBase.destroyInternal() line: 73   \n         ContainerBase.destroyInternal() line: 1109   \n         StandardContext.destroyInternal() line: 5114   \n         LifecycleBase.destroy() line: 271\n         ...', 'Ivan', '2010-10-27 22:47:42 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (187, '49426', 'Bug 49426 Manager app wrongly localized', 'Created  attachment 25582   [details] \nPatch (with unit test) fixing the problem for the ManagerServlet\n\nThe manager app shows message using the server\'s default locale whereas it should react on the request Locale.\n\nThe cause is that the ManagerServlet uses StringManager what is fine for messages that are logged but not for those that are sent as responses.\n\nThe attached patch fixes the problem for the ManagerServlet but not for the HTMLManagerServlet. It will require a bit more refactoring there because the same messages may be intended for log or for output to the response. I can propose a second patch for it once the problem has been fixed for the ManagerServlet.\n\nFor info: same problem occurs in Tomcat 6.', 'Marc Guillemot', '2010-06-11 03:26:07 UTC', 'tomcat_attachment/attachment 25582.txt');
INSERT INTO `tomcatbody` VALUES (188, '50066', 'Bug 50066 Cannot compile recursive tag with ant if it uses a class from the webapp', 'The following simple tag file cannot be compiled with the jspc ant task (or the jpsc maven plugin) :\n\n<%@ taglib prefix=\'c\' uri=\' http://java.sun.com/jsp/jstl/core \' %>\n<%@ taglib prefix=\'tags\' tagdir=\'/WEB-INF/tags\' %>\n\nHello world !\n<c:if test=\'${false}\' >\n    <tags:recursive />\n</c:if>\n\nThe error is \norg.apache.jasper.JasperException: /WEB-INF/tags/recursive.tag(21,0) Unable to load tag handler class \'org.apache.taglibs.standard.tag.rt.core.IfTag\' for tag \'c:if\'\n\nIt\'s OK when the compilation is done \'online\', when the first jsp that uses this tag is called with a http request.\n\nThe problem is that japer\'s TagFileProcessor does not set the correct classloader when compiling recursive tags. It works in online mode because the parent classloader of the jsp classloader is the webapp classloader.', 'Sylvain Laurent', '2010-10-09 09:49:32 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (189, '50027', 'Bug 50027 NullPointerException if context.xml is present with <Resource>', 'If you deploy a WAR with contex.xml in META-INF and the context.xml has <Resource> tag, Tomcat don´t boot and gives this error:\n\njava.lang.NullPointerException\n	at org.apache.catalina.core.StandardContext.getObjectKeyPropertiesNameOnly(StandardContext.java:5570)\n	at org.apache.catalina.core.StandardContext.setNamingResources(StandardContext.java:1757)\n	at org.apache.catalina.core.StandardContext.getNamingResources(StandardContext.java:1735)\n	at org.apache.catalina.startup.SetNextNamingRule.end(SetNextNamingRule.java:99)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1058)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:601)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:180)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1544)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:524)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:560)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\n29/09/2010 13:50:37 org.apache.catalina.startup.Catalina load\nAVISO: Catalina.start using conf/server.xml: \njava.lang.NullPointerException\n	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2688)\n	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2714)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1061)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:601)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:180)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1544)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:524)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:560)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\nCaused by: java.lang.NullPointerException\n	at org.apache.catalina.core.StandardContext.getObjectKeyPropertiesNameOnly(StandardContext.java:5570)\n	at org.apache.catalina.core.StandardContext.setNamingResources(StandardContext.java:1757)\n	at org.apache.catalina.core.StandardContext.getNamingResources(StandardContext.java:1735)\n	at org.apache.catalina.startup.SetNextNamingRule.end(SetNextNamingRule.java:99)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1058)\n	... 20 more\n29/09/2010 13:50:37 org.apache.tomcat.util.digester.SetPropertiesRule begin\nAVISO: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property \'source\' to \'org.eclipse.jst.jee.server:bestforkprime\' did not find a matching property.\n29/09/2010 13:50:37 org.apache.tomcat.util.digester.Digester endElement\nGRAVE: End event threw exception\njava.lang.NullPointerException\n	at org.apache.catalina.core.StandardContext.getObjectKeyPropertiesNameOnly(StandardContext.java:5570)\n	at org.apache.catalina.core.StandardContext.setNamingResources(StandardContext.java:1757)\n	at org.apache.catalina.core.StandardContext.getNamingResources(StandardContext.java:1735)\n	at org.apache.catalina.startup.SetNextNamingRule.end(SetNextNamingRule.java:99)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1058)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:601)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:180)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1544)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:524)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:573)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\n29/09/2010 13:50:37 org.apache.catalina.startup.Catalina load\nAVISO: Catalina.start using conf/server.xml: \njava.lang.NullPointerException\n	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2688)\n	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2714)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1061)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:601)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:180)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1544)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:524)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:573)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\nCaused by: java.lang.NullPointerException\n	at org.apache.catalina.core.StandardContext.getObjectKeyPropertiesNameOnly(StandardContext.java:5570)\n	at org.apache.catalina.core.StandardContext.setNamingResources(StandardContext.java:1757)\n	at org.apache.catalina.core.StandardContext.getNamingResources(StandardContext.java:1735)\n	at org.apache.catalina.startup.SetNextNamingRule.end(SetNextNamingRule.java:99)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1058)\n	... 20 more\n29/09/2010 13:50:37 org.apache.catalina.startup.Catalina start\nGRAVE: Cannot start server. Server instance is not configured.\n\nHere is my contex.xml OBS: some values were replaced with XXXX \n\n\n<?xml version=\'1.0\' encoding=\'UTF-8\'?>\n<Context privileged=\'true\' reloadable=\'true\'>\n\n	<WatchedResource>WEB-INF/web.xml</WatchedResource>\n	<WatchedResource>META-INF/context.xml</WatchedResource>\n	\n	<Resource name=\'jdbc/bestfork\' auth=\'Container\'\n		type=\'com.mchange.v2.c3p0.ComboPooledDataSource\' factory=\'org.apache.naming.factory.BeanFactory\'\n		user=\'xxx\' password=\'xxxx\' driverClass=\'org.postgresql.Driver\'\n		jdbcUrl=\'jdbc:postgresql://localhost:5432/xxxxx\' minPoolSize=\'5\'\n		maxPoolSize=\'30\' acquireIncrement=\'5\' idleConnectionTestPeriod=\'100\'\n		maxIdleTime=\'30\'/>\n\n	<Resource name=\'mail/Session\' auth=\'Container\' type=\'javax.mail.Session\'\n		mail.smtp.host=\'xxxx\' mail.smtp.auth=\'true\'\n		username=\'xxx\' password=\'xxx\'\n		mail.user=\'xxxx\' mail.password=\'xxxx\'\n		mail.smtp.port=\'587\' mail.transport.protocol=\'smtp\' mail.debug=\'true\' />\n\n	<Realm className=\'org.apache.catalina.realm.JDBCRealm\'\n		driverName=\'org.postgresql.Driver\' connectionURL=\'jdbc:postgresql://localhost:5432/xxxx\'\n		connectionName=\'xxxx\' connectionPassword=\'xxxx\' userTable=\'usuario\'\n		userNameCol=\'usuario_cpf\' userCredCol=\'usuario_senha\' userRoleTable=\'usuario_papel\'\n		roleNameCol=\'papel_nome\' digest=\'MD5\' />\n				\n\n</Context>', 'Flávio Henrique', '2010-09-29 13:02:53 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (190, '49986', 'Bug 49986 Double-check locking. Possible data-race in JspServletWrapper', ' r998053 \n http://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/java/org/apache/jasper/servlet/JspServletWrapper.java \n\nCommon anti-pattern: Double checked locking. I don\'t know is this race dangerous or no.\n\nRace on private boolean reload\n    \npublic Servlet getServlet()\n        throws ServletException, IOException, FileNotFoundException\n    {\n        if (reload) {\n            synchronized (this) {\n                // Synchronizing on jsw enables simultaneous loading\n                // of different pages, but not the same page.\n                if (reload) {\n                    // This is to maintain the original protocol.\n                   \n..........\n\n                    theServlet = servlet;\n                    reload = false;\n                }\n            }    \n        }\n        return theServlet;\n    }', 'Sergey Vorobyev', '2010-09-23 09:31:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (191, '49972', 'Bug 49972 Double-check idiom. Possible data-race.', ' r998053 \nclass org/apache/tomcat/util/http/FastHttpDateFormat\n http://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/java/org/apache/tomcat/util/http/FastHttpDateFormat.java \n\nThere is double-check anti-pattern in public static final String getCurrentDate() method\non protected static long currentDateGenerated variable\n\nConcurrent read on line 112\nConcurrent write on line 115\n\nP.S.: Maybe I have mistake with determine component', 'Sergey Vorobyev', '2010-09-22 04:44:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (192, '49985', 'Bug 49985 Lazy initialization without any synchronization - data race in AstInteger, AstFloatingPoint, AstString', ' r998053 \n http://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/java/org/apache/el/parser/AstInteger.java \n http://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/java/org/apache/el/parser/AstFloatingPoint.java \n http://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/java/org/apache/el/parser/AstString.java \n\nUse lazy init without any synchronization in methods getInteger(), getFloatingPoint(), getString(), respectively.\n \nConsider AstInteger:\n\nprivate Number number;\n\n    protected Number getInteger() {\n        if (this.number == null) {\n            try {\n                this.number = new Long(this.image);\n            } catch (ArithmeticException e1) {\n                this.number = new BigInteger(this.image);\n            }\n        }\n        return number;\n    }\n\n\nData races on variable number :37\nin method getInteger() :39\nconcurrent read on line 40\nconcurrent write on lines 42, 44', 'Sergey Vorobyev', '2010-09-23 08:55:42 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (193, '49915', 'Bug 49915 [Patch] o.a.c.c.StandardServer swallows error on storeConfig.', 'When o.a.c.c.StandardServer#storeConfig is called all exceptions were getting swallowed. \n\nThis lead to the impresssion it was working correctly when saved either through the manager application /manager/save or through jconsole.\n\nI\'ve removed the catch throwable block and thrown an exception upon not finding the registerd MBean.', 'Wesley', '2010-09-10 19:35:43 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (194, '49667', 'Bug 49667 JdbcLeakPrevention class can register unregistered JCBC Driver', 'Overview\nSuppose there is an web application A that uses a database and registers a Driver with the java.sql.DriverManager, and a web application B that doesn\'t use a database but has a jar file in its WEB-INF/lib directory that contains the same Driver. Suppose you undeploy web application B.\nRunning the org.apache.catalina.loader.JdbcLeakPrevention class will actually register the Driver and leave it loaded! The cause is the way the DriverManager checks whether a ClassLoader has permission to load the Driver. It does that by calling Class.forName with the ClassLoader, which will load the class if the class has not been loaded by that ClassLoader. Loading a Driver class triggers the Driver to register itself. \n\nSteps to reproduce\nCreate two web applications: one which registeres a Driver with the java.sql.Drivermanager and one that uses no database. Put the jar containing the Driver class in the WEB-INF/lib directory of both applications. Deploy both in Tomcat. Then undeploy the latter one.\nInspect catalina.out, verify that there are no messages about a JDBC Driver being forcibly unregistered.\nCreate a memory dump using jmap and inspect the dump using jhat.\n\nActual results\nThe WebappClassLoader for the latter application is still present. Its \'rootset references\' page shows two reference chains from class java.sql.DriverManager:\nStatic reference from java.sql.DriverManager.readDrivers (from class java.sql.DriverManager) :\n--> java.util.Vector@0xeb6eb3f0 (24 bytes) (field elementData:)\n--> [Ljava.lang.Object;@0xeb6eb408 (20 bytes) (Element 2 of [Ljava.lang.Object;@0xeb6eb408:)\n--> java.sql.DriverInfo@0xeb6eb420 (20 bytes) (field driverClass:)\n--> class oracle.jdbc.driver.OracleDriver (84 bytes) (??:)\n--> org.apache.catalina.loader.WebappClassLoader@0xeb5a84a0 (157 bytes) \n\nand a similar one from java.sql.DriverManager.writeDrivers.\n\nExpected results\nThe WebappClassLoader is not present in memory anymore.\n\nBuild date & platform\nDownloaded Core tar.gz from  http://tomcat.apache.org/download-70.cgi ', 'Arjen Knibbe', '2010-07-29 09:31:33 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (195, '49730', 'Bug 49730 Race condition in StandardThreadExecutor : requests are sometimes enqueued instead of creating new threads', 'In tomcat 6, I often configure an Executor with minSpareThreads=0 to work around memory leak issues upon redeployment.\n\nSometimes (especially in development), when I refresh a page of my webapp with Safari, Chrome or Firefox, some resources of the page take several seconds (>10s) to be served though they are static resources and should come in less than 50ms. For instance, over 15 requests for a page (1 for html, the others for resources like js, css, images...), I sometimes have 1 or 2 that take >10s. \n\nAfter analysis, I found that in org.apache.catalina.core.StandardThreadExecutor.TaskQueue.offer(Runnable) the statement \nif (parent.getActiveCount()<(parent.getPoolSize()))\nis sometimes true unexpectedly. Here is the scenario :\n\n- ThreadPoolExecutor is empty\n- the user refreshes the page (or accesses it with an empty cache) in his web browser for a page that uses a more than 10-15 resources\n- the browser establishes one TCP connection and a new Thread is created\n- after the browser receives the response, it decides to load as many resources as possible in parallel. For this it establishes up to 6 TCP connections (in my tests)\n- The Acceptor thread calls StandardThreadExecutor.execute to process each incoming connection.\n- For each call, StandardThreadExecutor.TaskQueue.offer(Runnable) is being called\n- if you study the sources of Java 6 ThreadPoolExecutor, you can see that there\'s a small delay between the time a new Thread is created (thus increasing poolSize) and the time it starts working on its first task (increasing the activeCount)\n- Since in my case connections are established in a rapid burst, the calls to TaskQueue.offer() are sometimes faster than this small delay, so that we do have parent.getActiveCount()<parent.getPoolSize() and thus the task is enqueued instead of forcing the creation of a thread to serve it.\n- Since Keep-Alive is enabled and tomcat 6 threads take care of only one TCP connection at a time, the requests in the queue must wait for the keep-alive timeout so that a Thread is returned to the pool to serve pending tasks.\n- With 25s keepAliveTimeOut, it means that some requests take more than 25s to be served eventhough the pool was never full and the server quite idle!!!\n\nOther facts about this issue :\n- Although my test case starts with an empty pool, it can occur even on a loaded server. The thing that triggers the issue is the burst of new TCP connections.\n- The problem is less severe with a lower keepAliveTimeout, or if keepalive is disabled. In any case, it also depends on the time taken to serve current requests.\n- The issue also affects tomcat 7 but is less severe because tc7 threads are returned to the pool after each http request, even if the TCP connection is kept alive. The impact would the same as with tc6 with keepAlive disabled.', 'Sylvain Laurent', '2010-08-09 16:16:04 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (196, '49665', 'Bug 49665 When file not found error occurs it does not tell you which file caused the error.', 'Created  attachment 25814   [details] \nPatch to jasper so file not found error while parsing tld\'s report file and location.\n\nWhen parsing jsp\'s into java, if a \'file not found\' occurrs like on a tag file it will not tell you which file caused the error.\n\nAs an example : \n------------------------\n   [jasper] Jul 29, 2010 7:02:24 PM org.apache.jasper.JspC processFile\n   [jasper] SEVERE: File \'/tags/struts-bean\' not found\n   [jasper] Jul 29, 2010 7:02:25 PM org.apache.jasper.JspC processFile\n   [jasper] SEVERE: file:/data/cvs/oscar_mcmaster/build/tmp/jspc/web/ticklerPlus/preparedTicklerList.jsp(22,18) Attribute value request.getAttribute(\'preparedTicklers\') is quoted with \' which must be escaped when used within the value\n------------------------\n\nThere are 2 errors showing here, one is from an invalid tag and the other is on an attribute. Note that the attribute works well and tells me which file and location is causing the problem. Note that with the first error it doesn\'t even tell me which file is causing the error.\n\nAttached is a patch which shows the file and location of the error. After the patch file is applied I get a more useful out put\n\n-------------------------\n   [jasper] Jul 29, 2010 6:54:11 PM org.apache.jasper.JspC processFile\n   [jasper] SEVERE: file:/data/cvs/oscar_mcmaster/build/tmp/jspc/web/ticklerPlus/Auth.jsp(1,49) File \'/tags/struts-bean\' not found\n   [jasper] Jul 29, 2010 6:54:11 PM org.apache.jasper.JspC processFile\n   [jasper] SEVERE: file:/data/cvs/oscar_mcmaster/build/tmp/jspc/web/ticklerPlus/preparedTicklerList.jsp(22,18) Attribute value request.getAttribute(\'preparedTicklers\') is quoted with \' which must be escaped when used within the value\n-------------------------', 'Ted Leung', '2010-07-29 05:08:43 UTC', 'tomcat_attachment/attachment 25814.txt');
INSERT INTO `tomcatbody` VALUES (197, '49209', 'Bug 49209 AccessControlException when undeploying application', 'When running Tomcat with a SecurityManager, an AccessControlException is thrown during undeployment.\n\nStack trace:\n\nCaused by: java.security.AccessControlException: access denied (java.lang.RuntimePermission getClassLoader)\n	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:323)\n	at java.security.AccessController.checkPermission(AccessController.java:546)\n	at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\n	at java.lang.Class.getClassLoader(Class.java:594)\n	at org.apache.catalina.loader.JdbcLeakPrevention.clearJdbcDriverRegistrations(JdbcLeakPrevention.java:49)\n\nI assume the default catalina.policy should be updated, to take this case into account.', 'Stephan Bublava', '2010-04-28 07:30:12 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (198, '49234', 'Bug 49234 JMX Descriptor Modifications', 'Created  attachment 25378   [details] \nDescriptor Modification\n\nPackage: org.apache.catalina\n\nI have slightly modified mbeans-descriptor.xml in above package as below.\n 1. Removed username and password attributes from the User mbean object since it exposes username and the password of the users.\n 2. Modified some attributes as non writeable according to the context.', 'chamith buddhika', '2010-04-30 00:17:34 UTC', 'tomcat_attachment/attachment 25378.txt');
INSERT INTO `tomcatbody` VALUES (199, '49749', 'Bug 49749 SSO cookie should be added as HttpOnly', 'SSO cookies should be made HttpOnly by default.\n\nIn org.apache.catalina.authenticator.AuthenticatorBase#register(), \n\n798- response.addCookie(cookie);\n798+ response.addCookieInternal(cookie, true);', 'dheinecke', '2010-08-13 19:18:22 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (200, '48738', 'Bug 48738 [PATCH]Allow GzipOutputFilter to send partial result when flushBuffer() is called', 'Created  attachment 24979   [details] \npatch for the making GzipOutputFilter work with early flush\n\nAs part of our site speed optimizations (at Linkedin) we bumped into a problem when trying to do partial flush of compressed content stream from Tomcat to the browser. We discovered the root cause to be a couple of long outstanding JDK bugs:\n\n  http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4255743 \n  http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4813885 \n\nBasically, with the GzipOutputFilter turned on, the GZIPOutputStream it uses internally buffers the data that\'s been sent over, and does not flush to client (browser) when flushBuffer() is invoked.\n\nWe have produced a patch which we verified internally, that it did work to do a partial flush on the compressed stream. We also have a unit testcase included in the patch to quickly show the problem. \n\nEarly flush is a quite useful technique that many sites out there can benefit from to speed up the page download/rendering time, and by having it working in tomcat would benefit the existing and new customers. \n\nThanks!', 'Jiong Wang', '2010-02-13 23:28:26 UTC', 'tomcat_attachment/attachment 24979.txt');
INSERT INTO `tomcatbody` VALUES (201, '49670', 'Bug 49670 org.apache.catalina.authenticator.SingleSignOn valve does not function', 'I have two web applications; neither declare a realm in the context.xml and both are configured for authentication in the web.xml using standard tomcat authentication methods.  I have enabled the tomcat valve in the host and have added a realm to the host as well.\n\n      <Host name=\'localhost\'  appBase=\'webapps\' unpackWARs=\'true\' autoDeploy=\'true\'>\n      	<Realm className=\'org.apache.catalina.realm.JAASRealm\' appName=\'SSO\' userClassNames=\'a.b.c\' roleClassNames=\'a.b.c\' useContextClassLoader=\'false\'/>\n        <!-- SingleSignOn valve, share authentication between web applications\n             Documentation at: /docs/config/valve.html -->\n        <Valve className=\'org.apache.catalina.authenticator.SingleSignOn\'/>\n        <!-- Access log processes all example.\n             Documentation at: /docs/config/valve.html -->\n        <!--\n        <Valve className=\'org.apache.catalina.valves.AccessLogValve\' directory=\'logs\'  \n               prefix=\'localhost_access_log.\' suffix=\'.txt\' pattern=\'common\' resolveHosts=\'false\'/>\n        -->\n\nI have added a jaas configuration for the SSO app in the jaas.conf file for the server.  I am certain that the realm, jaas.conf are all configured properly as the web applications do require a user to authenticate before accessing the application, but if I have authenticated to one application I still am required to authenticate before accessing the other application.\n\nI have this exact same configuration working on a tomcat 6 environment, but an identical configuration will not operate on a tomcat 7 server.', 'chornsey', '2010-07-29 10:43:35 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (202, '49721', 'Bug 49721 Fail to access the resources such as jsp files from a jar file which is supported by servlet 3.0', 'I put a jsp file in a jar file and test whether tomcat 7 supports it by viewing it from the browser and failed.', 'Wang Guangzhe', '2010-08-06 21:52:37 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (203, '49613', 'Bug 49613 Request.getAttributeNames() slows down some applications', '', 'Sampo Savolainen', '2010-07-19 06:23:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (204, '49567', 'Bug 49567 when starting a new thread from a startAsync Runnable, an infinite amount of doPosts is generated', 'Created  attachment 25728   [details] \ntestcase demonstrating the bug\n\nwhen starting a new thread from a startAsync Runnable, an infinite amount of doPosts is generated.\n\nAlso, the GET status is: 500 Internal Server Error,\nhowever, there is no exception thrown by tomcat.\n\nThe attached code demonstrates this, by printing \'Start async()\' an infinite amount of times.', 'Pieter Libin', '2010-07-07 09:22:22 UTC', 'tomcat_attachment/attachment 25728.txt');
INSERT INTO `tomcatbody` VALUES (205, '48998', 'Bug 48998 Proposal : port mod_expires in java as ExpiresFilter Servlet Filter', 'Created  attachment 25189   [details] \nPort of mod_expires as ExpiresFilter\n\nHere is a proposal to port Apache Httpd mod_expires in java as ExpiresFilter, a standard Servlet Filter.\n\nI detailed a standalone version on  http://code.google.com/p/xebia-france/wiki/ExpiresFilter  . More over, I tried my best to provide very detailed javadocs and docs (in filter.html).\n\nThe proposed contribution is slightly different because it uses Tomcat logging, few Servlet 3 enhancements and test cases use Tomcat engine.\n\nThe attached patch contains :\n* ExpiresFilter.java : the Expires Filter\n* TestExpiresFilter : detailed test cases\n* filter.xml : doc updates\n\nThe filter has been optimized using a profiler and stress tested with Apache Bench under high load.', 'Cyrille Le Clerc', '2010-03-26 16:38:18 UTC', 'tomcat_attachment/attachment 25189');
INSERT INTO `tomcatbody` VALUES (206, '48960', 'Bug 48960 SSI Servlet should support safe configuration', 'The current configuration of the SSI module is \'All\' or \'None\'. The \'ALL\' option will expose all the legacy Apache SSI directive (echo, printenv, if, exec, ...). As documented, allowing SSI will allow execution of arbitrary programs using the \'exec\'. As a result, there is no safe way to expose sites/projects containing SSI directive, without taking a security risk, or reviewing of every file.\n\nThe \'exec\' directive, with the cmd option is a major risk. Even for Apache, you have the option to allowing the \'safe\' include (includeNoExec). The includeNoExec allow pages to be served, even when the content is not reviewed, or when users are allowed to upload content to the site.\n\nI have a big site which need to be converted into JSP. I would like to use the SSI servlet to allow for transition over time. The extra risk from ( from exec cmd) make it impossible to deploy the SSI.\n\nMy request: Modify the configuration of SSI as follow: By default, it will only allow \'safe\' directive (no exec cmd=...). This will eliminate the risk from arbitrary execution of commands (\'del *.*\'). It will also remove many potentail load problems. The cmd= should only be allowed using a directive like \'allowUnsafeExec\', which will default to false.\n\nI think that the change will make it easier to use the SSI feature, without exposing the server to big risk. The risk associated with the \'safer\' version of SSI is similar to the risk from running JSP pages.', 'Yair Lenga', '2010-03-22 16:37:48 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (207, '49570', 'Bug 49570 The CompressionFilter example should support HTTP proxies to cache gzipped content better by sending Vary: Accept-Encoding header', 'At the moment the Compression Filter example doesn\'t send the header \'Vary: Accept-Encoding\' with the compressed content (see method writeToGZip(..) in  http://svn.apache.org/repos/asf/tomcat/trunk/webapps/examples/WEB-INF/classes/compressionFilters/CompressionResponseStream.java ). \n\nFrom many sources like\n\n1.  http://httpd.apache.org/docs/2.0/mod/mod_deflate.html#proxies \n2.  http://developer.yahoo.net/blog/archives/2007/07/high_performanc_3.html \n\nit looks like a \'Vary: Accept-Encoding\' header should be sent with the compressed content to make sure proxy servers can serve gzipped content correctly.\n\nTo enhance this example, the method writeToGzip(..) should be updated to send Vary: Accept-Encoding header like below:\n\npublic void writeToGZip(byte b[], int off, int len) throws IOException {\n...\n   response.addHeader(\'Content-Encoding\', \'gzip\');\n   response.addHeader(\'Vary\', \'Accept-Encoding\');\n   gzipstream = new GZIPOutputStream(output);\n...\n}', 'Thai Ha', '2010-07-08 02:11:36 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (208, '49550', 'Bug 49550 [PATCH] Response class fix isSpace (deprecated) => isWhiteSpace', 'Created  attachment 25703   [details] \nfix isSpace (deprecated) => isWhiteSpace\n\nAs the subject says', 'Sebb', '2010-07-05 07:23:31 UTC', 'tomcat_attachment/attachment 25703.txt');
INSERT INTO `tomcatbody` VALUES (209, '49525', 'Bug 49525 IE8: Unabled to store data in HttpSession (root context)', 'Environment:\n\nTomcat 7.0.0 Beta\nIE8\n\nA simplest webapp only have a test.jsp below:\n\n<%=request.getSession().getId()%>\n\nthis app installed as root context\n\nthe test.jsp works fine in firefox\n\nbut when using IE8\n\nthere is always a different session id where refresh the test page.\n\nBTW: the test.jsp works find in Tomcat 6.x', 'oschina.net', '2010-06-29 22:22:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (210, '49445', 'Bug 49445 After session ID is changed on authentication, the session replication does not work.', 'After  r889716 , \nsession ID is changed on authentication. \n(default of changeSessionIdOnAuthentication is true. )\nBut DeltaManager doesn\'t notify other cluster nodes. \n\nTherefore, non-primary node keeps having old session ID. \nAnd, can not replicate of change of session attribute notified by new session ID. \n\nThe workaround is ...\noverride changeSessionId method, and notify to change session ID.\n\nBackupManager is OK. \nThis problem is DeltaManager only.\n\nBest regards.', 'Keiichi Fujino', '2010-06-16 05:08:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (211, '48971', 'Bug 48971 memory leak protection : stopping TimeThreads should be optional and disabled by default', 'While investigating to write this wiki page  http://wiki.apache.org/tomcat/MemoryLeakProtection  , I realized that WebAppClassLoader.clearReferencesStopTimerThread() can have dangerous side effects.\n\nIndeed, if the TimerThread was spawned by some library deployed in the common (or even JRE) classpath, then stopping it can impact other webapps still running.\nIt would probably be a bug of that library to have such a thread with such a context classloader, but we have to be realistic, we cannot fix every third-party library (and the JRE).\n\nIn my opinion, tomcat should better play it safe in such a case, and should not attempt by default to stop TimerThreads : it\'s safer to have a leak for a stopped webapp than break running apps !\n\nWebAppClassLoader.clearReferencesStopTimerThread() should be conditioned with the existing boolean clearReferencesStopThreads.\n\nsee attached proposed patch.', 'Sylvain Laurent', '2010-03-23 22:56:08 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (212, '49224', 'Bug 49224 NullPointerException in PooledConnection when username or password are null', 'I\'m using jdbc-pool (version 1.0.8.5) to connect to a DataSource requiring no authentication.  Unless I explicitly set the username and password in the PoolProperties object to empty String (as opposed to leaving them null), a NullPointerException is thrown on lines 215 or 216 of PooledConnection.connectUsingDriver().', 'Matt Passell', '2010-04-29 11:15:49 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (213, '48689', 'Bug 48689 Jar abstraction for Jasper', 'Jasper can load TLD files through the ServletContext or from a Jar file. To load TLDs from Jar file, an URL to a Jar file must be passed. However, in some environments (e.g. in OSGi) it might not be easy to provide an URL to a jar file. It would be nice to abstract the way Jasper is looking up the embedded TLDs so that different ways of looking up TLDs within Jar files or Bundles or whatever could be used.', 'Jarek Gawor', '2010-02-05 12:30:40 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (214, '43642', 'Bug 43642 Add prestartminSpareThreads attribute for Executor', 'The attached patch adds the boolean attribute prestartminSpareThreads to the\nExecutor element. This allows the admin to prestart minspareThreads for this\nExecutor during the start of Tomcat. The default value is false which is the old\nbehaviour. A documentation patch for executor.xml can be created if there is\ninterest in committing this patch.', 'Ruediger Pluem', '2007-10-17 08:00:46 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (215, '49045', 'Bug 49045 JMX Enhancement- Provision of MBeanFactory createStandardService', 'Currently MBeanFactory doesn\'t have a method for creating a new StandardService MBean. This would become an issue for future enhancements of JMX support in Tomcat. As per discussions with Mark, this enhancement is suggested as a starting point for possible future enhancements in JMX support.', 'chamith buddhika', '2010-04-04 05:40:57 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (216, '49086', 'Bug 49086 Addition of Javadoc for Servlet 3.0 annotations', 'Created  attachment 25252   [details] \nJavadoc patch for WebServlet annotation\n\nAddition of Javadoc for Servlet 3.0 javax.servlet.annotation package.\nSeveral patches to follow.', 'Pid', '2010-04-11 16:43:49 UTC', 'tomcat_attachment/attachment 25252.txt');
INSERT INTO `tomcatbody` VALUES (217, '48717', 'Bug 48717 Session listeners not called on cluster node start', 'This appears to be a regression from an earlier  bug #35916  which describes the exact same problem, but somewhere along the way, it appears that the bug has come back.\n\nBasically, once Tomcat is put in to a cluster and a node joins the cluster, the webapp isn\'t notified via either HttpSessionActivationListener.didActivate or HttpSessionListener.sessionCreated.\n\nOtherwise, all nodes seem to receive these events as expected once in the cluster.\n\nThis is a problem for an application which needs to track all currently active sessions as it will not know of any existing sessions when joining a cluster.\n\nThis also appears to affect Tomcat 6.0.24 as well where the symptoms are the same.\n\nI actually posted to the users list almost a year ago (totally forgot I did that until I was searching the archives again), but didn\'t hear any response and worked around the issue temporarily, but it has come up again so I posted to the list again, but no response either time.\n\n http://www.mail-archive.com/users@tomcat.apache.org/msg58675.html \n http://www.mail-archive.com/users@tomcat.apache.org/msg73135.html ', 'David Rees', '2010-02-09 17:43:14 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (218, '48760', 'Bug 48760 Tomcat breaks in serving large files (>=1.8MB) under high load and high threading.', 'When serving a 1.8MB file, Tomcat 6.0.16->6.0.20 (all versions tested), will occasionally throw a BadFileNumber exception and only serve part of the file. The rate of occurrence is roughly a few times a day under high load, but we have stress tools which can reliably reproduce this issue, and multiple continuous wget connections can reproduce the issue, as well.\n\nWe are serving a large SWF application, although this may affect arbitrary binary data. To reproduce this issue, serve a large file (at least 1.8MB, in our case), and continuously request the file over a period of several hours to a few days; this issue happens intermittently, but it is reproducible.\n\nThis problem is especially critical to us, as we use apache as a cache in front of tomcat. For whatever reason, apache aggressively caches this bad data and never again requests the file, although this is probably another unrelated problem. In this configuration, however, after the file has gone bad, all users get served corrupt files, causing the application to break entirely. \n\nThis was reported in 2008 here, but the issue was dismissed:\n http://mail-archives.apache.org/mod_mbox/tomcat-dev/200808.mbox/%3Cbug-45601-78@https.issues.apache.org/bugzilla/%3E \n\nThe fix provided here works to resolve the issue, but our IT department cannot support a custom-rolled version of tomcat indefinitely. It\'s not a sustainable solution, and this issue should affect other users. We are not sure why the fix works, but it does resolve our completely reproducible scenario. Ideally, then, someone with more knowledge of tomcat could understand why this fix works and what, exactly, it\'s solving, and then integrate this into the main tomcat release line.\n\nHere is how the error appears in the logs:\nFeb 16, 2010 1:25:59 PM org.apache.catalina.core.StandardWrapperValve invoke\nSEVERE: Servlet.service() for servlet default threw exception\njava.io.IOException: Bad file number\n	at java.io.FileInputStream.readBytes(Native Method)\n	at java.io.FileInputStream.read(FileInputStream.java:199)\n	at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)\n	at java.io.BufferedInputStream.read(BufferedInputStream.java:317)\n	at java.io.FilterInputStream.read(FilterInputStream.java:90)\n	at org.apache.catalina.servlets.DefaultServlet.copyRange(DefaultServlet.java:1968)\n	at org.apache.catalina.servlets.DefaultServlet.copy(DefaultServlet.java:1714)\n	at org.apache.catalina.servlets.DefaultServlet.serveResource(DefaultServlet.java:809)\n	at org.apache.catalina.servlets.DefaultServlet.doGet(DefaultServlet.java:325)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:690)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:568)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n	at org.apache.catalina.ha.session.JvmRouteBinderValve.invoke(JvmRouteBinderValve.java:209)\n	at org.apache.catalina.ha.tcp.ReplicationValve.invoke(ReplicationValve.java:347)\n	at org.terracotta.modules.tomcat.tomcat_5_5.SessionValve55.invoke(SessionValve55.java:57)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)\n	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)\n	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n	at java.lang.Thread.run(Thread.java:619)', 'Stefan Kendall', '2010-02-17 20:44:37 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (219, '48737', 'Bug 48737 JspCompilationContext assumes that tagfile with a path starting with META-INF are in jars without checking', 'Created  attachment 24978   [details] \npatch to JspCompilationContext\n\nThis is a pretty special case, since tagfiles in META-INF are usually in jar files...\nbut when using a custom dircontext implementation (usually during development in order to load files from the filesystem without building a full jar) it may happen that the path given to jasper starts with META-INF also if the file is not in a jar. This is what happens using the Eclipse WTP tomcat loader, which loads classes from the workspaces and tld/tagfiles from directories inside your projects.\n\nTagfiles contained in META-INF directories worked properly till tomcat 6.0.17, but the final fix for  BUG 43741  broke it (I am still using 6.0.16 and not upgrading due to this problem).\n\nLooking at JspCompilationContext.getResource() the patch to solve this problem would be very simple and \'safe\': if the path starts with META-INF and a jar file containing the tld doesn\'t exist the resulting URL is simply null.\nAdding a check for the null jar and setting the URL to the \'standard\' path inside the context fixes the problem and everything starts working again (note that this doesn\'t break the previous fix and it can\'t cause any problem, since the result would have been null anyway).\n\n\nA patch against trunk (2010-02-13) is attached, the following code should easily displays what the patch does: \n\n        URL result = null;\n        if (res.startsWith(\'/META-INF/\')) {\n           // some lines to get the jar url\n           // ...\n           if (jarUrl != null) {\n               result = new URL(jarUrl.toExternalForm() + res.substring(1));\n           }\n+          else {\n+              // the path starts with /META-INF but the file is not in a jar\n+              result = context.getResource(canonicalURI(res));\n+          }\n        }', 'Fabrizio Giustina', '2010-02-13 18:19:03 UTC', 'tomcat_attachment/attachment 24978.txt');
INSERT INTO `tomcatbody` VALUES (220, '48582', 'Bug 48582 JspServletWrapper.getServletContext() throws NullPointerException', 'We\'re getting this exception/stack trace in a web application:\n\n\'\'[2010-01-15 17:52:01,381] -  ERROR [org.apache.catalina.core.ContainerBase] Exception invoking periodic operation:\n\'java.lang.NullPointerException\n        at org.apache.jasper.servlet.JspServletWrapper.getServletContext(JspServletWrapper.java:174)\n        at org.apache.jasper.compiler.JspRuntimeContext.checkCompile(JspRuntimeContext.java:304)\n        at org.apache.jasper.servlet.JspServlet.periodicEvent(JspServlet.java:289)\n        at org.apache.catalina.core.StandardWrapper.backgroundProcess(StandardWrapper.java:668)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1571)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1580)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1580)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1580)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1560)\n        at java.lang.Thread.run(Thread.java:595)\n\nLooking at JspServletWrapper, I see that it has 2 constructors; one for JSP pages, and another for tag files.  The one for tag files has a problem in this line:\n\n       this.config = null; // not used\n\nbecause this.config is indeed used by the public method getServletContext():\n\npublic ServletContext getServletContext() {\n  return config.getServletContext();\n}\n\nand since that method is public, you can\'t safely say that this.config will not be used. :)  So this means that if you create a JspServletWrapper for a JSP tag file, you can never call getServletContext() on it, or you\'ll generate the NPE above.  However, JspRuntimeContext does exactly that in the following block of code, from the checkCompile() method:\n\n        Object [] wrappers = jsps.values().toArray();\n        for (int i = 0; i < wrappers.length; i++ ) {\n            JspServletWrapper jsw = (JspServletWrapper)wrappers[i];\n            JspCompilationContext ctxt = jsw.getJspEngineContext();\n            // JspServletWrapper also synchronizes on this when\n            // it detects it has to do a reload\n            synchronized(jsw) {\n                try {\n                    ctxt.compile();\n                } catch (FileNotFoundException ex) {\n                    ctxt.incrementRemoved();\n                } catch (Throwable t) {\n                    jsw.getServletContext().log(\'Background compile failed\',\n            t);\n                }\n            }\n        }\n\nThe values in the \'jsps\' map are both JSP files and tag files, as seen by TagFileProcessor.loadTagFile(), which puts tag files there.\n\nSo to summarize, any JSP tag file that experiences a compilation failure inside of the checkCompile() method will seem to generate this NullPointerException.  \n\nA secondary issue here is that if any problem occurs inside of the catch block in the code pasted above (as is currently happening), the original exception is swallowed forever.  This is the Throw From Within Finally anti-pattern ( http://today.java.net/article/2006/04/04/exception-handling-antipatterns#throwFromWithinFinally ) and should be fixed as well.', 'Tim McCune', '2010-01-20 13:25:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (221, '48580', 'Bug 48580 6.0.24: AccessControlException in ProtectedFunctionMapper on first access to certain JSP', 'Steps to reproduce:\n1. Download and install 6.0.24 release candidate\n2. Run  catalina start -security\n3. Access   http://localhost:8080/examples/jsp/jsp2/el/implicit-objects.jsp?foo=bar \n4. Observe error page, with a stacktrace\n\njava.security.AccessControlException: access denied (java.lang.RuntimePermission accessClassInPackage.org.apache.jasper.security)\n  java.security.AccessControlContext.checkPermission(Unknown Source)\n  java.security.AccessController.checkPermission(Unknown Source)\n  java.lang.SecurityManager.checkPermission(Unknown Source)\n  java.lang.SecurityManager.checkPackageAccess(Unknown Source)\n  sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)\n  java.lang.ClassLoader.loadClass(Unknown Source)\n  java.lang.ClassLoader.loadClass(Unknown Source)\n  java.lang.ClassLoader.loadClassInternal(Unknown Source)\norg.apache.jasper.runtime.ProtectedFunctionMapper.getMapForFunction(ProtectedFunctionMapper.java:145)\n  org.apache.jsp.jsp.jsp2.el.implicit_002dobjects_jsp.<clinit>(implicit_002dobjects_jsp.java:13)\n...\n\nThis issues does not occur if the following JSP page is accessed before the one where it is observed:\n http://localhost:8080/examples/jsp/jsp2/el/basic-arithmetic.jsp \n\nOS: Windows XP, 32-bit,  JRE version:\njava version \'1.6.0_17\'\nJava(TM) SE Runtime Environment (build 1.6.0_17-b04)\nJava HotSpot(TM) Client VM (build 14.3-b01, mixed mode, sharing)', 'Konstantin Kolinko', '2010-01-20 11:54:45 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (222, '48498', 'Bug 48498 6.0.22RC: ArrayIndexOutOfBoundsException from Jasper when compilation error inside a CDATA block', 'Created  attachment 24808   [details] \n/webapps/examples/WEB-INF/tags/panel.tagx\n\nSteps to reproduce:\n1. Remove /WEB-INF/tags/panel.tag\nfrom the Tomcat Examples webapp and replace it with the attached XML Tag file, panel.tagx\n\n2. Visit the following page:\n http://localhost:8080/examples/jsp/jsp2/tagfiles/panel.jsp \n\n3. The page contains a scriptlet, with a CDATA block that produces\na compilatin error.\n\nExpected result:\nCompilation error being reported for line 39,\n  Integer.parseInt(10);\n\nActual result:\njava.lang.ArrayIndexOutOfBoundsException: 46\n	org.apache.jasper.compiler.JavacErrorDetail.<init>(JavacErrorDetail.java:111)\n\n4. If I add sufficient number of empty lines after the CDATA block,\nArrayIndexOutOfBoundsException disappears and I can see the compiler error,\nbut the error lines shown are wrong. The shown lines are below the actual\nlocation of the error.\nIt looks like this offset in line numbers is due to the size of the CDATA\nblock.\n\n\n\n\n\n\n====================================================================\nFull stacktrace of the above ArrayIndexOutOfBoundsException exception:\n\njava.lang.ArrayIndexOutOfBoundsException: 46\n	org.apache.jasper.compiler.JavacErrorDetail.<init>(JavacErrorDetail.java:111)\n	org.apache.jasper.compiler.ErrorDispatcher.createJavacError(ErrorDispatcher.java:533)\n	org.apache.jasper.compiler.JDTCompiler$2.acceptResult(JDTCompiler.java:377)\n	org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:398)\n	org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:429)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n	org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n	org.apache.jasper.servlet.JspServletWrapper.loadTagFile(JspServletWrapper.java:215)\n	org.apache.jasper.compiler.TagFileProcessor.loadTagFile(TagFileProcessor.java:625)\n	org.apache.jasper.compiler.TagFileProcessor.access$000(TagFileProcessor.java:52)\n	org.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:685)\n	org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n	org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n	org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n	org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2417)\n	org.apache.jasper.compiler.Node$Root.accept(Node.java:495)\n	org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n	org.apache.jasper.compiler.TagFileProcessor.loadTagFiles(TagFileProcessor.java:703)\n	org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:195)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:332)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n	org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n====================================================================', 'Konstantin Kolinko', '2010-01-06 19:40:54 UTC', 'tomcat_attachment/attachment 24808');
INSERT INTO `tomcatbody` VALUES (223, '48371', 'Bug 48371 addWebXmlMappings does not place servlet tags correctly', 'If there is a commented-out <security-constraint> or commented-out <servlet> tag and addWebXmlMappings=\'true\', the JSP\'s servlet and servlet-mapping tags are placed incorrectly and Tomcat will not start due to \'--\' being inside a comment.\n\nBasically, it seems the web.xml is not parsed correctly when using addWebXmlMappings and you cannot have above tags commented out, or new servlet tags will be placed incorrectly and comment tags not respected.', 'Lee Clemens', '2009-12-10 18:16:34 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (224, '48170', 'Bug 48170 Unnecessary synchronization by JspFactory.getDefaultFactory contributes to stability problems', 'I have a soak test at constant load that is initially stable.  Within the hour, an ever increasing number of blocked threads develops.  The vast majority of threads are in JSP rendering, blocked on JspFactory.getDefaultFactory().\n\nThe server eventually crashes.\n\nWe are running Java 6.\n\nUpon code inspection, there appears to be no real reason for synchronizing the getDefaultFactory() and setDefaultFactory() as the setter is called only once upon startup when the sub-class loads.\n\nPatching the jar, I tried three other experiments:\n1) Removing the synchronized keyword entirely.\n2) Locking on an inner static class instead of the JspFactory.class.\n3) Using volatile for the static member variable.\n\nBoth experiments #1 and #3 showed vastly better stability.  I was able to double the throughput of the server without seeing increasing number of blocked threads.\n\nExperiment #2 yielded the same behavior as the original code.  Thus, no other code\nis synchronizing on JspFactory.class.  Rather, there seem to be some sort of contention in the java.lang.Class monitor.\n\nUsing volatile would preserve the multi-threading semantics while avoiding contributing to the instability issue.', 'Earl Nolan', '2009-11-10 18:04:01 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (225, '48643', 'Bug 48643 catalina.session.FileStore.save() and load() - close() bugs', 'The code for the save() method reads:\n\ntry {\n    fos = new FileOutputStream(file.getAbsolutePath());\n    oos = new ObjectOutputStream(new BufferedOutputStream(fos));\n} catch (IOException e) {\n    if (oos != null) { <== oos can only be null here\n        try {\n            oos.close();\n        } catch (IOException f) {\n            // Ignore\n        }\n    }\n    throw e;\n}\n\nPresumably the catch statement should try to close fos instead?\n\nSimilarly for the load() method; at line 280/281 there is the code:\n\n        } catch (IOException e) {\n            if (ois != null) {\n\nHowever, ois is the last object created by the try clause, so must be null.\nProbably the code should check and close bis and/or fis.\n\nAt the end of the load() method, the code says:\n\n            // Close the input stream\n            if (ois != null) {\n\nHowever, ois cannot be null at that point.\n\nNote: these bugs were detected by the Eclipse compiler.', 'Sebb', '2010-01-30 16:53:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (226, '48516', 'Bug 48516 NullPointerException in JNDIRealm', 'Created  attachment 24824   [details] \nPatch to fix NPE\n\nThere is a NullPointerException being thrown when the server attempts to look up a non-existent user in JNDIRealm.\n\nSpecifically, the getUser(DirContext, String) method will return null if the user is not found.  However, getPrincipal(DirContext, String) will not check to see if the result from getUser() is null.\n\nI\'m attaching a patch from the 6.0.20 tag but this should also be backported to the 5.5.x branch as well because the issue exists there.', 'Kevin Conaway', '2010-01-11 05:42:00 UTC', 'tomcat_attachment/attachment 24824.txt');
INSERT INTO `tomcatbody` VALUES (227, '48004', 'Bug 48004 setHeader() does not replace the previous value for a \'Server\'', 'Hello,\nIn a servlet or in a filter (before passing the control to doFilter() or after) try the following\nHttpServletResponse myResponse = ...\nmyResponse.setHeader(\'Server\',\'My own server name because I do not want to expose the real server name to the public for security reasons\');\n...\n\nIn the headers of the response you will get\nServer	Apache-Coyote/1.1, My own server name...\n\nAccording to the J2EE API for HttpServletResponse.html.setHeader()\n http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/http/HttpServletResponse.html#setHeader(java.lang.String,%20java.lang.String )\n...\nSets a response header with the given name and value. If the header had already been set, the new value overwrites the previous one. The containsHeader method can be used to test for the presence of a header before setting its value.\n...\nIn fact if I call myResponse.containsHeader(\'Server\') I even get a false!!!\n\nIf you look in the IDE at the response object and dig in the responses and wrappers, you will find at the end a buffer with some data already set by Tomcat with this value and other things\n.\nAs I understand it Tomcat (or Coyote) does not let this header to be changed while nothing in the specification says that it is special.\nI did not find either a parameter in server.xml or other where the server name is specified to be overiden.\n\nSo the spec is not implemented properly for this specific header.\nSome other values are in this buffer, my goal was not to change them but other headers or values could have the same issue.\n\nThis issue is the same in Tomcat 5.5.28 and Tomcat 6.0.20. Not tested on 7.x.\n\nThanks \nOlivier', 'olivier dupuy', '2009-10-15 11:16:16 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (228, '48006', 'Bug 48006 Implement the header X-Powered-By suggested by the servlet specification', 'Hello,\n\nThe servlet 2.5 specification at \n http://jcp.org/aboutJava/communityprocess/mrel/jsr154/index2.html \nsuggests in section \'SRV.5.2 Headers\'\n\n...\nIt is recommended that containers use the X-Powered-By HTTP header to\npublish its implementation information. The field value should consist of one or\nmore implementation types, such as \'Servlet/2.4\'. Optionally, the\nsupplementary information of the container and the underlying Java platform can\nbe added after the implementation type within parentheses. The container should\nbe configurable to suppress this header.\nHere’s the examples of this header.\nX-Powered-By: Servlet/2.4\nX-Powered-By: Servlet/2.4 JSP/2.0 (Tomcat/5.0 JRE/1.4.1)\n...\n\nThis behavior is not implemented in Tomcat 6.0.20.\nTo make it totally clear, may I suggest to return the precise Tomcat and JVM version with all the digits and the vendor such as Tomcat/5.5.28 JRE/SUN/1.5.0_12-b04)\n\nHaving this headers helps a lot the development team to determine what is really running his application in test or production w/o asking to the maintenance guy who is either often unreachable or not able to answer (YES).\n\nProvide the option to remove the header through the configuration (file) or through programming (see related bugs 48004 and 48005).\n\nThe servlet 3.0 specification at\n http://jcp.org/aboutJava/communityprocess/pfd/jsr315/index.html \nin the same section \'SRV.5.2 Headers\' says the same but I did not test for it in Tomcat 7.\n\nThanks\n\nOlivier', 'olivier dupuy', '2009-10-15 11:34:52 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (229, '43819', 'Bug 43819 Support latest JSR245 proposal to make EL \'self-contained\'', 'Please add the two static methods ExpressionFactory.newInstance(..) as described\nin  http://jcp.org/aboutJava/communityprocess/maintenance/jsr245/245-MR1.html .\nThese changes make the EL \'self-contained\' and allow to plug-in third party EL\nimplementations like JUEL ( http://juel.sf.net ).', 'Christoph Beck', '2007-11-08 14:48:53 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (230, '47744', 'Bug 47744 Memory leak when using SSL + Java security manager', 'Created  attachment 24170   [details] \nThe zip described in the main bug. Contains test client, JSP for the server, and patch.\n\nWhen using SSL + the java security manager, Tomcat leaks memory when servlets\naccess cert path/cipher as request properties.  When the servlet/JSP asks for\nthese properties and they are not in the request, they are loaded via the\nJSSESupport class.\n\nThe offending method calculates the key size and attempts to cache this in the\nSSLSession.  Without the security manager, this is fine.  When the security\nmanager runs, however, the AccessControlContext is different every time. \nRetrieving from the cache will always return null, and putting into the\nSSLSession\'s cache leaks memory.  This part is probably a JVM bug and not\nTomcat\'s fault, but Tomcat is exercising it nonetheless.\n\nPopular web service tools (such as Apache CXF) retrieve cert properties from\nthe request for every invocation.  Depending on the policy file, the leak may\nbe relatively slow, requiring 100s of thousands or millions of requests; or it\ncould be fast (in our case), requiring only ~40k to crash an instance of Tomcat\nlimited to 1 gig of memory.\n\nA note here.  The SSLSession can be collected once it is not in use, so the\nmemory leak isn\'t permanent.  If you turn down the SSLSession timeout and wait\nat least that amount of time in between using a specific session, you might\nnever see this bug.  You have to continuously use the same session *and* trip\nJSSESession into attempting to get the keysize.  In our particular case, we\nhave long-connected clients that stream information to us, so it is only taking\nis 10-20 minutes before we are being affected negatively by this.\n\nI have attached a zip containing:\n- A test client\n- A script (.bat, sorry guys, but easily adapted) to run the test client\n- A .jsp that trips the JSSESupport to call the affected method.\n- The simplest possible policy file, to demonstrate it\'s not a policy file\nissue.\nAlso attached: a patch that fixes this issue. (It\'s in the zip for good\nmeasure.)\n\nI recommend setting the invocation count to at least 100,000 or so on the test\nclient.  Use jconsole or a similar tool attached to tomcat to monitor the\nmemory use.  You should notice that after the test, a large chunk of memory is\nnot able to be returned by the garbage collector.  If you apply the patch,\nupdate tomcat-coyote.jar, and re-run the load test, you will notice that memory\nconsumption stays low and you can immediately return to the baseline.', 'Greg Vanore', '2009-08-26 11:01:57 UTC', 'tomcat_attachment/attachment 24170.zip');
INSERT INTO `tomcatbody` VALUES (231, '47502', 'Bug 47502 clustering fails on serializing javax.security.auth.subject', 'Clustering fails on serializing javax.security.auth.subject. See stack below.\n\nI looked a little into the Tomcat code. In ./java/org/apache/catalina/connector/Request.java on line 1752 Tomcat puts the \'javax.security.auth.subject\' on the session if you use a securitymanager. This is the MemoryUser in my case I think.\n\nI must use the securitymanager because I use RMI.\n\nIs there a solution possible by making the MemoryUser serializable or by not putting it in the session as an attribute. Mark Thomas <markt_at_apache_dot_org> suggested a note on the session at the Tomcat user-mailinglist. I\'ve never seen notes on sessions.\n\nThe MemoryUser comes from the security-constraint in my web.xml.\n\n\nJul 8, 2009 5:53:52 PM org.apache.catalina.ha.session.DeltaSession writeObject\nSEVERE: Cannot serialize session attribute javax.security.auth.subject for session 9C533E0EB4A79ED5B206B8F5A5DB09AD\njava.io.NotSerializableException: org.apache.catalina.users.MemoryUser\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1156)\n    at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:326)\n    at java.util.LinkedList.writeObject(LinkedList.java:943)\n    at sun.reflect.GeneratedMethodAccessor216.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1461)\n    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n    at java.io.ObjectOutputStream.access$300(ObjectOutputStream.java:143)\n    at java.io.ObjectOutputStream$PutFieldImpl.writeFields(ObjectOutputStream.java:1668)\n    at java.io.ObjectOutputStream.writeFields(ObjectOutputStream.java:454)\n    at javax.security.auth.Subject$SecureSet.writeObject(Subject.java:1281)\n    at sun.reflect.GeneratedMethodAccessor215.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1461)\n    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n    at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1509)\n    at java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:416)\n    at java.util.Collections$SynchronizedCollection.writeObject(Collections.java:1602)\n    at sun.reflect.GeneratedMethodAccessor214.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1461)\n    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n    at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1509)\n    at java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:416)\n    at javax.security.auth.Subject.writeObject(Subject.java:919)\n    at sun.reflect.GeneratedMethodAccessor213.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1461)\n    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n    at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:326)\n    at org.apache.catalina.ha.session.DeltaSession.writeObject(DeltaSession.java:714)\n    at org.apache.catalina.ha.session.DeltaSession.writeObjectData(DeltaSession.java:475)\n    at org.apache.catalina.ha.session.DeltaSession.writeObjectData(DeltaSession.java:472)\n    at org.apache.catalina.ha.session.DeltaManager.serializeSessions(DeltaManager.java:733)\n    at org.apache.catalina.ha.session.DeltaManager.sendSessions(DeltaManager.java:1513)\n    at org.apache.catalina.ha.session.DeltaManager.handleGET_ALL_SESSIONS(DeltaManager.java:1479)\n    at org.apache.catalina.ha.session.DeltaManager.messageReceived(DeltaManager.java:1310)\n    at org.apache.catalina.ha.session.DeltaManager.messageDataReceived(DeltaManager.java:1093)\n    at org.apache.catalina.ha.session.ClusterSessionListener.messageReceived(ClusterSessionListener.java:87)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.messageReceived(SimpleTcpCluster.java:901)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.messageReceived(SimpleTcpCluster.java:882)\n    at org.apache.catalina.tribes.group.GroupChannel.messageReceived(GroupChannel.java:269)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\n    at org.apache.catalina.tribes.group.interceptors.TcpFailureDetector.messageReceived(TcpFailureDetector.java:110)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\n    at org.apache.catalina.tribes.group.ChannelCoordinator.messageReceived(ChannelCoordinator.java:241)\n    at org.apache.catalina.tribes.transport.ReceiverBase.messageDataReceived(ReceiverBase.java:225)\n    at org.apache.catalina.tribes.transport.nio.NioReplicationTask.drainChannel(NioReplicationTask.java:188)\n    at org.apache.catalina.tribes.transport.nio.NioReplicationTask.run(NioReplicationTask.java:91)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:619)', 'Ronald Klop', '2009-07-09 05:57:29 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (232, '47342', 'Bug 47342 ReplicatedContext#start throws NullPointerException.', 'ReplicatedContext#start throws NullPointerException.\n\ncontext.xml is as follows.\n<Context className=\'org.apache.catalina.ha.context.ReplicatedContext\' />\n\nWhen Tomcat is started, the following logs are output. \n\nJun 10, 2009 6:40:57 PM org.apache.catalina.ha.context.ReplicatedContext start\nSEVERE: Unable to start ReplicatedContext\njava.lang.NullPointerException\n    at java.io.File.<init>(Unknown Source)\n    at org.apache.catalina.core.StandardContext.getBasePath(StandardContext.java:4840)\n    at org.apache.catalina.ha.context.ReplicatedContext.start(ReplicatedContext.java:63)\n    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)\n    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)\n    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:526)\n    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:630)\n    at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:556)\n    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:491)\n    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1206)\n    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:314)\n    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)\n    at org.apache.catalina.core.StandardHost.start(StandardHost.java:722)\n    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)\n    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)\n    at org.apache.catalina.core.StandardService.start(StandardService.java:516)\n    at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n    at org.apache.catalina.startup.Catalina.start(Catalina.java:583)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\n\n\nThis causes because docBase has not been initialized. \nI think that this solution for the problem is an addition of initialization to ReplicatedContext#start. \n\nI made a patch.\n\nIndex: java/org/apache/catalina/ha/context/ReplicatedContext.java\n===================================================================\n--- java/org/apache/catalina/ha/context/ReplicatedContext.java    ( revision 763870 )\n+++ java/org/apache/catalina/ha/context/ReplicatedContext.java    (working copy)\n@@ -51,6 +51,13 @@\n     @Override\n     public synchronized void start() throws LifecycleException {\n         if ( this.started ) return;\n+        if( !initialized ) { \n+            try {\n+                init();\n+            } catch( Exception ex ) {\n+                throw new LifecycleException(\'Error initializaing \', ex);\n+            }\n+        }\n         super.addLifecycleListener(this);            \n         try {\n             CatalinaCluster catclust = (CatalinaCluster)this.getCluster();\n\n\n\nRegards.', 'Keiichi Fujino', '2009-06-10 02:48:24 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (233, '48267', 'Bug 48267 Patch to fix generics in javax packages', 'Created  attachment 24597   [details] \nPatch to fix generics in javax packages\n\nPatch to fix generics in javax packages', 'Sebb', '2009-11-23 13:22:35 UTC', 'tomcat_attachment/attachment 24597.txt');
INSERT INTO `tomcatbody` VALUES (234, '47799', 'Bug 47799 Domain does not work in Membership and DomainFilterInterceptor.', 'I used domain =\'{1,2,3,4}\' as follows by the Cluster configuration. \n<Cluster className=\'org.apache.catalina.ha.tcp.SimpleTcpCluster\'\n    channelSendOptions=\'6\'>\n...\n<Membership className=\'org.apache.catalina.tribes.membership.McastService\'\n    address=\'228.0.0.4\' port=\'45564\' frequency=\'500\' dropTime=\'3000\'\n    domain=\'{1,2,3,4}\'/>\n...\n<Interceptor className=\'org.apache.catalina.tribes.group.interceptors.DomainFilterInterceptor\' \n    domain=\'{1,2,3,4}\'/>\n...\n</Cluster>\n\nHowever, domain does not work in Membership and DomainFilterInterceptor.\n\nThe type of instance variable domain of org.apache.catalina.tribes.membership.McastService\nand org.apache.catalina.tribes.group.interceptors.DomainFilterInterceptor is byte array.\n\norg.apache.tomcat.util.IntrospectionUtils#setProperty is invoked \nin org.apache.tomcat.util.digester.SetPropertyRule#begin. \nHowever, \n\nBecause byte array property is not supported in org.apache.tomcat.util.IntrospectionUtils#setProperty, \nMcastService#setDomain(byte array) and DomainFilterInterceptor#setDomain(byte array) is never invoked. \n\nAs a result, domain can not set, and domain is always null.\n\nThere are two workarounds as follows.\n1:org.apache.tomcat.util.IntrospectionUtils#setProperty supports byte array property.\n\n2:Prepares setDomain(String) method for McastService and DomainFilterInterceptor.\n  Invoke setDomain(byte array) from setDomain(String).\n  This is the same way as org.apache.catalina.tribes.membership.StaticMember. \n\nI think that it is easy to prepare setDomain(String) method.\nI made the patch. \n\nMcastService\'s patch against tomcat_trunk.\n[start.]\nIndex: java/org/apache/catalina/tribes/membership/McastService.java\n===================================================================\n--- java/org/apache/catalina/tribes/membership/McastService.java	( revision 787304 )\n+++ java/org/apache/catalina/tribes/membership/McastService.java	(working copy)\n@@ -30,6 +30,7 @@\n import org.apache.catalina.tribes.MessageListener;\n import org.apache.catalina.tribes.io.ChannelData;\n import org.apache.catalina.tribes.io.XByteBuffer;\n+import org.apache.catalina.tribes.util.Arrays;\n import org.apache.catalina.tribes.util.StringManager;\n import org.apache.catalina.tribes.util.UUIDGenerator;\n \n@@ -607,6 +608,12 @@\n         }\n     }\n \n+    public void setDomain(String domain) {\n+        if ( domain == null ) return;\n+        if ( domain.startsWith(\'{\') ) setDomain(Arrays.fromString(domain));\n+        else setDomain(Arrays.convert(domain));\n+    }\n+\n     /**\n      * Simple test program\n      * @param args Command-line arguments\n\n[end.]\n\nDomainFilterInterceptor\'s patch against tomcat_trunk.\n[start.]\nIndex: java/org/apache/catalina/tribes/group/interceptors/DomainFilterInterceptor.java\n===================================================================\n--- java/org/apache/catalina/tribes/group/interceptors/DomainFilterInterceptor.java	( revision 763870 )\n+++ java/org/apache/catalina/tribes/group/interceptors/DomainFilterInterceptor.java	(working copy)\n@@ -97,4 +97,13 @@\n     public void setDomain(byte[] domain) {\n         this.domain = domain;\n     }\n+\n+    public void setDomain(String domain) {\n+        if ( domain == null ) return;\n+        if (domain.startsWith(\'{\'))\n+            setDomain(org.apache.catalina.tribes.util.Arrays.fromString(domain));\n+	    else\n+            setDomain(org.apache.catalina.tribes.util.Arrays.convert(domain));\n+    }\n+\n }\n\n[end.]\n\n\nBest regards.', 'Keiichi Fujino', '2009-09-08 02:39:42 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (235, '47462', 'Bug 47462 The annotation doesn\'t become effective.(metadata-complete=\'false\' is not effective.)', 'Even if \'false\' is set to metadata-complete, \nthe annotation doesn\'t become effective. \n\nTo invalidate the annotation by all the Web applications of Tomcat, \nmetadata-complete of conf/web.xml is set to \'true\'. \n\n[conf/web.xml]\n<web-app xmlns=\' http://java.sun.com/xml/ns/javaee \'\n    xmlns:xsi=\' http://www.w3.org/2001/XMLSchema-instance \'\n    xsi:schemaLocation=\' http://java.sun.com/xml/ns/javaee   http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd \'\n    version=\'2.5\'\n    metadata-complete=\'true\'\n    >\n.....\n</web-app>\n\nTo make the annotation of Web application (testWebApp) effective, \nmetadata-complete of webapps/testWebApp/WEB-INF/web.xml is set to \'false\'.\n\n[webapps/testWebApp/WEB-INF/web.xml]\n<web-app xmlns=\' http://java.sun.com/xml/ns/javaee \'\n   xmlns:xsi=\' http://www.w3.org/2001/XMLSchema-instance \'\n   xsi:schemaLocation=\' http://java.sun.com/xml/ns/javaee   http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd \'\n   version=\'2.5\'\n   metadata-complete=\'false\'> \n....\n</web-app>\n\nHowever, testWebApp doesn\'t make the annotation effective. \n\nBecause WebRuleSet#IgnoreAnnotationsRule#begin is as follows. \nWhen metadata-complete is \'false\', context.setIgnoreAnnotations(false) is not invoked. \n[WebRuleSet#IgnoreAnnotationsRule#begin]\nfinal class IgnoreAnnotationsRule extends Rule {\n\n    public IgnoreAnnotationsRule() {\n    }\n\n    public void begin(String namespace, String name, Attributes attributes)\n        throws Exception {\n        Context context = (Context) digester.peek(digester.getCount() - 1);\n        String value = attributes.getValue(\'metadata-complete\');\n        if (\'true\'.equals(value)) {\n            context.setIgnoreAnnotations(true);\n        }\n        if (digester.getLogger().isDebugEnabled()) {\n            digester.getLogger().debug\n                (context.getClass().getName() + \'.setIgnoreAnnotations( \' +\n                    context.getIgnoreAnnotations() + \')\');\n        }\n    }\n\n}\n\nI think that the following patches are necessary. \n\nIndex: java/org/apache/catalina/startup/WebRuleSet.java\n===================================================================\n--- java/org/apache/catalina/startup/WebRuleSet.java	( revision 763870 )\n+++ java/org/apache/catalina/startup/WebRuleSet.java	(working copy)\n@@ -848,6 +848,8 @@\n         String value = attributes.getValue(\'metadata-complete\');\n         if (\'true\'.equals(value)) {\n             context.setIgnoreAnnotations(true);\n+        } else if (\'false\'.equals(value)) {\n+            context.setIgnoreAnnotations(false);\n         }\n         if (digester.getLogger().isDebugEnabled()) {\n             digester.getLogger().debug\n\n\nBest regards.', 'Keiichi Fujino', '2009-07-01 02:51:39 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (236, '47997', 'Bug 47997 NamingContextListener fails to add itself as a PropertyChangeListener to all namingResources', 'Created  attachment 24378   [details] \nproposed fix\n\nIn the NamingContextListener.lifecycleEvent(LifecycleEvent) method, the\nNamingContextListener object fails to add itself as a PropertyChangeListener to\nnamingResources whose context is not a Server, e.g. a Context instance.  This\nprevents the NamingResourcesMBean from working with non-Server contexts.', 'Michael Allman', '2009-10-14 17:45:53 UTC', 'tomcat_attachment/attachment 24378.txt');
INSERT INTO `tomcatbody` VALUES (237, '47718', 'Bug 47718 ManagerBase leaks fd to /dev/urandom when context stopped', 'On operating systems where /dev/urandom exists, org.apache.catalina.session.ManagerBase will use it as a source of data for getRandomBytes().\n\nIf you stop a context or undeploy a host, the number of file descriptors that have /dev/urandom open tomcat remains constant.\n\nFor example, if you use the manager application to stop or undeploy a context, the number of file descriptors to /dev/urandom is the same as before the stop.\n\nFile descriptor use is determined by using lsof or examining the /proc/<pid>/fd directory on Linux.\n\nThe same issue is seen if you undeploy a virtual host.\n\nIf you undeploy/deploy a context, or remove/add a virtual host, the # of file descriptors to /dev/urandom will increase each time.\n\nThis is because ManagerBase does not close the DataInputStream it holds to /dev/urandom.\n\nThe patch shown below resolves this issue. Stopping a context, or undeploying a virtual host will close the session manager\'s reference to /dev/urandom.\n\n--- apache-tomcat-5.5.28-src/container/catalina/src/share/org/apache/catalina/session/ManagerBase.java	2009-07-24 13:35:00.000000000 -0600\n+++ apache-tomcat-5.5.28-gls/container/catalina/src/share/org/apache/catalina/session/ManagerBase.java	2009-08-20 13:38:03.000000000 -0600\n@@ -688,10 +688,17 @@\n     }\n\n    public void destroy() {\n         if( oname != null )\n             Registry.getRegistry(null, null).unregisterComponent(oname);\n+        if (randomIS!=null) {\n+            try {\n+                randomIS.close();\n+            } catch (IOException ioe) {\n+            }\n+            randomIS=null;\n+        }\n         initialized=false;\n         oname = null;\n         // Don\'t clear log since it is required in case attributes are changed\n         // (eg via JMX) whilst the manager is stopped.\n     }', 'George Sexton', '2009-08-20 14:48:26 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (238, '48172', 'Bug 48172 JspRuntimeContext synch. problems.', 'JspRuntimeContext.jspReloadCount is synchronised when updated, but not when read by getJspReloadCount().\n\nIf the instance is accessed from multiple threads, then the returned value may not be the current value, it could be arbitrarily stale.\n\nIf this is acceptable, then the Javadoc should say so; otherwise the getter needs to be synch. (or the field needs to be volatile) Or just use AtomicInteger.\n\n==\n\nVarious other fields are neither final nor synchronized, e.g.\n\nclasspath\ncodeSource\netc.\n\nAs far as I can tell, these could easily be made final as they are only written by the constructor.', 'Sebb', '2009-11-11 03:23:50 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (239, '47881', 'Bug 47881 org.apache.catalina.startup.Bootstrap\'s main method handles \'startd\' or \'stopd\' wrongly', 'String command = \'start\';\nif (args.length > 0) {\n    command = args[args.length - 1];\n}\n\nif (command.equals(\'startd\')) {\n    args[0] = \'start\';\n    daemon.load(args);\n    daemon.start();\n} else if (command.equals(\'stopd\')) {\n    args[0] = \'stop\';\n    daemon.stop();\n} \n... ...\n\n\nshould be: \n\nString command = \'start\';\nif (args.length > 0) {\n    command = args[args.length - 1];\n}\nif (command.equals(\'startd\')) {\n    args[args.length - 1] = \'start\';\n    daemon.load(args);\n    daemon.start();\n} else if (command.equals(\'stopd\')) {\n    args[args.length - 1] = \'stop\';\n    daemon.stop();\n} \n... ...\n\nPlease refer to the following usage method of  org.apache.catalina.startup.Catalina:\nprotected void usage() {\n\n        System.out.println\n            (\'usage: java org.apache.catalina.startup.Catalina\'\n             + \' [ -config {pathname} ]\'\n             + \' [ -nonaming ] { start | stop }\');\n\n    }', 'qingyang.xu', '2009-09-20 19:14:04 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (240, '47451', 'Bug 47451 NPE if response contains null content-encoding header', 'I\'ve been getting a NullPointerException when using the JnlpDownloadServlet\nfrom JDK 1.6.0_14 with Tomcat 6.0.20:\n\nJun 29, 2009 3:35:03 PM org.apache.coyote.http11.Http11Processor process\nSEVERE: Error finishing response\njava.lang.NullPointerException\n	at org.apache.tomcat.util.buf.MessageBytes.indexOf(MessageBytes.java:479)\n	at org.apache.tomcat.util.buf.MessageBytes.indexOf(MessageBytes.java:485)\n	at org.apache.coyote.http11.Http11Processor.isCompressable(Http11Processor.java:1441)\n	at org.apache.coyote.http11.Http11Processor.prepareResponse(Http11Processor.java:1517)\n	at org.apache.coyote.http11.Http11Processor.action(Http11Processor.java:944)\n	at org.apache.coyote.Response.action(Response.java:181)\n	at org.apache.coyote.http11.InternalOutputBuffer.endRequest(InternalOutputBuffer.java:379)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:889)\n	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)\n	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454)\n	at java.lang.Thread.run(Thread.java:619)\n\nA brief analysis of the JnlpDownloadServlet code shows that the content-encoding\nheader on the response is being set to null in DownloadResponse$FileDownloadResponse.\n\nThe Tomcat code tries to guard against a null header in Http11Process.isCompressable:\n        if ((contentEncodingMB != null)\n            && (contentEncodingMB.indexOf(\'gzip\') != -1))\n            return false;\n\nHowever, it appears that it\'s possible for contentEncodingMB, which is an\ninstance of MessageBytes, to be non-null, while the value encapsulated by\nthe MessageBytes IS null, resulting in an NPE in MessageBytes.indexOf().\n\nSince this occurs with the JnlpDownloadServlet provided by Sun (see  http://java.sun.com/j2se/1.5.0/docs/guide/javaws/developersguide/downloadservletguide.html ), I imagine more people might be running into this problem.', 'Dan Rabe', '2009-06-29 14:53:48 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (241, '40001', 'Bug 40001 HTML pages should not use GET to restart web-apps.', ' ', 'Michiel Meeuwissen', '2006-07-10 14:32:20 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (242, '47499', 'Bug 47499 provide better insight on BindException: Cannot assign requested address', '1) cite the address you attempt to listen (not just the port)\n2) proper exception chaining\n\nthe following info is currently lost: <<java.net.BindException: Cannot assign requested address\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:359)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at javax.net.ssl.SSLServerSocket.<init>(SSLServerSocket.java:106)\n	at com.privasphere.net.ssl.SSLServerSocketImpl.<init>(SSLServerSocketImpl.java:106)\n	at com.privasphere.net.ssl.SSLServerSocketFactoryImpl.createServerSocket(SSLServerSocketFactoryImpl.java:71)\n	at org.apache.tomcat.util.net.jsse.JSSESocketFactory.createSocket(JSSESocketFactory.java:100)\n	at org.apache.tomcat.util.net.PoolTcpEndpoint.initEndpoint(PoolTcpEndpoint.java:295)\n	at org.apache.coyote.http11.Http11BaseProtocol.init(Http11BaseProtocol.java:139)\n	at org.apache.catalina.connector.Connector.initialize(Connector.java:1017)\n	at org.apache.catalina.core.StandardService.initialize(StandardService.java:578)>>', 'Ralf Hauser', '2009-07-08 22:05:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (243, '47866', 'Bug 47866 NullPointerException in embedded tomcat', 'It seems that the WebappClassLoader was stopped?\n\n{noformat}\nCaused by: java.lang.NullPointerException\n	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:994)\n	at java.lang.ClassLoader.getResources(ClassLoader.java:1016)\n{noformat}\n\nAll I did was launch a server add a context and then ask it to load a resource from its classpath.  It\'s a bit more complicated than that, so I\'ll try and narrow it down if needed.', 'Dave Syer', '2009-09-18 00:23:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (244, '47161', 'Bug 47161 Manager ignores executors on status pages', 'When displaying the thread pools, the StatusManagerServlet ignores executors and uses the \'standard\' ThreadPool information for each connector. This causes incorrect information to be displayed when a connector is configured to use an executor.\n\nOn a related topic, it appears that the connector<->executor link is not exposed via JMX (which it will need to be to fix this).', 'Mark Thomas', '2009-05-06 07:20:31 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (245, '46950', 'Bug 46950 SSL renegotiation does not occur when resource with CLIENT-CERT auth is requested', 'When a part of a webapp requires an SSL connection with a client certificate there should be an SSL renegotiation to request a client certificate from the browser.\n\nThis is the configuration I added to an webapp that already uses an SSL connector:\n\n<login-config id=\'LoginConfig_1\'>\n                <auth-method>CLIENT-CERT</auth-method>\n                <realm-name>WPS</realm-name>\n</login-config>\n\n<security-constraint id=\'SecurityConstraint_1\'>\n                <web-resource-collection id=\'WebResourceCollection_1\'>\n                        <web-resource-name/>   \n                        <url-pattern>/LoginWithCert.do</url-pattern>\n                        <http-method>DELETE</http-method>\n                        <http-method>GET</http-method>\n                        <http-method>POST</http-method>\n                        <http-method>PUT</http-method>\n                        <http-method>HEAD</http-method>\n                </web-resource-collection>\n                <user-data-constraint id=\'UserDataConstraint_4\'>\n                        <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n                </user-data-constraint>\n</security-constraint>\n\nRequests to /LoginWithCert.do require an SSL connection, if there isn\'t one, but no client certificate is requested.', 'Andre Cruz', '2009-04-01 06:33:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (246, '47378', 'Bug 47378 welcome-file ignores servlet mapping', 'Web applications that use a servlet mapping for their welcome-file are ignored\nand the server returns either a directory listing or a 404 if the listing is\ndisabled.\nI have JSF servlet defined and a servlet-mapping for *.jsf to go to the\nFacesServlet.\nI have \'index.jsf\' listed as by welcome-file and I get a 404 with directory\nlisting disabled.\nI also have a custom servlet defined with its mapping and set the welcome-file\nto its mapping and get a 404 as well.', 'Bobby Lawrence', '2009-06-16 12:52:31 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (247, '41824', 'Bug 41824 Unable to use nested type in TLD', 'I wish to pass instances of a nested type to a JSP tag. My nested type is \nedu.ucsf.library.ltdl2.history.SearchHistory.Item (static inner class).\nI wrote my TLD like so:\n\n<tag>		\n ...\n <attribute>\n  <name>historyItem</name>\n  <required>no</required>\n  <rtexprvalue>true</rtexprvalue>\n  <type>edu.ucsf.library.ltdl2.history.SearchHistory.Item</type>\n </attribute>\n</tag>\n\nTomcat (Jasper) 5.5.20 then fails with:\n\norg.apache.jasper.JasperException: /WEB-INF/jsp/history/view.jsp(88,14) Unknown \nattribute type (edu.ucsf.library.ltdl2.history.SearchHistory.Item) for \nattribute historyItem.\n	at org.apache.jasper.compiler.DefaultErrorHandler.jspError\n(DefaultErrorHandler.java:39)\n	at org.apache.jasper.compiler.ErrorDispatcher.dispatch\n(ErrorDispatcher.java:405)\n	at org.apache.jasper.compiler.ErrorDispatcher.jspError\n(ErrorDispatcher.java:234)\n	at \norg.apache.jasper.compiler.Validator$ValidateVisitor.checkXmlAttributes\n(Validator.java:946)\n	at org.apache.jasper.compiler.Validator$ValidateVisitor.visit\n(Validator.java:710)\n	at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Validator$ValidateVisitor.visit\n(Validator.java:730)\n	at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2219)\n	at org.apache.jasper.compiler.Node$Root.accept(Node.java:456)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Validator.validate(Validator.java:1489)\n	at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:166)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:295)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:276)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:264)\n	at org.apache.jasper.JspCompilationContext.compile\n(JspCompilationContext.java:563)\n	at org.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:305)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:314)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\n\nIf I use the name \'edu.ucsf.library.ltdl2.history.SearchHistory$Item\' instead, \nI get: \n\norg.apache.jasper.JasperException: Unable to compile class for JSP\n\nAn error occurred at line: 88 in the jsp file: /WEB-INF/jsp/history/view.jsp\nGenerated servlet error:\nThe nested type edu.ucsf.library.ltdl2.history.SearchHistory$Item cannot be \nreferenced using its binary name\n\nAn error occurred at line: 88 in the jsp file: /WEB-INF/jsp/history/view.jsp\nGenerated servlet error:\nThe nested type edu.ucsf.library.ltdl2.history.SearchHistory$Item cannot be \nreferenced using its binary name\n\n	at org.apache.jasper.compiler.DefaultErrorHandler.javacError\n(DefaultErrorHandler.java:84)\n	at org.apache.jasper.compiler.ErrorDispatcher.javacError\n(ErrorDispatcher.java:328)\n	at org.apache.jasper.compiler.JDTCompiler.generateClass\n(JDTCompiler.java:414)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:297)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:276)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:264)\n	at org.apache.jasper.JspCompilationContext.compile\n(JspCompilationContext.java:563)\n	at org.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:305)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:314)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\n\nThis appears to be related to  bug 35351 , where the nested type is used in \n<jsp:useBean> constructs. Thanks for your help.', 'Renaud Waldura', '2007-03-12 10:40:25 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (248, '46907', 'Bug 46907 Jasper with log4j in web-app classpath and debug level enabled prevents reading HTTP POST stream from JSP', 'This is on Tomcat 5.5.x (don\'t remember the last rev. number, not my current machine).\n\nWhen log4j is in the classpath of the web-app and is configured to log at debug level, Jasper dumps the whole HTTP POST request body as debug traces. This consumes the HttpServletRequest input stream which then arrives unusable for the user at the beginning of the JSP code (using  HttpServletRequest.getInputStream(), the stream is already at its end).\nA workaround is to disable debug traces for Japser class in log4j.properties, but Jasper should not consume the HttpServletRequest input stream whatever mode it runs into.', 'Olivier Lau', '2009-03-24 15:20:17 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (249, '47518', 'Bug 47518 Valve Interface Javadocs for invoke method references non-existent method', 'It appears that the Valve interface javadoc hasn\'t been updated since around TC 5.5. Here is a snip of what it currently available from TC\'s website (6.0.20 I would guess):\n\n\'\n# If the corresponding Response was not generated (and control was not returned, call the next Valve in the pipeline (if there is one) by executing context.invokeNext().\n\n.\n.\n.\n\n# Modify the HTTP headers included with the Response after the invokeNext() method has returned.\n# Perform any actions on the output stream associated with the specified Response after the invokeNext() method has returned.\n\'\n\nThe invokeNext method has not existed in the Valve interface in many versions. I believe the replacement is:\n\nthis.getNext().invoke(request, response)\n\nI\'m happy to provide a doc patch if getNext().invoke(request, response) is the expected replacement for invokeNext(request, response).\n\nNote that the docs for 5.5 also have the same problem. Please let me know if I should log that separately.', 'Christopher Schultz', '2009-07-13 06:40:01 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (250, '41059', 'Bug 41059 WebAppClassLoader clearReferences code break running threads', 'When the WebAppClassLoader stops it manually sets all static and final \nvariables to null in the clearReferences method.  This results in NPEs for any \nthread that was not stopped and not expecting its final or static variables to \nbe null.  This is particularly a problem with hot deploys since the unload \nfails and terminating the deploy.', 'James Birmingham', '2006-11-28 11:53:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (251, '40551', 'Bug 40551 Sticky sessions using PersistentManager enter indeterminate state on node failover', 'If a cluster of nodes is being load balanced with sticky sessions, and a\nparticular node becomes unavailable, any sessions bound to that node must be\nredistributed.  Particularly in the case of mod_jk these sessions will not be\nbound to whichever node the failover occurred on because the jessionid will\nstill contain the JVM route of the original failed node, thus placing the\nsession in an indeterminate state and losing sticky properties.\n\nI am attaching a patch that will trigger a session to rebind itself to a new\nnode if the jvmroutes don\'t match and replace the jessionid in the browser\'s cookie.', 'Chris Chandler', '2006-09-20 01:33:41 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (252, '47515', 'Bug 47515 Tomcat can\'t replicate session when it is started.', 'System\n  two Tomcat Server(AP1,AP2)\n  Tomcat\'s version is 6.0.18.\n  Replication method is Delta Manager\n \n I stopped Tomcat of AP1.\n Then, I restarted Tomcat of AP1.\n Then, for AP1, Tomcat\'s log is as follows.\n \n  Jul 2, 2009 4:51:04 PM\n  org.apache.catalina.ha.session.DeltaManager getAllClusterSessions\n  WARNING: Manager [/tpcw]: Drop message SESSION-DELTA\n  inside GET_ALL_SESSIONS sync phase start date 7/2/09 4:51 PM message date 1/1/70 9:00 AM\n  \n  Jul 2, 2009 4:51:04 PM\n  org.apache.catalina.ha.session.DeltaManager getAllClusterSessions\n  WARNING: Manager [/tpcw]: Drop message SESSION-ACCESSED\n  inside GET_ALL_SESSIONS sync phase start date 7/2/09 4:51 PM message date 1/1/70 9:00 AM\n  \n TimeStamp is incorrect when SESSION-DELTA or SESSION-ACCESSED because \'1/1/70 9:00 AM\' isn\'t created time of session.\n In this case, AP1\'s Tomcat may drop all session data.\n As a result, AP1\'s Tomcat can\'t replicate session.\n If TimeStamp is updated when update last replicated time, it goes well.\n \n I made patch.\n \n DeltaManager\'s patch.\n \nIndex: java/org/apache/catalina/ha/session/DeltaManager.java\n===================================================================\n--- java/org/apache/catalina/ha/session/DeltaManager.java	( revision 792004 )\n+++ java/org/apache/catalina/ha/session/DeltaManager.java	(working copy)\n@@ -1162,7 +1162,10 @@\n             }\n \n             //update last replicated time\n-            if (msg != null) session.setLastTimeReplicated(System.currentTimeMillis());\n+            if (msg != null){\n+            	session.setLastTimeReplicated(System.currentTimeMillis());\n+            	msg.setTimestamp(session.getLastTimeReplicated());\n+            }\n             return msg;\n         } catch (IOException x) {\n             log.error(sm.getString(\'deltaManager.createMessage.unableCreateDeltaRequest\',sessionId), x);', 'Ryuichi Yoshihara', '2009-07-12 23:08:36 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (253, '40380', 'Bug 40380 Potential syncro problem in StandardSession.expire(boolean)', 'public void expire(boolean notify) {\n\n        // Mark this session as \'being expired\' if needed\n        if (expiring)\n            return;\n\n// No man\'s land here\n\n        synchronized (this) {\n\n            if (manager == null)\n                return;\n\n            expiring = true;', 'Claude Qu', '2006-08-31 18:57:30 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (254, '39231', 'Bug 39231 The JAAS contract for LoginModule is broken', 'The issue is that the custom JAAS\'s LoginModule.logout() method is never \ncalled. I guess this has been never implemented correctly (at least since \nTomcat 5.5.9).\n\nThe thing is that according to the JAAS spec, the LoginContext.logout() is \nsupposed to invoke the logout method for each LoginModule configured for this \nLoginContext.\n\nSo, somebody should be sure to call LoginContext.logout() method. The caller \nfor this method could be either a server or a client. \n\nSo, either Tomcat should provide some means to access the LoginContext to the \nclients, or Tomcat should take the responsibility to call this method by itself.\n\nI guess the solution could be for Tomcat to associate the instance of \nLoginContext with the user\'s session, and then Tomcat could invoke \nLoginContext.logout() when the session is being invalidated (both when the \nsession times out or invalidated explicitely).\n\nI hope that I am correctly interpreting the JAAS spec.', 'Seva Popov', '2006-04-06 21:19:49 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (255, '37984', 'Bug 37984 JNDIRealm.java not able to handle MD5 password', 'I\'m using JNDIRealm to authenticate to OpenLDAP 2.2.28.  Within OpenLDAP I\'ve\nconfigured the userPassword attribute for each user to contain the MD5 digest,\nand each is prefixed with the string \'{MD5}\'.  I am not an LDAP expert by any\nmeans but I believe this prefix is a standard convention.  Anyway assuming this\nis a convention then JNDIRealm needs to strip off the \'{MD5}\' portion much like\nit does with \'{SHA1}\'.  See attached patch which accomplishes this and I\nverified it works in my environment.', 'Eric Lenio', '2005-12-21 05:51:20 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (256, '47440', 'Bug 47440 Remove DB-specific SQL statements from test cases (SELECT 1)', 'Some of the test cases assume that the JDBC provider supports \'SELECT 1\' as a valid SQL statement; however this is not always the case, e.g. Derby requires a table name to select from.\n\nThe solution provided in the patches is to use the validation query defined in the properties set up for the test, rather than always using \'SELECT 1\'.', 'Sebb', '2009-06-27 05:17:55 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (257, '47439', 'Bug 47439 PooledConnection.connect() fails to check for null connection', 'PooledConnection.connect() fails to check for null return from java.sql.Driver.connect() method.\n\nThis can result in an NPE when the connection is used later.', 'Sebb', '2009-06-27 05:01:35 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (258, '38352', 'Bug 38352 Additional Entries for Default catalina.policy file.', 'This patch adds additional entries to the catalina.policy file. Specifically:\n\nThe catalina.base/shared directory is added and given equal permissions to\ncatalina.home/common\n\njava.io.tmpdir is now readable.\njavax.servlet.context.tempdir is now readable. I think to be compliant with the\nspec, this must be allowed.\n\nDirectory specified by java.io.tmpdir (which is what tomcat points\njavax.servlet.context.tempdir to) is now read, write, delete. Again, I think the\nspec requires this.', 'George Sexton', '2006-01-22 20:27:46 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (259, '47046', 'Bug 47046 Shutdown does not unregister all MBeans', 'Created  attachment 23505   [details] \nSimple driver to highlight problem\n\nIf I start and stop Tomcat in a VM using the Catalina class then it does not unregister all its MBeans. The list left over is:\n\nCatalina:type=RequestProcessor,worker=http-8080,name=HttpRequest1 true\nCatalina:type=MBeanFactory true\nCatalina:type=Engine true\nCatalina:type=JkWorkerEnv true\nCatalina:type=StringCache true\nCatalina:type=Host,host=localhost true\nCatalina:type=JkMain true\nCatalina:type=JkHandler,name=channelSocket true\nCatalina:type=Server true\nCatalina:type=JkHandler,name=request true\nCatalina:type=Connector,port=8080 true\nCatalina:type=Connector,port=8009 true\n\nI\'ve attached a simple class that can be used to reproduce this list.', 'Rob Harrop', '2009-04-17 07:59:51 UTC', 'tomcat_attachment/attachment 23505');
INSERT INTO `tomcatbody` VALUES (260, '37929', 'Bug 37929 invalidated session causes pageContext methods to fail', 'javax.servlet.http.HttpSession methods such as getAttribute(),\ngetValue(), getAttributeNames(), getValueNames(), etc, throw an\nIllegalStateException if called on a session that has been\ninvalidated.\n\nSo, with the following code in a JSP page:\n\n    <% \n       session.invalidate(); \n       Object obj = pageContext.findAttribute(\'foo\');\n    %>\n\nAn IllegalStateException is thrown because pageContext.findAttribute()\neventually calls session.getAttribute() on a session that has been\ninvalidated.\n\nThe session that has been invalidated should simply be ignored when a\nmethod needs to process the various scopes (page, request, session,\napplication).\n\nThis impacts the following methods in PageContextImpl:\n\n   public int getAttributesScope(final String name)\n      which calls -> private int doGetAttributeScope(String name);\n   public Object findAttribute(final String name)\n      which calls -> private Object doFindAttribute(String name);\n   public void removeAttribute(final String name)\n      which calls -> private void doRemoveAttribute(String name);\n\nThe fix is to catch IllegalStateException and ignore it when processing\nthe attribute in session scope. The code then simply follows through to \nprocess application scope.\n\nNo need to worry about setAttribute() because it is always invoked\non a specific scope, and the spec already states\nthat java.lang.IllegalStateException must be thrown when called \non an invalidated session.\n\n  pageContext.setAttribute(\'foo\', \'value of foo\', PageContext.SESSION_SCOPE);\n\n  java.lang.IllegalStateException - if the scope is PageContext.SESSION_SCOPE \n  but the page that was requested does not participate in a session or \n  the session has been invalidated.\n\n---------------------------------------------------------------------------\n\nAt the same time, a fix should be done to method \'doRemoveAttribute(String\nname)\' where a try/catch block for Exception appears unnecessary.\n\n    private void doRemoveAttribute(String name){\n        try {\n            removeAttribute(name, PAGE_SCOPE);\n            removeAttribute(name, REQUEST_SCOPE);\n            if( session != null ) {\n                try {\n                    removeAttribute(name, SESSION_SCOPE);\n                } catch (IllegalStateException ex) {\n                    // Session has been invalidated.\n                    // Ignore and fall through to application scope.\n                }\n            }\n            removeAttribute(name, APPLICATION_SCOPE);\n        } catch (Exception ex) {\n            // we remove as much as we can, and\n            // simply ignore possible exceptions\n        }\n    }\n\nHere is a full analysis:\n\nStarting with \'removeAttribute(final String name)\'\n  - we check for null and throw NPE if necessary\n\n  - we call doRemoveAttribute(name)\n  \ndoRemoveAttribute(name)\n  - we call removeAttribute(name, scope) for each scope\n\nremoveAttribute(final String name, final int scope)\n  - this calls doRemoveAttribute(name, scope)\n\ndoRemoveAttribute(name, scope)\n  - page scope: attributes.remove -> won\'t throw an Exception\n  - request scope: request.removeAttribute -> no documented Exception thrown\n  - session scope: throws IllegalStateException if session is null\n  - app scope: context.removeAttribute -> no documented Exception thrown\n\nA null value for name is already checked in removeAttribute(final String name)\nand we throw NPE. So this situation (removing an attr from page or request\nscope throwing an NPE) won\'t happen.\n\nIn doRemoveAttribute(name), we already check on session != null\nbefore calling removeAttribute(name, SESSION_SCOPE). So there\nnormally is no IllegalStateException thrown (except for the invalidated\ncase).\n\nWhen removing an attribute from application (i.e., ServletContext)\nscope, any registered listeners will be notified, but the code that\ndoes that (see\nappserv-webtier/src/java/org/apache/catalina/core/ApplicationContext.\nremoveAttribute()) already catches any Throwable that a listener\nmay throw.\n\nThe try/catch block is therefore unnecessary.\nMoreover, if any of the removal actions from the different scopes could\nhave thrown an exception, each of them would have needed to be wrapped\ninside their own try/catch, so as to ensure that an exception in one\nscope does not cause any of the subsequent removals to be bypassed.\n\ndoRemoveAttribute(String name) has therefore been modified as follows:\n\n    private void doRemoveAttribute(String name){\n            removeAttribute(name, PAGE_SCOPE);\n            removeAttribute(name, REQUEST_SCOPE);\n            if( session != null ) {\n                try {\n                    removeAttribute(name, SESSION_SCOPE);\n                } catch (IllegalStateException ex) {\n                    // Session has been invalidated.\n                    // Ignore and fall through to application scope.\n                }\n            }\n            removeAttribute(name, APPLICATION_SCOPE);\n    }\n\n--------------------------\nChanges done on glassfish. ymmv on jasper for the diffs.\n\n--- PageContextImpl.java	9 Dec 2005 18:54:30 -0000	1.7\n+++ PageContextImpl.java	16 Dec 2005 00:11:21 -0000	1.8\n@@ -452,8 +452,13 @@\n             return REQUEST_SCOPE;\n \n         if (session != null) {\n+            try {\n             if (session.getAttribute(name) != null)\n                 return SESSION_SCOPE;\n+            } catch (IllegalStateException ex) {\n+ 	        // Session has been invalidated.\n+                // Ignore and fall through to application scope.\n+            }\n         }\n \n         if (context.getAttribute(name) != null)\n@@ -495,9 +500,14 @@\n             return o;\n \n         if (session != null) {\n+	    try {\n             o = session.getAttribute(name);\n-            if (o != null)\n-                return o;\n+ 	    } catch (IllegalStateException ex) {\n+ 	        // Session has been invalidated.\n+                // Ignore and fall through to application scope.\n+ 	    }\n+\n+ 	    if (o != null) return o;\n         }\n \n         return context.getAttribute(name);\n@@ -559,19 +569,18 @@\n         }\n     }\n \n-\n     private void doRemoveAttribute(String name){\n-        try {\n             removeAttribute(name, PAGE_SCOPE);\n             removeAttribute(name, REQUEST_SCOPE);\n             if( session != null ) {\n+            try {\n                 removeAttribute(name, SESSION_SCOPE);\n+            } catch (IllegalStateException ex) {\n+                // Session has been invalidated.\n+                // Ignore and fall through to application scope.\n             }\n-            removeAttribute(name, APPLICATION_SCOPE);\n-        } catch (Exception ex) {\n-            // we remove as much as we can, and\n-            // simply ignore possible exceptions\n         }\n+        removeAttribute(name, APPLICATION_SCOPE);\n     }\n \n     public JspWriter getOut() {', 'Pierre Delisle', '2005-12-16 01:58:15 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (261, '47013', 'Bug 47013 JSP not compiled at startup when used as a servlet', 'I created a servlet with a jsp and the following web.xml entry:\n\n	<servlet>\n		<servlet-name>Repository</servlet-name>\n		<jsp-file>/Repository.jsp</jsp-file>\n		<load-on-startup>1</load-on-startup>\n	</servlet>\n	<servlet-mapping>\n		<servlet-name>Repository</servlet-name>\n		<url-pattern>/Repository</url-pattern>\n	</servlet-mapping>\n\nI altered the JSP and started Tomcat.  The initial startup invokes the JSP with the following call stack:\n\n	org.apache.jsp.Repository_jsp.jspInit(Repository_jsp.java:42)\n	org.apache.jasper.runtime.HttpJspBase.init(HttpJspBase.java:51)\n	org.apache.jasper.servlet.JspServletWrapper.getServlet(JspServletWrapper.java:159)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:329)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1191)\n	org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:992)\n	org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4058)\n	org.apache.catalina.core.StandardContext.start(StandardContext.java:4371)\n	org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)\n	org.apache.catalina.core.StandardHost.start(StandardHost.java:719)\n	org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)\n	org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)\n	org.apache.catalina.core.StandardService.start(StandardService.java:516)\n	org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n	org.apache.catalina.startup.Catalina.start(Catalina.java:578)\n	sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	java.lang.reflect.Method.invoke(Method.java:597)\n	org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\n\nThen I hit the servlet with a normal request with  http://localhost:8080/context/Repository  which yields this call stack:\n\n	org.apache.jsp.Repository_jsp.jspInit(Repository_jsp.java:42)\n	org.apache.jasper.runtime.HttpJspBase.init(HttpJspBase.java:51)\n	org.apache.jasper.servlet.JspServletWrapper.getServlet(JspServletWrapper.java:159)\n	org.apache.jasper.servlet.JspServletWrapper.getDependants(JspServletWrapper.java:263)\n	org.apache.jasper.compiler.Compiler.isOutDated(Compiler.java:430)\n	org.apache.jasper.compiler.Compiler.isOutDated(Compiler.java:351)\n	org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:582)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n	org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n	org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n	org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n	org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n	org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)\n	org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)\n	org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)\n	org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n	java.lang.Thread.run(Thread.java:619)\n\nThe JSP gets compiled on the request, but not at startup.  I backtracked a little and found StandardWrapper is doing:\n\n	req.setQueryString(\'jsp_precompile=true\');\n\nwhich is unsafe b/c the precompile param can be specified as system property org.apache.jasper.Constants.PRECOMPILE.  Instead it should be:\n\n	req.setQueryString(Constants.PRECOMPILE + \'=true\');\n\nAnyway, I wasn\'t overriding it so that didn\'t help.', 'Robert Flaherty', '2009-04-10 09:26:22 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (262, '42579', 'Bug 42579 [Patch] JNDIRealm fails to parse absolute names', 'Active Directory can respond to a query with SearchResult\'s that are not\nrelative.  We discovered this happening with a directory hosted across many\nservers when the userBase was not sufficient to identify a single server.\n\nIn getUserBySearch, JNDIRealm assumes that the SearchResult is relative and goes\nabout creating a DN for the user by appending together the various bits of names\nit gets back.  This is definitely wrong for absolute names which are URL\'s of\nthe form:  ldap://server/encoded_user_dn\n\nI discovered this issue in Tomcat 5.5 and a cursory look at the SVN repo for\nTomcat 6.0 reveals that this bug is also present there.  \n\nI have a patch for this issue which I will attach.', 'Brandon DuRette', '2007-06-04 14:13:14 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (263, '46354', 'Bug 46354 LIMIT_BUFFER setting causes arraycopy errors', 'Per the advice in this issue:\n\n http://issues.apache.org/bugzilla/show_bug.cgi?id=37793 \n\nWe just tried to apply the following setting to our Tomcat instances\n\n-Dorg.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true\n\nA short time after applying this setting, we would start seeing the following stack traces on various random requests.\n\nSEVERE: Servlet.service() for servlet jsp threw exception\njava.lang.ArrayIndexOutOfBoundsException\n        at java.lang.System.arraycopy(System.java)\n        at java.lang.String.getChars(String.java:855)\n        at org.apache.jasper.runtime.BodyContentImpl.write(BodyContentImpl.java:146)\n        at org.apache.jasper.runtime.BodyContentImpl.write(BodyContentImpl.java:159)\n        at org.apache.jsp.tag.web.arch.patterns.DetailInspector.list_tag._jspx_meth_c_005fif_005f3(list_tag.java:683)\n        at org.apache.jsp.tag.web.arch.patterns.DetailInspector.list_tag._jspx_meth_c_005fforEach_005f0(list_tag.java:630)\n        at org.apache.jsp.tag.web.arch.patterns.DetailInspector.list_tag.doTag(list_tag.java:302)\n        at org.apache.jsp.WEB_002dINF.pages.registrar.academic.Student.inspect.pgmstudy_002dtab_jsp._jspx_meth_detail_005flist_005f0(pgmstudy_002dtab_jsp.java:224)\n        at org.apache.jsp.WEB_002dINF.pages.registrar.academic.Student.inspect.pgmstudy_002dtab_jsp.access$0(pgmstudy_002dtab_jsp.java:214)\n        at org.apache.jsp.WEB_002dINF.pages.registrar.academic.Student.inspect.pgmstudy_002dtab_jsp$pgmstudy_002dtab_jspHelper.invoke0(pgmstudy_002dtab_jsp.java:492)\n        at org.apache.jsp.WEB_002dINF.pages.registrar.academic.Student.inspect.pgmstudy_002dtab_jsp$pgmstudy_002dtab_jspHelper.invoke(pgmstudy_002dtab_jsp.java:571)\n        at org.apache.jsp.tag.web.arch.patterns.DetailInspector.inspector_tag.doTag(inspector_tag.java:163)\n        at org.apache.jsp.WEB_002dINF.pages.registrar.academic.Student.inspect.pgmstudy_002dtab_jsp._jspService(pgmstudy_002dtab_jsp.java:151)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:98)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:328)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        ...\n\nIf we remove the setting, then things behave normally (albeit with the memory issues discussed in the linked issue).\n\nWe are running on top of java version 1.6.0.', 'Ed Hill', '2008-12-05 09:01:51 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (264, '46562', 'Bug 46562 Reader not closed', 'SHTML files are locked when using windows. Closing the reader solves the problem.', 'Michael Rauner', '2009-01-19 08:17:14 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (265, '46991', 'Bug 46991 \'Bytes received \'  problem', 'use jk module\n\nsubmit some data with post method ,but  \'Bytes received\' always show zero\n\nsee source file ,JkCoyoteHandler.java ,in \'inovke\' method\n\n public int invoke( Msg msg, MsgContext ep )\n        throws IOException {\n        if( ep.isLogTimeEnabled() )\n            ep.setLong( MsgContext.TIMER_PRE_REQUEST, System.currentTimeMillis());\n\n        Request req=ep.getRequest();\n        Response res=req.getResponse();\n\n        if( log.isDebugEnabled() )\n            log.debug( \'Invoke \' + req + \' \' + res + \' \' + req.requestURI().toString());\n\n        res.setNote( epNote, ep );\n        ep.setStatus( MsgContext.JK_STATUS_HEAD );\n        RequestInfo rp = req.getRequestProcessor();\n        rp.setStage(Constants.STAGE_SERVICE);\n        try {\n            adapter.service( req, res );\n        } catch( Exception ex ) {\n            log.info(\'Error servicing request \' + req,ex);\n        }\n        if(ep.getStatus() != MsgContext.JK_STATUS_CLOSED) {\n            res.finish();\n        }\n      \n        req.recycle();         \n        req.updateCounters();   //see this line\n         res.recycle();\n        ep.recycle();\n        if( ep.getStatus() == MsgContext.JK_STATUS_ERROR ) {\n            return ERROR;\n        }\n        ep.setStatus( MsgContext.JK_STATUS_NEW );\n        rp.setStage(Constants.STAGE_KEEPALIVE);\n        return OK;\n    }\n\n the request object recycled,the \'byteRead\' property must be set to zero ,but at the next line ,begin to \'updateCounters\',this may be a bug', 'huangfeng', '2009-04-08 01:37:54 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (266, '46967', 'Bug 46967 ManagerBase.setRandomFile error handling fix', 'On some platforms (z/OS for sure), the device file /dev/urandom can pass the \'f.exists()\' test, but throws an IOException of some kind when trying to open it.  The current code in ManagerBase.setRandomFile() doesn\'t handle this, which results in EVERY call to getRandom() to try again and log the error  \'Failed to close randomIS\'.\n\nThe following changes to the method will add proper error handling to correct this (my changes marked \'// kjw\')\n\n    public void setRandomFile( String s ) {\n        // as a hack, you can use a static file - and genarate the same\n        // session ids ( good for strange debugging )\n        if (Globals.IS_SECURITY_ENABLED){\n            randomIS = (DataInputStream)AccessController.doPrivileged(new PrivilegedSetRandomFile());          \n        } else {\n            try{\n                devRandomSource=s;\n                File f=new File( devRandomSource );\n                if( ! f.exists() ) return;\n                randomIS= new DataInputStream( new FileInputStream(f));\n                randomIS.readLong();\n                if( log.isDebugEnabled() )\n                    log.debug( \'Opening \' + devRandomSource );\n            } catch( IOException ex ) {\n            	log.debug(\'Error reading \' + devRandomSource, ex); //kjw\n            	if (randomIS != null) {  // kjw: if opened\n	                try {\n	                    randomIS.close();\n	                } catch (Exception e) {\n	                    log.warn(\'Failed to close randomIS.\');\n	                }\n            	}                       // kjw \n            	devRandomSource = null; // kjw: don\'t try again automatically\n                randomIS=null;\n            }\n        }\n    }', 'Kirk Wolf', '2009-04-03 18:57:28 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (267, '46933', 'Bug 46933 Using Java 1.5 in StringManager', 'Created  attachment 23424   [details] \nupdate method to java 1.5\n\nUsing Java 1.5 in StringManager', 'Jens Kapitza', '2009-03-27 15:34:14 UTC', 'tomcat_attachment/attachment 23424.txt');
INSERT INTO `tomcatbody` VALUES (268, '46982', 'Bug 46982 AccessLogValve reports correct time but incorrect offset following Spring DST transition.', 'This is a problem with AccessLogValve for tc5.5 as well as tc6.0 on all platforms.\n\nWith the system clock on my linux machine (Ubuntu in my case) to just before the US time change on March 8, I started Tomcat 5.5 and see the following messages in my Tomcat access log after accessing Tomcat JSP example pages at the time of DST transition:\n\n-: - [08/Mar/2009:01:56:20 -0700] GET /jsp-examples/jsp2/simpletag/book.jsp HTTP/1.1 200 1738 1 - {http-8080-Processor24}\n-: - [08/Mar/2009:03:01:22 -0700] GET /jsp-examples/jsp2/tagfiles/hello.jsp HTTP/1.1 200 2213 68 - {http-8080-Processor25}\n\nNote the offset of \'-0700\' both before and after DST transition.  Following a Tomcat restart the offset is correct:\n\n-: - [08/Mar/2009:03:19:42 -0600] GET /jsp-examples/jsp2/jspx/basic.jspx HTTP/1.1 200 1919 780 - {http-8080-Processor25}\n-: - [08/Mar/2009:03:19:59 -0600] GET /jsp-examples/jsp2/jspx/svgexample.html HTTP/1.1 200 2239 4 - {http-8080-Processor25}\n-: - [08/Mar/2009:03:19:59 -0600] GET /jsp-examples/jsp2/jspx/textRotate.jpg HTTP/1.1 200 26729 3 - {http-8080-Processor25}\n\n\nBTW, I ran the tzupdater before my tests:\n\nlinwin01-512> java -jar tzupdater.jar -V\ntzupdater version 1.3.12-b01\nJRE time zone data version: tzdata2009a\nEmbedded time zone data version: tzdata2009a\n\n\n\nThe problem is in the org.apache.catalina.valves.AccessLogValve which contains the following in its start method:\n\n\n// Initialize the timeZone, Date formatters, and currentDate\ntimezone = TimeZone.getDefault();\ntimeZoneNoDST = calculateTimeZoneOffset(timezone.getRawOffset());\nCalendar calendar = Calendar.getInstance(timezone);\nint offset = calendar.get(Calendar.DST_OFFSET);\ntimeZoneDST = calculateTimeZoneOffset(timezone.getRawOffset()+offset);\n\n\nBased on what I’ve seen, “int offset = calendar.get(Calendar.DST_OFFSET);” returns 0 when the current time is not in Daylight savings time and (for my timezone) 3600000 (60 * 60 * 1000) when the current time is in Daylight Savings.  It looks like the code assumes this is always the offset for Daylight Savings for the current timezone.  I have no idea if there are some locations/timezones where Daylight Savings Time does not have a 1 hour offset.\n\nBecause of this, if in a non-DST time period, timeZoneDST and timeZoneNoDST are set to the same value.  If in a DST time period, I believe they are set correctly so that the transition in Autumn works correctly.  I think the only problem is when moving ahead in Springtime (unless the software has been running for 6 months or so which caused the offset to be set correctly).', 'Philip Pickett', '2009-04-07 07:32:55 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (269, '41606', 'Bug 41606 The jspInit method is called twice.', 'The problem is:\nThe jspInit method is called twice.\n\nThe definition is:\n-The JSP background compilations are enable.\n (In default web.xml, define checkInterval and define development false.)\n-Define the JSP with <servlet> and <load-on-startup> tag in web.xml.\n\nThe proposing:\norg/apache/jasper/compiler/Compiler.java \n----\npublic void compile(boolean compileClass, boolean jspcMode)\n    throws FileNotFoundException, JasperException, Exception\n{\n....\n    if( compileClass ) {\n        File targetFile = new File(ctxt.getClassFileName());\n        if (targetFile.exists()) {\n            long targetLastModified = targetFile.lastModified();\n            if (jsw != null) {\n                jsw.setServletClassLastModifiedTime(targetLastModified);\n            }   \n        }\n    }\n}// last of the method.\n----\n\nRegards,\nYuichiro', 'Suzuki Yuichiro', '2007-02-13 20:46:54 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (270, '46875', 'Bug 46875 CometConnectionManagerValve: concurrent access on session object when calling HttpSession.invalidate()', 'When calling invalidate() on an valid HttpSession object CometConnectionManagerValve methods sessionDestroy(HttpSessionEvent se) and event(Request request, Response response, CometEvent event) are called concurrently.\n\nSo either a CometEvent with EventType.END and EventSubType.SESSION_END is never signaled via sessionDestroyed(...) or the HttpSession object has become invalid and the attribute holding comet requests can not be set or removed via event(...).\n\nI have configured CometConnectionManagerValve as a Valve element in context.xml and also as a Listener element in my applications web.xml.\n\n\n\nsee this stacktrace \'sessionDestroy() was a bit faster\':\n\nAn exception or error occurred in the container during the request processing\njava.lang.IllegalStateException: removeAttribute: Session already invalidated\n	at org.apache.catalina.session.StandardSession.removeAttribute(StandardSession.java:1206)\n	at org.apache.catalina.session.StandardSession.removeAttribute(StandardSession.java:1181)\n	at org.apache.catalina.session.StandardSessionFacade.removeAttribute(StandardSessionFacade.java:140)\n	at org.apache.catalina.valves.CometConnectionManagerValve.event(CometConnectionManagerValve.java:335)\n	at org.apache.catalina.core.StandardHostValve.event(StandardHostValve.java:179)\n	at org.apache.catalina.valves.ValveBase.event(ValveBase.java:200)\n	at org.apache.catalina.core.StandardEngineValve.event(StandardEngineValve.java:128)\n	at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:198)\n	at org.apache.coyote.http11.Http11NioProcessor.event(Http11NioProcessor.java:750)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.event(Http11NioProtocol.java:653)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:2081)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)\n	at java.lang.Thread.run(Thread.java:637)', 'holger.schott', '2009-03-19 02:15:04 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (271, '46666', 'Bug 46666 Why is disableUploadTimeout and KeepAliveTimeout correlated in Http11 Connector?', 'In Http11Processor.java\n\n        while (started && !error && keepAlive) {\n\n            // Parsing the request header\n            try {\n                if (!disableUploadTimeout && keptAlive) {\n                    if (keepAliveTimeout > 0) {\n                        socket.setSoTimeout(keepAliveTimeout);\n                    }\n                    else if (soTimeout > 0) {\n                        socket.setSoTimeout(soTimeout);\n                    }\n                }\n                inputBuffer.parseRequestLine();\n                request.setStartTime(System.currentTimeMillis());\n                keptAlive = true;\n                if (!disableUploadTimeout) {\n                    socket.setSoTimeout(timeout);\n                }\n\ndisableUploadTimeout  - This flag allows the servlet container to use a different, longer connection timeout while a servlet is being executed, which in the end allows either the servlet a longer amount of time to complete its execution, or a longer timeout during data upload. If not specified, this attribute is set to \'true\'.\n\nThe code above is waiting on a new Http Request and precedes the servlet processing logic.  It seems odd to me that I must set disableTimeout to false to get my keepAliveTimeout set.  \n\nTo set keepalivetimout, I must implicitely enable upload timeout whether I need it or not.  It seems to me that the disableTimeout is unneccessary in the following line\n\nif (!disableUploadTimeout && keptAlive) {\n\nDo you agree with this?\n\nThanks for the insight', 'Doug Drechsel', '2009-02-04 08:28:34 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (272, '39396', 'Bug 39396 OPTIONS request on directory with no default file reports an incorrect list of allowed HTTP verbs', 'When an \'options\' http request is made to Tomcat to a directory that has no \ndefault file (like index.jsp) in it, Tomcat reports a full list of allowed \nverbs, when in fact, most of them are NOT allowed.  For example, a request to \na generic img directory:\n\nOPTIONS /img/ HTTP/1.0\n	Cookie: JSESSIONID=C46C2E18BE95AD91828C9370CBDF0AF2\n	Content-Length: 0\n	Accept: */*\n	Accept-Language: en-us\n	Connection: Keep-Alive\n	User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; \nSV1; .NET CLR 1.1\n	4322; InfoPath.1)\n\nReturns:\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nAllow: GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONS\nContent-Length: 0\nDate: Mon, 24 Apr 2006 15:11:16 GMT\nConnection: close\n\nWhich shows several destructive options available (PUT, DELETE).  But a \nrequest to DELETE or PUT (correctly) returns a 403 FORBIDDEN result:\n\nDELETE /img/ HTTP/1.0\n	Cookie: JSESSIONID=C46C2E18BE95AD91828C9370CBDF0AF2\n	Content-Length: 0\n	Accept: */*\n	Accept-Language: en-us\n	Connection: Keep-Alive\n	User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; \nSV1; .NET CLR 1.1\n	4322; InfoPath.1)\n\nReturns:\nHTTP/1.1 403 Forbidden\nServer: Apache-Coyote/1.1\nContent-Type: text/html;charset=utf-8\nContent-Length: 964\nDate: Mon, 24 Apr 2006 15:12:31 GMT\nConnection: close\n\nBecause the initial OPTIONS request returns a list containing dangerous verbs, \nthe directory will be flagged as a serious security vulnerability by most \nscanners (a false positive).\n\nThe issue DOES NOT occur when the directory HAS a default file in it:\nOPTIONS /user_management/ HTTP/1.0\n	Cookie: JSESSIONID=C46C2E18BE95AD91828C9370CBDF0AF2\n	Content-Length: 0\n	Accept: */*\n	Accept-Language: en-us\n	Connection: Keep-Alive\n	User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; \nSV1; .NET CLR 1.1\n	4322; InfoPath.1)\n\nReturns:\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nSet-Cookie: JSESSIONID=BC992F0C86E2BCBD0A2E5F1B3A12C50C; Path=/\nContent-Type: text/html;charset=ISO-8859-1\nDate: Mon, 24 Apr 2006 15:14:27 GMT\nConnection: close', 'Sean Molloy', '2006-04-24 15:15:57 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (273, '38570', 'Bug 38570 if docBase path contains \'webapps\', a backslash is inserted', 'There seem to be a problem when interpreting docBase in context definitions, if\nit contains the string \'webapps\'. \n\nFor testing, I moved tomcat-docs to a separate directory outside of webapps,\nthen defined a file tomcat-docs.xml in CATALINA_HOME/conf/Catalina/localhost :\n<Context\n        docBase=\'${catalina.home}/../something/tomcat-docs\'>\n</Context>\n\nWhen I name that directory \'something\' as above, everything works ok,\n http://localhost:12345/tomcat-docs  displays the documentation (my tomcat runs on\nport 12345).\n\nWhen I name that directory \'webappsSomething\', it is interpreted as\n\'webapps/Something\' and loading the application (tomcat docu) fails on start of\nTomcat: \n\n<Context\n        docBase=\'${catalina.home}/../webappsSomething/tomcat-docs\'>\n</Context>\n\n08.02.2006 15:25:30 org.apache.catalina.core.StandardContext resourcesStart\nSCHWERWIEGEND: Error starting static Resources\njava.lang.IllegalArgumentException: Document base\nD: be JAVA_IDE jakarta-tomcat-5.5.9 .. webapps Something tomcat-docs does not\nexist or is not a readable directory\n	at org.apache.naming.resources.FileDirContext.setDocBase(FileDirContext.java:140)\n	at\norg.apache.catalina.core.StandardContext.resourcesStart(StandardContext.java:3754)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:3925)\n\nApparently Tomcat is fiddling around with the docBase path as soon as it\ncontains the string webapps - why?', 'Edith', '2006-02-08 15:46:45 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (274, '38553', 'Bug 38553 Wrong HTTP code for failed CLIENT-CERT authentication', 'server.xml:\n===========\nI set clientAuth to \'want\'\n\ntomcat-user.xml:\n================\nI create a role and an user with the ssl certificate metadata\n\nweb.xml:\n========\nFor a private URL on my webseite, I create a security constraint like this one:\n\n <security-constraint>\n	<web-resource-collection>\n	<web-resource-name>App</web-resource-name>\n	    <url-pattern>/protected.jsp</url-pattern>\n	</web-resource-collection>\n	<auth-constraint>\n	    <role-name>tomcat</role-name>\n	</auth-constraint>\n	<user-data-constraint>\n	    <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n	</user-data-constraint>\n    </security-constraint>\n\n    <login-config>\n      <auth-method>CLIENT-CERT</auth-method> \n    </login-config>\n\n    <security-role>\n      <role-name>tomcat</role-name>\n    </security-role>\n\nMy results: (I try to access the restricted JSP-Page)\n===========\n1) When there is the RIGHT client certificate in the browser keystore:\nit works :-)\n\n2) When there is the WRONG client certificate I get:\n\n  HTTP Status 401 - Cannot authenticate with the provided credentials\n  (this is ok, too)\n\n3) When there is NO client certificate I get:\n\n  HTTP Status 400 - No client certificate chain in this request\n\n400 usually stands for a bad request or bad syntax. \n\nThe Bug:\n========\nIn case 3 I expect to get HTTP Status 401.', 'Markus', '2006-02-07 16:54:17 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (275, '38197', 'Bug 38197 taglib pool bug when tag is used with jsp:attribute', 'When i use a taglib twice in the same page and the two instances of these tags \nshare the same atrributes in the declaration but one of them have and attribute\nset using jsp:attribute, the value of this attribute is used in the other one too.\n\nExample\n<%@ taglib prefix=\'c\' uri=\' http://java.sun.com/jstl/core \' %>\n<html>\n<body>\n<h4>1 to 10 step 2</h4>\n<c:forEach var=\'i\' begin=\'1\' end=\'10\'>\n<jsp:attribute name=\'step\'>2</jsp:attribute>\n<jsp:body>\n  <c:out value=\'${i}\'/> \n</jsp:body>\n</c:forEach>\n<br>\n<h4>1 to 10 no step</h4>\n<c:forEach var=\'i\' begin=\'1\' end=\'10\' >\n  <c:out value=\'${i}\'/> \n</c:forEach>\n</body>\n</html>\n\nThe output is \n\nSimple Range Iteration\n1 to 10 step 2\n1 3 5 7 9\n1 to 10 no step\n1 3 5 7 9\n\nExpected\nSimple Range Iteration\n1 to 10 step 2\n1 3 5 7 9\n1 to 10 no step\n1 2 3 4 5 5 7 8 9\n\n\nThanks', 'Diego Belfer', '2006-01-09 15:53:09 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (276, '46261', 'Bug 46261 Context with %2F in name causes tomcat crash on shutdown', 'Context with %2F in name causes tomcat crash on shutdown\n\nSeveral years ago I worked on integrating tomcat 5.5 into our web application management infrastructure.  During the process I fixed several tomcat 5.5 bugs, but apparently never sent the fixes upstream.  Oops.\n\nOur application needs to be deployed to create a URL that looks like this:\n\n/product/customername/servlet\n\nI worked with several people on IRC to get tomcat5.5 to do this.  We had previously been using the path= parameter in the context xml file element with tomcat 4.1.  Unfortunately, it appears this feature was removed from tomcat5.5, and tomcat5.5 does not recurse into subdirectories when reading .xml context files.  The recommendation on IRC (after several suggestions which would not work for our environment) was to put %2F in the context xml file\'s name.  Such as this\n\nproduct%2Fcustomername.xml\n\nThis does work, however when you try to shutdown tomcat 6.0.18, you will get this crash:\n\nNov 9, 2008 10:56:17 PM org.apache.coyote.http11.Http11Protocol pause\nINFO: Pausing Coyote HTTP/1.1 on http-8180\nNov 9, 2008 10:56:18 PM org.apache.catalina.core.StandardService stop\nINFO: Stopping service Catalina\nNov 9, 2008 10:56:18 PM org.apache.catalina.startup.HostConfig undeployApps\nWARNING: Error while removing context [/product%2Fcustomername]\njava.lang.NullPointerException\n        at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:915)\n        at org.apache.catalina.startup.HostConfig.undeployApps(HostConfig.java:1191)\n        at org.apache.catalina.startup.HostConfig.stop(HostConfig.java:1162)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:313)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1086)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1098)\n        at org.apache.catalina.core.StandardEngine.stop(StandardEngine.java:448)\n        at org.apache.catalina.core.StandardService.stop(StandardService.java:584)\n        at org.apache.catalina.core.StandardServer.stop(StandardServer.java:744)\n        at org.apache.catalina.startup.Catalina.stop(Catalina.java:628)\n        at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:671)\nNov 9, 2008 10:56:18 PM org.apache.coyote.http11.Http11Protocol destroy\nINFO: Stopping Coyote HTTP/1.1 on http-8180', 'Joe Kislo', '2008-11-21 08:34:21 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (277, '46381', 'Bug 46381 Coerce EL expression to java.lang.Object breaks expression concatenation', 'Created  attachment 23009   [details] \nSource file\n\nI have a simple <c:set> tag with expression concatenation. This tag breaks with this stack trace:\n\norg.apache.jasper.JasperException: Unable to compile class for JSP: \n\nAn error occurred at line: 22 in the jsp file: /templates/paragraphs/notizia.jsp\nThe operator + is undefined for the argument type(s) java.lang.Object, java.lang.Object\n19:       <c:when test=\'${!empty(node.link)}\'>\n20:         <c:set value=\'${node.link}\' var=\'url\' />\n21:         <c:if test=\'${!(fn:startsWith(url,\'http\'))}\'>\n22:           <c:set value=\'${pageContext.request.contextPath}${url}\' var=\'url\' />\n23:           <c:set value=\' \' var=\'target\' />\n24:         </c:if>\n25:         <a href=\'${url}\' class=\'${target}\'>${node.testo}</a>\n\n\nStacktrace:\n	at org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)\n	at org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n	at org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:423)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n	at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:586)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n	at info.magnolia.context.WebContextImpl.include(WebContextImpl.java:191)\n	at info.magnolia.module.templating.paragraphs.JspParagraphRenderer.render(JspParagraphRenderer.java:73)\n	at info.magnolia.cms.beans.config.ParagraphRenderingFacade.render(ParagraphRenderingFacade.java:112)\n	at info.magnolia.cms.beans.config.ParagraphRenderingFacade.render(ParagraphRenderingFacade.java:91)\n	at info.magnolia.cms.taglibs.Include.doEndTag(Include.java:192)\n	at org.apache.jsp.templates.paragraphs.bloccoInfo_jsp._jspx_meth_cms_005fincludeTemplate_005f0(bloccoInfo_jsp.java:332)\n	at org.apache.jsp.templates.paragraphs.bloccoInfo_jsp._jspx_meth_cms_005fcontentNodeIterator_005f0(bloccoInfo_jsp.java:289)\n	at org.apache.jsp.templates.paragraphs.bloccoInfo_jsp._jspService(bloccoInfo_jsp.java:98)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:374)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n	at info.magnolia.context.WebContextImpl.include(WebContextImpl.java:191)\n	at info.magnolia.module.templating.paragraphs.JspParagraphRenderer.render(JspParagraphRenderer.java:73)\n	at info.magnolia.cms.beans.config.ParagraphRenderingFacade.render(ParagraphRenderingFacade.java:112)\n	at info.magnolia.cms.beans.config.ParagraphRenderingFacade.render(ParagraphRenderingFacade.java:91)\n	at info.magnolia.cms.taglibs.Include.doEndTag(Include.java:192)\n	at org.apache.jsp.templates.pages.firstlevelgruppo_jsp._jspx_meth_cms_005fincludeTemplate_005f1(firstlevelgruppo_jsp.java:428)\n	at org.apache.jsp.templates.pages.firstlevelgruppo_jsp._jspx_meth_cms_005fcontentNodeIterator_005f1(firstlevelgruppo_jsp.java:385)\n	at org.apache.jsp.templates.pages.firstlevelgruppo_jsp._jspService(firstlevelgruppo_jsp.java:115)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:374)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at info.magnolia.cms.filters.MgnlMainFilter.doFilter(MgnlMainFilter.java:100)\n	at info.magnolia.cms.filters.MgnlMainFilter.doFilter(MgnlMainFilter.java:200)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n	at info.magnolia.module.templating.renderers.JspTemplateRenderer.renderTemplate(JspTemplateRenderer.java:78)\n	at info.magnolia.cms.filters.RenderingFilter.doFilter(RenderingFilter.java:103)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.BackwardCompatibilityFilter.doFilter(BackwardCompatibilityFilter.java:72)\n	at info.magnolia.cms.filters.OncePerRequestAbstractMgnlFilter.doFilter(OncePerRequestAbstractMgnlFilter.java:62)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.InterceptFilter.doFilter(InterceptFilter.java:117)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.AggregatorFilter.doFilter(AggregatorFilter.java:111)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.security.BaseSecurityFilter.doFilter(BaseSecurityFilter.java:61)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.RepositoryMappingFilter.doFilter(RepositoryMappingFilter.java:90)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.CompositeFilter.doFilter(CompositeFilter.java:64)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:65)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.CompositeFilter.doFilter(CompositeFilter.java:64)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.VirtualUriFilter.doFilter(VirtualUriFilter.java:115)\n	at info.magnolia.cms.filters.OncePerRequestAbstractMgnlFilter.doFilter(OncePerRequestAbstractMgnlFilter.java:62)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.i18n.I18nContentSupportFilter.doFilter(I18nContentSupportFilter.java:75)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at net.sourceforge.stripes.controller.StripesFilter.doFilter(StripesFilter.java:180)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.module.cache.executor.Bypass.processCacheRequest(Bypass.java:57)\n	at info.magnolia.module.cache.filter.CacheFilter.doFilter(CacheFilter.java:118)\n	at info.magnolia.cms.filters.OncePerRequestAbstractMgnlFilter.doFilter(OncePerRequestAbstractMgnlFilter.java:62)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.module.cache.filter.GZipFilter.doFilter(GZipFilter.java:84)\n	at info.magnolia.cms.filters.OncePerRequestAbstractMgnlFilter.doFilter(OncePerRequestAbstractMgnlFilter.java:62)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:73)\n	at info.magnolia.cms.filters.CosMultipartRequestFilter.doFilter(CosMultipartRequestFilter.java:84)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.security.BaseSecurityFilter.doFilter(BaseSecurityFilter.java:61)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.security.LogoutFilter.doFilter(LogoutFilter.java:81)\n	at info.magnolia.cms.filters.OncePerRequestAbstractMgnlFilter.doFilter(OncePerRequestAbstractMgnlFilter.java:62)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.security.auth.login.LoginFilter.doFilter(LoginFilter.java:76)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.ContentTypeFilter.doFilter(ContentTypeFilter.java:80)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.ContextFilter.doFilter(ContextFilter.java:72)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlFilterChain.doFilter(MgnlFilterChain.java:71)\n	at info.magnolia.cms.filters.CompositeFilter.doFilter(CompositeFilter.java:64)\n	at info.magnolia.cms.filters.AbstractMgnlFilter.doFilter(AbstractMgnlFilter.java:71)\n	at info.magnolia.cms.filters.MgnlMainFilter.doFilter(MgnlMainFilter.java:97)\n	at info.magnolia.cms.filters.MgnlMainFilter.doFilter(MgnlMainFilter.java:200)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at it.ragno.web.filters.LocaleSyncFilter.doFilter(LocaleSyncFilter.java:82)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)\n	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)\n	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)\n	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n	at java.lang.Thread.run(Thread.java:619)', 'Fabian Necci', '2008-12-11 07:13:00 UTC', 'tomcat_attachment/attachment 23009');
INSERT INTO `tomcatbody` VALUES (278, '46397', 'Bug 46397 Potential memory leak with TagHandlers and JspIdConsumer', 'Created  attachment 23022   [details] \ntest case app\n\nAs a follow up on the thread on the mailing list, here\'s my summary again:\n\nSince the JSP Spec says that TagHandlers implementing JspIdConsumer may not be reused, I was expecting them to be collected after the servlet finishes\nprocessing. A few experiments showed that that is not the case.\nAfter delving into the details of the servlet code generated for JSP\npages I discovered that the methods instantiating TagHandlers also\nstore them in TagHandlerPools using #reuse().\n\nI ran some more experiments to see what  \nhappens with these TagHandlers. My setup is  \nTomcat 6 + MyFaces + JSF CarDemo, and I\'m using AspectJ to trace  \ncreation and garbage collection of objects implementing JspIdConsumer.  \nMy experiments indicate the following:\n\n1. JspIdConsumer instances do NOT get garbage collected after a page  \nhas finished processing.\n2. JspIdConsumer instances do NOT always get garbage collected after a  \nsession times out.\n3. SOME JspIdConsumer instances DO get garbage collected when a given  \nJSP-generated page is reloaded or accessed in a different session.\n\nTo obtain these results I ran Tomcat with very little heap memory (it  \nseems it starts fine with the 64M default), loaded the car demo in  \nseveral browser sessions and ran through all the other JSP/Servlet  \nexamples that come with Tomcat to increase the memory consumption and  \ntrigger GC. Unfortunately I don\'t have the time and tools to do a  \nproper stress test.\n\nTo provide some sort of simpler test case, I attach a WAR to use, but you still need to put the runtime library of AspectJ (aspectjrt.jar) on the classpath when running Tomcat.\nThe behavior I observe is that whenever I load/reload the page, the  \nJspIdConsumer objects get allocated, and some, but never all of\nthem get GC\'d. You should see messages on the console/log like\n\nAdding JspIdConsumer:<someClassName>:<itsHashCode>:<theJspId>\n\nand\n\nRemoved <someJspId>\n\nYou will see three \'Adding messages\' for every instance created (it\'s  \na mess to track this properly),\nand you should see one \'Removed\' message for every GC\'d instance.\nWhen I run grep | wc on the output, the \'distance\' between the number  \nof created and GC\'d object grows over time and reloads of the test page.\nI had this running for a bit, trying to see if after a session timeout  \nthe remaining instances would be GC\'d, but they didn\'t. I don\'t know  \nwhat to make of this, but it feels like Tomcat is holding on to some  \nof the instances for too long for no good reason.\n\nIn any case, considering the specification of JspIdConsumer, which  \nstates that instances may never be reused, the caching of these  \ninstances as it is done in current JSPs is unnecessary, and since  \nthese instances don\'t seem to be GC\'d, this seems to be a memory leak.', 'Jochen Wuttke', '2008-12-15 00:43:53 UTC', 'tomcat_attachment/attachment 23022');
INSERT INTO `tomcatbody` VALUES (279, '46403', 'Bug 46403 Persistent cookies written by 6.0.18 do not work in Internet Explorer or Safari', 'This blog post shows up in Google when searching for this problem, and is a better explanation that I can give here:\n\n http://cephas.net/blog/2008/11/18/tomcat-6018-version-1-cookies-acegi-remember-me-and-ie/ \n\nTo summarize, in 6.0.18, the way Tomcat writes persistent cookie headers was changed from:\n\nSet-Cookie: yankeessuck=YWFyb246MTIyODI0ODEwMjk5NjoyOGM5ODc4YzExOGZiOGZjZTBkZDE0ZTA1ZWRhZTM3Nw==; Expires=Thu, 19-Nov-2009 02:29:29 GMT;\n\nto:\n\nSet-Cookie: yankeessuck=\'YWFyb246MTIyODI0ODEwMjk5NjoyOGM5ODc4YzExOGZiOGZjZTBkZDE0ZTA1ZWRhZTM3Nw==\'; Version=1; Max-Age=31536000;\n\nThe value was enclosed in quotes, a \'Version=1\' parameter was added, and the Expires parameter was replaced with a Max-Age parameter.\n\nThough cookies are written correctly to specification, Internet Explorer (6 and 7) and Safari do not support the Max-Age parameter. As a result, an application writing persistent cookies in this version of Tomcat won\'t work for Internet Explorer or Safari.', 'Matt Wiseley', '2008-12-15 13:46:47 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (280, '46408', 'Bug 46408 Invalid cast in SecurityUtil', 'In case of PrivilegedActionException thrown in:\n\n    private static void execute(final Method method,\n                                final Object targetObject, \n                                final Object[] targetArguments,\n                                Principal principal)\n\nmethod, there is a false assumption in catch block, that PrivilegedActionException.getException() will return InvocationTargetException. It could be also IllegalAccessException and possibly other types of exceptions as well.\n\nHere is the stack trace provoked on catalina shutdown when enabled security manager:\njava.lang.ClassCastException: java.lang.IllegalAccessException cannot be cast to java.lang.reflect.InvocationTargetException\n        at org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:278)\n        at org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:218)\n        at org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:178)\n        at org.apache.catalina.core.ApplicationFilterConfig.release(ApplicationFilterConfig.java:326)\n        at org.apache.catalina.core.StandardContext.filterStop(StandardContext.java:3744)\n        at org.apache.catalina.core.StandardContext.stop(StandardContext.java:4513)\n        at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:924)\n        at org.apache.catalina.startup.HostConfig.undeployApps(HostConfig.java:1191)\n        at org.apache.catalina.startup.HostConfig.stop(HostConfig.java:1162)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:313)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1086)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1098)\n        at org.apache.catalina.core.StandardEngine.stop(StandardEngine.java:448)\n        at org.apache.catalina.core.StandardService.stop(StandardService.java:584)\n        at org.apache.catalina.core.StandardServer.stop(StandardServer.java:744)\n        at org.apache.catalina.startup.Catalina.stop(Catalina.java:628)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.stop(Bootstrap.java:300)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.commons.daemon.support.DaemonLoader.stop(DaemonLoader.java:200)', 'Kazimierz Pogoda', '2008-12-16 15:22:51 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (281, '46247', 'Bug 46247 SVN property patches', 'Created  attachment 22905   [details] \nPatch for tomcat trunk to set SVN properties\n\nScript file that can be used to set some missing properties on Tomcat trunk.\n\nUsable on Unix and Windows; best run from the OS that last updated the file.', 'Sebb', '2008-11-19 18:16:54 UTC', 'tomcat_attachment/attachment 22905.txt');
INSERT INTO `tomcatbody` VALUES (282, '42693', 'Bug 42693 JSP-Generation error with recursive tagfile structure', 'addendum: it\'s Version 6.13 (not available in combobox above)\n\nscenario:\n=========\na menu is decribed by a tree structure;\nrendering the menu is done by a tagfile \'render_menuitem\', which renders the\ncurrent item either as a leaf item (clicking on it causes an action) or as a\nnode item (clicking on it opens another next-level submenu);\nrendering the submenu is done by calling the tagfile again from within its body;\nthis worked fine with tomcat 5.0.x and 5.5.x\n\nto make it clear see the following pseudo code (the original code is to\nvoluminous): \ntagfile \'render_menuitem.tagx\':\n<jsp:root ...>\n   <jsp:directive.attribute name=\'menu_item\'/>\n   <c:choose>\n      <c:when test=\'${menu_item.isNode}\n         <div>node: ${menu_item.label}</div>\n         <c:forEach var=\'sub_item\' items=\'menu_item.children\'>\n            <!-- THIS IS GOING TO CAUSE THE PROBLEM WITH TOMCAT6: -->\n            <tags:render_menuitem menu_item=\'${sub_item}\'/>\n         </c:forEach>\n      <c:when>\n      <c:otherwise>\n         <div>leaf: ${menu_item.label}</div>\n      </c:otherwise>\n   </c:choose>\n</jsp:root>\n\nfaulty behaviour:\n================\nwith tomcat 6.0.13, the generated Java-Source for the tagfile reveals, that the\nbody of the doTag() method is empty and therefore emits no html; the compilation\nitself was silently done, no error or warning was shown in the logfiles.', 'Frank Hofmann', '2007-06-18 10:10:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (283, '42707', 'Bug 42707 add host alias using jmx doesn\'t take affect until restart', 'Adding a host alias using jmx doesn\'t take affect until tomcat is restarted.\n\nTo test it I started tomcat using \n-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=6702\n-Dcom.sun.management.jmxremote.authenticate=false\n-Dcom.sun.management.jmxremote.ssl=false\n\nI created a webapps_test/test/index.html\nI created a new host \n      <Host\n          appBase=\'webapps_test\'\n          name=\'test.localdomain\'>\n      </Host>\n\nI tested the url  http://test.localdomain:8080/test/  and the index page showed up\nas expected.\n\nI used jconsole under Catalina/Host/test.localdomain/Operations/addAlias and\nadded test1.localdomain (I edited my /etc/hosts file to map test.localdomain and\ntest1.localdomain to 127.0.0.1).\n\nI went to the url  http://test1.localdomain:8080/test/  and instead of the\nindex.html page I received a 404 error. I tried starting and stopping the host\nfrom within jmx, it didn\'t help, I tried Catalina/Server/Operations/storeConfig\nand starting and stopping the host and that didn\'t help either.\n\nI tested with the following versions for the server\njdk 1.6.0_01-b06\ntomcat 5.5.20, 6.0.10, 6.0.13\n\nfor the client I was using the jdk 1.6.0_01-b06 jconsole, as well as a custom\napplication I had written as well as the the \'administration web application 5.5.23\'\n\nall the combinations above had similar results.\n\nI will briefly mention that in tomcat 6.0.10/13 I was unable to save the\nconfiguration due to an error :\n   Jun 20, 2007 5:26:11 PM org.apache.catalina.core.StandardServer storeConfig\n   SEVERE: StoreConfig mbean not registeredCatalina:type=StoreConfig\nI will open a separate bug for that.\n\nIn tomcat 5 I was able to save the config.\n\nIf I restart tomcat5 after saving the config (using catalina.sh stop / start)\nthe new alias works properly. \n\nLikewise, if I edit the tomcat 6 conf/server.xml and add the alias entry in\nmanually and restart tomcat, the url  http://test1.localdomain:8080/test/  works fine.\n\nSo, the main problem is that adding an alias dynamically doesn\'t seem to work.', 'Ted Leung', '2007-06-20 14:46:49 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (284, '42409', 'Bug 42409 Extra response headers not sent when using custom error page', 'If I create a servlet that does the following:\n\nresponse.setHeader(\'X-BUG\', \'Value\');\nresponse.sendError(HttpServletResponse.SC_BAD_REQUEST);\n\nIf I use the tomcat default error page for 400 responses, the response will\ncontain the header \'X-BUG\' with value \'Value\'.\n\nHowever, if I create a custom error page, the response headers do NOT contain\nthe \'X-BUG\' header in the response. \n\nHere is my web.xml, for example:\n\n<error-page>\n    <error-code>400</error-code>\n    <location>/400.jsp</location>\n</error-page>\n\n400.jsp contains plain html:\n\n<html>\n<body>\n<h3>Custom 400 error page</h3>\n</body>\n</html>', 'Hayden James', '2007-05-14 09:03:17 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (285, '46051', 'Bug 46051 Servlet response writer does not respect line.separator system property', 'Created  attachment 22763   [details] \nremove special CoyoteWriter println handling\n\npublic void doGet(final HttpServletRequest request, final HttpServletResponse response) throws ServletException, IOException {\n  response.setContentType(\'text/plain\');\n  PrintWriter writer = response.getWriter();\n  writer.print(\'hello world\');\n  writer.println(); //FIXME ignores System.getProperty(\'line.separator\') and always outputs  r n\n  return;\n}\n\nThis means that if you use a servlet Writer on a Unix system to output any text based data format which is defined as requiring Unix format line endings (\' n\'), that data will be corrupted.\n\nThis appears to be because org.apache.catalina.connector.CoyoteWriter does:\n--------\nprivate static final char[] LINE_SEP = { \' r\', \' n\' };\n\npublic void println() {\n  write(LINE_SEP);\n}\n--------\n\nThis used to work in Tomcat 4.\n\nLooking at the old code at  http://svn.apache.org/repos/asf/tomcat/archive/tc4.0.x/tags/tc4.0.6/connectors/coyote/src/java/org/apache/coyote/tomcat4/CoyoteWriter.java  it appears to defer line endings to the PrintWriter base class which does the right thing.\n\nWas this change was made to output HTTP headers properly or something?  It specifically seems to override the default behavior to do this.  I don\'t know the code well enough to determine if the attached patch to revert to the default behavior again would break something?\n\nThanks for your consideration.', 'Chris Hubick', '2008-10-21 10:54:42 UTC', 'tomcat_attachment/attachment 22763.txt');
INSERT INTO `tomcatbody` VALUES (286, '46096', 'Bug 46096 DefaultAnnotationProcessor.processAnnotations should use doPrivileged to call getDeclaredFields', 'If tomcat is running with a SecurityManager, and a JSP uses PageContext.forward, DefaultAnnotationProcessor code can be called with untristed code on the call stack.\n\nThe processAnnotations method contains the line:\n\n   Field[] fields = instance.getClass().getDeclaredFields();\n\ngetDeclaredFields() is subject to security checks so this throws a java.security.AccessControlException.\n\nDefaultAnnotationProcessor is part of the code in the catlina lib directory, which is granted AllPermissions in the standard policy file.  However, because there is untrusted JSP code on the stack, these permissions are not used.\n\nThe call to getDeclaredFields() should be wrapped in an AccessController.doPrivileged call to avoid the exception.', 'Richard Evans', '2008-10-27 05:44:55 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (287, '45933', 'Bug 45933 Error processing TLD file in webapp with XML parser', 'Along the same lines with CR 29936, com.apache.catalina.startup.TldConfig.tldDigester has an issue with initialization.  Basically, the TldConfig\'s parser can be initialized with the webapp\'s XML parser, which causes a security problem, since it has permission issues with reading files.  This is caused by a similar scenario to CR 29936:\n\n1) Remove all stock webapps that come with the standard installation.  This\nincludes the ones in server/webapps.  Remember to remove the configurations in\nconf/Catalina.\n2) Add a webapp that has a XML parser located in WEB-INF/lib.  For instance,\none from sourceforge or Apache Xerces.\n3) Add a library containing a .tld file in META-INF like Spring.\n4) In order to actually have a log containing the error, you need to enable logging.  For example, by following the instructions laid out in  http://tomcat.apache.org/tomcat-5.5-doc/logging.html .  I used log4j.\n5) Start the appserver in secure mode.\n\nYou should see an error in the log similar to the following:\n\nERROR main org.apache.catalina.startup.TldConfig - Exception processing TLD META-INF/spring-form.tld in JAR at resource path TOMCAT_PATH/webapps/MY_WAR/WEB-INF/lib/spring.jar in context /MY_WAR\njava.security.AccessControlException: access denied (java.io.FilePermission TOMCAT_PATH/common/lib/jsp-api.jar read)\n        at java.security.AccessControlContext.checkPermission(AccessControlContext.java:323)\n        at java.security.AccessController.checkPermission(AccessController.java:546)\n        at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\n        at java.lang.SecurityManager.checkRead(SecurityManager.java:871)\n        at java.util.zip.ZipFile.<init>(ZipFile.java:109)\n        at java.util.jar.JarFile.<init>(JarFile.java:133)\n        at java.util.jar.JarFile.<init>(JarFile.java:70)\n        at sun.net.www.protocol.jar.URLJarFile.<init>(URLJarFile.java:72)\n        at sun.net.www.protocol.jar.URLJarFile.getJarFile(URLJarFile.java:48)\n        at sun.net.www.protocol.jar.JarFileFactory.get(JarFileFactory.java:53)\n        at sun.net.www.protocol.jar.JarURLConnection.connect(JarURLConnection.java:104)\n        at sun.net.www.protocol.jar.JarURLConnection.getInputStream(JarURLConnection.java:132)\n        at java.net.URL.openStream(URL.java:1009)\n        at org.apache.xerces.impl.XMLEntityManager.setupCurrentEntity(Unknown Source)\n        at org.apache.xerces.impl.XMLEntityManager.startEntity(Unknown Source)\n        at org.apache.xerces.impl.XMLEntityManager.startDTDEntity(Unknown Source)\n        at org.apache.xerces.impl.XMLDTDScannerImpl.setInputSource(Unknown Source)\n        at org.apache.xerces.impl.XMLDocumentScannerImpl$DTDDispatcher.dispatch(Unknown Source)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1562)\n        at org.apache.catalina.startup.TldConfig.tldScanStream(TldConfig.java:514)\n        at org.apache.catalina.startup.TldConfig.tldScanJar(TldConfig.java:472)\n        at org.apache.catalina.startup.TldConfig.execute(TldConfig.java:307)\n        at org.apache.catalina.core.StandardContext.processTlds(StandardContext.java:4307)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4144)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:760)\n        at org.apache.catalina.core.ContainerBase.access$000(ContainerBase.java:122)\n        at org.apache.catalina.core.ContainerBase$PrivilegedAddChild.run(ContainerBase.java:144)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:738)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:831)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:720)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:490)\n        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1150)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:736)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)\n        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:448)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:700)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:552)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)\n\nNote that if you restart the appserver, you will need to remove the webapp\'s TLD cache located at \'TOMCAT_PATH/work/Catalina/localhost/MY_WAR/tldCache.ser\' to reproduce the error again.', 'Eddy Chan', '2008-10-01 23:51:18 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (288, '45851', 'Bug 45851 FarmWarDeployer fails to properly unpack copied war on target node', 'Created  attachment 22616   [details] \nfiles used to reproduce issue\n\nWhen trying to deploy a war to a cluster, it seems that the war will deploy locally when placed in the listener directory, however, it seems that either there is some corruption when moving the war across the wire, or the deployer on the target node is not able to properly unpack and read the files inside.\n\nPertinent portion of the log from the target node is attached.\n\nI can provide any other info as needed, but not sure what else would be pertinent.  The test.war is simply a war\'d copy of the default Tomcat Manager web app.\n\nTo reproduce:\n\n1. Configure two nodes two make up a SimpleTCPCluster (version 6.0.18 was used)\n2. From either node, drop test.war into the listen directory\n\nResults:\n* test.war will be deployed locally\n* test.war will be copies to the webapps directory on the target\n* test.war will not fully deploy on the target\n\nExpected results:\n* war unpacked and deployed locally\n* copied to each node in the cluster\n* war unpacked and deployed on each node of the cluster', 'Paul McGurn', '2008-09-19 22:17:57 UTC', 'tomcat_attachment/attachment 22616.txt');
INSERT INTO `tomcatbody` VALUES (289, '45026', 'Bug 45026 Custom HTTP-Error codes get remapped to 500er codes', 'We use Apache 2.2.8 with mod_JK 1.2.26 as a load-balancer for a Tomcat 5.5 cluster.\nWe use Custom HTTP-Error codes like 450 for authentication-purposes. Those\ncodes get remapped to 500.\nThe Error-Code 450 is in the RFC2616 described as valid return code so this is\na bug.\n\nThe custom error-codes worked fine in Apache 1.3.41 with MOD_JK/1.2.25.\n\nYou can easily reproduce this bug by writing a simple jsp-page with the following\nline:\n<%response.setStatus(450);%>', 'Jan Schulte', '2008-05-18 04:16:12 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (290, '45419', 'Bug 45419 Return Accept-Ranges from DefaultServlet', 'Currently the DefaultServlet accepts the \'Ranges\' request header, but doesn\'t indicate this in its response by returning \'Accept-Ranges: bytes\'. Although this is not required in HTTP/1.1, setting the header is required in order for the Adobe Acrobat plugin to correctly handle Linearized PDF\'s (which can speed download by allowing random access to a PDF file).\n\nAlthough it\'s not strictly necessary according to the specification I can\'t think of any reason why this header is not safe to set in a response from DefaultServlet, which is always dealing with static files, and not doing so has a negative impact on serving large PDF files - so I\'m filing it as a bug rather than an RFE.', 'Mike Bremford', '2008-07-17 07:38:07 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (291, '45441', 'Bug 45441 Matching of relevant servlet filters fails when request is forwarded...', 'I ran into a situation where Tomcat will not execute appropriate filters on a request that has been forwarded.\n\nI\'m using the handy URLRewriteFilter implementation (from tuckey.org).  When I forwarded a request internally, filters that had a matching url-pattern (in the web.xml file) and with a dispatcher setting of both REQUEST and FORWARD were not invoked.\n\nOn tracing the code (hours later), I found that the problem lies inside the ApplicationDispatcher code.  It set the DISPATCHER_REQUEST_PATH_ATTR state attribue to be the servletPath.  That meant that only matches using the servlet path would match, but longer (more exact) urls would fail to match.\n\nFor example, using the following filter mapping:\n\n<filter-mapping>\n   <filter-name>my-filter</filter-name>		   \n   <url-pattern>/app/level/mycode.do</url-pattern>\n   <dispatcher>REQUEST</dispatcher> \n   <dispatcher>FORWARD</dispatcher>\n</filter-mapping>\n\nwould not match a request that was forwarded to /app/level/mycode.do, which it should! \n\nChanging the url pattern to be \'/app/*\' would match, but \'/app/level/*\' would not, since the servletPath was /app in this example.\n\nThe fix for this is quite simple.  In the ApplicationDispatcher.java code, in the method processRequest() (which is only called for forwards), change the following statement:\n\nstate.outerRequest.setAttribute\n   (ApplicationFilterFactory.DISPATCHER_REQUEST_PATH_ATTR,\n   servletPath);\n\nto use requestURI instead as follows:\n\nstate.outerRequest.setAttribute\n   (ApplicationFilterFactory.DISPATCHER_REQUEST_PATH_ATTR,\n   requestURI );\n\nThis resolves the problem and let all the examples above correctly match and run the filter on a forward.\n\nI believe includes will also be broken in the same manner. Similar changes to the doInclude() method in ApplicationDispatcher.java will likely resolve that issue as well, though I have not tested this personally.\n\nBe nice to see this resolved in 6.0.17+.\n\nThanks!\n\n....Andrzej', 'Andrzej Taramina', '2008-07-20 10:54:40 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (292, '45618', 'Bug 45618 Selector is not closed.', 'In the class ParallelNioSender [1], a Selector (selector) is declared as a field. In line 60, it is opened (selector = Selector.open()). However, it is not closed in any situations. As shown by its Javadoc [2], it has a close() method, and this method should be called to close the selector.\n\n\n[1] http://www.google.com/codesearch?hl=en&q=lang:java+open+java.nio.channels.Selector+show:hsMlF-2s6UU:ZSXpd2XI4bI:dK-_LkuTzG4&sa=N&ct=rx&cd=4&cs_p=http://archive.apache.org/dist/tomcat/tomcat-6/v6.0.0/src/apache-tomcat-6.0.0-src.tar.gz&cs_f=apache-tomcat-6.0.0-src/java/org/apache/catalina/tribes/transport/nio/ParallelNioSender.java&cs_p=http://archive.apache.org/dist/tomcat/tomcat-6/v6.0.0/src/apache-tomcat-6.0.0-src.tar.gz&cs_f=apache-tomcat-6.0.0-src/java/org/apache/catalina/tribes/transport/nio/ParallelNioSender.java \n\n[2] http://java.sun.com/j2se/1.5.0/docs/api/java/nio/channels/Selector.html ', 'Hao Zhong', '2008-08-11 22:45:15 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (293, '45666', 'Bug 45666 JspContextWrapper contains infinite loop in include(String relativeUrlPath, boolean flush)', 'public void include(String relativeUrlPath, boolean flush)\n			throws ServletException, IOException {\n		include(relativeUrlPath, false); // XXX\n	}\n\njust calls itself it seems. Perhaps this should be (just a guess):\n\npublic void include(String relativeUrlPath, boolean flush)\n			throws ServletException, IOException {\n		invokingJspCtxt.include(relativeUrlPath, false); // XXX\n	}\n\nThis came up for me when I had a .tag file that had an include in it. \n\nI was using Tomcat 5.5 but looking at the source of JspContextWrapper.java it looks like this issue is in 5.5 as well as 6 (and the svn trunk).', 'Tom Wadzinski', '2008-08-21 06:47:17 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (294, '45648', 'Bug 45648 Function \'f:length\' not found', 'This error happens when accessing the Proxy Connectors page in an Apache Archiva 1.1.1 installation:  http://localhost:8080/archiva/admin/proxyConnectors.action \n\n\nThis error happens against a build exported from trunk on 2008/08/14 (I\'m using this build, to work around bug  https://issues.apache.org/bugzilla/show_bug.cgi?id=45511  - EL \'empty\' keyword does not work, which also happens with Archiva). This error seems very similar to 45511.\n\n\n\nSignificant part of the stack trace:\n\norg.apache.jasper.JasperException: /WEB-INF/jsp/admin/proxyConnectors.jsp(76,2) \'${fn:length(repository.value)}\' contains invalid expression(s): javax.el.ELException: Function \'f:length\' not found\n	org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:40)\n	org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:407)\n	org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:198)\n	org.apache.jasper.compiler.Validator$ValidateVisitor.checkXmlAttributes(Validator.java:1132)\n	org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:813)\n	org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1512)\n	org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2343)\n	org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2393)\n	org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:832)\n	org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1512)\n	org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2343)\n	org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2393)\n	org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:832)\n	org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1512)\n	org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2343)\n	org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2393)\n	org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:832)\n	org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1512)\n	org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2343)\n	org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2393)\n	org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2399)\n	org.apache.jasper.compiler.Node$Root.accept(Node.java:489)\n	org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2343)\n	org.apache.jasper.compiler.Validator.validate(Validator.java:1713)\n	org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:166)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:315)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:295)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:282)\n	org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:312)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:321)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:268)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	com.opensymphony.webwork.dispatcher.ServletDispatcherResult.doExecute(ServletDispatcherResult.java:114)\n	com.opensymphony.webwork.dispatcher.WebWorkResultSupport.execute(WebWorkResultSupport.java:143)\n...', 'Carlos Costa e Silva', '2008-08-18 19:54:44 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (295, '45691', 'Bug 45691 Jasper creates duplicate variable names', 'Sometimes a JSP\'s Java code, which have been generated by Jasper, has duplicate variable names. Therefore the JSP cannot be compiled and tomcat delivers an HTTP status code 500. You get an error message like this\n\norg.apache.jasper.JasperException: Unable to compile class for JSP: \nAn error occurred at line: 10 in the jsp file: /test1.jsp\nDuplicate local variable _jspx_temp0\n7: 		<c:set var=\'a\'>\n8: 			<jsp:attribute name=\'value\'><%= new java.util.Date().toString() %></jsp:attribute>\n9: 		</c:set>\n10: 		<c:set var=\'b\'>\n11: 			<jsp:attribute name=\'value\'><%= new java.util.Date().toString() %></jsp:attribute>\n12: 		</c:set>\n13: 		<h1>Test 1</h1>\n\nThe reason of this error is the generation of variable names like _jspx_temp0, which are created for <jsp:attribute> tags. At the beginning of parsing a JSP file a counter is reset to 0. Every time an <jsp:attribute> tag occurs, the counter is used to build a variable name _jspx_temp<counter>. Thereafter the counter will be incremented. Unfortunately the counter is a static member of the JspUtil class. Suppose there\'s a thread 1, which created _jspx_temp4. The counter is 5. Now a second thread (thread 2) starts and resets the counter. Afterwards thread 2 creates _jspx_temp0 to _jspx_temp3. The counter is 4 by now. Then thread 2 stops and thread 1 continues. The next variable\'s name in thread 1 will be _jspx_temp4, which already exists. Therefore the generated java class cannot be compiled.', 'Stefan Birkner', '2008-08-26 07:23:33 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (296, '43327', 'Bug 43327 Socket bind fails on tomcat startup when using apr', 'I\'m running debian sid, kernel 2.6.22 and use tomcat 6.0.14 together with apr\n1.2.11. no special tomcat configuration (out of the box).\nOn start up of tomcat I get the following error log:\n\nDebugging apr revealed a problem with IPV6:\napr_socket_create() assigns a AF_INET6 socket,\napr_socket_bind tries to bind a AF_INET address which fails.\n\nINFO: Loaded Apache Tomcat Native library 1.1.10.\nSep 7, 2007 6:05:16 PM org.apache.catalina.core.AprLifecycleListener init\nINFO: APR capabilities: IPv6 [true], sendfile [true], accept filters [false],\nrandom [true].\nSep 7, 2007 6:05:16 PM org.apache.coyote.http11.Http11AprProtocol init\nSEVERE: Error initializing endpoint\njava.lang.Exception: Socket bind failed: [22] Invalid argument\n    at org.apache.tomcat.util.net.AprEndpoint.init(AprEndpoint.java:612)\n    at org.apache.coyote.http11.Http11AprProtocol.init(Http11AprProtocol.java:121)\n    at org.apache.catalina.connector.Connector.initialize(Connector.java:1059)\n  \nregards\nerik', 'Erik Moller', '2007-09-07 07:22:31 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (297, '45608', 'Bug 45608 Race conditions on field countAllocated of class org.apache.catalina.core.StandardWrapper', 'We found field countAllocated are accessed by allocate() and deallocate() without any protections by locks.\n\nHere is a trace log,\n\n  Thread http-8081-1 id: 23 : READ\n      [org.apache.catalina.core.StandardWrapper : allocate : 820]\n      [org.apache.catalina.core.StandardWrapperValve : invoke : 129]\n      [org.apache.catalina.core.StandardContextValve : invoke : 175]\n      [org.apache.catalina.core.StandardHostValve : invoke : 128]\n      [org.apache.catalina.valves.ErrorReportValve : invoke : 104]\n      [org.apache.catalina.core.StandardEngineValve : invoke : 109]\n      [org.apache.catalina.connector.CoyoteAdapter : service : 261]\n      [org.apache.coyote.http11.Http11Processor : process : 844]\n      [org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler : process : 581]\n      [org.apache.tomcat.util.net.JIoEndpoint$Worker : run : 447]\n      [java.lang.Thread : run : 735]\n\n  Thread http-8081-4 id: 26 : WRITE\n\n      [org.apache.catalina.core.StandardWrapper : deallocate : 871]\n      [org.apache.catalina.core.StandardWrapperValve : invoke : 298]\n      [org.apache.catalina.core.StandardContextValve : invoke : 175]\n      [org.apache.catalina.core.StandardHostValve : invoke : 128] \n      [org.apache.catalina.valves.ErrorReportValve : invoke : 104] \n      [org.apache.catalina.core.StandardEngineValve : invoke : 109]\n      [org.apache.catalina.connector.CoyoteAdapter : service : 261]\n      [org.apache.coyote.http11.Http11Processor : process : 844]\n      [org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler : process : 581]\n      [org.apache.tomcat.util.net.JIoEndpoint$Worker : run : 447]\n      [java.lang.Thread : run : 735]\n\nThread http-8081-4 and http-8081-1 will access countAllocated in parallel.  Since increment and decrement is *NOT* atomic, we think it is a potential race condition.', 'Yao Qi', '2008-08-10 21:27:37 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (298, '41407', 'Bug 41407 CLIENT-CERT Authentication with JAASRealm not working', 'I tried to config my webapp to authenticate user by CLIENT-CERT auth method.\n\nI verified my JAAS LoginModule by using \'BASIC\' to auth method and successfully \nauthenticated user login.\n\nAfter studying Tomcat 5.5.20 source, I found that the problem is caused by the \nRealmBase.java and JAASRealm.java.\n\nif CLIENT-CERT auth method is used, SSLAuthenticator will call the :\n\n  JAASRealm.authenticate(X509Certificate certs[])\n\nAs JAASRealm didn\'t override authenticate(X509Certificate certs[]), RealmBase\'s \nauthenticate will be used and it will only validate the certs and then call\ngetPrincipal(X509Certificate) and then getPrincipal(String) is being called to \nget the Principal. However, in JAASRealm, this function always return null.\n\nThat means Tomcat can\'t use JAASRealm with CLIENT-CERT auth method.\n\nThanks\nButler', 'Butler', '2007-01-18 18:33:49 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (299, '45591', 'Bug 45591 NullPointerException during shutdown in JKMain.pause()', 'On startup, if Tomcat discovers that the main port is already bound to another process, it fails and tries to execute the shutdown code.  In some situations (I\'m not sure which), the org.apache.jk.server.JKMain instance variable wEnv is null at this point, which causes a NullPointerException when JKMain.pause() is called (see stacktrace below).  Since this is occurring within a shutdown hook thread, it can result in a dirty shutdown of the JVM.  I\'ve observed this with Tomcat 5.5.20, but I looked over the code in 5.5.26 and it looks like the same problem is still present.\n\nFortunately, the solution is very simple.  Just add the following if test at the beginning of JKMain.pause():\n\n        if (wEnv == null) {\n          return;\n        }\n\n\nStacktrace:\nSEVERE: StandardServer.await: create[8006]: \njava.net.BindException: Address already in use: JVM_Bind\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:359)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at org.apache.catalina.core.StandardServer.await(StandardServer.java:372)\n	at org.apache.catalina.startup.Catalina.await(Catalina.java:615)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:575)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:585)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:294)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:432)\nAug 7, 2008 3:25:34 PM org.apache.coyote.http11.Http11BaseProtocol pause\nINFO: Pausing Coyote HTTP/1.1 on http-8000\nAug 7, 2008 3:25:34 PM org.apache.catalina.connector.Connector pause\nSEVERE: Protocol handler pause failed\njava.lang.NullPointerException\n	at org.apache.jk.server.JkMain.pause(JkMain.java:678)\n	at org.apache.jk.server.JkCoyoteHandler.pause(JkCoyoteHandler.java:162)\n	at org.apache.catalina.connector.Connector.pause(Connector.java:1031)\n	at org.apache.catalina.core.StandardService.stop(StandardService.java:491)\n	at org.apache.catalina.core.StandardServer.stop(StandardServer.java:743)\n	at org.apache.catalina.startup.Catalina.stop(Catalina.java:601)\n	at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:644)', 'Matt Passell', '2008-08-07 12:35:38 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (300, '45453', 'Bug 45453 JDBCRealm.getRoles bad synchronization causes hangs w/ DIGEST authentication', 'JDBCRealm.getRoles bad synchronization causes hangs w/ DIGEST authentication\n\nJDBCRealm caches PreparedStatement preparedRoles. That, and missing synchronization in JDBCRealm and/or DigestAuthenticator allow two threads to call getRoles simultaneously so that T1 will do stmt.executeQuery() while T2 does stmt.setString(1, userName) plus another .executeQuery() on the same PreparedStatement object.\n\nIn the worst case, the JDBC driver gets confused by this, and blocks forever waiting for server response, causing all other threads that try to access DB hang. (This was observed with PostgreSQL 8.3-603-jdbc4 JDBC driver)\n\norg.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:451)\norg.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:350)\norg.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:254)\norg.apache.catalina.realm.JDBCRealm.getRoles(JDBCRealm.java:631)\norg.apache.catalina.realm.JDBCRealm.getPrincipal(JDBCRealm.java:596)\norg.apache.catalina.realm.RealmBase.authenticate(RealmBase.java:399)\norg.apache.catalina.authenticator.DigestAuthenticator.findPrincipal(DigestAuthenticator.java:283)\norg.apache.catalina.authenticator.DigestAuthenticator.authenticate(DigestAuthenticator.java:176)', 'Santtu Hyrkkö', '2008-07-22 02:25:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (301, '42727', 'Bug 42727 CoyoteReader readLine returns null for some post request bodies that are a multiple of MAX_LINE_LENGTH in size', 'i have a webapp running on jboss-4.0.5.GA/apache-tomcat-5.5.20 that reads in \nthe http post request body and processes it.\n\ni noticed that for request bodies that didn\'t contain line separators and that \nhad sizes that were exact multiples of \norg.apache.catalina.connector.CoyoteReader.MAX_LINE_LENGTH (4096), i was \nreceiving null when calling org.apache.catalina.connector.CoyoteReader.readLine\n().\n\ni believe that the problem is at line 155 in \norg.apache.catalina.connector.CoyoteReader, where on the last iteration through \nthe loop, \'pos\' does equal zero and null is returned even though data has been \naggregated.\n\nhere\'s a command to run in cygwin to easily reproduce the problem:\nfor requestSize in 4095 4096 4097 8191 8192 8193; do dd if=/dev/zero bs=1c \ncount=$requestSize | tr \' 000\' \'A\' | curl --data-binary @- \n http://localhost:8080/DebugJboss/DebugServlet  > $requestSize.txt; done;\n\noutput from directory listing (size filename):\n4095 4095.txt\n   0 4096.txt\n4097 4097.txt\n8191 8191.txt\n   0 8192.txt\n8193 8193.txt\n\nhere\'s the bulk of the servlet code i used to reproduce the problem:\npublic class DebugServlet extends HttpServlet {\n	protected void doPost(HttpServletRequest arg0, HttpServletResponse arg1)\n			throws ServletException, IOException {\n		BufferedReader br = arg0.getReader();\n		Writer writer = arg1.getWriter();\n		String line = null;\n		while ((line = br.readLine()) != null) {\n			writer.write(line);\n		}\n		writer.close();\n		br.close();\n	}\n}\n\nit appears that a workaround is to wrap the requests\'s input stream instead:\nBufferedReader br = new BufferedReader(new InputStreamReader(arg0.getInputStream\n()));', 'mike', '2007-06-23 06:29:58 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (302, '42722', 'Bug 42722 Potential NullPointerException in org.apache.catalina.servlets.CGIServlet', 'There is a potential NPE in CGIServlet, even if it\'s unlikely it may happen.\n\nThe following patch resolves this problem:\n\nIndex:\nF:/Workspace/Apache2/tomcat6/java/org/apache/catalina/servlets/CGIServlet.java\n===================================================================\n---\nF:/Workspace/Apache2/tomcat6/java/org/apache/catalina/servlets/CGIServlet.java\n( revision 548385 )\n+++\nF:/Workspace/Apache2/tomcat6/java/org/apache/catalina/servlets/CGIServlet.java\n(working copy)\n@@ -1631,7 +1631,6 @@\n              * with major modifications by Martin Dengler\n              */\n             Runtime rt = null;\n-            InputStream cgiOutput = null;\n             BufferedReader commandsStdErr = null;\n             BufferedOutputStream commandsStdIn = null;\n             Process proc = null;\n@@ -1700,7 +1699,9 @@\n                     new HTTPHeaderInputStream(proc.getInputStream());\n                 BufferedReader cgiHeaderReader =\n                     new BufferedReader(new InputStreamReader(cgiHeaderStream));\n-            \n+\n+                InputStream cgiOutput = null;\n+\n                 while (isRunning) {\n                     try {\n                         //set headers\n@@ -1763,7 +1764,10 @@\n                 } //replacement for Process.waitFor()\n     \n                 // Close the output stream used\n-                cgiOutput.close();\n+                if (cgiOutput != null)\n+                {\n+                    cgiOutput.close();\n+                }\n             }\n             catch (IOException e){\n                 log (\'Caught exception \' + e);', 'Nils Hammar', '2007-06-22 05:21:27 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (303, '36155', 'Bug 36155 tomcat chooses wrong host if using mod_jk', 'Hi,\n\nmy config is as follows:\n\ntomcat 5.5.9 knows two hosts, let\'s say the host \'host1\' and the host \'host2\'.\n http://host1/  is basically a jsp-page echoing the string host1 -  http://host2/ \nechos the string host2.\n\napache 2.0.54 is configured with two vhost with ServerName host1 and host2. Both\nservers have a ServerAlias too - the one has ServerAlias alias1, the other has\nServerAlias alias2\n\nmod-jk 1.2.14 only knows one worker. My worker.properties looks like this:\nworker.list=worker1\nworker.worker1.type=ajp13\nworker.worker1.host=127.0.0.1\n\nA very simple config. Both apache vhosts contain a \'JkMount *.jsp worker1\'\n\nApache\'s UseCanonialName is on and Tomcats AJP-connector has useIPVHosts turned\non. Therefor tomcat will chose the host by the server-name that mod_jk sends.\n\nSo calling  http://alias1/  results in a page containing the string host1, and\ncalling  http://alias2/  results in a page containing the string host2.\n\nThe problem:\nSometimes (not always and very selden)  http://alias1  returns the string host2\nand  http://alias2  returns the string host1.\n\nI\'m not sure, where the problem is, but i\'m almost sure it\'s mod_jk - although i\ndon\'t know, what should go wrong.\n\nI now defined a second worker with the same address and each of apache\'s vhosts\nuse a different worker. The error didn\'t come up yet.', 'Sven', '2005-08-12 05:08:52 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (304, '42750', 'Bug 42750 Http Post requests not handled correctly if there is more than one space between the \'POST\' and the URL', 'When a Tomcat based Http listener receives a Soap request with more than one \nspace between the \'POST\' command and the URL, this error response is returned \nby Tomcat version 5.5.20, and there is no response at all from other versions \n(4.0.2 and 5.0):\n\nHTTP/1.1 505 HTTP Version Not Supported\nServer: Apache-Coyote/1.1\nDate: Fri, 08 Jun 2007 22:19:07 GMT\nConnection: close\n\nHere is what I mean about there being more than one space between the Post and \nthe URL.  In the examples below I leave out the body of the Soap request for \nsimplification.  I used the TCPMonitor supplied by the Apache project to \ncapture a Soap request and here is how it is displayed in the monitor (it \nprobably looks completely different on the wire):\n\nPOST     http://C010030S:5599/NXAServer/NextAxiomServer  HTTP/1.0\n\nUser-Agent: Natural 4.2\nContent-Type: text/xml; charset=utf-8\nSOAPAction: urn:rpc?path=Training.webMethods.validateUserid\nContent-Length: 338\n\nNote the four spaces between the \'POST\' and the URL in the first line.  Now \nhere is what the request looks like after removing three of the four spaces:\n\nPOST  http://C010030S:5599/NXAServer/NextAxiomServer  HTTP/1.0\nUser-Agent: Natural 4.2\nContent-Type: text/xml; charset=utf-8\nSOAPAction: urn:rpc?path=Training.webMethods.validateUserid\nContent-Length: 338\n\nThe request seems to only get handled correctly by the Tomcat HTTP listener \nwhen there is one space between the \'Post\' and the URL.  \n\nThis example is from a Soap request issued by a Natural program running on a \nZ/OS mainframe.  Instead of sending you a complete example to recreate the \nproblem (which would require a mainframe) it would probably be easy to use the \nApache TCP Monitor to capture a Soap request from an available test system and \nthen add one of more spaces between the Post and the URL, resend the request \nin the monitor and see what happens.  \n\nWhat I\'m trying to do is invoke from Natural on a mainframe (which \nunfortunately we have no control over) a web service running on webMethods \n(IntegrationServer version 6.1 which uses Tomcat402B.jar, so that may be \nversion 4.0.2B (?), and JVM 1.4.2_13). No response is returned at all from \nthat version.  I then tried to do the same thing with webMethods version 6.5 \n(which uses Tomcat 5.0 and JVM 1.4.2_07) and still got no response.  Then I \ntried NextAxiom version 6.5.2.0 (which uses Tomcat version 5.5.20) and I at \nleast got a response from it (see the response at the top of this \ndescription).  I then tried invoking web services that use other Http \nlisteners and found the two I tried handled the Soap request just fine.  One \nexample is IBM HTTP Server (version 1.3.8) that is running on a WebSphere \nserver; it handles the request with more than one space just fine (by \'fine\' I \nmean it recognized the URL and handed it off to the process at that URL).  The \nother I don\'t know much about; it was just some remote web service I found on \nthe web ( http://www.webserviceX.NET ).\n\nI have looked through the Apache Tomcat website, documentation and an \nassociate looked through the bug database for version 5, and we can\'t find \nanything that addresses this problem.  I downloaded the source code, but got \nlost looking around and decided to ask for some help to find and fix this \nproblem.  Or maybe someone has an idea on how to configure the Http listener \nto handle this better.\n\nIf this is a bug, I would be more than happy to attempt to fix this myself if \nsomeone could point me in the right direction.\n\nThank you very very much for your time and efforts.\n\nDick Salisbury\nIdaho Power Company\n dsalisbury@idahopower.com ', 'Dick Salisbury', '2007-06-26 16:57:13 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (305, '42934', 'Bug 42934 sessionDidActivate() called before contextInitialized()', 'I\'m using Seam and a Seam app depends upon the Seam application being\ninitialized before you can do much of anything in Seam.\n\nThat said Seam puts some hooks into the sessionDidActivate() and\nsessionDidPassivate() events.  Because of that when I start up my app\nI\'m getting a Seam IllegalStateException because the\ncontextInitialized() event is fired after sessionDidActivate() so Seam\nis not yet initialized it\'s Session hooks are being fired.\n\nWhat makes me think this is a bug is that sessionWillPassivate() is being\ncorrectly called before contextDestroyed() so it would seem that\nsessionDidActivate() being called before contextInitialized() would be\ninconsistent behavior.\n\nSo to sum up I think tomcat should fire context and session events in the\nfollowing order:\n\ncontextInitialized\nsessionDidActivate\nsessionWillPassivate\ncontextDestroyed\n\n\nAs a side note Tomcat 5 follows what I think is the completely wrong but\nconsistent order by firing events in this order:\n\nsessionDidActivate\ncontextInitialized\ncontextDestroyed\nsessionWillPassivate', 'Mike Youngstrom', '2007-07-18 14:40:10 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (306, '42943', 'Bug 42943 jsp:text gets confused with other *:text elements in a JSP tag file', 'I have a JSP .tag file (label.tagx) that I want to use in other JSPs. The tag\nfile looks as follows:\n\n<jsp:root version=\'2.0\'\n   xmlns:jsp=\' http://java.sun.com/JSP/Page \'>\n  <jsp:directive.tag body-content=\'scriptless\'/>\n  <dul:text xmlns:dul=\' http://www.whatever.com/dul \'><jsp:doBody/></dul:text>\n</jsp:root>\n\n\nWhen I want to use this tag file in a JSP:\n\n...\n<tagx:label>blablabla</tagx:label>\n...\n\nI get the stacktrace at the end of this message.\n\nHowever, if I replace the dul:text element with something else, such as\ndul:dul:textzz, then everything works fine:\n\n<jsp:root version=\'2.0\'\n   xmlns:jsp=\' http://java.sun.com/JSP/Page \'>\n  <jsp:directive.tag body-content=\'scriptless\'/>\n  <dul:textzz xmlns:dul=\' http://www.whatever.com/dul \'><jsp:doBody/></dul:textzz>\n</jsp:root>\n\nSeems like the dul:text and jsp:text tags get confused (namespace problems?)\nsomewhere during the page compilation.\n\nStacktrace:\n\n2007-07-20 12:05:50,828 [http-8080-Processor25] ERROR\norg.apache.struts.taglib.tiles.InsertTag - ServletException in\n\'/WEB-INF/jsp/test-page.jsp\': /WEB-INF/tags/label.tagx(6,90) &lt;jsp:text&gt;\nmust not have any subelements\norg.apache.jasper.JasperException: /WEB-INF/tags/label.tagx(6,90)\n&lt;jsp:text&gt; must not have any subelements\n	at\norg.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:39)\n	at org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:409)\n	at org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:90)\n	at org.apache.jasper.compiler.JspDocumentParser.parse(JspDocumentParser.java:201)\n	at org.apache.jasper.compiler.ParserController.doParse(ParserController.java:197)\n	at org.apache.jasper.compiler.ParserController.parse(ParserController.java:101)\n	at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:203)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:495)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:476)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:464)\n	at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:511)\n	at\norg.apache.jasper.servlet.JspServletWrapper.loadTagFile(JspServletWrapper.java:201)\n	at\norg.apache.jasper.compiler.TagFileProcessor.loadTagFile(TagFileProcessor.java:514)\n	at org.apache.jasper.compiler.TagFileProcessor.access$000(TagFileProcessor.java:47)\n	at\norg.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:565)\n	at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2324)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1185)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at\norg.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:569)\n	at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2224)\n	at org.apache.jasper.compiler.Node$JspRoot.accept(Node.java:525)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2219)\n	at org.apache.jasper.compiler.Node$Root.accept(Node.java:456)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at\norg.apache.jasper.compiler.TagFileProcessor.loadTagFiles(TagFileProcessor.java:583)\n	at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:226)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:495)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:476)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:464)\n	at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:511)\n	at\norg.apache.jasper.servlet.JspServletWrapper.loadTagFile(JspServletWrapper.java:201)\n	at\norg.apache.jasper.compiler.TagFileProcessor.loadTagFile(TagFileProcessor.java:514)\n	at org.apache.jasper.compiler.TagFileProcessor.access$000(TagFileProcessor.java:47)\n	at\norg.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:565)\n	at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2324)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1185)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2324)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1185)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at\norg.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:569)\n	at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2324)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1185)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2324)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1185)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2324)\n	at org.apache.jasper.compiler.Node$UninterpretedTag.accept(Node.java:1185)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at\norg.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:569)\n	at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2224)\n	at org.apache.jasper.compiler.Node$JspRoot.accept(Node.java:525)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)\n	at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2219)\n	at org.apache.jasper.compiler.Node$Root.accept(Node.java:456)\n	at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)\n	at\norg.apache.jasper.compiler.TagFileProcessor.loadTagFiles(TagFileProcessor.java:583)\n	at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:226)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:495)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:476)\n	at org.apache.jasper.compiler.Compiler.compile(Compiler.java:464)\n	at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:511)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:295)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:292)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:236)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n	at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n	at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n	at\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:696)\n	at\norg.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:585)\n	at\norg.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:510)\n	at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:966)\n	at org.apache.jasper.runtime.PageContextImpl.include(PageContextImpl.java:602)\n	at org.apache.struts.tiles.TilesUtilImpl.doInclude(TilesUtilImpl.java:101)\n	at org.apache.struts.tiles.TilesUtil.doInclude(TilesUtil.java:137)\n	at org.apache.struts.taglib.tiles.InsertTag.doInclude(InsertTag.java:758)\n	at\norg.apache.struts.taglib.tiles.InsertTag$InsertHandler.doEndTag(InsertTag.java:890)\n	at org.apache.struts.taglib.tiles.InsertTag.doEndTag(InsertTag.java:460)\n	at\norg.apache.jsp.WEB_002dINF.jsp.layouts.default_jsp._jspx_meth_tiles_insert_4(default_jsp.java:401)\n	at\norg.apache.jsp.WEB_002dINF.jsp.layouts.default_jsp._jspService(default_jsp.java:135)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:94)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:324)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:292)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:236)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n	at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n	at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n	at\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:696)\n	at\norg.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:474)\n	at\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:409)\n	at\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:312)\n...', 'Vojtech Toman', '2007-07-20 03:46:22 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (307, '43080', 'Bug 43080 Suspicious url pattern warning logged to wrong webapp', '\'Suspicious url pattern\' warnings are logged to the wrong webapp, not the one\nactually using them.\n\nThese log events are coming from SecurityCollection.java.', 'Marius Scurtescu', '2007-08-09 15:18:42 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (308, '43191', 'Bug 43191 compressableMimeType attribute ignored', 'I have set compression=\'on\' and compressableMimeType=\'text/html\' in server.xml.\nIt appears that the value of compressableMimeType is being ignored. My XML\nresponses are all coming back gzipped. If I switch to compression=\'off\' the\nresponses are not gzipped, but as soon as I turn it on, regardless of the value\nof compressableMimeType, the XML responses are coming back gzipped.\n\nA full Connector tag follows. Note that this is just an example -- I have tried\nmany values for compressableMimeType (that do NOT include text/xml) and the\nresponses are still compressed.\n\n      <Connector port=\'7630\' address=\'${jboss.bind.address}\'\n         maxThreads=\'20\' minSpareThreads=\'4\' maxSpareThreads=\'10\' strategy=\'ms\'\nmaxHttpHeaderSize=\'8192\'\n         emptySessionPath=\'true\' enableLookups=\'false\' redirectPort=\'7643\'\nacceptCount=\'16\'\n         connectionTimeout=\'20000\' disableUploadTimeout=\'true\'\n         compression=\'off\'\n        \ncompressableMimeType=\'text/html,text/javascript,application/x-javascript,application/javascript\'\n/>', 'Dave Wood', '2007-08-22 15:02:44 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (309, '43366', 'Bug 43366 Session Statistics command in manager fails with \'Unknown command /sessions\'', 'A documentation page for Tomcat 6 at\n http://tomcat.apache.org/tomcat-6.0-doc/manager-howto.html#Session%20Statistics  \nallows for the following command to be used in the manager:\n http://localhost/manager/sessions?path=/  \n\nThis used to work in Tomcat 5.\nIn Tomcat 6, the following error is returned:\nFAIL - Unknown command /sessions \n\nI have created two different installations of Tomcat 6.0.14 (one on CentOS 5,\nand one on Fedora 7). Both installations exhibit the same failure.', 'Greg Johnson', '2007-09-12 08:15:55 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (310, '44877', 'Bug 44877 ClassCastException due to bad TagHandlerPool name generation of two different tags', 'Created  attachment 21857   [details] \nSmall Eclipse 3.3 WST project\n\nThe two different tags below will have the same TagHandlerPool name in the generated JSP. This will lead to a ClassCastException when accessing the JSP at runtime.\n\n<bug:hello_world/>\n\n<bug:hello world=\'true\'/>\n\n-------------------\nTop of stacktrace :\n\njava.lang.ClassCastException: fr.illod.tomcat.bug.taglib.HelloWorldTag\n	org.apache.jsp.index_jsp._jspx_meth_bug_005fhello_005f0(index_jsp.java:115)\n	org.apache.jsp.index_jsp._jspService(index_jsp.java:75)\n	org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:98)\n        ...\n\n--------------\n\nThe error seems to come from the \'createTagHandlerPoolName\' method in org.apache.jasper.compiler.Generator.java', 'illod', '2008-04-25 13:43:26 UTC', 'tomcat_attachment/attachment 21857');
INSERT INTO `tomcatbody` VALUES (311, '31257', 'Bug 31257 java.endorsed.dirs is not used when JSP compilation is forked', 'When the JSP compiler forks a javac process, it should check to see what the \ncurrently endorsed directories are (check the system \nproperty \'java.endorsed.dirs\' - otherwise, classes end up missing and JSP \npages do not properly compile.  We experienced a problem when we explicitly \nset the java.endorsed.dirs property on the command line, and the JSP compiler \ndid not use it when javac was forked.\n\nI have patched org.apache.jasper.compiler.Compiler to support this:\n*** src.original jakarta-tomcat-jasper jasper2\n src share org apache jasper compiler Compiler.java       Tue Jun 15 17:30:35 \n2004\n--- src org apache jasper compiler Compiler.java        Thu Sep 16 00:05:14 \n2004\n\n***************\n*** 349,358 ****\n--- 349,369 ----\n              extdirs.setPath(exts);\n              javac.setExtdirs(extdirs);\n              info.append(\'    extension dir=\' + exts + \' n\');\n          }\n\n+         // Add endorsed directories\n+         String endorsed = System.getProperty(\'java.endorsed.dirs\');\n+         if(endorsed != null) {\n+             Javac.ImplementationSpecificArgument endorsedArg = \njavac.createCompilerArg();\n+             endorsedArg.setLine(\'-J-Djava.endorsed.dirs=\'+endorsed);\n+             info.append(\'    endorsed dir=\' + endorsed + \' n\');\n+         }\n+         else {\n+             info.append(\'    no endorsed dirs specified n\');\n+         }\n+\n          // Configure the compiler object\n          javac.setEncoding(javaEncoding);\n          javac.setClasspath(path);\n          javac.setDebug(ctxt.getOptions().getClassDebugInfo());\n\ntrue, i should probably check ctxt.getOptions().getFork() in the if() as well, \nbut since i always fork it doesn\'t matter to me.', 'James DeFelice', '2004-09-16 05:10:06 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (312, '29936', 'Bug 29936 XML parser loading problems by container', 'I\'m trying to use JSTL 1.1 with this version of tomcat and have both saxon and \ncrimson in my web-app.\n\nIf we have crimson and saxon in our webapp lib then tomcat tries to use crimson \nas the xml parser when reading the web.xml and compiling the jsp and we get the \nprefix error:\n\norg.apache.jasper.JasperException: <h3>Validation error messages from \nTagLibraryValidator for c</h3><p>null: java.lang.IllegalStateException: can\'t \ndeclare any more prefixes in this context</p><h3>Validation error messages from \nTagLibraryValidator for fmt</h3><p>null: java.lang.IllegalStateException: can\'t \ndeclare any more prefixes in this context</p>\n\nIf we remove crimson, tomcat uses saxon (aelfred parser) and this fails on \nreading the web.xml (javax.xml.parsers.ParserConfigurationException: AElfred \nparser is namespace-aware)\n\nIf we remove saxon and crimson then we are okay (defaults to xerces in the \ntomcat endorsed directory?)\n\nIt seems to me that tomcat is using the parser in my web-app to read the \nweb.xml rather than using xerces from the endorsed directory.  \n\nThe same web-app runs without problems in version 5.0.16.  \n\nTomcat seems to be using the service provider mechanism in 5.0.25 as I have \nproperty files in C: Java jakarta-tomcat-5.0.25\n work Catalina localhost diabetes loader META-INF services (can\'t find any \ndocuments on this).\n\nIf I\'m using more than one parser won\'t this cause problems as tomcat is \nsetting only one parser and xslt processor here?\n\nAny comments are gratefully received.\n\nThanks,\nPeter Neville', 'peter neville', '2004-07-06 15:18:51 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (313, '44562', 'Bug 44562 HEAD requests cannot go through request dispatch include.', 'See  https://issues.apache.org/jira/browse/GERONIMO-3896 \n\nbriefly...\n\ntomcat complains:\nServlet.service() for servlet SimpleDispatchServlet threw exception\njavax.servlet.ServletException: Original SevletResponse or wrapped original ServletResponse not passed to\nRequestDispatcher in violation of SRV.8.2 and SRV.14.2.5.1\n        at org.apache.catalina.core.ApplicationDispatcher.checkSameObjects(ApplicationDispatcher.java:985)\n...\n\nThe relevant code seems to be in javax.servlet.http.HttpServlet\n\n    protected void doHead(HttpServletRequest req, HttpServletResponse resp)\n	throws ServletException, IOException\n    {\n	NoBodyResponse response = new NoBodyResponse(resp);\n	\n	doGet(req, response);\n	response.setContentLength();\n    }\n\n\nwhich is fine but\n\nclass NoBodyResponse implements HttpServletResponse {\n\n\nrather than\nclass NoBodyResponse extends HttpServletResponseWrapper {\n\nThe patch attached to the jira issue makes this change and adapts NoBodyResponse to be a subclass of HttpServletResponseWrapper and the user reports that it fixes the problem.   I don\'t know if there would be formatting issues applying the patch to tomcat\'s copy of the spec classes.', 'david jencks', '2008-03-07 13:19:40 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (314, '43701', 'Bug 43701 Error while starting tomcat', 'this is my NIO Connector configuration in server.xml \n<Connector acceptCount=\'100\' enableLookups=\'false\' port=\'80\'\nprotocol=\'org.apache.coyote.http11.Http11NioProtocol\' \n      acceptorThreadCount=\'2\' socket.bufferPool=\'-1\' connectionTimeout=\'60000\'\nmaxKeepAliveRequests=\'-1\' maxThreads=\'200\'\n      minSpareThreads=\'25\' redirectPort=\'8443\' />\n\nwhen I am starting my tomcat it is giving following error in the console several\ntime \nSEVERE: \njava.lang.NullPointerException\n	at org.apache.tomcat.util.net.NioEndpoint.setSocketOptions(NioEndpoint.java:985)\n	at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:1169)\n	at java.lang.Thread.run(Thread.java:595)', 'prabhat', '2007-10-26 03:01:21 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (315, '44268', 'Bug 44268 Multiple registrations of same ServletContextListener class not possible', 'When I register the same class implementing ServletContextListener twice or more\nits\' contextInitialized methods only gets called once.\n\nThe servlet specifications (2.4 and 2.5) say the conforming container has to \ncall the listeners in the same order they are registered in the deployment\ndescriptor.\nThe case that one listener class is registered twice is not mentioned\nexplicitly in the specification, though.\n\nExample:\n<listener>\n  <listener-class>test.ServletContextListener1</listener-class>\n</listener>\n<listener>\n  <listener-class>test.ServletContextListener2</listener-class>\n</listener>\n<listener>\n  <listener-class>test.ServletContextListener1</listener-class>\n</listener>\n\ntest.ServletContextListener1 and test.ServletContextListener2 get called,\nbut test.ServletContextListener1 does not get called again.\n\nApache Tomcat 5.5.25 has the same bug.', 'Stefan Fleiter', '2008-01-18 08:42:18 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (316, '44223', 'Bug 44223 Tomcat ignores the \'javax.net.ssl.trustStoreType\' system property', 'Set up a SSL Connector with a keystore in JKS format:\n\n<Connector ... SSLEnabled=\'true\'\nkeystoreFile=\'tomcat.keystore\' keystoreType=\'JKS\'>\n\nLet\'s say you need a custom truststore (e.g. for authenticating self-signed \nclient certificates), and that this truststore is also needed by some of your \nwebapps, not only Tomcat. The natural thing to do then is to configure this \ntruststore globally for the whole JVM, not in server.xml.\n\nLet\'s also assume this truststore is in a different format (e.g. PKCS#12). So \nbefore starting Tomcat, you do this:\n\nexport JAVA_OPTS=\'-Djavax.net.ssl.trustStore=trusted.keystore -\nDjavax.net.ssl.trustStoreType=PKCS12\'\n\nWell, it doesn\'t work. If you look at tomcat/logs/catalina.out, you will see a \nkeystore-related exception. Upon further debugging, you will discover the \nproblem is that Tomcat is trying to open the truststore as if it were in JKS \nformat, even though it is clearly specified as type PKCS12 in JAVA_OPTS above.', 'Ivan Todoroski', '2008-01-14 04:24:16 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (317, '11117', 'Bug 11117 Coyote connector does not correctly deal with large PUT when using chunked transfer encoding', 'I\'ve built a small test servlet (included below) that shows this behaviour.\n\nIf I upload data to tomcat (configured to use the HTTP/1.1 Coyote connector)\nusing a chunked transfer-encoding on a PUT, then the result (i.e. what I read\nusing the servlet\'s request.getInputStream() is corrupted.\n\nThis _only_ happens on large PUTs (it happens every time I tried it (about 10)\non a large PUT - I was testing with something around 700 kB, and another thing\nof about 1 MB, but does NOT always corrupt it in the same way. I did not see any\ncorruption on small files (~50 kB and smaller), though I didn\'t test this\nextensively.\n\nThe total length of the data read is exactly correct (712080 bytes in my first\ntest). At the first point of corruption in the file, a chunk header appears in\nthe output (\' r n1000 r n\') followed by correct data from about 700 bytes later\non, then a second copy (in the correct place, I think) of the corrupt data (i.e.\ncorrect data, followed by the chunk header, followed by some data repeated, the\nsecond instance of which is in the correct place - so the first instance is\nbeing produced _instead_ of the correct data for that point in the input).\n\nTest servlet follows:\n\nimport java.io.*;\n\nimport javax.servlet.*;\nimport javax.servlet.http.*;\n\npublic class Test extends HttpServlet\n{\n\n    public void doPut(HttpServletRequest req, HttpServletResponse res)\n                throws ServletException, IOException\n    {\n        FileOutputStream fos = new FileOutputStream(\'/tmp/servlet-out\');\n\n        InputStream is = req.getInputStream();\n\n        byte buf[] = new byte[2000];\n        int ret;\n\n        while((ret = is.read(buf)) > 0) {\n            fos.write(buf, 0, ret);\n        }\n\n        fos.close();\n        is.close();\n\n        PrintWriter pw = res.getWriter();\n        pw.println(\'Done\');\n        pw.flush();\n        pw.close();\n    }\n}', 'Michael Smith', '2002-07-24 07:44:57 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (318, '43285', 'Bug 43285 Missing EL Coercion causes argument type mismatch', 'I\'ll attach a sample web application reproducing the error. Note that this error\nonly occurs when using Tomcat 6.0.x (i.e. it works with Jetty as it uses Sun\'s\nEL RI). Moreover it doesn\'t matter which JSF implementation you\'re using to\nreproduce the error (I just wanted to mention that as it\'s definitely no bug in\nMyFaces even though the following stack trace shows a FacesException).\n\nThe exception stack trace:\njavax.faces.FacesException: Exception while calling broadcast on component :\n{Component-Path : [Class: javax.faces.component.UIViewRoot,ViewId: /home.jsp][\nClass: javax.faces.component.html.HtmlForm,Id: j_id_jsp_923754602_1][Class:\njavax.faces.component.html.HtmlCommandButton,Id: j_id_jsp_923754602_3]}\n        at javax.faces.component.UIComponentBase.broadcast(UIComponentBase.java:494)\n        at javax.faces.component.UICommand.broadcast(UICommand.java:105)\n        at javax.faces.component.UIViewRoot._broadcastForPhase(UIViewRoot.java:292)\n        at javax.faces.component.UIViewRoot.process(UIViewRoot.java:209)\n        at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:117)\n        at\norg.apache.myfaces.lifecycle.InvokeApplicationExecutor.execute(InvokeApplicationExecutor.java:32)\n        at\norg.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:95)\n        at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:70)\n        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:144)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:263)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:584)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n        at java.lang.Thread.run(Thread.java:619)\nCaused by: org.apache.jasper.el.JspELException: /home.jsp(12,3)\n\'#{numberBean.number}\' java.lang.IllegalArgumentException: argument type mismatch\n        at\norg.apache.jasper.el.JspValueExpression.setValue(JspValueExpression.java:94)\n        at\norg.apache.myfaces.event.SetPropertyActionListener.processAction(SetPropertyActionListener.java:72)\n        at javax.faces.event.ActionEvent.processListener(ActionEvent.java:48)\n        at javax.faces.component.UIComponentBase.broadcast(UIComponentBase.java:489)\n        ... 20 more\nCaused by: java.lang.IllegalArgumentException: argument type mismatch\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at javax.el.BeanELResolver.setValue(BeanELResolver.java:108)\n        at javax.el.CompositeELResolver.setValue(CompositeELResolver.java:68)\n        at\norg.apache.myfaces.el.unified.resolver.FacesCompositeELResolver.access$501(FacesCompositeELResolver.java:46)\n        at\norg.apache.myfaces.el.unified.resolver.FacesCompositeELResolver$6.invoke(FacesCompositeELResolver.java:132)\n        at\norg.apache.myfaces.el.unified.resolver.FacesCompositeELResolver.invoke(FacesCompositeELResolver.java:148)\n        at\norg.apache.myfaces.el.unified.resolver.FacesCompositeELResolver.setValue(FacesCompositeELResolver.java:128)\n        at org.apache.el.parser.AstValue.setValue(AstValue.java:114)\n        at org.apache.el.ValueExpressionImpl.setValue(ValueExpressionImpl.java:249)\n        at\norg.apache.jasper.el.JspValueExpression.setValue(JspValueExpression.java:85)\n        ... 23 more', 'Bernhard Huemer', '2007-09-02 13:14:26 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (319, '42503', 'Bug 42503 ServletContext.getResourceAsStream returns stale data', 'Under certain conditions, the resource cache implementation used by the\nservlet/JSP engine (in org.apache.naming.resource) does not detect that a file\nin its cache has been modified and therefore returns the previous contents of\nthe file.\n\nThis happens only \n * when the file contents are modified but the file length doesn\'t change\n * until the time the first change in the file is detected after server startup\n   \nTo reproduce the problem, put the attached test.jsp and test.txt into the ROOT\nweb app and then do the following. (I used Tomcat 6\'s trunk for the test)\n\n% cat test.txt\nabcd\n% telnet . 9080 \nTrying 0.0.0.0...\nConnected to ..\nEscape character is \'^]\'.\nGET /test.jsp HTTP/1.0\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nSet-Cookie: JSESSIONID=706D6FE8B06687509D42E79DBEE266EF; Path=/\nContent-Type: text/html\nContent-Length: 26\nDate: Wed, 23 May 2007 23:03:05 GMT\nConnection: close\n\n\n\nFile contents=[\nabcd\n\n]\nConnection to . closed by foreign host.\n\n% cat test.txt (change the contents but not the size)\nefgh\n % telnet . 9080 \nTrying 0.0.0.0...\nConnected to ..\nEscape character is \'^]\'.\nGET /test.jsp HTTP/1.0\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nSet-Cookie: JSESSIONID=2B144247B747F54184114FA82869DE14; Path=/\nContent-Type: text/html\nContent-Length: 26\nDate: Wed, 23 May 2007 23:04:24 GMT\nConnection: close\n\n\n\nFile contents=[\nabcd\n\n]', 'Arvind Srinivasan', '2007-05-23 16:52:35 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (320, '43914', 'Bug 43914 HTTP spec violation when generating HTTP redirects for folders without trailing slash', 'Copy the attached static.war into $CATALINA_HOME/webapps. Then start the server \nand paste this HTTP request in netcat:\n\nGET /static/name%20with%20spaces HTTP/1.1\nUser-Agent: Jakarta Commons-HttpClient/3.0\nHost: localhost:8080\n\nTomcat will answer with the following HTTP redirect:\n\nHTTP/1.1 302 Moved Temporarily\nServer: Apache-Coyote/1.1\nLocation:  http://localhost:8080/static/name  with spaces/\nTransfer-Encoding: chunked\nDate: Tue, 20 Nov 2007 13:46:12 GMT\n\nObserve the Location: header. It has raw unencoded spaces in the URL which is \nin clear violation of the HTTP specification.', 'Ivan Todoroski', '2007-11-20 05:53:53 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (321, '44084', 'Bug 44084 JAASRealm useContextClassLoader has problems', 'The useContextClassLoader config option doesn\'t work right. \n\n- it is ignored when setting userClassNames and roleClassNames \n- it\'s respected when the LoginContext is created, but that is insufficient,\nbecause all the needed classes are not necessarily loaded until\nloginContext.login() is called\n\nPatch to follow. With it I\'m able to keep everything related to the JAASRealm in\nmy webapp.', 'Noah Levitt', '2007-12-15 14:27:25 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (322, '43236', 'Bug 43236 Response.setCharacterEncoding() fails after Response.getWriter() and Response.reset()', 'The class org.apache.catalina.connector.Response\n\nresets the internal hold coyoteResponse and outputBuffer during reset():\n\n    public void reset() {\n        if (included)\n            return;     // Ignore any call from an included servlet\n        coyoteResponse.reset();\n        outputBuffer.reset();\n    }\n\nbut if anyone has already set the characterEncoding (e.g. to UTF-8) and already\ngot the writer, than all following invocations of request.setCharacterEncoding()\nwill do nothing, because the internal save flag for usingWriter is not reseted.\nThis is very annoying, because the coyoteResponse.reset(), resets the\ncharacterEncoding to iso8859-1. So I have no change to change/reset the\ncharaterEncoding to UTF-8.\nI\'ll think if you reset the response, you should also reset the usingWriter flag\nor add another special flag, that works with this circumstances.', 'Olaf Meske', '2007-08-29 03:56:43 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (323, '43241', 'Bug 43241 ServletContext.getResourceAsStream()  does not follow API specs for Path', 'Say for example, you have a file style.css deployed in your context. The call to\nServletContext.getResourceAsStream(\'style.css\') returns an input stream. This is\nnot correct behavior.\n\nThe spec (2.3) says:\n\n> The path must be specified according to \n> the rules given in getResource. \n\ngetResource() says:\n\n> The path must begin with a \'/\' and is interpreted \n> as relative to the current context root.\n\nMy reading of these two things is that getResourceAsStream(\'style.css\') should\nreturn null, not an input stream to the file.\n\nI got bit on this because my app behavior changed (broke) when ran on the\ncurrent version of WebSphere.', 'George Sexton', '2007-08-29 12:54:18 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (324, '43622', 'Bug 43622 compression / minCompressionSize attribute not properly implemented', '2 of the compression related attributes for the http connector are:\n\ncompression = on | off | force | <integer val>\nThe documentation states that integer val will be implemented as:\ncompression=\'on\' and minCompressionSize = <integer val>\n\nminCompressionSize = <integer val>\n(The documentation for 5.5.12 doesnt mention this at all, but read this in the\nserver.xml)\n\nThe problem is that the documenation gives the impression that only setting\ncompression=\'some integer val\' is sufficient, however the way the code is\nwritten, the value of \'minCompressionSize\' always overrides the value specified\nin the \'compression\' field. Even if minCompressionSize isnt set, it will still\nget the default value of 2048 and override whatever value was there in the\n\'compression\' field.\n\nI looked at the implementation of the http11 connector and found the following\ncode that might be the culprit:\n\nIn org.apache.coyote.http11.Http11BaseProtocol.Http11ConnectionHandler.init\n    processor.setCompression( proto.compression );\n    processor.setCompressionMinSize( proto.compressionMinSize);\n\nsince the \'setCompressionMinSize\' is called after compressionMinSize, its value\nwill override the value read from compression atttribute.\n\n\nI have looked at the code for Tomcat 6.0 also, and the problems appears to still\nbe present.', 'redeemer', '2007-10-15 03:51:24 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (325, '43757', 'Bug 43757 Improper parsing of response.sendRedirect() in JSP source', 'Tomcat is throwing a java.lang.illegalStateException due to an attempted\nresponse.sendRedirect() after the time for such matters has come and gone...\nBut, this appears to be a symptom of bad .jsp parsing at runtime.\n\n==========================\n\norg.apache.jasper.JasperException: Exception in JSP: /buslog.jsp:42\n\n39: // if (session.getAttribute(\'isAuth\') == null) {\n40: //     session.setAttribute(\'messageToUser\',\'Authentication failed.\');\n41: //        you.shouldNotParseThis();\n42: //     response.sendRedirect(\'./index.jsp\');\n43: // }\n44: \n45: // if (session.getAttribute(\'isAuth\') != null) {\n\n==============================\n\nThese lines are commented out in the source, and should not conceivably cause a\nruntime error. Changing \'response.sendRedirect(...)\' to\n\'response.sendAbendOMG(...)\' suppresses the error. I am willing to provide the\ncomplete source if necessary.\n\nBuild and execution environments are NetBeans 5.5.1 with bundled Tomcat 5.5.17.', 'Charles Stahl', '2007-10-31 11:55:53 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (326, '43893', 'Bug 43893 WebdavServlet returns incorrect values for the \'href\' property when it is mapped with / url prefix, instead of /*', 'Deploy the attached WAR file under a vanilla installation of Tomcat 6.0.14, \nthen send the following WebDAV request (I simply pasted it in netcat, maybe \ntelnet will work too if you don\'t have netcat):\n\nPROPFIND /webdav/file.txt HTTP/1.1\nContent-Type: text/xml; charset=utf-8\nUser-Agent: Jakarta Commons-HttpClient/3.0\nHost: localhost:8080\nDepth: 0\n\nDon\'t forget to press enter twice at the end. Observe the result:\n\n<?xml version=\'1.0\' encoding=\'utf-8\' ?>\n<multistatus xmlns=\'DAV:\'><response><href>/webdav/file.txt/file.txt</href>\n<propstat><prop><creationdate>2007-11-18T07:42:14Z</creationdate>\n<displayname><![CDATA[file.txt]]></displayname>\n<getlastmodified>Sun, 18 Nov 2007 07:42:14 GMT</getlastmodified>\n<getcontentlength>0</getcontentlength>\n<getcontenttype>text/plain</getcontenttype>\n<getetag>W/\'0-1195371734000\'</getetag>\n<resourcetype/><source></source>\n<supportedlock><lockentry><lockscope><exclusive/></lockscope><locktype><write/\n></locktype></lockentry><lockentry><lockscope><shared/></\nlockscope><locktype><write/></locktype></lockentry></supportedlock>\n</prop>\n<status>HTTP/1.1 200 OK</status>\n</propstat>\n</response>\n</multistatus>\n\nNote in particular the incorrect value in <href>/webdav/file.txt/file.txt</\nhref>, paths are being duplicated.\n\nThis wouldn\'t usually be a big problem as many WebDAV clients don\'t rely so \nmuch on this \'href\' value, but the Apache slide-webdavlib client library relies \non it and breaks if it\'s incorrect, so any WebDAV enabled applications using \nthis library will not work with Tomcat 6. That\'s the only reason I marked this \nbug as major, apologies if it\'s a wrong classification.', 'Ivan Todoroski', '2007-11-18 00:04:05 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (327, '43356', 'Bug 43356 keystoreFile parameter, when specified as relative, is not treated relative to $CATALINA_BASE or catalina.base property for NioEndPoint', 'This issue is virtually the same symptoms as  http://issues.apache.org/bugzilla/ \nshow_bug.cgi?id=27050 except that it is with \norg.apache.tomcat.util.net.NioEndpoint.java instead of JSSESocketFactory\n\n----\nThe docs state \'keystoreFile - Add this attribute if the keystore file you \ncreated is not in the default place that Tomcat expects (a file named .keystore \nin the user home directory under which Tomcat is running). You can specify an \nabsolute pathname, or a relative pathname that is resolved against the \n$CATALINA_BASE environment variable.\'\n\nRelative paths don\'t work though with NioConnector. Here is the problem code in \nNioEndPoint starting line 744:\n\n// Initialize SSL if needed\n        if (isSSLEnabled()) {\n            // Initialize SSL\n            char[] passphrase = getKeystorePass().toCharArray();\n\n            KeyStore ks = KeyStore.getInstance(getKeystoreType());\n            ks.load(new FileInputStream(getKeystoreFile()), passphrase);\n            KeyStore ts = KeyStore.getInstance(getKeystoreType());\n            ts.load(new FileInputStream(getKeystoreFile()), passphrase);\n\n\nAs you can see $CATALINA_BASE is not taken into account at all and therefore we \nget something like this on startup:\n\n[] 2007-09-11 14:38:20,828 ERROR \norg.apache.coyote.http11.Http11NioProtocol.start(168) | Error starting endpoint\njava.net.BindException: Address already in use: bind\n        at sun.nio.ch.Net.bind(Native Method)\n        at \nsun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:119)\n        at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:59)\n        at org.apache.tomcat.util.net.NioEndpoint.init(NioEndpoint.java:731)\n        at org.apache.tomcat.util.net.NioEndpoint.start(NioEndpoint.java:779)\n        at \norg.apache.coyote.http11.Http11NioProtocol.start(Http11NioProtocol.java:166)\n        at org.apache.catalina.connector.Connector.start(Connector.java:1132)\n        at \norg.apache.catalina.core.StandardService.start(StandardService.java:531)\n        at \norg.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:566)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at \nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at \nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\n\n\nAlso I am curious why the keystoreFile is being used as the truststoreFile?\n\nAlso found this against version 6.0.13, not 6.0.9 ( although it may be in 6.0.9 \ntoo).', 'Peter Lynch', '2007-09-11 11:42:39 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (328, '30949', 'Bug 30949 After Failed Include, Request and Response not Unwrapped', 'In org.apache.catalina.core.ApplicationDispatcher.doInclude(ServletRequest \nrequest, ServletResponse response), after invoke() is called to perform the \ninclude, the request and response objects are normally unwrapped.  However, if \na ServletException or IOException is thrown, the unwrapping does not take place.\n\nThis leads to problems in environments in which cross context includes are \nbeing performed.  For example, \n\n1.  Web App A performs an include to a Servlet in Web App B\n2.  The Servlet in Web App B throws a ServletException\n3.  Web App A catches the ServletException and attempts to forward to an error \njsp.\n\nStep 3 above will fail due to the fact that the request has not been \nunwrapped.  The active request will contain the ServletContext of web app B and \nthe jsp file will not be found.', 'Scott Goldstein', '2004-08-30 23:54:36 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (329, '42753', 'Bug 42753 Race condition when using available() or reading in CometProcessor.event()', 'Tomcat version: 6.0.13 (no 6.0.13 available in the version field)\n\nWhen trying to process data in CometProcessor.event() either during the BEGIN\nevent or during the READ event, it is impossible to guarantee that all data has\nbeen read before returning (since new data may arrive between the last statement\nbefore the return, and the return statement itself). However, the\nCoyoteProcessor does this check:\n\n } else if (!error && read && request.getAvailable()) {\n    // If this was a read and not all bytes have been read, or if no data\n    // was read from the connector, then it is an error\n    error = true;\n    log.error(sm.getString(\'coyoteAdapter.read\'));\n } \n\ncausing a severe error and the Comet request to break when this race condition\nmanifests itself.\n\nI am using the following code according to the aio.html description to read data\nin my comet event handler:\n\n  while (request.getInputStream().available() > 0) {\n     // read some data\n  }\n  // ***** NO MORE DATA AVAILABLE\n  return;\n\nAnd I am experiencing the error as described in certain conditions (rapid\narrival of fragmented data):\n\nSEVERE: The servlet did not read all available bytes during the processing of\nthe read event', 'Sebastiaan van Erk', '2007-06-27 05:21:53 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (330, '42314', 'Bug 42314 Jasper output no details with compilation error in specific case.', 'Jasper output no details when Jasper cannot find\nmappings between generated servlet code (with mistakes)\nand former JSP.\nOne example JSP is the following. \n(The imported class in the JSP is not found.)\n---\n<%@\n  page import = \'not.exist.class\'\n%>\n---', 'Suzuki Yuichiro', '2007-05-02 01:13:16 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (331, '42547', 'Bug 42547 Same env-entry (web.xml) and ResourceLink (context) names causes NPE', 'Having the following in web.xml:\n\n  <env-entry>\n    <env-entry-name>testIt</env-entry-name>\n    <env-entry-type>java.lang.String</env-entry-type>\n    <env-entry-value>test</env-entry-value>\n  </env-entry>\n\nand the following in your context descriptor:\n\n  <ResourceLink name=\'testIt\'\n                global=\'testIt\'\n                type=\'java.lang.String\'/>\n\ncauses an NPE on context load.\n\njava.lang.NullPointerException\n	at\norg.apache.catalina.deploy.NamingResources.addEnvironment(NamingResources.java:188)\n	\nThis assumes you have an entry for \'testIt\' in the <GlobalNamingResources>\nsection of server.xml to link to.\n\nThis worked in 5.5.20. No longer works in 5.5.23.', 'John Hutchnson', '2007-05-30 11:29:37 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (332, '42497', 'Bug 42497 304 response should consistently include ETag header', 'According to the HTTP spec, if a server includes an ETag header when it sends a\nfile, it must also include the ETag when it sends a 304 (not-modified) response\nfor that file. Tomcat does not do this for static files - if you request a\nstatic file and get a 200 response, the response has an ETag header; but if you\nget a 304 resopnse, the ETag is omitted.\n\nTo reproduce:\n- In a browser, request a static file from Tomcat (e.g.  http://localhost/tomcat.gif )\n- Make sure you get a 200 response (force reload or clear browser cache)\n- Examine the response headers (using a browser plugin or whatever) - note that\nthere is an ETag header\n- Request the same file again, getting a 304 (not-modified) response from Tomcat\n- Examine the response headers - note there is no ETag\nThe 304 response should include an ETag header, because the 200 response had one.\n\nSpec reference: RFC 2616 section 10.3.5 says:\n\'304 Not Modified\n[...]\nThe response MUST include the following header fields:\n[...]\n      - ETag and/or Content-Location, if the header would have been sent\n        in a 200 response to the same request\'', 'Len Popp', '2007-05-23 09:00:19 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (333, '42438', 'Bug 42438 Duplicate JSP temp variable declaration when jsp:attribute used in conjunction with custom tags', 'Here is an example of the bug in its most primitive form:\n\nWEB-INF/jsp/test.jsp:\n===================================\n<%@ page contentType=\'text/html;charset=UTF-8\' language=\'java\' %>\n\n<%@ taglib prefix=\'c\' uri=\' http://java.sun.com/jsp/jstl/core \'%>\n<%@ taglib prefix=\'t\' tagdir=\'/WEB-INF/tags\' %>\n\n<jsp:element name=\'a\'>\n    <jsp:attribute name=\'href\'> http://www.apache.org </jsp:attribute>\n</jsp:element>\n\n<t:test />\n\n<c:if test=\'${true}\'>it\'s true!</c:if>\n===================================\n\nWEB-INF/tags/test.tag:\n===================================\n<%@ tag pageEncoding=\'UTF-8\' body-content=\'scriptless\' %>\ndo nothing\n===================================\n\nWEB-INF/tagPlugins.xml:\n===================================\n<tag-plugins>\n    <tag-plugin>\n      <tag-class>org.apache.taglibs.standard.tag.rt.core.IfTag</tag-class>\n      <plugin-class>org.apache.jasper.tagplugins.jstl.core.If</plugin-class>\n    </tag-plugin>\n</tag-plugins>\n===================================\n\nOnce you run this through Jasper, you will get the following java code:\n===================================\npackage org.apache.jsp.WEB_002dINF.jsp;\n\nimport javax.servlet.*;\nimport javax.servlet.http.*;\nimport javax.servlet.jsp.*;\n\npublic final class test_jsp extends org.apache.jasper.runtime.HttpJspBase\n    implements org.apache.jasper.runtime.JspSourceDependent {\n\n  private static java.util.List _jspx_dependants;\n\n  static {\n    _jspx_dependants = new java.util.ArrayList(1);\n    _jspx_dependants.add(\'/WEB-INF/tags/test.tag\');\n  }\n\n  private org.apache.jasper.runtime.TagHandlerPool _jspx_tagPool_c_if_test;\n\n  public Object getDependants() {\n    return _jspx_dependants;\n  }\n\n  public void _jspInit() {\n    _jspx_tagPool_c_if_test =\norg.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());\n  }\n\n  public void _jspDestroy() {\n    _jspx_tagPool_c_if_test.release();\n  }\n\n  public void _jspService(HttpServletRequest request, HttpServletResponse response)\n        throws java.io.IOException, ServletException {\n\n    JspFactory _jspxFactory = null;\n    PageContext pageContext = null;\n    HttpSession session = null;\n    ServletContext application = null;\n    ServletConfig config = null;\n    JspWriter out = null;\n    Object page = this;\n    JspWriter _jspx_out = null;\n    PageContext _jspx_page_context = null;\n\n\n    try {\n      _jspxFactory = JspFactory.getDefaultFactory();\n      response.setContentType(\'text/html;charset=UTF-8\');\n      pageContext = _jspxFactory.getPageContext(this, request, response,\n      			null, true, 8192, true);\n      _jspx_page_context = pageContext;\n      application = pageContext.getServletContext();\n      config = pageContext.getServletConfig();\n      session = pageContext.getSession();\n      out = pageContext.getOut();\n      _jspx_out = out;\n\n      String _jspx_temp0 = \' http://www.apache.org \';\n      out.write(\'<\' + \'a\' + \' href= \'\' + _jspx_temp0 + \' \'\' + \'/>\');\n      if (_jspx_meth_t_test_0(_jspx_page_context))\n        return;\nboolean _jspx_temp0=\n((java.lang.Boolean)\norg.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(\'${true}\',\njava.lang.Boolean.class, (PageContext)_jspx_page_context, null,\nfalse)).booleanValue();\nif (_jspx_temp0){\n      out.write(\'it\'s true!\');\n}\n    } catch (Throwable t) {\n      if (!(t instanceof SkipPageException)){\n        out = _jspx_out;\n        if (out != null && out.getBufferSize() != 0)\n          out.clearBuffer();\n        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);\n      }\n    } finally {\n      if (_jspxFactory != null) _jspxFactory.releasePageContext(_jspx_page_context);\n    }\n  }\n\n  private boolean _jspx_meth_t_test_0(PageContext _jspx_page_context)\n          throws Throwable {\n    PageContext pageContext = _jspx_page_context;\n    JspWriter out = _jspx_page_context.getOut();\n    //  t:test\n    org.apache.jsp.tag.web.test_tag _jspx_th_t_test_0 = new\norg.apache.jsp.tag.web.test_tag();\n    _jspx_th_t_test_0.setJspContext(_jspx_page_context);\n    _jspx_th_t_test_0.doTag();\n    return false;\n  }\n}\n===================================\n\nScan that code for the temp variable named _jspx_temp0.  Notice that there is\none String with that name and one boolean with that name.  Thus, this results in\na java compilation error once you ultimately try to compile the page:\n===================================\nCompiling 2 source files to c: work marzen tmp jspc classes\nc: work marzen tmp jspc src org apache jsp WEB_002dINF jsp test_jsp.java:61:\n_jspx_temp0 is already defined in\n_jspService(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\nboolean _jspx_temp0=\n        ^\nc: work marzen tmp jspc src org apache jsp WEB_002dINF jsp test_jsp.java:63:\nincompatible types\nfound   : java.lang.String\nrequired: boolean\nif (_jspx_temp0){\n    ^\nNote: c: work marzen tmp jspc src org apache jsp WEB_002dINF jsp test_jsp.java\nuses unchecked or unsafe operations.\nNote: Recompile with -Xlint:unchecked for details.\n2 errors\n===================================\n\nThe problem is caused by the fact that the Node.NamedAttribute constructor\ndirectly uses JspUtil.nextTemporaryVariableName() to generate a variable name. \nI *believe* that if the variable was initialized just-in-time in the getter,\nthat the problem would be solved.\n\nThe flow goes like this:\n\n1) When compiling test.jsp, Compiler.generateJava() calls\nJspUtil.resetTemporaryVariableName() to reset the temp variable name\n\n2) The test.jsp file gets parsed immediately thereafter, thus creating a\nvariable with name _jspx_temp0 for the \'href\' attribute\n\n3) Shortly thereafter, tag files are loaded, which means that the test.tag file\nwill be recompiled, thus resulting in JspUtil.resetTemporaryVariableName() being\ninvoked again (thus setting the variable back to 0).\n\n4) Since test.tag doesn\'t do anything to cause a temporary variable name to be\nrecreated, the temp variable name remains at 0.\n\n5) Upon returning to the compilation of the test.jsp, the If tag plugin is used\nto create yet another variable name with name _jspx_temp0, hence the conflict.\n\nI think step 2 is the root of the problem.  If the NamedAttribute didn\'t get a\ntemporary variable name assigned in the constructor and instead generated it\njust-in-time in the getter, then this issue wouldn\'t exist since the \'href\'\nattribute variable name would be created only after first compiling all of the\ntag files.\n\nI still think that the logic in the compilation is a bit strange given that the\nJSP will use temporary variable names starting at whatever point the last\ncompiled tag file left off at.  I think that issue could be resolved by moving\nthe JspUtil.resetTemporaryVariableName() call in Compiler.generateJava() down\nafter the call to loadTagFiles().  Note that you would probably also want to\ncall JspUtil.resetTemporaryVariableName() in the ctxt.isPrototypeMode()\nscenario.  Here is the diff that I would propose for Compiler.java based on the\n5.5.20 codebase:\n\n===================================\n150,152d149\n<             // Reset the temporary variable counter for the generator.\n<             JspUtil.resetTemporaryVariableName();\n<\n157a155,156\n>                 // Reset the temporary variable counter for the generator.\n>                 JspUtil.resetTemporaryVariableName();\n179a179,181\n>             // Reset the temporary variable counter for the generator.\n>             JspUtil.resetTemporaryVariableName();\n>\n===================================\n\n\nHere is the diff I would propose for Node.java:\n===================================\n1791d1790\n<             temporaryVariableName = JspUtil.nextTemporaryVariableName();\n1837a1837,1839\n>             if(temporaryVariableName==null) {\n>                 temporaryVariableName = JspUtil.nextTemporaryVariableName();\n>             }\n===================================', 'Brian Lenz', '2007-05-16 17:43:51 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (334, '42361', 'Bug 42361 POST content type incorrect for multipart forms after login', 'When using a form with a custom encoding (e.g. \'multipart/form-data\'), the\ncontent type is not restored after a redirect to a login page (auth-method = FORM).\n\nTo reproduce:\n- A page that POSTs using multipart/form-data encoding (or anything other than\napplication/x-www-form-urlencoded) to a result page that is protected by a login\npage (auth-method=FORM) is invoked.\n- Even though the multipart POST data exists (verified by reading input stream\nof request from result page) the content type of the request is always\n\'application/x-www-form-urlencoded\'.  \n- This only happens when redirected to the login page first.  It does not happen\nif already logged in.', 'Peter Runge', '2007-05-08 16:06:35 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (335, '42202', 'Bug 42202 if you install tomcat in a directory with spaces it ignores TLD files inside jar files', 'if you install tomcat or a web application in a directory with spaces in the\nname, for example \'C: Program Files vds tomcat\' for tomcat or \'C: Program\nFiles vds console\' for a web application.\nthe TLD files that are inside the META-INF directory of the jar files will not\nbe loaded.\n\nthe problem is is the file treatment inside the TldConfig class ...\nI have attached a patch with the correction.\nthis bug is found in Tomcat 6 too', 'Rodrigo Urubatan', '2007-04-23 14:07:38 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (336, '42071', 'Bug 42071 If a JSP throws an UnavailableException twice, an IllegalStateException occurs.', 'If a JSP throws an UnavailableException twice, an IllegalStateException occurs.\n\nfirst access:\nJSP throws UnavailableException.\n\nsecond access:\nIf the JSP throws an UnavailableException again then an IllegalStateException\noccurs and Tomcat returns status code:500 to the client.\n\nThe problem is not that the IllegalStateException occurs.\nThe problem is that the JSP can be called even though it cannot be used.', 'kawasima', '2007-04-08 17:49:37 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (337, '42085', 'Bug 42085 java.util.Logging duplicated since 5.5.23.  5.5.20 is OK', 'We use the followwing logging.properties in our WebApplication:\n\n----------%<--------------------%<----------------\nhandlers = 1tivoli.java.util.logging.FileHandler,\n2product.java.util.logging.FileHandler\n\n# Handlers for the root logger\n.handlers = 1tivoli.java.util.logging.FileHandler,\n2product.java.util.logging.FileHandler\n\n1tivoli.java.util.logging.FileHandler.level = INFO\n1tivoli.java.util.logging.FileHandler.pattern = /var/log/product/tivoli%g.log\n# limit Output to 1MB\n1tivoli.java.util.logging.FileHandler.limit=1048576\n# Limit rotation to 10 Logs ...\n1tivoli.java.util.logging.FileHandler.count=10\n1tivoli.java.util.logging.FileHandler.append=true\n1tivoli.java.util.logging.FileHandler.formatter=de.customer.product.tivoli.TivoliFormatter\n\n2product.java.util.logging.FileHandler.level = FINEST\n2product.java.util.logging.FileHandler.pattern = /var/log/product/product%g.log\n# limit Output to 1MB\n2product.java.util.logging.FileHandler.limit=1048576\n# Limit rotation to 5 Logs ...\n2product.java.util.logging.FileHandler.count=5\n2product.java.util.logging.FileHandler.append=true\n2product.java.util.logging.FileHandler.formatter=java.util.logging.SimpleFormatter\n----------%<--------------------%<----------------\n\nWhen using apache-tomcat-5.5.23 every Line in the Logfiles\nis duplicated. Debugging I found that the TivoliFormatter \nis actually created twice. And the root-logger has actually\n4 Handlers and not two as intended. This does not allow us an\nupgrade beyond 5.5.20.\n\nFound on Linux64Bit and Windows-XP, both with JDK 1.5_R11', 'Klaus Halfmann', '2007-04-10 23:13:02 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (338, '41289', 'Bug 41289 Error when deploying XML Configuration file URL', 'I tried to deploy a webapp using a context.xml file under manager webapp and\nreceived this error:\n\njava.io.FileNotFoundException:\n/opt/apache-tomcat-6.0.2/conf/Catalina/localhost/mywebapp3.xml (No such file or\ndirectory)\n        at java.io.FileOutputStream.open(Native Method)\n        at java.io.FileOutputStream.<init>(FileOutputStream.java:179)\n        at java.io.FileOutputStream.<init>(FileOutputStream.java:131)\n        at\norg.apache.catalina.manager.ManagerServlet.copyInternal(ManagerServlet.java:1570)\n        at org.apache.catalina.manager.ManagerServlet.copy(ManagerServlet.java:1530)\n        at\norg.apache.catalina.manager.ManagerServlet.deploy(ManagerServlet.java:803)\n        at\norg.apache.catalina.manager.HTMLManagerServlet.deployInternal(HTMLManagerServlet.java:249)\n        at\norg.apache.catalina.manager.HTMLManagerServlet.doGet(HTMLManagerServlet.java:96)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:690)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:228)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n        at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:525)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:212)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:818)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:624)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:445)\n        at java.lang.Thread.run(Thread.java:613)\n\nI did checked and noticed apache-tomcat-6.0.2/conf/Catalina directory no longer\nexists in version 6. Did something changed?', 'Zemian Deng', '2007-01-04 07:42:41 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (339, '40150', 'Bug 40150 Incorrect User/Role classnames are silently ignored.', 'org.apache.catalina.realm.JAASRealm does not verify any of the class names that\nare set through setRoleClassNames() and setUserClassNames().\n\nIf an incorrect class name (e.g. a typo) is configured in context.xml, this is\nunnoticed by JAASRealm. The result is that during authentication, when the\nsubject\'s principals are checked against the configured class names, the\nprincipals are not recognised, and therefore not added to the subject.\n\nThe fact an incorrect configured class name is currently not detected and logged\nmakes it very hard to find the source of the problem. It can be easily fixed by\nchecking the class names in the two methods mentioned above. The class must\nexist, and it must implement java.security.Principal, which is currently not\nenforced/checked by the code.', 'Tom', '2006-08-01 08:52:32 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (340, '40820', 'Bug 40820 Default JSP factory not initialized early enough', 'With the latest TC6 code, I\'m seeing a problem that did not exist on earlier TC6\ndrivers.  Sorry that I can\'t put a finger on when this problem arose.  I looked\ninto relevant source files (like JspRuntimeContext) but haven\'t found the source\nof the problem. \n\nHere\'s the issue (a testcase will be attached). \n\nThe app is very simple: it installs ServletContextListener for the purpose of\nadding a custom ELResolver.  It accomplishes this via: \n\n    public void contextInitialized(ServletContextEvent evt) { \n        ServletContext context = evt.getServletContext(); \n        JspApplicationContext jspContext =\nJspFactory.getDefaultFactory().getJspApplicationContext(context); \n        jspContext.addELResolver(new ChipsELResolver()); \n    } \n\n\nThe problem is that JspFactory.getDefaultFactory() is returning null; see below.\n\nOct 4, 2006 5:32:18 PM org.apache.catalina.core.AprLifecycleListener lifecycleEv \nent \nINFO: The Apache Tomcat Native library which allows optimal performance in produ \nction environments was not found on the java.library.path: C: javaFor6.0BuildJDK \n15 java jre bin;.;C: javaFor6.0BuildJDK15 java bin;c: mantis2.1 mantis bin;C: se \ntupIBASE;C: Perl bin ;C: WINDOWS system32;C: WINDOWS;C: WINDOWS System32 Wbem;c: \n Python22;C: Program Files PC-Doctor for Windows services;c: cvsnt-2.0.4;c: ecli \npse;w: ;w: bin;C: Program Files QuickTime QTSystem ;C: Diskeeper ;C: CMVC exe;C: \n CMVC exe bin;;C: CMVCDC50;C: CMVCDC50;C: CMVCDC50; \nOct 4, 2006 5:32:18 PM org.apache.coyote.http11.Http11Protocol init \nINFO: Initializing Coyote HTTP/1.1 on http-8080 \nOct 4, 2006 5:32:19 PM org.apache.catalina.startup.Catalina load \nINFO: Initialization processed in 1234 ms \nOct 4, 2006 5:32:19 PM org.apache.catalina.core.StandardService start \nINFO: Starting service Catalina \nOct 4, 2006 5:32:19 PM org.apache.catalina.core.StandardEngine start \nINFO: Starting Servlet Engine: Apache Tomcat/6.0.0-dev \nOct 4, 2006 5:32:19 PM org.apache.catalina.core.StandardHost start \nINFO: XML validation disabled \nOct 4, 2006 5:32:19 PM org.apache.catalina.startup.HostConfig deployWAR \nINFO: Deploying web application archive ELResolverTest.war \nChipsListener.contextInitialized  evt= javax.servlet.ServletContextEvent[source= \norg.apache.catalina.core.ApplicationContextFacade@3fbe3fbe] \nChipsListener.contextInitialized  context= org.apache.catalina.core.ApplicationC \nontextFacade@3fbe3fbe \nChipsListener.contextInitialized  JspFactory.getDefaultFactory()= null \nOct 4, 2006 5:32:20 PM org.apache.catalina.core.StandardContext start \nSEVERE: Error listenerStart \nOct 4, 2006 5:32:20 PM org.apache.catalina.core.StandardContext start \nSEVERE: Context [/ELResolverTest] startup failed due to previous errors \nOct 4, 2006 5:32:21 PM org.apache.coyote.http11.Http11Protocol start \nINFO: Starting Coyote HTTP/1.1 on http-8080 \nOct 4, 2006 5:32:21 PM org.apache.jk.common.ChannelSocket init \nINFO: JK: ajp13 listening on /0.0.0.0:8009 \nOct 4, 2006 5:32:21 PM org.apache.jk.server.JkMain start \nINFO: Jk running ID=0 time=0/63  config=null \nOct 4, 2006 5:32:21 PM org.apache.catalina.startup.Catalina start \nINFO: Server startup in 2657 ms \n\n\nThis is easily reproducible when you deploy the ELResolverTest.war *before* the\nserver has started (I assume JspFactory.setDefaultFactory() hasn\'t been invoked\nat the time the listeners are being installed).  If you deploy the WAR *after*\nthe server starts, the problem does not manifest and the app works --- until you\nstop and restart the server.', 'Scott Johnson', '2006-10-26 07:52:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (341, '41057', 'Bug 41057 Tomcat leaks memory on every request', 'POST parameter values stay referenced by a static field in\norg.apache.tomcat.util.buf.StringCache - thus the GC can never release the memory.\n\nSteps to Reproduce:\n1) install and start tomcat 5.5\n( http://apache.zone-h.org/tomcat/tomcat-5/v5.5.20/bin/apache-tomcat-5.5.20.zip )\n\n2) see the example webapp \'Request Parameters Example\' included in the install\n( http://localhost:8080/servlets-examples/servlet/RequestParamExample )\n\n3) run script \'send.sh\' to create heavy load\n#!/bin/bash\n\nexport LEAK_COMMAND=\'curl --silent\n http://localhost:8080/servlets-examples/servlet/RequestParamExample  --output\nresponse.htm --data @send.txt\'\n\n#create initial POST parameter with value about 10kB\n\necho \'firstname=\' > send.txt\nfor((i=0;$i<=10000;i=$(($i+1))));do\n  echo -n \'x\' >> send.txt\ndone\n\n\n#send the request\nfor((i=0;$i<=1000;i=$(($i+1))));do\n  echo $i\n  # modify the param value to send (append i)\n  echo -n $i >> send.txt\n  \n  $LEAK_COMMAND\n\ndone\n\n4) running the script causes heap usage to increase for some 40MB', 'vilks56', '2006-11-28 10:07:27 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (342, '40901', 'Bug 40901 listings page does not escape XML characters', 'On Solaris you can have a file or directory name called \'<b>xxx\' or \'<i>yyy\'.\nUsing Tomcat\'s listings feature, you get a directory listing with the file name\nin bold or italics.\n\nI am not familiar with Javascript or cross-site scripting security problems, but\nI believe Tomcat escapes XML characters like \'>\' and \'<\' to prevent client\nbrowsers to interpret HTML codes that are not intended to be interpreted as such\nfor the default error page.\nI think the same should be done for listings, or a warning should be added to\nthe documentation not to use it if you have no control over the file/directory\nnames you list.', 'Dies Koper', '2006-11-05 20:38:27 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (343, '37509', 'Bug 37509 ClassLoaderLogManager remove \' n\' at the end of logging.properties values', 'The method ClassLoaderLogManager.replace(String) that is in charge of replacing\nsystem properties at the begining of the property also modify the end of the\nproperty due to a call to trim.\n\nThis implies that Logger/Handler/Formatter that relies on properties endding\nwith some spases (including \' n\') will have a different behaviour with JDK\nLogManger and tomcat ClassLoaderLogManager\n\na modified verstion of this method could be:\n\n    protected String replace(String str) {\n// start modification    	\n//        String result = str.trim();  // commented out\n    	\n    	int len = str.length();\n    	int st = 0;\n    	while ((st < len) && (str.charAt(st) <= \' \')) {\n    	    st++;\n    	}\n    	String result = (st > 0) ? str.substring(st) : str;\n// end modification        \n        \n        if (result.startsWith(\'${\')) {\n            int pos = result.indexOf(\'}\');\n            if (pos != -1) {\n                String propName = result.substring(2, pos);\n                String replacement = System.getProperty(propName);\n                if (replacement != null) {\n                    result = replacement + result.substring(pos + 1);\n                }\n            }\n        }\n        return result;\n    }', 'Franck Hamelin', '2005-11-15 18:22:38 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (344, '34956', 'Bug 34956 Tomcat should enforce the requirements from servlet 2.4 specification SRV.8.2', 'Tomcat should enforce the requirements from servlet 2.4 specification SRV.8.2\n\nSRV.8.2 Using a Request Dispatcher\n\n\'To use a request dispatcher, a servlet calls either the include method or\nforward method of the RequestDispatcher interface. The parameters to these\nmethods can be either the request and response arguments that were passed in via\nthe service method of the Servlet interface, or instances of subclasses of the\nrequest and response wrapper classes that have been introduced for version 2.3\nof the specification. In the latter case, the wrapper instances must wrap the\nrequest or response objects that the container passed into the service method.\nThe Container Provider must ensure that the dispatch of the request to a target\nservlet occurs in the same thread of the same VM as the original request\'\n\nJustification:\n==============\nThe absense of this enforcement leads to software beeing developed not following\nthe specification. The software cannot be deployed later on a container which\nconforms to the above paragraph and hence must be changed before deployment.\nThis somehow contradicts the idea of having a standards based infrastructure.', 'christian.buchegger', '2005-05-18 14:47:47 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (345, '40817', 'Bug 40817 servlet-cgi throws index out of bounds exception on certain cgi', 'First, servlets-cgi.jar needs to exist and the servlet must be mapped:\nfor example:\n <servlet-mapping>\n   <servlet-name>cgi</servlet-name>\n   <url-pattern>*.pl</url-pattern>\n </servlet-mapping>\n\nTest perl cgi script:\n #!/usr/bin/perl\n print \'Content-type: text/plain\', \' n n\';\n print \'Hello world, from Perl n\';\n\nOne perl script is placed in www-root (\'/test.pl\') and the other in any\nsubfolder (\'/test/test.pl\' or \'/cgi-bin/test.pl\', etc.)\n\nThe cgi script in the subfolder will run fine.\nThe cgi script in the www-root will generate an exception:\njava.lang.StringIndexOutOfBoundsException: String index out of range: -1\n	java.lang.String.substring(String.java:1768)\n	java.lang.String.substring(String.java:1735)\n	org.apache.catalina.servlets.CGIServlet$CGIEnvironment.findCGI(CGIServlet.java:948)\n	org.apache.catalina.servlets.CGIServlet$CGIEnvironment.setCGIEnvironment(CGIServlet.java:1015)\n	org.apache.catalina.servlets.CGIServlet$CGIEnvironment.<init>(CGIServlet.java:766)\n	org.apache.catalina.servlets.CGIServlet.doGet(CGIServlet.java:584)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\n\nThe problem is this line (line 948 in CGIServlet.java):\n\ncginame =              \ncurrentLocation.getParent().substring(webAppRootDir.length())+ File.separator +\nname;\n\nThe problem is that webAppRootDir is 1 char longer than\ncurrentLocation.getParent() because webAppRootDir ends with a File.separator (in\nthis case, a \'/\').  And removing the extra File.separator from webAppRootDir\nwill result in a different String related exception elsewhere.\n\nAnd here\'s a fix that works:\n\ncginame = (currentLocation.getParent() + \nFile.separator).substring(webAppRootDir.length()) + name;\n\n(If necessary, the fix can be made more adaptive by checking to see if it really\ndoes have a File.separator at the end and if not...add it...otherwise, let it\nbe, etc.)\n\n(on a side note, I have one more bug to fix; the ENV_VAR \'SCRIPT_FILENAME\' isn\'t\ndefined as it should be [required for PHP4/5] but I\'ll submit a different\nbug/fix for that.)', 'Gene Hardesty', '2006-10-25 20:02:52 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (346, '37458', 'Bug 37458 Datarace on org.apache.catalina.loader.WebappClassLoader', 'In findClassInternal, it is possible that entry.manifest is set to null by \nanother thread right before calling definePackage(packageName, entry.manifest, \nentry.codeBase).', 'Feng Chen', '2005-11-10 21:34:17 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (347, '39724', 'Bug 39724 Bug on StandardPipeline.removeValve(Valve valve) for T5.5.16+', 'I run into this problem with T5 when tring to add/remove/add a valve to the\nstandard engine. -For what I understand an empty pipeline has:\nbasic = StandardEngineValve (For example);\nfirst = null;\n\n-If you add a valve you will get\nbasic = StandardEngineValve\nfirst = myValve (with myValve.next = StandardEngineValve)\n\n-If you remove the valve you will get\nbasic =StandardEngineValve\nfirst = StandardEngineValve\nNote that StandardEngineValve is in first too here.\n\n-If I try to add a new valve given the actual code in  addValve the valve will\nnot be added because (see the **) current = basic and current.getNext() = null;\n\naddValve(Valve valve) {\n \n       // Add this Valve to the set associated with this Pipeline\n       if (first == null) {\n           first = valve;\n           valve.setNext(basic);\n       } else {\n           Valve current = first;\n           while (current != null) {\n**                if (current.getNext() == basic) {\n                   current.setNext(valve);\n                   valve.setNext(basic);\n                   break;\n               }\n               current = current.getNext();\n           }\n       }\n\n   }', 'David Gagnon', '2006-06-05 14:01:56 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (348, '29727', 'Bug 29727 JNDI env-entry not reload when context reloaded', 'If environment entries are changed in web.xml, and the application context is \nrestarted, the values in the JNDI context are the old values.\n\nIf the environment entries are changed via the Tomcat \'admin\' interface, then \nthe values provided to the context are correct.\n\nThe following code is can be used to check the environment:\n\n        try {\n            InitialContext ic = new InitialContext();\n            NamingEnumeration enum = ic.listBindings(\'java:comp/env\');\n\n            while (enum.hasMore()) {\n                Binding binding = (Binding) enum.next();\n                jndi.setProperty(binding.getName(), \'\' + binding.getObject());\n                System.out.println(\'jndi setting: \' + binding.getName() + \'=\' \n+ binding.getObject());\n            }\n        } catch (NamingException e) {\n            System.err.println(\'unable to read JNDI settings, \' + e);\n        }\n\n\nThe web.xml fragment looks as follows:\n\n	<env-entry>\n		<env-entry-name>DatabaseURL</env-entry-name>\n		<env-entry-value>jdbc:hsqldb:hsql://localhost</env-entry-value>\n		<env-entry-type>java.lang.String</env-entry-type>\n	</env-entry>', 'robert engels', '2004-06-21 22:56:25 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (349, '34399', 'Bug 34399 Undeploying fails when context defined in server.xml & server fails to stop', 'Steps to reproduce: \n \n1. autodeploy a web application by defining its context in server.xml \n2. start the Tomcat server \n3. use the Tomcat Manager to undeploy the application \n \nYou will get the \'OK - Undeployed application at context path /WebApplication\' \nmessage, but the application will NOT be undeployed, it will be only stopped. \n \nIf you try to stop the server after that, it will fail! \n \nI have used the shared installation (CATALINA_BASE dir), but I guess this \nwon\'t work for standalone Tomcat isntallation either.', 'sherold', '2005-04-11 16:32:42 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (350, '34509', 'Bug 34509 tag names that are xml:Name but not java identifier are not accepted', 'According to the JSP 2.0 specification, custom tag prefix and name should be \nof the type XML:Name. However, for Tomcat 5.5.8, if the name is not a legal \njava identifier, then a compilation error occurs. For instance, Tomcat won\'t \naccept Da~te`T#ag as a legal name for the Tag.', 'elaine chien', '2005-04-19 00:45:34 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (351, '31804', 'Bug 31804 setParent() is not called on nested tags in a tag file (.tagx)', 'Hi, everybody.\n\nSuppose I have a tag file (.tagx to be precise). I have some custom tags of mine \nincluded in that tag file. If I override setParent() in such a custom tag, then \nI see, that it\'s invoked with \'null\' parameter. Custom tag is a \'Classic\' tag \n(extends TagSupport).\n\nSimplified example: This tag file is called \'submit.tagx\'\n\n<?xml version=\'1.0\' encoding=\'UTF-8\'?>\n<jsp:root xmlns:jsp=\' http://java.sun.com/JSP/Page \' xmlns:custom=\' http://my.com/ \ntags-html\' version=\'2.0\' >\n\n    <jsp:directive.tag body-content=\'empty\'/>\n    <jsp:directive.attribute name=\'action\' required=\'true\' rtexprvalue=\'true\'/>\n    <jsp:directive.attribute name=\'label\' required=\'true\' rtexprvalue=\'true\'/>\n\n    <custom:submit action=\'${action}\' label=\'${label}\' name=\'submitButton\' />\n\n</jsp:root>\n\nIn debug output from setParent(Tag) of custom:submit I see, that it\'s called \nwith \'null\' value.\n\nIf, instead of custom:submit, I put there another custom tag, which follows \nSimpleTagSupport model, then setParent(JspTag) is not called at all!!!\n\nI would expect a reference to something, representing translated class of Tag \nFile (submit.tagx) is passed.\n\nAs the result, tag nesting tree is broken. \n\nI need to access Struts html:form tag, which is the embracing tag from my inner \n<custom:submit> tag to obtain form name, but this is not possible.\n\n<nested:form action=\'/Action\'>\n   <ctrl:submit action=\'save\' label=\'Save\'/>\n</nested:form>\n\n(where ctrl:submit is submit.tagx)', 'Firepica', '2004-10-20 16:26:40 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (352, '38713', 'Bug 38713 java.io.IOException: tmpFile.renameTo(classFile) failed when compiling new JSP (upon redeploy)', '[http-8080-Processor24 ERROR 26902165 DispatcherServlet.serviceWrapper()] -\nCould not complete request\norg.apache.jasper.JasperException: Unable to compile class for JSP\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:565)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:293)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:291)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:672)\n        at\norg.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:463)\n        at\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:398)\n        at\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:301)\n        at\norg.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:97)\n        at\norg.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)\n        at\norg.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:928)\n        at\norg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:705)\n        at\norg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:625)\n        at\norg.springframework.web.servlet.FrameworkServlet.serviceWrapper(FrameworkServlet.java:386)\n        at\norg.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:346)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:856)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:744)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)\n[http-8080-Processor24 ERROR 26902165 [wirelessapp].invoke()] -\nServlet.service() for servlet wirelessapp threw exception\njava.io.IOException: tmpFile.renameTo(classFile) failed\n        at\norg.apache.jasper.compiler.SmapUtil$SDEInstaller.install(SmapUtil.java:245)\n        at org.apache.jasper.compiler.SmapUtil.installSmap(SmapUtil.java:164)\n        at\norg.apache.jasper.compiler.AntCompiler.generateClass(AntCompiler.java:267)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:288)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:267)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:255)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:556)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:293)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:291)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:672)\n        at\norg.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:463)\n        at\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:398)\n        at\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:301)\n        at\norg.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:97)\n        at\norg.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)\n        at\norg.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:928)\n        at\norg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:705)\n        at\norg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:625)\n        at\norg.springframework.web.servlet.FrameworkServlet.serviceWrapper(FrameworkServlet.java:386)\n        at\norg.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:346)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:856)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:744)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)', 'Eric', '2006-02-20 08:08:04 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (353, '40306', 'Bug 40306 mod_jk, POST request bodies are not restored on successful login when using mod_jk', 'After the FormAuthenticator intercepts a POST request to a protected resource,\nthe original request is not properly restored upon successful login when using\nmod_jk. When connectiong to tomcat directly (8080), the POST request is restored\nas expected.\n\nI\'ve tested this with mod_jk 1.2.15 and 1.2.18. It seems the problem is that the\norginal request is not saved properly. I (think) I\'ve narrowed down the issue in\n  FormAuthenticator.java. body.toString() was returning null. (The buffer was\nnull) so it looks like the root of the problem is that nothing is read from the\ninput stream.\n\nDuring testing I reverted to the old way of adding the request parameters\n(saved.addParameter()) to see if they were indeed there and it worked. \n\nI also tried,\nInputStream is = new BufferedInputStream(request.getInputStream()); \nwhich didn\'t work..\n\n\nfrom FormAuthenticator.java: \n\nprotected void saveRequest(Request request, Session session)\n        throws IOException {\n\n      ...\n\n      if (\'POST\'.equalsIgnoreCase(request.getMethod())) {\n            ByteChunk body = new ByteChunk();\n            body.setLimit(request.getConnector().getMaxSavePostSize());\n\n            byte[] buffer = new byte[4096];\n            int bytesRead;\n            InputStream is = request.getInputStream();\n        \n            while ( (bytesRead = is.read(buffer) ) >= 0) {\n                body.append(buffer, 0, bytesRead);\n            }\n			\n            saved.setBody(body);\n        } \n\n        ...\n}', 'Aaron Loucks', '2006-08-23 19:48:03 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (354, '34801', 'Bug 34801 PATCH: CGIServlet does not terminate child after a timeout', 'CGIServlet does not kill CGI child process on IOException, nor terminate child\nafter a timeout.\n\nWe had a problem where a CGI child process (in perl, on windows) remained\nrunning for a long time. In some situations where the client disconnected, an\nIOException was thrown in the servlet, but this did not result in a cleanup of\nthe CGI child process. This was a problem as our CGI program accessed a single\nthreaded resource over TCP, and could therefore lock the system up indefinitly.\n\n===\n\n--- CGIServlet.java	Sun May 08 04:46:05 2005\n+++\nC: Temp hjakarta-tomcat-5.5.9-src.tar jakarta-tomcat-5.5.9-src jakarta-tomcat-catalina catalina src share org apache catalina servlets CGIServlet.java\nSat Mar 26 18:24:02 2005\n@@ -267,8 +267,6 @@\n     private String parameterEncoding = System.getProperty(\'file.encoding\',\n                                                           \'UTF-8\');\n \n-    private long lScriptTimeoutMillis = 2000;\n-\n     /** object used to ensure multiple threads don\'t try to expand same file */\n     static Object expandFileLock = new Object();\n \n@@ -332,16 +330,10 @@\n             cgiExecutable = value;\n         }\n \n-\n         value = getServletConfig().getInitParameter(\'parameterEncoding\');\n         if (value != null) {\n             parameterEncoding = value;\n         }\n-        // Added by CJD\n-        value = getServletConfig().getInitParameter(\'scriptTimeout\');\n-        if (value != null) {\n-            lScriptTimeoutMillis = Integer.valueOf(value).intValue();\n-        }\n \n         // Identify the internal container resources we need\n         context = config.getServletContext();\n@@ -1440,7 +1432,7 @@\n      */\n \n     protected class CGIRunner {\n-        private Process proc = null;\n+\n         /** script/command to be executed */\n         private String command = null;\n \n@@ -1656,6 +1648,7 @@\n             InputStream cgiOutput = null;\n             BufferedReader commandsStdErr = null;\n             BufferedOutputStream commandsStdIn = null;\n+            Process proc = null;\n             int bufRead = -1;\n \n             //create query arguments\n@@ -1731,200 +1724,138 @@\n             }\n \n             rt = Runtime.getRuntime();\n-            try {\n+            proc = rt.exec(cmdAndArgs.toString(), hashToStringArray(env), wd);\n \n-                proc = rt.exec(cmdAndArgs.toString(), hashToStringArray(env), wd);\n+            if(contentStream != null) {\n+                commandsStdIn = new BufferedOutputStream(proc.getOutputStream());\n+                commandsStdIn.write(contentStream.toByteArray());\n+                commandsStdIn.flush();\n+                commandsStdIn.close();\n+            }\n \n-                if(contentStream != null) {\n-                    commandsStdIn = new\nBufferedOutputStream(proc.getOutputStream());\n-                    commandsStdIn.write(contentStream.toByteArray());\n-                    commandsStdIn.flush();\n-                    commandsStdIn.close();\n-                }\n+            /* we want to wait for the process to exit,  Process.waitFor()\n+             * is useless in our situation; see\n+             *  http://developer.java.sun.com/developer/ \n+             *                               bugParade/bugs/4223650.html\n+             */\n \n-                /* we want to wait for the process to exit,  Process.waitFor()\n-                 * is useless in our situation; see\n-                 *  http://developer.java.sun.com/developer/ \n-                 *                               bugParade/bugs/4223650.html\n-                 */\n-\n-                boolean isRunning = true;\n-                commandsStdErr = new BufferedReader\n-                    (new InputStreamReader(proc.getErrorStream()));\n-                BufferedWriter servletContainerStdout = null;\n+            boolean isRunning = true;\n+            commandsStdErr = new BufferedReader\n+                (new InputStreamReader(proc.getErrorStream()));\n+            BufferedWriter servletContainerStdout = null;\n \n-                try {\n-                    if (response.getOutputStream() != null) {\n-                        servletContainerStdout =\n-                            new BufferedWriter(new OutputStreamWriter\n-                                (response.getOutputStream()));\n-                    }\n-                } catch (IOException ignored) {\n-                    //NOOP: no output will be written\n+            try {\n+                if (response.getOutputStream() != null) {\n+                    servletContainerStdout =\n+                        new BufferedWriter(new OutputStreamWriter\n+                            (response.getOutputStream()));\n                 }\n-                final BufferedReader stdErrRdr = commandsStdErr ;\n+            } catch (IOException ignored) {\n+                //NOOP: no output will be written\n+            }\n+            final BufferedReader stdErrRdr = commandsStdErr ;\n \n-                new Thread() {\n-                        public void run () {\n-                            sendToLog(stdErrRdr) ;\n-                        } ;\n-                    }.start() ;\n-\n-\n-                new Thread() {\n-                        public void run () {\n-                            deadProcWatcher(proc,lScriptTimeoutMillis) ;\n-                        } ;\n-                    }.start() ;\n-\n-                InputStream cgiHeaderStream =\n-                    new HTTPHeaderInputStream(proc.getInputStream());\n-                BufferedReader cgiHeaderReader =\n-                    new BufferedReader(new InputStreamReader(cgiHeaderStream));\n-                boolean isBinaryContent = false;\n+            new Thread() {\n+                public void run () {\n+                    sendToLog(stdErrRdr) ;\n+                } ;\n+            }.start() ;\n+\n+            InputStream cgiHeaderStream =\n+                new HTTPHeaderInputStream(proc.getInputStream());\n+            BufferedReader cgiHeaderReader =\n+                new BufferedReader(new InputStreamReader(cgiHeaderStream));\n+            boolean isBinaryContent = false;\n             \n-\n-\n-                while (isRunning) {\n-                    try {\n-                        //set headers\n-                        String line = null;\n-                        while (((line = cgiHeaderReader.readLine()) != null)\n-                               && !(\'\'.equals(line))) {\n-                            if (debug >= 2) {\n-                                log(\'runCGI: addHeader( \'\' + line + \' \')\');\n-                            }\n-                            if (line.startsWith(\'HTTP\')) {\n-                                //TODO: should set status codes (NPH support)\n-                                /*\n-                                 * response.setStatus(getStatusCode(line));\n-                                 */\n-                            } else if (line.indexOf(\':\') >= 0) {\n-                                String header =\n-                                    line.substring(0, line.indexOf(\':\')).trim();\n-                                String value =\n-                                    line.substring(line.indexOf(\':\') + 1).trim(); \n-                                response.addHeader(header , value);\n-                                if ((header.toLowerCase().equals(\'content-type\'))\n-                                    && (!value.toLowerCase().startsWith(\'text\'))) {\n-                                    isBinaryContent = true;\n-                                }\n-                            } else {\n-                                log(\'runCGI: bad header line  \'\' + line + \' \'\');\n+            while (isRunning) {\n+                try {\n+                    //set headers\n+                    String line = null;\n+                    while (((line = cgiHeaderReader.readLine()) != null)\n+                           && !(\'\'.equals(line))) {\n+                        if (debug >= 2) {\n+                            log(\'runCGI: addHeader( \'\' + line + \' \')\');\n+                        }\n+                        if (line.startsWith(\'HTTP\')) {\n+                            //TODO: should set status codes (NPH support)\n+                            /*\n+                             * response.setStatus(getStatusCode(line));\n+                             */\n+                        } else if (line.indexOf(\':\') >= 0) {\n+                            String header =\n+                                line.substring(0, line.indexOf(\':\')).trim();\n+                            String value =\n+                                line.substring(line.indexOf(\':\') + 1).trim(); \n+                            response.addHeader(header , value);\n+                            if ((header.toLowerCase().equals(\'content-type\'))\n+                                && (!value.toLowerCase().startsWith(\'text\'))) {\n+                                isBinaryContent = true;\n                             }\n+                        } else {\n+                            log(\'runCGI: bad header line  \'\' + line + \' \'\');\n                         }\n+                    }\n \n-                        //write output\n-                        if (isBinaryContent) {\n-                            byte[] bBuf = new byte[2048];\n-                            OutputStream out = response.getOutputStream();\n-                            cgiOutput = proc.getInputStream();\n-                            while ((bufRead = cgiOutput.read(bBuf)) != -1) {\n-                                if (debug >= 4) {\n-                                    log(\'runCGI: output \' + bufRead +\n-                                        \' bytes of binary data\');\n-                                }\n-                                out.write(bBuf, 0, bufRead);\n+                    //write output\n+                    if (isBinaryContent) {\n+                        byte[] bBuf = new byte[2048];\n+                        OutputStream out = response.getOutputStream();\n+                        cgiOutput = proc.getInputStream();\n+                        while ((bufRead = cgiOutput.read(bBuf)) != -1) {\n+                            if (debug >= 4) {\n+                                log(\'runCGI: output \' + bufRead +\n+                                    \' bytes of binary data\');\n                             }\n-                        } else {\n-                            commandsStdOut = new BufferedReader\n-                                (new InputStreamReader(proc.getInputStream()));\n+                            out.write(bBuf, 0, bufRead);\n+                        }\n+                    } else {\n+                        commandsStdOut = new BufferedReader\n+                            (new InputStreamReader(proc.getInputStream()));\n \n-                            char[] cBuf = new char[1024];\n-                            try {\n-                                while ((bufRead = commandsStdOut.read(cBuf)) !=\n-1) {\n-                                    if (servletContainerStdout != null) {\n-                                        if (debug >= 4) {\n-                                            log(\'runCGI: write( \'\' +\n+                        char[] cBuf = new char[1024];\n+                        try {\n+                            while ((bufRead = commandsStdOut.read(cBuf)) != -1) {\n+                                if (servletContainerStdout != null) {\n+                                    if (debug >= 4) {\n+                                        log(\'runCGI: write( \'\' +\n                                                 new String(cBuf, 0, bufRead) +\n\' \')\');\n-                                        }\n-                                        servletContainerStdout.write(cBuf, 0,\nbufRead);\n                                     }\n-                                }\n-                            } finally {\n-                                // Attempt to consume any leftover byte if\nsomething bad happens,\n-                                // such as a socket disconnect on the servlet\nside; otherwise, the\n-                                // external process could hang\n-                                if (bufRead != -1) {\n-                                    while ((bufRead =\ncommandsStdOut.read(cBuf)) != -1) {}\n+                                    servletContainerStdout.write(cBuf, 0, bufRead);\n                                 }\n                             }\n-    \n-                            if (servletContainerStdout != null) {\n-                                servletContainerStdout.flush();\n+                        } finally {\n+                            // Attempt to consume any leftover byte if\nsomething bad happens,\n+                            // such as a socket disconnect on the servlet side;\notherwise, the\n+                            // external process could hang\n+                            if (bufRead != -1) {\n+                                while ((bufRead = commandsStdOut.read(cBuf)) !=\n-1) {}\n                             }\n                         }\n-\n-                        proc.exitValue(); // Throws exception if alive\n-\n-                        isRunning = false;\n-\n-                    } catch (IllegalThreadStateException e) {\n-                        try {\n-                            Thread.sleep(500);\n-                        } catch (InterruptedException ignored) {\n+    \n+                        if (servletContainerStdout != null) {\n+                            servletContainerStdout.flush();\n                         }\n                     }\n-               \n-                } //replacement for Process.waitFor()\n-                // Close the output stream used\n-                if (isBinaryContent) {\n-                    cgiOutput.close();\n-                } else {\n-                    commandsStdOut.close();\n-                }\n-            }\n-            catch (IOException e){\n-                log (\'Caught exception \' + e);\n-                System.out.println(\'Caught IOException - printing dump 1\');\n-                e.printStackTrace();\n-                if (proc != null){\n-                    proc.destroy();\n-                    proc = null;\n-                }\n-                throw new IOException (e.toString());\n-            }\n-            finally{\n-                log (\'Running finally block\');\n-                if (proc != null){\n-                    proc.destroy();\n-                    proc = null;\n-                }\n-            }\n-        }\n \n-        private void deadProcWatcher(Process myproc,long lWait){\n-            long processRunDeadline = System.currentTimeMillis() +lWait;\n+                    proc.exitValue(); // Throws exception if alive\n+\n+                    isRunning = false;\n \n-            while(System.currentTimeMillis() < processRunDeadline){\n-                log(\'deadProcWatcher: cgi run:  \' + \n-                    processRunDeadline + \' \' +\n-                    System.currentTimeMillis() +\n-                    \' \' + myproc);\n-                try{\n-                    myproc.exitValue(); // Throws exception if alive\n-                    log(\'deadProcWatcher: exiting normally\');\n-                    return; // child has exited, we can exit\n-                    \n                 } catch (IllegalThreadStateException e) {\n                     try {\n                         Thread.sleep(500);\n                     } catch (InterruptedException ignored) {\n                     }\n                 }\n+            } //replacement for Process.waitFor()\n+            // Close the output stream used\n+            if (isBinaryContent) {\n+                cgiOutput.close();\n+            } else {\n+                commandsStdOut.close();\n             }\n-            if (System.currentTimeMillis() > processRunDeadline){\n-                log(\'Killing process due to timeout\' + \n-                    processRunDeadline + \' \' +\n-                    System.currentTimeMillis() +\n-                    \' \' + myproc);\n-                myproc.destroy();\n-            }\n-            \n         }\n \n-        \n-        \n         private void sendToLog(BufferedReader rdr) {\n             String line = null;\n             int lineCount = 0 ;', 'chris_j_davey', '2005-05-08 06:47:30 UTC', NULL);
INSERT INTO `tomcatbody` VALUES (355, '39699', 'Bug 39699 simple deploy failed in cluster (distributable flag)', 'Hi,\n\ni encounter a strange problem with my tomcat cluster and webapps deployment.\n\nserver.xml\n--------------------------------\n<Server port=\'8005\' shutdown=\'SHUTDOWN\'>\n\n  <Listener className=\'org.apache.catalina.core.AprLifecycleListener\' />\n  <Listener className=\'org.apache.catalina.mbeans.ServerLifecycleListener\' />\n  <Listener\nclassName=\'org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\' />\n  <Listener\nclassName=\'org.apache.catalina.storeconfig.StoreConfigLifecycleListener\'/>\n\n  <!-- Global JNDI resources -->\n  <GlobalNamingResources>\n\n    <Environment name=\'simpleValue\' type=\'java.lang.Integer\' value=\'30\'/>\n    <Resource name=\'UserDatabase\' auth=\'Container\'\n              type=\'org.apache.catalina.UserDatabase\'\n       description=\'User database that can be updated and saved\'\n           factory=\'org.apache.catalina.users.MemoryUserDatabaseFactory\'\n          pathname=\'conf/tomcat-users.xml\' />\n\n  </GlobalNamingResources>\n\n\n  <!-- Define the Tomcat Stand-Alone Service -->\n  <Service name=\'Catalina\'>\n\n\n    <!-- Define a non-SSL HTTP/1.1 Connector on port 8080 -->\n    <Connector address=\'polen-integ\' port=\'8080\' maxHttpHeaderSize=\'8192\'\n               maxThreads=\'300\' minSpareThreads=\'25\' maxSpareThreads=\'100\'\n               enableLookups=\'false\' acceptCount=\'100\'\n               connectionTimeout=\'20000\' disableUploadTimeout=\'true\' />\n\n    <!-- Define an AJP 1.3 Connector on port 8009 -->\n    <Connector port=\'8009\'\n               address=\'polen-integ.sofinco.fr\'\n               minProcessors=\'20\' maxProcessors=\'0\' maxThreads=\'350\'\nminSpareThreads=\'50\' maxSpareThreads=\'100\'\n               enableLookups=\'false\' redirectPort=\'8080\' protocol=\'AJP/1.3\'\ndisableUploadTimeout=\'true\' />\n\n     <Engine name=\'Catalina\' defaultHost=\'localhost\' jvmRoute=\'uxdev103\' >\n\n      <Realm className=\'org.apache.catalina.realm.UserDatabaseRealm\'\nresourceName=\'UserDatabase\'/>\n\n      <Host name=\'localhost\' appBase=\'webapps\' unpackWARs=\'true\' autoDeploy=\'true\'\n       xmlValidation=\'false\' xmlNamespaceAware=\'false\' >\n\n <!-- Cluster Definition -->\n\n        <Cluster className=\'org.apache.catalina.cluster.tcp.SimpleTcpCluster\'\n                doClusterLog=\'true\' clusterLogName=\'clusterlog\'\n                expireSessionsOnShutdown=\'false\'\n                useDirtyFlag=\'true\'\n                notifyListenersOnReplication=\'true\'>\n\n        <Membership className=\'org.apache.catalina.cluster.mcast.McastService\'\n                mcastAddr=\'228.0.0.4\'\n                mcastBindAddress=\'127.0.0.1\'\n                mcastClusterDomain=\'polen-integ\'\n                mcastPort=\'45564\'\n                mcastFrequency=\'1000\'\n                mcastDropTime=\'30000\'/>\n\n        <Receiver className=\'org.apache.catalina.cluster.tcp.ReplicationListener\'\n                tcpListenAddress=\'polen-integ\'\n                tcpSelectorTimeout=\'100\'\n                tcpThreadCount=\'6\'/>\n\n        <Sender className=\'org.apache.catalina.cluster.tcp.ReplicationTransmitter\'\n                replicationMode=\'fastasyncqueue\'\n                doTransmitterProcessingStats=\'true\'\n                doProcessingStats=\'false\'\n                doWaitAckStats=\'false\'\n                waitForAck=\'false\'\n                keepAliveMaxRequestCount=\'-1\'/>\n\n        <Valve className=\'org.apache.catalina.cluster.tcp.ReplicationValve\'\n               \nfilter=\'.* .gif;.* .js;.* .css;.* .png;.* .jpeg;.* .jpg;.* .htm;.* .html;.* .txt;\'\n/>\n\n        <Valve className=\'org.apache.catalina.cluster.session.JvmRouteBinderValve\'\n                enabled=\'true\' />\n\n        <ClusterListener\nclassName=\'org.apache.catalina.cluster.session.ClusterSessionListener\' />\n\n        <ClusterListener\nclassName=\'org.apache.catalina.cluster.session.JvmRouteSessionIDBinderListener\' />\n\n        <Deployer className=\'org.apache.catalina.cluster.deploy.FarmWarDeployer\'\n                tempDir=\'/home/tomcat/polen-integ/tmp/war-temp/\'\n                deployDir=\'${catalina.base}/webapps\'\n                watchDir=\'/home/tomcat/polen-integ/tmp/war-listen/\'\n                watchEnabled=\'true\'/>\n\n        </Cluster>\n\n      </Host>\n    </Engine>\n\n  </Service>\n\n</Server>\n------------------------\n\n\n\nwhen i am trying to deploy a \'dsitributable\' (and only when this flag is\nenabled) i get the following errors :\n\n---------------------------\nINFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.startup.HostConfig - Deploying web application archive po\nlen.war\n INFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.loader.WebappClassLoader - Illegal access: this web appli\ncation instance has been stopped already.  Could not load java.io.PrintStream. \nThe eventual following stack trace is caused by an error t\nhrown for debugging purposes as well as to attempt to terminate the thread which\ncaused the illegal access, and has no functional impact.\n java.lang.IllegalStateException\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1238)\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1198)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n        at org.apache.log4j.helpers.LogLog.error(LogLog.java:142)\n        at\norg.apache.log4j.helpers.PatternParser$DatePatternConverter.convert(PatternParser.java:447)\n        at\norg.apache.log4j.helpers.PatternConverter.format(PatternConverter.java:64)\n        at org.apache.log4j.PatternLayout.format(PatternLayout.java:503)\n        at org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:301)\n        at\norg.apache.log4j.RollingFileAppender.subAppend(RollingFileAppender.java:234)\n        at org.apache.log4j.WriterAppender.append(WriterAppender.java:159)\n        at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:230)\n        at\norg.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:65)\n        at org.apache.log4j.Category.callAppenders(Category.java:203)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.info(Log4JLogger.java:133)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:976)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nINFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.loader.WebappClassLoader - Illegal access: this web applic\nation instance has been stopped already.  Could not load java.io.PrintStream. \nThe eventual following stack trace is caused by an error th\nrown for debugging purposes as well as to attempt to terminate the thread which\ncaused the illegal access, and has no functional impact.\n Java.lang.IllegalStateException\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1238)\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1198)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n        at org.apache.log4j.helpers.LogLog.error(LogLog.java:142)\n        at\norg.apache.log4j.helpers.PatternParser$DatePatternConverter.convert(PatternParser.java:447)\n        at\norg.apache.log4j.helpers.PatternConverter.format(PatternConverter.java:64)\n        at org.apache.log4j.PatternLayout.format(PatternLayout.java:503)\n        at org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:301)\n        at\norg.apache.log4j.RollingFileAppender.subAppend(RollingFileAppender.java:234)\n        at org.apache.log4j.WriterAppender.append(WriterAppender.java:159)\n        at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:230)\n        at\norg.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:65)\n        at org.apache.log4j.Category.callAppenders(Category.java:203)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.info(Log4JLogger.java:133)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:976)\n at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nINFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.loader.WebappClassLoader - Illegal access: this web applic\nation instance has been stopped already.  Could not load\norg.apache.log4j.spi.VectorWriter.  The eventual following stack trace is caused\nby an error thrown for debugging purposes as well as to attempt to terminate the\nthread which caused the illegal access, and has no functi\nonal impact.\n java.lang.IllegalStateException\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1238)\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1198)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n        at org.apache.log4j.spi.LoggingEvent.<init>(LoggingEvent.java:154)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.error(Log4JLogger.java:193)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:990)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nINFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.loader.WebappClassLoader - Illegal access: this web applic\nation instance has been stopped already.  Could not load\norg.apache.log4j.spi.VectorWriter.  The eventual following stack trace is caused\nby an error thrown for debugging purposes as well as to attempt to terminate the\nthread which caused the illegal access, and has no functi\nonal impact.\n java.lang.IllegalStateException\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1238)\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1198)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n        at org.apache.log4j.spi.LoggingEvent.<init>(LoggingEvent.java:154)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.error(Log4JLogger.java:193)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:990)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nERROR ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.commons.modeler.Registry - Null component Catalina:type=JspMonitor\n,name=jsp,WebModule=//localhost/polen,J2EEApplication=none,J2EEServer=none\n ERROR ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.startup.HostConfig - Error deploying web application arc\nhive polen.war\n java.lang.NoClassDefFoundError: org/apache/log4j/spi/VectorWriter\n        at org.apache.log4j.spi.LoggingEvent.<init>(LoggingEvent.java:154)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.error(Log4JLogger.java:193)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:990)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nERROR ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.startup.HostConfig - Error deploying web application arch\nive polen.war\n java.lang.NoClassDefFoundError: org/apache/log4j/spi/VectorWriter\n        at org.apache.log4j.spi.LoggingEvent.<init>(LoggingEvent.java:154)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.error(Log4JLogger.java:193)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:990)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n\nat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\n---------------\n\ni have tried to deployed via web manager application or simple copy of my war in\nwebapps directory... No luck, if i put \'<distributable/> flag in application\nweb.xml config file, i encounter this error ; i need to restart manually tomcat\ninstance... After this restart the application is correctly deployed without any\nerror...\nOf course if i disable cluster in server.xml, no problem...', 'Christophe Yayon', '2006-06-01 16:28:04 UTC', NULL);

-- ----------------------------
-- Table structure for tomcatdataset
-- ----------------------------
DROP TABLE IF EXISTS `tomcatdataset`;
CREATE TABLE `tomcatdataset`  (
  `id` int(0) NOT NULL AUTO_INCREMENT,
  `bug_id` char(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `commit` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `buggy_paths` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  `report_timestamp` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `commit_timestamp` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `old_buggy_paths` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 356 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of tomcatdataset
-- ----------------------------
INSERT INTO `tomcatdataset` VALUES (1, '56029', 'b430e29', 'java/org/apache/jasper/compiler/ELParser.java\ntest/org/apache/jasper/compiler/TestELParser.java', '1390070000', '1390070000', 'java/org/apache/jasper/compiler/ELParser.java test/org/apache/jasper/compiler/TestELParser.java');
INSERT INTO `tomcatdataset` VALUES (2, '55943', 'f28800c', 'java/org/apache/catalina/loader/WebappClassLoader.java', '1388590000', '1389970000', 'java/org/apache/catalina/loader/WebappClassLoader.java');
INSERT INTO `tomcatdataset` VALUES (3, '55995', '5e6b884', 'java/org/apache/jasper/compiler/TldCache.java', '1389610000', '1389700000', 'java/org/apache/jasper/compiler/TldCache.java');
INSERT INTO `tomcatdataset` VALUES (4, '55976', 'd423ae2', 'java/org/apache/coyote/http11/Http11NioProcessor.java', '1389190000', '1389300000', 'java/org/apache/coyote/http11/Http11NioProcessor.java');
INSERT INTO `tomcatdataset` VALUES (5, '55958', '5964a52', 'java/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/mbeans/MBeanUtils.java\njava/org/apache/catalina/startup/FailedContext.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/storeconfig/StandardContextSF.java\njava/org/apache/catalina/util/ContextName.java\ntest/org/apache/catalina/startup/TestHostConfigAutomaticDeployment.java\ntest/org/apache/catalina/util/TestContextName.java', '1389020000', '1389280000', 'java/org/apache/catalina/core/ContainerBase.java java/org/apache/catalina/ha/deploy/FarmWarDeployer.java java/org/apache/catalina/manager/HTMLManagerServlet.java java/org/apache/catalina/mbeans/MBeanUtils.java java/org/apache/catalina/startup/FailedContext.java java/org/apache/catalina/startup/HostConfig.java java/org/apache/catalina/storeconfig/StandardContextSF.java java/org/apache/catalina/util/ContextName.java test/org/apache/catalina/startup/TestHostConfigAutomaticDeployment.java test/org/apache/catalina/util/TestContextName.java');
INSERT INTO `tomcatdataset` VALUES (6, '55937', '346e264', 'java/org/apache/catalina/util/ContextName.java\ntest/org/apache/catalina/util/TestContextName.java', '1388180000', '1389270000', 'java/org/apache/catalina/util/ContextName.java test/org/apache/catalina/util/TestContextName.java');
INSERT INTO `tomcatdataset` VALUES (7, '55884', '8a5179c', 'java/org/apache/jasper/compiler/JspRuntimeContext.java', '1387060000', '1387210000', 'java/org/apache/jasper/compiler/JspRuntimeContext.java');
INSERT INTO `tomcatdataset` VALUES (8, '55801', 'ef3f56e', 'java/org/apache/tomcat/websocket/WsWebSocketContainer.java', '1384960000', '1386450000', 'java/org/apache/tomcat/websocket/WsWebSocketContainer.java');
INSERT INTO `tomcatdataset` VALUES (9, '55842', 'f4970a7', 'java/org/apache/catalina/connector/OutputBuffer.java\njava/org/apache/tomcat/util/buf/ByteChunk.java', '1386190000', '1386330000', 'java/org/apache/catalina/connector/OutputBuffer.java java/org/apache/tomcat/util/buf/ByteChunk.java');
INSERT INTO `tomcatdataset` VALUES (10, '55837', 'a63bf3a', 'java/org/apache/catalina/webresources/DirResourceSet.java\njava/org/apache/catalina/webresources/EmptyResource.java\njava/org/apache/catalina/webresources/StandardRoot.java\ntest/org/apache/catalina/webresources/AbstractTestResourceSet.java', '1386080000', '1386180000', 'java/org/apache/catalina/webresources/DirResourceSet.java java/org/apache/catalina/webresources/EmptyResource.java java/org/apache/catalina/webresources/StandardRoot.java test/org/apache/catalina/webresources/AbstractTestResourceSet.java');
INSERT INTO `tomcatdataset` VALUES (11, '55804', '8f67335', 'java/org/apache/catalina/connector/Request.java', '1384990000', '1385750000', 'java/org/apache/catalina/connector/Request.java');
INSERT INTO `tomcatdataset` VALUES (12, '55798', '13c6551', 'java/org/apache/catalina/users/MemoryUserDatabase.java', '1384920000', '1384940000', 'java/org/apache/catalina/users/MemoryUserDatabase.java');
INSERT INTO `tomcatdataset` VALUES (13, '55776', 'a1ad6ce', 'java/org/apache/catalina/webresources/StandardRoot.java', '1384430000', '1384530000', 'java/org/apache/catalina/webresources/StandardRoot.java');
INSERT INTO `tomcatdataset` VALUES (14, '55760', '0a4e847', 'java/org/apache/catalina/authenticator/SpnegoAuthenticator.java', '1383930000', '1384160000', 'java/org/apache/catalina/authenticator/SpnegoAuthenticator.java');
INSERT INTO `tomcatdataset` VALUES (15, '55735', '7ee1275', 'java/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/runtime/PageContextImpl.java\ntest/org/apache/jasper/compiler/TestParser.java\ntest/org/apache/jasper/runtime/TesterPageContextImpl.java', '1383390000', '1383690000', 'java/org/apache/jasper/compiler/Validator.java java/org/apache/jasper/runtime/PageContextImpl.java test/org/apache/jasper/compiler/TestParser.java test/org/apache/jasper/compiler/TesterValidator.java test/org/apache/jasper/runtime/TesterPageContextImpl.java');
INSERT INTO `tomcatdataset` VALUES (16, '55684', 'd244284', 'java/org/apache/catalina/loader/WebappClassLoader.java', '1382390000', '1383040000', 'java/org/apache/catalina/loader/WebappClassLoader.java');
INSERT INTO `tomcatdataset` VALUES (17, '55691', 'b82c0c6', 'java/javax/el/ArrayELResolver.java\njava/javax/el/Util.java\ntest/javax/el/TestArrayELResolver.java', '1382500000', '1382990000', 'java/javax/el/ArrayELResolver.java java/javax/el/Util.java test/javax/el/TestArrayELResolver.java');
INSERT INTO `tomcatdataset` VALUES (18, '55317', 'dd0cba7', 'java/org/apache/catalina/loader/WebappClassLoader.java', '1375010000', '1380240000', 'java/org/apache/catalina/loader/WebappClassLoader.java java/org/apache/tomcat/InstrumentableClassLoader.java test/org/apache/catalina/loader/TestWebappClassLoaderWeaving.java test/org/apache/catalina/loader/TesterNeverWeavedClass.java test/org/apache/catalina/loader/TesterUnweavedClass.java');
INSERT INTO `tomcatdataset` VALUES (19, '55576', '90556a9', 'java/org/apache/catalina/util/ParameterMap.java\njava/org/apache/tomcat/util/http/Parameters.java', '1379730000', '1379970000', 'java/org/apache/catalina/util/ParameterMap.java java/org/apache/tomcat/util/http/Parameters.java');
INSERT INTO `tomcatdataset` VALUES (20, '54693', 'b022c57', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java', '1363220000', '1378720000', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PooledConnection.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java modules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/test/TestValidationQueryTimeout.java');
INSERT INTO `tomcatdataset` VALUES (21, '55494', '7e74aee', 'java/org/apache/catalina/realm/JNDIRealm.java', '1377710000', '1377700000', 'java/org/apache/catalina/realm/JNDIRealm.java');
INSERT INTO `tomcatdataset` VALUES (22, '55454', '8b03dcf', 'java/org/apache/tomcat/util/http/parser/HttpParser.java\ntest/org/apache/tomcat/util/http/parser/TestMediaType.java', '1377010000', '1377010000', 'java/org/apache/tomcat/util/http/parser/HttpParser.java test/org/apache/tomcat/util/http/parser/TestMediaType.java');
INSERT INTO `tomcatdataset` VALUES (23, '55404', 'df02b95', 'java/org/apache/catalina/startup/ContextConfig.java', '1376330000', '1376320000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (24, '55312', '7540e90', 'java/org/apache/tomcat/util/scan/StandardJarScanner.java', '1374870000', '1375280000', 'java/org/apache/tomcat/util/scan/StandardJarScanner.java');
INSERT INTO `tomcatdataset` VALUES (25, '55267', '11bf498', 'java/org/apache/coyote/ajp/AjpNioProcessor.java\njava/org/apache/coyote/http11/InternalNioOutputBuffer.java\njava/org/apache/coyote/http11/upgrade/NioServletOutputStream.java\njava/org/apache/tomcat/util/net/NioEndpoint.java', '1373900000', '1374590000', 'java/org/apache/coyote/ajp/AjpNioProcessor.java java/org/apache/coyote/http11/InternalNioOutputBuffer.java java/org/apache/coyote/http11/upgrade/NioServletOutputStream.java java/org/apache/tomcat/util/net/NioEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (26, '55259', 'c6a45a6', 'java/org/apache/jasper/compiler/JspConfig.java', '1373700000', '1373750000', 'java/org/apache/jasper/compiler/JspConfig.java');
INSERT INTO `tomcatdataset` VALUES (27, '55245', 'c0c5017', NULL, '1373610000', '1373620000', 'test/org/apache/jasper/TestJspC.java');
INSERT INTO `tomcatdataset` VALUES (28, '55238', '4758796', 'java/org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer.java', '1373540000', '1373560000', 'java/org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer.java');
INSERT INTO `tomcatdataset` VALUES (29, '55228', '95ee699', 'java/org/apache/coyote/http11/AbstractHttp11Processor.java', '1373430000', '1373560000', 'java/org/apache/coyote/http11/AbstractHttp11Processor.java');
INSERT INTO `tomcatdataset` VALUES (30, '55231', 'c8376e8', 'java/org/apache/jasper/compiler/JspConfig.java', '1373440000', '1373460000', 'java/org/apache/jasper/compiler/JspConfig.java');
INSERT INTO `tomcatdataset` VALUES (31, '55166', 'f554475', 'java/org/apache/catalina/startup/Constants.java', '1372640000', '1373280000', 'java/org/apache/catalina/startup/Constants.java');
INSERT INTO `tomcatdataset` VALUES (32, '53777', '6871d4c', 'java/org/apache/catalina/realm/JAASRealm.java', '1345830000', '1372690000', 'java/org/apache/catalina/realm/JAASRealm.java');
INSERT INTO `tomcatdataset` VALUES (33, '55160', '9a01f2d', 'java/org/apache/coyote/http11/InternalNioInputBuffer.java', '1372560000', '1372690000', 'java/org/apache/coyote/http11/InternalNioInputBuffer.java');
INSERT INTO `tomcatdataset` VALUES (34, '55017', '45f59bb', 'java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java', '1369420000', '1372670000', 'java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java');
INSERT INTO `tomcatdataset` VALUES (35, '55102', '7aea9cb', 'java/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/coyote/Response.java', '1371330000', '1372020000', 'java/org/apache/catalina/valves/AccessLogValve.java java/org/apache/coyote/Response.java');
INSERT INTO `tomcatdataset` VALUES (36, '55046', '72edec7', 'test/org/apache/catalina/filters/TesterHttpServletResponse.java', '1370150000', '1370340000', 'java/org/apache/catalina/filters/CorsFilter.java test/org/apache/catalina/filters/TestCorsFilter.java test/org/apache/catalina/filters/TesterFilterChain.java test/org/apache/catalina/filters/TesterFilterConfigs.java test/org/apache/catalina/filters/TesterHttpServletRequest.java test/org/apache/catalina/filters/TesterHttpServletResponse.java test/org/apache/catalina/filters/TesterServletContext.java');
INSERT INTO `tomcatdataset` VALUES (37, '54971', 'cccd0ac', 'java/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/ApplicationPart.java', '1368600000', '1369750000', 'java/org/apache/catalina/connector/Request.java java/org/apache/catalina/core/ApplicationPart.java');
INSERT INTO `tomcatdataset` VALUES (38, '54947', 'f763975', 'java/org/apache/coyote/http11/InternalNioInputBuffer.java\ntest/org/apache/catalina/startup/SimpleHttpClient.java\ntest/org/apache/coyote/http11/TestInternalInputBuffer.java', '1368150000', '1369740000', 'java/org/apache/coyote/http11/InternalNioInputBuffer.java test/org/apache/catalina/startup/SimpleHttpClient.java test/org/apache/coyote/http11/TestInternalInputBuffer.java');
INSERT INTO `tomcatdataset` VALUES (39, '54984', '7558546', 'java/org/apache/catalina/connector/Request.java\ntest/org/apache/catalina/connector/TestRequest.java', '1368720000', '1369420000', 'java/org/apache/catalina/connector/Request.java test/org/apache/catalina/connector/TestRequest.java');
INSERT INTO `tomcatdataset` VALUES (40, '54928', '3960b22', 'test/org/apache/catalina/connector/TestCoyoteAdapter.java', '1367690000', '1369400000', 'test/org/apache/catalina/connector/TestCoyoteAdapter.java');
INSERT INTO `tomcatdataset` VALUES (41, '54703', '7aeab0e', 'java/org/apache/tomcat/util/http/parser/HttpParser.java\ntest/org/apache/tomcat/util/http/parser/TestMediaType.java', '1363370000', '1367940000', 'java/org/apache/tomcat/util/http/parser/HttpParser.java test/org/apache/tomcat/util/http/parser/TestMediaType.java');
INSERT INTO `tomcatdataset` VALUES (42, '54801', '1631be1', 'java/org/apache/jasper/compiler/JspDocumentParser.java\ntest/org/apache/jasper/compiler/TestJspDocumentParser.java', '1365130000', '1366900000', 'java/org/apache/jasper/compiler/JspDocumentParser.java test/org/apache/jasper/compiler/TestJspDocumentParser.java');
INSERT INTO `tomcatdataset` VALUES (43, '54178', '4171baf', 'java/org/apache/catalina/core/AsyncContextImpl.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java', '1353500000', '1366800000', 'java/org/apache/catalina/core/AsyncContextImpl.java test/org/apache/catalina/core/TestAsyncContextImpl.java');
INSERT INTO `tomcatdataset` VALUES (44, '54781', '67ed3e7', 'java/org/apache/tomcat/websocket/server/WsFilter.java\njava/org/apache/tomcat/websocket/server/WsServerContainer.java', '1364860000', '1366750000', 'java/org/apache/tomcat/websocket/server/WsFilter.java java/org/apache/tomcat/websocket/server/WsServerContainer.java');
INSERT INTO `tomcatdataset` VALUES (45, '54800', 'd2630df', 'java/org/apache/tomcat/websocket/WsWebSocketContainer.java', '1365130000', '1366730000', 'java/org/apache/tomcat/websocket/WsWebSocketContainer.java');
INSERT INTO `tomcatdataset` VALUES (46, '54724', '12f89ff', 'java/org/apache/tomcat/websocket/WsSession.java\ntest/org/apache/tomcat/websocket/TestWsWebSocketContainer.java', '1363710000', '1363720000', 'java/org/apache/tomcat/websocket/WsSession.java test/org/apache/tomcat/websocket/TestWsWebSocketContainer.java');
INSERT INTO `tomcatdataset` VALUES (47, '54702', '7c88af9', 'java/org/apache/catalina/startup/ContextConfig.java', '1363350000', '1363360000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (48, '54690', 'fedf189', 'java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java', '1363210000', '1363270000', 'java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java');
INSERT INTO `tomcatdataset` VALUES (49, '54602', 'b2f0e7c', 'java/org/apache/catalina/connector/CoyoteAdapter.java', '1361580000', '1361570000', 'java/org/apache/catalina/connector/CoyoteAdapter.java');
INSERT INTO `tomcatdataset` VALUES (50, '54552', 'c11952d', 'java/javax/servlet/http/HttpServletRequest.java\njava/javax/servlet/http/HttpServletRequestWrapper.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/connector/RequestFacade.java\njava/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/websocket/WsHttpServletRequestWrapper.java', '1360700000', '1360750000', 'java/javax/servlet/http/HttpServletRequest.java java/javax/servlet/http/HttpServletRequestWrapper.java java/javax/servlet/http/HttpSessionIdListener.java java/org/apache/catalina/connector/Request.java java/org/apache/catalina/connector/RequestFacade.java java/org/apache/catalina/core/ApplicationContext.java java/org/apache/catalina/core/StandardContext.java java/org/apache/catalina/ha/session/DeltaManager.java java/org/apache/catalina/session/ManagerBase.java java/org/apache/catalina/websocket/WsHttpServletRequestWrapper.java');
INSERT INTO `tomcatdataset` VALUES (51, '54536', 'ef9ed07', 'java/org/apache/catalina/valves/ErrorReportValve.java\ntest/org/apache/catalina/valves/TestErrorReportValve.java', '1360260000', '1360700000', 'java/org/apache/catalina/valves/ErrorReportValve.java test/org/apache/catalina/valves/TestErrorReportValve.java');
INSERT INTO `tomcatdataset` VALUES (52, '54239', 'f8ac6a0', 'java/org/apache/jasper/compiler/Generator.java', '1354620000', '1360680000', 'java/org/apache/jasper/compiler/ELInterpreter.java java/org/apache/jasper/compiler/ELInterpreterFactory.java java/org/apache/jasper/compiler/Generator.java test/org/apache/jasper/compiler/TestELInterpreterFactory.java');
INSERT INTO `tomcatdataset` VALUES (53, '54456', 'cc2f8db', 'java/org/apache/coyote/http11/filters/ChunkedInputFilter.java', '1358800000', '1360240000', 'java/org/apache/coyote/http11/filters/ChunkedInputFilter.java');
INSERT INTO `tomcatdataset` VALUES (54, '54513', 'bbb13f6', 'java/org/apache/tomcat/util/net/AprEndpoint.java', '1359690000', '1359840000', 'java/org/apache/tomcat/util/net/AprEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (55, '53869', 'ce55f25', 'java/org/apache/jasper/runtime/JspContextWrapper.java', '1347560000', '1359120000', 'java/org/apache/jasper/runtime/JspContextWrapper.java');
INSERT INTO `tomcatdataset` VALUES (56, '54324', 'ab44514', 'java/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/tomcat/jni/SSL.java\njava/org/apache/tomcat/util/net/AprEndpoint.java', '1355890000', '1358450000', 'java/org/apache/coyote/http11/Http11AprProtocol.java java/org/apache/tomcat/jni/SSL.java java/org/apache/tomcat/util/net/AprEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (57, '54379', '71d075e', 'java/org/apache/catalina/Context.java\njava/org/apache/catalina/core/DefaultInstanceManager.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/FailedContext.java\njava/org/apache/catalina/startup/WebRuleSet.java\njava/org/apache/catalina/util/Introspection.java\ntest/org/apache/catalina/core/TestStandardContext.java\ntest/org/apache/catalina/core/TesterContext.java\ntest/org/apache/catalina/deploy/TestWebXml.java\ntest/org/apache/catalina/startup/TestContextConfig.java\ntest/org/apache/catalina/startup/TestWebRuleSet.java', '1357550000', '1357820000', 'java/org/apache/catalina/Context.java java/org/apache/catalina/core/DefaultInstanceManager.java java/org/apache/catalina/core/StandardContext.java java/org/apache/catalina/deploy/WebXml.java java/org/apache/catalina/startup/FailedContext.java java/org/apache/catalina/startup/WebRuleSet.java java/org/apache/catalina/util/Introspection.java test/org/apache/catalina/core/TestStandardContext.java test/org/apache/catalina/core/TesterContext.java test/org/apache/catalina/deploy/TestWebXml.java test/org/apache/catalina/startup/TestContextConfig.java test/org/apache/catalina/startup/TestWebRuleSet.java test/org/apache/catalina/startup/TesterServletWithLifeCycleMethods.java');
INSERT INTO `tomcatdataset` VALUES (58, '54377', '95e6056', 'java/org/apache/catalina/filters/RemoteIpFilter.java\ntest/org/apache/catalina/filters/TestRemoteIpFilter.java\ntest/org/apache/catalina/valves/TestRemoteIpValve.java', '1357450000', '1357680000', 'java/org/apache/catalina/filters/RemoteIpFilter.java test/org/apache/catalina/filters/TestRemoteIpFilter.java test/org/apache/catalina/valves/TestRemoteIpValve.java');
INSERT INTO `tomcatdataset` VALUES (59, '54284', '113c0bd', 'java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/deploy/FilterDef.java\njava/org/apache/catalina/deploy/ServletDef.java\ntest/org/apache/catalina/core/TestApplicationContext.java', '1355350000', '1357590000', 'java/org/apache/catalina/core/ApplicationContext.java java/org/apache/catalina/deploy/FilterDef.java java/org/apache/catalina/deploy/ServletDef.java test/org/apache/catalina/core/TestApplicationContext.java test/org/apache/catalina/deploy/TestFilterDef.java test/org/apache/catalina/deploy/TestServletDef.java');
INSERT INTO `tomcatdataset` VALUES (60, '54262', '5418e2b', 'java/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/WebRuleSet.java\ntest/org/apache/catalina/startup/TestContextConfig.java', '1354940000', '1357580000', 'java/org/apache/catalina/deploy/WebXml.java java/org/apache/catalina/startup/WebRuleSet.java test/org/apache/catalina/startup/TestContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (61, '54241', 'ffc4525', 'java/org/apache/jasper/runtime/JspWriterImpl.java', '1354630000', '1357140000', 'java/org/apache/jasper/runtime/JspWriterImpl.java test/org/apache/jasper/runtime/TestJspWriterImpl.java');
INSERT INTO `tomcatdataset` VALUES (62, '54220', 'a2d1441', 'java/org/apache/catalina/valves/ErrorReportValve.java\ntest/org/apache/catalina/valves/TestErrorReportValve.java', '1354150000', '1354540000', 'java/org/apache/catalina/valves/ErrorReportValve.java test/org/apache/catalina/valves/TestErrorReportValve.java');
INSERT INTO `tomcatdataset` VALUES (63, '54217', 'a81538d', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java', '1354120000', '1354540000', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java');
INSERT INTO `tomcatdataset` VALUES (64, '54144', '7c4a841', 'java/org/apache/jasper/tagplugins/jstl/Util.java\njava/org/apache/jasper/tagplugins/jstl/core/Out.java\ntest/org/apache/jasper/tagplugins/jstl/core/TestOut.java', '1352900000', '1353110000', 'java/org/apache/jasper/tagplugins/jstl/Util.java java/org/apache/jasper/tagplugins/jstl/core/Out.java test/org/apache/jasper/tagplugins/jstl/core/TestOut.java');
INSERT INTO `tomcatdataset` VALUES (65, '54087', '810732d', 'java/javax/servlet/http/HttpServlet.java', '1351800000', '1352720000', 'java/javax/servlet/http/HttpServlet.java');
INSERT INTO `tomcatdataset` VALUES (66, '54076', '9f65875', 'java/org/apache/catalina/authenticator/SpnegoAuthenticator.java', '1351620000', '1351980000', 'java/org/apache/catalina/authenticator/SpnegoAuthenticator.java');
INSERT INTO `tomcatdataset` VALUES (67, '53867', 'c40ca99', 'java/org/apache/jasper/runtime/PageContextImpl.java', '1347560000', '1351460000', 'java/org/apache/jasper/runtime/PageContextImpl.java test/org/apache/jasper/runtime/TesterPageContextImpl.java');
INSERT INTO `tomcatdataset` VALUES (68, '54012', 'a0ff3f9', 'java/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/PageInfo.java\njava/org/apache/jasper/compiler/TagPluginManager.java\njava/org/apache/jasper/compiler/tagplugin/TagPluginContext.java\njava/org/apache/jasper/tagplugins/jstl/core/Set.java', '1350390000', '1351170000', 'java/org/apache/jasper/compiler/Compiler.java java/org/apache/jasper/compiler/PageInfo.java java/org/apache/jasper/compiler/TagPluginManager.java java/org/apache/jasper/compiler/tagplugin/TagPluginContext.java java/org/apache/jasper/tagplugins/jstl/core/Set.java');
INSERT INTO `tomcatdataset` VALUES (69, '53986', '88d8dd5', 'java/org/apache/jasper/compiler/JspReader.java', '1349820000', '1349880000', 'java/org/apache/jasper/compiler/JspReader.java test/org/apache/jasper/compiler/TestJspReader.java');
INSERT INTO `tomcatdataset` VALUES (70, '53854', 'a3e0f09', 'java/org/apache/naming/resources/BaseDirContext.java\njava/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/WARDirContext.java', '1347410000', '1349030000', 'java/org/apache/naming/resources/BaseDirContext.java java/org/apache/naming/resources/FileDirContext.java java/org/apache/naming/resources/WARDirContext.java');
INSERT INTO `tomcatdataset` VALUES (71, '53713', '5fccf68', 'java/org/apache/jasper/compiler/JspReader.java\njava/org/apache/jasper/compiler/Mark.java', '1344940000', '1346880000', 'java/org/apache/jasper/compiler/JspReader.java java/org/apache/jasper/compiler/Mark.java');
INSERT INTO `tomcatdataset` VALUES (72, '53793', 'fcc3d65', 'java/org/apache/catalina/manager/HTMLManagerServlet.java', '1346210000', '1346190000', 'java/org/apache/catalina/manager/HTMLManagerServlet.java');
INSERT INTO `tomcatdataset` VALUES (73, '42181', 'cd05aa1', 'java/org/apache/coyote/http11/filters/ChunkedInputFilter.java\njava/org/apache/tomcat/util/buf/HexUtils.java', '1177210000', '1346110000', 'java/org/apache/coyote/http11/filters/ChunkedInputFilter.java java/org/apache/tomcat/util/buf/HexUtils.java test/org/apache/tomcat/util/buf/TestHexUtils.java');
INSERT INTO `tomcatdataset` VALUES (74, '53783', '6b934d8', 'java/org/apache/catalina/startup/ContextConfig.java', '1346090000', '1346090000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (75, '53725', '3dff241', 'java/org/apache/coyote/http11/filters/FlushableGZIPOutputStream.java', '1345070000', '1345930000', 'java/org/apache/coyote/http11/filters/FlushableGZIPOutputStream.java');
INSERT INTO `tomcatdataset` VALUES (76, '53697', '6c13431', 'java/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java', '1344690000', '1345070000', 'java/org/apache/coyote/http11/AbstractHttp11Processor.java java/org/apache/coyote/http11/Http11NioProcessor.java');
INSERT INTO `tomcatdataset` VALUES (77, '53654', '1efc23d', 'java/org/apache/jasper/compiler/Compiler.java', '1344190000', '1345050000', 'java/org/apache/jasper/compiler/Compiler.java');
INSERT INTO `tomcatdataset` VALUES (78, '53545', '5a6b27b', 'java/org/apache/jasper/runtime/PageContextImpl.java', '1342180000', '1344680000', 'java/org/apache/jasper/runtime/PageContextImpl.java test/org/apache/jasper/runtime/TestPageContextImpl.java test/org/apache/tomcat/unittest/tags/Bug53545.java');
INSERT INTO `tomcatdataset` VALUES (79, '53481', '82e5dce', 'java/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/tomcat/util/net/AprEndpoint.java', '1340910000', '1344530000', 'java/org/apache/coyote/http11/Http11AprProtocol.java java/org/apache/tomcat/util/net/AprEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (80, '53606', 'eb9f94e', 'java/org/apache/catalina/tribes/group/interceptors/TcpPingInterceptor.java', '1343330000', '1343600000', 'java/org/apache/catalina/tribes/group/interceptors/TcpPingInterceptor.java');
INSERT INTO `tomcatdataset` VALUES (81, '53535', '7db08d3', 'java/org/apache/catalina/startup/ContextConfig.java', '1342020000', '1343600000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (82, '53469', '9a80d06', 'java/org/apache/catalina/connector/Response.java\ntest/org/apache/catalina/connector/TestResponse.java', '1340730000', '1343590000', 'java/org/apache/catalina/connector/Response.java test/org/apache/catalina/connector/TestResponse.java');
INSERT INTO `tomcatdataset` VALUES (83, '53513', '4c03dff', 'java/org/apache/catalina/ha/tcp/SimpleTcpCluster.java', '1341540000', '1341830000', 'java/org/apache/catalina/ha/tcp/SimpleTcpCluster.java');
INSERT INTO `tomcatdataset` VALUES (84, '52135', '6213b38', 'java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardHostValve.java\njava/org/apache/catalina/deploy/ErrorPage.java', '1320430000', '1341060000', 'java/org/apache/catalina/core/StandardContext.java java/org/apache/catalina/core/StandardHostValve.java java/org/apache/catalina/deploy/ErrorPage.java test/org/apache/catalina/core/TestStandardHostValve.java');
INSERT INTO `tomcatdataset` VALUES (85, '53416', 'ff9a272', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSource.java', '1339700000', '1340820000', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSource.java');
INSERT INTO `tomcatdataset` VALUES (86, '53406', 'ce24a10', 'java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java', '1339570000', '1339600000', 'java/org/apache/coyote/http11/Http11AprProcessor.java java/org/apache/coyote/http11/Http11NioProcessor.java');
INSERT INTO `tomcatdataset` VALUES (87, '53374', '0290e57', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java', '1339030000', '1339160000', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java');
INSERT INTO `tomcatdataset` VALUES (88, '53367', '1412935', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PooledConnection.java', '1338960000', '1338940000', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PooledConnection.java');
INSERT INTO `tomcatdataset` VALUES (89, '53032', '957d33b', 'java/org/apache/jasper/JspC.java', '1333500000', '1338940000', 'java/org/apache/jasper/JspC.java');
INSERT INTO `tomcatdataset` VALUES (90, '53337', 'c6b691d', 'java/org/apache/catalina/core/ApplicationDispatcher.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java', '1338500000', '1338740000', 'java/org/apache/catalina/core/ApplicationDispatcher.java test/org/apache/catalina/core/TestAsyncContextImpl.java');
INSERT INTO `tomcatdataset` VALUES (91, '53301', '6ce3128', 'java/org/apache/catalina/startup/Tomcat.java\ntest/org/apache/catalina/startup/TestTomcat.java', '1338080000', '1338550000', 'java/org/apache/catalina/startup/Tomcat.java test/org/apache/catalina/startup/TestTomcat.java');
INSERT INTO `tomcatdataset` VALUES (92, '53074', '098a647', 'java/org/apache/catalina/websocket/StreamInbound.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/upgrade/UpgradeAprProcessor.java\njava/org/apache/coyote/http11/upgrade/UpgradeBioProcessor.java\njava/org/apache/coyote/http11/upgrade/UpgradeInbound.java\njava/org/apache/coyote/http11/upgrade/UpgradeNioProcessor.java\njava/org/apache/tomcat/util/net/AprEndpoint.java', '1334340000', '1337960000', 'java/org/apache/catalina/websocket/StreamInbound.java java/org/apache/coyote/ajp/AjpAprProtocol.java java/org/apache/coyote/http11/Http11AprProtocol.java java/org/apache/coyote/http11/upgrade/UpgradeAprProcessor.java java/org/apache/coyote/http11/upgrade/UpgradeBioProcessor.java java/org/apache/coyote/http11/upgrade/UpgradeInbound.java java/org/apache/coyote/http11/upgrade/UpgradeNioProcessor.java java/org/apache/tomcat/util/net/AprEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (93, '50864', '518662f', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java', '1299170000', '1334080000', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java');
INSERT INTO `tomcatdataset` VALUES (94, '53001', '1aced29', NULL, '1333030000', '1333130000', 'test/javax/el/TestResourceBundleELResolver.java');
INSERT INTO `tomcatdataset` VALUES (95, '52833', '6a8e480', 'java/org/apache/catalina/core/StandardServer.java', '1331010000', '1332870000', 'java/org/apache/catalina/core/StandardServer.java');
INSERT INTO `tomcatdataset` VALUES (96, '52066', 'fe16ac2', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java', '1319150000', '1332870000', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java');
INSERT INTO `tomcatdataset` VALUES (97, '52850', 'adbf442', 'java/org/apache/catalina/loader/WebappClassLoader.java', '1331150000', '1331320000', 'java/org/apache/catalina/loader/WebappClassLoader.java test/org/apache/catalina/loader/TestWebappClassLoaderExecutorMemoryLeak.java test/org/apache/catalina/loader/TestWebappClassLoaderThreadLocalMemoryLeak.java');
INSERT INTO `tomcatdataset` VALUES (98, '52500', '401c703', 'java/org/apache/catalina/realm/RealmBase.java', '1327340000', '1331230000', 'java/org/apache/catalina/realm/RealmBase.java java/org/apache/catalina/realm/X509SubjectDnRetriever.java java/org/apache/catalina/realm/X509UsernameRetriever.java');
INSERT INTO `tomcatdataset` VALUES (99, '52792', '7cec4ff', 'java/org/apache/naming/NamingContext.java', '1330480000', '1331150000', 'java/org/apache/naming/NamingContext.java');
INSERT INTO `tomcatdataset` VALUES (100, '52669', '34b1a7e', 'java/org/apache/catalina/startup/ContextConfig.java', '1329270000', '1329340000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (101, '52444', 'f4896de', 'java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/tomcat/util/bcel/classfile/JavaClass.java\ntest/org/apache/catalina/startup/TestContextConfigAnnotation.java', '1326150000', '1327920000', 'java/org/apache/catalina/startup/ContextConfig.java java/org/apache/tomcat/util/bcel/classfile/JavaClass.java test/org/apache/catalina/startup/TestContextConfigAnnotation.java');
INSERT INTO `tomcatdataset` VALUES (102, '52543', 'ee0562d', 'java/org/apache/coyote/http11/AbstractOutputBuffer.java', '1327680000', '1327780000', 'java/org/apache/coyote/http11/AbstractOutputBuffer.java');
INSERT INTO `tomcatdataset` VALUES (103, '52511', '3277494', 'java/org/apache/catalina/startup/ContextConfig.java', '1327370000', '1327700000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (104, '52474', '2dd8a40', 'java/org/apache/catalina/startup/TldRuleSet.java', '1326800000', '1327090000', 'java/org/apache/catalina/startup/TldRuleSet.java');
INSERT INTO `tomcatdataset` VALUES (105, '51408', '9722128', 'java/org/apache/catalina/ant/AbstractCatalinaTask.java\njava/org/apache/catalina/authenticator/DigestAuthenticator.java\njava/org/apache/catalina/realm/JNDIRealm.java\njava/org/apache/catalina/realm/RealmBase.java\njava/org/apache/catalina/servlets/WebdavServlet.java\njava/org/apache/catalina/util/RequestUtil.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/SSLValve.java\njava/org/apache/coyote/http11/filters/BufferedInputFilter.java\njava/org/apache/coyote/http11/filters/ChunkedInputFilter.java\njava/org/apache/coyote/http11/filters/IdentityInputFilter.java\njava/org/apache/coyote/http11/filters/VoidInputFilter.java\njava/org/apache/jasper/Constants.java\njava/org/apache/jasper/compiler/SmapUtil.java\njava/org/apache/naming/resources/Constants.java\njava/org/apache/naming/resources/ProxyDirContext.java\njava/org/apache/tomcat/util/buf/MessageBytes.java', '1308690000', '1326990000', 'java/org/apache/catalina/ant/AbstractCatalinaTask.java java/org/apache/catalina/authenticator/DigestAuthenticator.java java/org/apache/catalina/realm/JNDIRealm.java java/org/apache/catalina/realm/RealmBase.java java/org/apache/catalina/servlets/WebdavServlet.java java/org/apache/catalina/util/RequestUtil.java java/org/apache/catalina/valves/AccessLogValve.java java/org/apache/catalina/valves/SSLValve.java java/org/apache/coyote/http11/filters/BufferedInputFilter.java java/org/apache/coyote/http11/filters/ChunkedInputFilter.java java/org/apache/coyote/http11/filters/IdentityInputFilter.java java/org/apache/coyote/http11/filters/VoidInputFilter.java java/org/apache/jasper/Constants.java java/org/apache/jasper/compiler/SmapUtil.java java/org/apache/naming/resources/Constants.java java/org/apache/naming/resources/ProxyDirContext.java java/org/apache/tomcat/util/buf/MessageBytes.java');
INSERT INTO `tomcatdataset` VALUES (106, '38216', 'bd478e5', 'java/org/apache/catalina/manager/JMXProxyServlet.java', '1136930000', '1326660000', 'java/org/apache/catalina/manager/JMXProxyServlet.java');
INSERT INTO `tomcatdataset` VALUES (107, '52245', 'ee2a461', 'java/org/apache/catalina/loader/WebappClassLoader.java', '1322250000', '1326400000', 'java/org/apache/catalina/loader/WebappClassLoader.java');
INSERT INTO `tomcatdataset` VALUES (108, '52440', 'f277b14', 'java/org/apache/el/parser/AstIdentifier.java\ntest/org/apache/el/TestValueExpressionImpl.java', '1326120000', '1326400000', 'java/org/apache/el/parser/AstIdentifier.java test/org/apache/el/TestValueExpressionImpl.java');
INSERT INTO `tomcatdataset` VALUES (109, '52328', '9c7ec4c', 'java/org/apache/catalina/connector/OutputBuffer.java', '1323880000', '1326230000', 'java/org/apache/catalina/connector/OutputBuffer.java');
INSERT INTO `tomcatdataset` VALUES (110, '52293', '33e48db', 'java/org/apache/catalina/startup/ContextConfig.java', '1323220000', '1324500000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (111, '52225', 'f3a7cd9', 'java/org/apache/tomcat/util/http/mapper/Mapper.java\ntest/org/apache/tomcat/util/http/mapper/TestMapper.java', '1321960000', '1321950000', 'java/org/apache/tomcat/util/http/mapper/Mapper.java test/org/apache/tomcat/util/http/mapper/TestMapper.java');
INSERT INTO `tomcatdataset` VALUES (112, '50570', 'c2001ce', 'java/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/tomcat/jni/SSL.java', '1294770000', '1320870000', 'java/org/apache/catalina/core/AprLifecycleListener.java java/org/apache/tomcat/jni/SSL.java');
INSERT INTO `tomcatdataset` VALUES (113, '52009', 'b90c0a1', 'java/org/apache/catalina/connector/CoyoteAdapter.java\ntest/org/apache/catalina/comet/TestCometProcessor.java', '1318330000', '1318630000', 'java/org/apache/catalina/connector/CoyoteAdapter.java test/org/apache/catalina/comet/TestCometProcessor.java');
INSERT INTO `tomcatdataset` VALUES (114, '51972', 'e70797e', 'java/org/apache/catalina/connector/Response.java', '1317860000', '1318250000', 'java/org/apache/catalina/connector/Response.java');
INSERT INTO `tomcatdataset` VALUES (115, '51952', '3ab3757', 'java/org/apache/catalina/Context.java\njava/org/apache/catalina/connector/Response.java\njava/org/apache/catalina/core/StandardContext.java', '1317760000', '1318020000', 'java/org/apache/catalina/Context.java java/org/apache/catalina/connector/Response.java java/org/apache/catalina/core/StandardContext.java');
INSERT INTO `tomcatdataset` VALUES (116, '51630', 'b080c7e', 'webapps/examples/WEB-INF/classes/async/Async0.java', '1312700000', '1317670000', 'webapps/examples/WEB-INF/classes/async/Async0.java');
INSERT INTO `tomcatdataset` VALUES (117, '51872', '18792f4', 'java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/coyote/ajp/AbstractAjpProcessor.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpNioProcessor.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java', '1316730000', '1317150000', 'java/org/apache/catalina/connector/CoyoteAdapter.java java/org/apache/coyote/ajp/AbstractAjpProcessor.java java/org/apache/coyote/ajp/AjpAprProcessor.java java/org/apache/coyote/ajp/AjpNioProcessor.java java/org/apache/coyote/ajp/AjpProcessor.java java/org/apache/coyote/http11/AbstractHttp11Processor.java');
INSERT INTO `tomcatdataset` VALUES (118, '51580', 'feff880', 'java/org/apache/catalina/startup/ExpandWar.java', '1311910000', '1316550000', 'java/org/apache/catalina/startup/ExpandWar.java');
INSERT INTO `tomcatdataset` VALUES (119, '51687', '423fd89', 'java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java', '1313780000', '1316550000', 'java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java');
INSERT INTO `tomcatdataset` VALUES (120, '51739', '3513acc', 'java/org/apache/catalina/authenticator/FormAuthenticator.java', '1314640000', '1314640000', 'java/org/apache/catalina/authenticator/FormAuthenticator.java');
INSERT INTO `tomcatdataset` VALUES (121, '51558', '25f02b4', 'java/org/apache/catalina/startup/Tomcat.java\ntest/org/apache/catalina/startup/TestTomcat.java', '1311690000', '1314370000', 'java/org/apache/catalina/startup/Tomcat.java test/org/apache/catalina/startup/TestTomcat.java');
INSERT INTO `tomcatdataset` VALUES (122, '49683', 'bf4a544', 'java/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/tomcat/util/net/AprEndpoint.java', '1280690000', '1313520000', 'java/org/apache/coyote/ajp/AjpAprProtocol.java java/org/apache/coyote/http11/Http11AprProtocol.java java/org/apache/tomcat/util/net/AprEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (123, '51588', '77213bb', 'java/org/apache/catalina/valves/AccessLogValve.java', '1312010000', '1312130000', 'java/org/apache/catalina/valves/AccessLogValve.java');
INSERT INTO `tomcatdataset` VALUES (124, '51056', '4d9fcc0', 'java/org/apache/tomcat/jni/SSL.java', '1302720000', '1311240000', 'java/org/apache/tomcat/jni/SSL.java');
INSERT INTO `tomcatdataset` VALUES (125, '49595', 'a3f3379', 'java/org/apache/coyote/ajp/AjpAprProcessor.java', '1279190000', '1311060000', 'java/org/apache/coyote/ajp/AjpAprProcessor.java');
INSERT INTO `tomcatdataset` VALUES (126, '51503', '1e79993', 'java/org/apache/catalina/connector/Connector.java', '1310580000', '1311010000', 'java/org/apache/catalina/connector/Connector.java');
INSERT INTO `tomcatdataset` VALUES (127, '51477', '6ee5a22', 'java/org/apache/tomcat/jni/Library.java\njava/org/apache/tomcat/util/net/AprEndpoint.java', '1309900000', '1310400000', 'java/org/apache/tomcat/jni/Library.java java/org/apache/tomcat/util/net/AprEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (128, '46252', '871dabd', 'java/org/apache/catalina/valves/AccessLogValve.java', '1227200000', '1310400000', 'java/org/apache/catalina/valves/AccessLogValve.java');
INSERT INTO `tomcatdataset` VALUES (129, '51475', 'acc5619', 'java/org/apache/catalina/tribes/group/interceptors/GzipInterceptor.java\ntest/org/apache/catalina/tribes/group/interceptors/TestGzipInterceptor.java', '1309870000', '1309880000', 'java/org/apache/catalina/tribes/group/interceptors/GzipInterceptor.java test/org/apache/catalina/tribes/group/interceptors/TestGzipInterceptor.java');
INSERT INTO `tomcatdataset` VALUES (130, '51473', 'ec00abf', 'java/org/apache/catalina/security/SecurityConfig.java', '1309860000', '1309850000', 'java/org/apache/catalina/security/SecurityConfig.java');
INSERT INTO `tomcatdataset` VALUES (131, '51467', 'eb98373', 'java/org/apache/catalina/core/StandardContext.java', '1309700000', '1309780000', 'java/org/apache/catalina/core/StandardContext.java');
INSERT INTO `tomcatdataset` VALUES (132, '51088', '92af111', 'java/org/apache/el/lang/ExpressionBuilder.java', '1303290000', '1309360000', 'java/org/apache/el/lang/ExpressionBuilder.java');
INSERT INTO `tomcatdataset` VALUES (133, '50353', 'd36c5d9', 'java/org/apache/catalina/core/AsyncContextImpl.java', '1290900000', '1309280000', 'java/org/apache/catalina/core/AsyncContextImpl.java');
INSERT INTO `tomcatdataset` VALUES (134, '51396', 'f75418b', 'java/org/apache/catalina/startup/ContextConfig.java\ntest/org/apache/catalina/startup/TestContextConfig.java', '1308600000', '1308610000', 'java/org/apache/catalina/startup/ContextConfig.java test/org/apache/catalina/startup/TestContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (135, '49165', '7d6c439', 'java/org/apache/catalina/valves/AccessLogValve.java', '1271870000', '1308480000', 'java/org/apache/catalina/valves/AccessLogValve.java');
INSERT INTO `tomcatdataset` VALUES (136, '48956', '874048a', 'java/org/apache/catalina/ssi/ExpressionParseTree.java', '1269270000', '1308180000', 'java/org/apache/catalina/ssi/ExpressionParseTree.java');
INSERT INTO `tomcatdataset` VALUES (137, '43538', '2b8e6cf', 'java/org/apache/catalina/manager/Constants.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/StatusManagerServlet.java', '1191350000', '1308180000', 'java/org/apache/catalina/manager/Constants.java java/org/apache/catalina/manager/HTMLManagerServlet.java java/org/apache/catalina/manager/StatusManagerServlet.java');
INSERT INTO `tomcatdataset` VALUES (138, '51306', '4e5571f', 'java/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/DeltaSession.java', '1306950000', '1307960000', 'java/org/apache/catalina/ha/session/DeltaManager.java java/org/apache/catalina/ha/session/DeltaSession.java');
INSERT INTO `tomcatdataset` VALUES (139, '51340', '1fe28a6', 'java/org/apache/catalina/startup/ContextConfig.java', '1307550000', '1307550000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (140, '51276', '5109678', 'java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/TldConfig.java\njava/org/apache/jasper/compiler/TldLocationsCache.java', '1306510000', '1307010000', 'java/org/apache/catalina/startup/ContextConfig.java java/org/apache/catalina/startup/TldConfig.java java/org/apache/jasper/compiler/TldLocationsCache.java java/org/apache/tomcat/util/scan/FileUrlJar.java java/org/apache/tomcat/util/scan/Jar.java java/org/apache/tomcat/util/scan/JarFactory.java java/org/apache/tomcat/util/scan/UrlJar.java');
INSERT INTO `tomcatdataset` VALUES (141, '51240', '73f9592', 'java/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/threads/CounterLatch.java\ntest/org/apache/tomcat/util/threads/TestCounterLatch.java', '1306110000', '1306420000', 'java/org/apache/tomcat/util/net/AbstractEndpoint.java java/org/apache/tomcat/util/net/AprEndpoint.java java/org/apache/tomcat/util/net/JIoEndpoint.java java/org/apache/tomcat/util/net/NioEndpoint.java java/org/apache/tomcat/util/threads/CounterLatch.java java/org/apache/tomcat/util/threads/LimitLatch.java test/org/apache/tomcat/util/threads/TestCounterLatch.java test/org/apache/tomcat/util/threads/TestLimitLatch.java');
INSERT INTO `tomcatdataset` VALUES (142, '51226', '1cd5e7b', 'java/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/ManagerServlet.java', '1305800000', '1306250000', 'java/org/apache/catalina/ant/FindLeaksTask.java java/org/apache/catalina/manager/HTMLManagerServlet.java java/org/apache/catalina/manager/ManagerServlet.java');
INSERT INTO `tomcatdataset` VALUES (143, '27122', '4161179', 'java/org/apache/catalina/authenticator/AuthenticatorBase.java', '1077330000', '1306100000', 'java/org/apache/catalina/authenticator/AuthenticatorBase.java');
INSERT INTO `tomcatdataset` VALUES (144, '51185', '4bdd8d0', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java', '1305120000', '1305930000', 'modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java');
INSERT INTO `tomcatdataset` VALUES (145, '35054', '9bb6e4f', 'java/org/apache/catalina/startup/HostConfig.java', '1117030000', '1305920000', 'java/org/apache/catalina/startup/HostConfig.java');
INSERT INTO `tomcatdataset` VALUES (146, '50950', '0559491', 'java/org/apache/catalina/ha/session/DeltaSession.java', '1300640000', '1304600000', 'java/org/apache/catalina/ha/session/DeltaSession.java');
INSERT INTO `tomcatdataset` VALUES (147, '51119', '2ffa0f7', 'java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java', '1303810000', '1304540000', 'java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java');
INSERT INTO `tomcatdataset` VALUES (148, '51124', '2cdbcd5', 'java/org/apache/jasper/runtime/BodyContentImpl.java', '1303900000', '1304540000', 'java/org/apache/jasper/runtime/BodyContentImpl.java');
INSERT INTO `tomcatdataset` VALUES (149, '51042', 'dc3758e', 'java/org/apache/catalina/Session.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/ha/session/JvmRouteBinderValve.java\njava/org/apache/catalina/manager/DummyProxySession.java\njava/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/session/StandardSession.java', '1302260000', '1302990000', 'java/org/apache/catalina/Session.java java/org/apache/catalina/ha/session/DeltaManager.java java/org/apache/catalina/ha/session/DeltaSession.java java/org/apache/catalina/ha/session/JvmRouteBinderValve.java java/org/apache/catalina/manager/DummyProxySession.java java/org/apache/catalina/session/ManagerBase.java java/org/apache/catalina/session/StandardSession.java');
INSERT INTO `tomcatdataset` VALUES (150, '50887', '552c4b7', 'java/org/apache/catalina/valves/SSLValve.java\njava/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ajp/AbstractAjpProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11AprProtocol.java', '1299580000', '1300020000', 'java/org/apache/catalina/valves/SSLValve.java java/org/apache/coyote/AbstractProtocolHandler.java java/org/apache/coyote/ajp/AbstractAjpProcessor.java java/org/apache/coyote/ajp/AjpAprProtocol.java java/org/apache/coyote/ajp/AjpProtocol.java java/org/apache/coyote/http11/Http11AprProcessor.java java/org/apache/coyote/http11/Http11AprProtocol.java');
INSERT INTO `tomcatdataset` VALUES (151, '50895', '5d61212', 'java/org/apache/jasper/compiler/ELFunctionMapper.java', '1299620000', '1299680000', 'java/org/apache/jasper/compiler/ELFunctionMapper.java');
INSERT INTO `tomcatdataset` VALUES (152, '25060', '1211dbe', 'java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/deploy/NamingResources.java', '1069990000', '1299620000', 'java/org/apache/catalina/core/StandardContext.java java/org/apache/catalina/deploy/NamingResources.java');
INSERT INTO `tomcatdataset` VALUES (153, '27988', '4a4d86e', 'java/org/apache/naming/resources/DirContextURLConnection.java', '1080340000', '1299070000', 'java/org/apache/naming/resources/DirContextURLConnection.java');
INSERT INTO `tomcatdataset` VALUES (154, '28852', 'e1bf740', 'java/org/apache/catalina/ant/JMXGetTask.java\njava/org/apache/catalina/ant/JMXQueryTask.java\njava/org/apache/catalina/ant/JMXSetTask.java\njava/org/apache/catalina/ant/ResourcesTask.java\njava/org/apache/catalina/ant/UndeployTask.java', '1084060000', '1298920000', 'java/org/apache/catalina/ant/JMXGetTask.java java/org/apache/catalina/ant/JMXQueryTask.java java/org/apache/catalina/ant/JMXSetTask.java java/org/apache/catalina/ant/ResourcesTask.java java/org/apache/catalina/ant/UndeployTask.java');
INSERT INTO `tomcatdataset` VALUES (155, '31027', '4b4ef0c', 'java/org/apache/catalina/startup/CatalinaProperties.java', '1094180000', '1298810000', 'java/org/apache/catalina/startup/CatalinaProperties.java');
INSERT INTO `tomcatdataset` VALUES (156, '50836', '92ff888', 'java/org/apache/catalina/Lifecycle.java\njava/org/apache/catalina/LifecycleListener.java\njava/org/apache/catalina/LifecycleState.java\njava/org/apache/catalina/util/LifecycleBase.java', '1298750000', '1298800000', 'java/org/apache/catalina/Lifecycle.java java/org/apache/catalina/LifecycleListener.java java/org/apache/catalina/LifecycleState.java java/org/apache/catalina/util/LifecycleBase.java');
INSERT INTO `tomcatdataset` VALUES (157, '19444', 'a085c4a', 'java/org/apache/catalina/realm/JNDIRealm.java', '1051670000', '1298370000', 'java/org/apache/catalina/realm/JNDIRealm.java');
INSERT INTO `tomcatdataset` VALUES (158, '50189', '514e713', 'java/org/apache/catalina/connector/OutputBuffer.java', '1288580000', '1298050000', 'java/org/apache/catalina/connector/OutputBuffer.java');
INSERT INTO `tomcatdataset` VALUES (159, '50780', 'b56bf50', 'java/org/apache/coyote/ajp/AjpAprProtocol.java', '1297760000', '1297960000', 'java/org/apache/coyote/ajp/AjpAprProtocol.java');
INSERT INTO `tomcatdataset` VALUES (160, '50713', '4b21973', 'java/org/apache/catalina/ant/RolesTask.java\njava/org/apache/catalina/manager/ManagerServlet.java', '1296720000', '1297860000', 'java/org/apache/catalina/ant/RolesTask.java java/org/apache/catalina/manager/ManagerServlet.java');
INSERT INTO `tomcatdataset` VALUES (161, '50700', 'a073ac8', 'java/org/apache/catalina/core/StandardContext.java', '1296580000', '1297710000', 'java/org/apache/catalina/core/StandardContext.java');
INSERT INTO `tomcatdataset` VALUES (162, '50771', '877a3df', 'java/org/apache/catalina/ha/session/DeltaRequest.java\njava/org/apache/catalina/ha/session/DeltaSession.java', '1297670000', '1297670000', 'java/org/apache/catalina/ha/session/DeltaRequest.java java/org/apache/catalina/ha/session/DeltaSession.java');
INSERT INTO `tomcatdataset` VALUES (163, '50726', 'd0f3899', 'java/org/apache/jasper/compiler/Generator.java', '1297080000', '1297540000', 'java/org/apache/jasper/compiler/Generator.java');
INSERT INTO `tomcatdataset` VALUES (164, '50673', '6ac4a27', 'java/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/startup/Catalina.java', '1296140000', '1296610000', 'java/org/apache/catalina/core/StandardServer.java java/org/apache/catalina/startup/Catalina.java');
INSERT INTO `tomcatdataset` VALUES (165, '50642', '5c13d8c', 'java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java', '1295880000', '1296220000', 'java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java java/org/apache/catalina/core/StandardContext.java java/org/apache/catalina/loader/WebappClassLoader.java java/org/apache/catalina/loader/WebappLoader.java');
INSERT INTO `tomcatdataset` VALUES (166, '50646', '0119483', 'java/org/apache/catalina/tribes/ByteMessage.java', '1295960000', '1296070000', 'java/org/apache/catalina/tribes/ByteMessage.java');
INSERT INTO `tomcatdataset` VALUES (167, '50613', '5cb0b7a', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java', '1295390000', '1295470000', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestSizePreservation.java');
INSERT INTO `tomcatdataset` VALUES (168, '50582', '35a84d1', 'java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/JDBCAccessLogValve.java\njava/org/apache/coyote/http11/AbstractOutputBuffer.java', '1294990000', '1295180000', 'java/org/apache/catalina/connector/CoyoteAdapter.java java/org/apache/catalina/valves/AccessLogValve.java java/org/apache/catalina/valves/JDBCAccessLogValve.java java/org/apache/coyote/http11/AbstractOutputBuffer.java');
INSERT INTO `tomcatdataset` VALUES (169, '18462', '164fd40', 'java/org/apache/catalina/startup/Catalina.java\njava/org/apache/catalina/startup/Embedded.java', '1048870000', '1294880000', 'java/org/apache/catalina/startup/Catalina.java java/org/apache/catalina/startup/Embedded.java');
INSERT INTO `tomcatdataset` VALUES (170, '15688', 'e69347b', 'java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/JspUtil.java', '1041050000', '1294830000', 'java/org/apache/jasper/compiler/Generator.java java/org/apache/jasper/compiler/JspUtil.java');
INSERT INTO `tomcatdataset` VALUES (171, '49953', 'fd990a4', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/StatementCache.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java', '1284750000', '1294680000', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/StatementCache.java modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java');
INSERT INTO `tomcatdataset` VALUES (172, '21157', '4ce656a', 'webapps/examples/WEB-INF/classes/CookieExample.java', '1056770000', '1294530000', 'webapps/examples/WEB-INF/classes/CookieExample.java');
INSERT INTO `tomcatdataset` VALUES (173, '50552', 'a6b37af', 'java/org/apache/catalina/ant/BaseRedirectorHelperTask.java', '1294340000', '1294400000', 'java/org/apache/catalina/ant/BaseRedirectorHelperTask.java');
INSERT INTO `tomcatdataset` VALUES (174, '49543', '3560f39', NULL, '1278100000', '1294340000', 'java/org/apache/naming/factory/DataSourceLinkFactory.java');
INSERT INTO `tomcatdataset` VALUES (175, '50547', 'a0ef3e6', 'java/org/apache/catalina/ha/session/DeltaManager.java', '1294300000', '1294310000', 'java/org/apache/catalina/ha/session/DeltaManager.java');
INSERT INTO `tomcatdataset` VALUES (176, '50453', '3541fc6', 'java/org/apache/catalina/filters/RemoteIpFilter.java\njava/org/apache/catalina/valves/RemoteIpValve.java\ntest/org/apache/catalina/filters/TestRemoteIpFilter.java\ntest/org/apache/catalina/valves/TestRemoteIpValve.java', '1291990000', '1294240000', 'java/org/apache/catalina/filters/RemoteIpFilter.java java/org/apache/catalina/valves/RemoteIpValve.java test/org/apache/catalina/filters/TestRemoteIpFilter.java test/org/apache/catalina/valves/TestRemoteIpValve.java');
INSERT INTO `tomcatdataset` VALUES (177, '50467', '688e61e', 'java/org/apache/tomcat/util/net/NioEndpoint.java', '1292270000', '1294240000', 'java/org/apache/tomcat/util/net/NioEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (178, '50500', 'b19fb3b', 'java/org/apache/el/lang/ELArithmetic.java', '1292800000', '1294150000', 'java/org/apache/el/lang/ELArithmetic.java test/org/apache/el/lang/TestELArithmetic.java');
INSERT INTO `tomcatdataset` VALUES (179, '50025', '59b17c1', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/driver/Connection.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/driver/Driver.java', '1285770000', '1294090000', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/AlternateUsernameTest.java modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/driver/Connection.java modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/driver/Driver.java');
INSERT INTO `tomcatdataset` VALUES (180, '49125', '5614817', 'java/org/apache/catalina/ha/deploy/FileMessageFactory.java\njava/org/apache/coyote/ajp/AjpMessage.java\njava/org/apache/tomcat/util/buf/HexUtils.java', '1271290000', '1292360000', 'java/org/apache/catalina/ha/deploy/FileMessageFactory.java java/org/apache/coyote/ajp/AjpMessage.java java/org/apache/tomcat/util/buf/HexUtils.java');
INSERT INTO `tomcatdataset` VALUES (181, '50460', '345e6b5', 'java/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/naming/resources/ImmutableNameNotFoundException.java', '1292120000', '1292200000', 'java/org/apache/jasper/compiler/JspDocumentParser.java java/org/apache/naming/resources/ImmutableNameNotFoundException.java');
INSERT INTO `tomcatdataset` VALUES (182, '48692', 'e34b164', 'java/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/Request.java\ntest/org/apache/catalina/connector/TestRequest.java', '1265530000', '1291390000', 'java/org/apache/catalina/connector/Connector.java java/org/apache/catalina/connector/Request.java test/org/apache/catalina/connector/TestRequest.java');
INSERT INTO `tomcatdataset` VALUES (183, '49142', '4cbb52f', 'java/javax/servlet/GenericServlet.java\njava/javax/servlet/ServletContextAttributeEvent.java\njava/javax/servlet/ServletContextEvent.java\njava/javax/servlet/ServletException.java\njava/javax/servlet/ServletRequestAttributeEvent.java\njava/javax/servlet/ServletRequestEvent.java\njava/javax/servlet/UnavailableException.java\njava/javax/servlet/http/HttpServlet.java\njava/javax/servlet/http/HttpSessionBindingEvent.java\njava/javax/servlet/http/HttpSessionEvent.java\njava/javax/servlet/jsp/JspException.java\njava/javax/servlet/jsp/JspTagException.java\njava/javax/servlet/jsp/SkipPageException.java\njava/javax/servlet/jsp/el/ELException.java\njava/javax/servlet/jsp/el/ELParseException.java\njava/javax/servlet/jsp/tagext/TagSupport.java\njava/org/apache/catalina/ha/deploy/FileMessage.java\njava/org/apache/catalina/ha/deploy/UndeployMessage.java\njava/org/apache/catalina/manager/StatusManagerServlet.java\njava/org/apache/catalina/session/StandardSession.java\njava/org/apache/catalina/ssi/SSIServlet.java\njava/org/apache/catalina/ssi/SSIStopProcessingException.java\njava/org/apache/catalina/tribes/ChannelException.java\njava/org/apache/catalina/tribes/RemoteProcessException.java\njava/org/apache/catalina/tribes/UniqueId.java\njava/org/apache/catalina/tribes/io/ChannelData.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/LazyReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/ReplicatedMap.java\njava/org/apache/catalina/tribes/util/ExecutorFactory.java\njava/org/apache/catalina/util/ParameterMap.java\njava/org/apache/catalina/util/ResourceSet.java\njava/org/apache/jasper/JasperException.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/runtime/HttpJspBase.java\njava/org/apache/juli/logging/LogConfigurationException.java\njava/org/apache/naming/EjbRef.java\njava/org/apache/naming/HandlerRef.java\njava/org/apache/naming/JndiPermission.java\njava/org/apache/naming/ResourceEnvRef.java\njava/org/apache/naming/ResourceLinkRef.java\njava/org/apache/naming/ServiceRef.java\njava/org/apache/naming/TransactionRef.java\njava/org/apache/tomcat/util/buf/CharChunk.java\njava/org/apache/tomcat/util/buf/MessageBytes.java\njava/org/apache/tomcat/util/modeler/BaseAttributeFilter.java\njava/org/apache/tomcat/util/modeler/FixedNotificationFilter.java\njava/org/apache/tomcat/util/modeler/ManagedBean.java\njava/org/apache/tomcat/util/net/URL.java\ntest/org/apache/catalina/tribes/demos/MapDemo.java\nwebapps/examples/WEB-INF/jsp/applet/Clock2.java', '1271470000', '1290640000', 'java/javax/servlet/GenericServlet.java java/javax/servlet/ServletContextAttributeEvent.java java/javax/servlet/ServletContextEvent.java java/javax/servlet/ServletException.java java/javax/servlet/ServletRequestAttributeEvent.java java/javax/servlet/ServletRequestEvent.java java/javax/servlet/UnavailableException.java java/javax/servlet/http/HttpServlet.java java/javax/servlet/http/HttpSessionBindingEvent.java java/javax/servlet/http/HttpSessionEvent.java java/javax/servlet/jsp/JspException.java java/javax/servlet/jsp/JspTagException.java java/javax/servlet/jsp/SkipPageException.java java/javax/servlet/jsp/el/ELException.java java/javax/servlet/jsp/el/ELParseException.java java/javax/servlet/jsp/tagext/TagSupport.java java/org/apache/catalina/ha/deploy/FileMessage.java java/org/apache/catalina/ha/deploy/UndeployMessage.java java/org/apache/catalina/manager/StatusManagerServlet.java java/org/apache/catalina/session/StandardSession.java java/org/apache/catalina/ssi/SSIServlet.java java/org/apache/catalina/ssi/SSIStopProcessingException.java java/org/apache/catalina/tribes/ChannelException.java java/org/apache/catalina/tribes/RemoteProcessException.java java/org/apache/catalina/tribes/UniqueId.java java/org/apache/catalina/tribes/io/ChannelData.java java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java java/org/apache/catalina/tribes/tipis/LazyReplicatedMap.java java/org/apache/catalina/tribes/tipis/ReplicatedMap.java java/org/apache/catalina/tribes/util/ExecutorFactory.java java/org/apache/catalina/util/ParameterMap.java java/org/apache/catalina/util/ResourceSet.java java/org/apache/jasper/JasperException.java java/org/apache/jasper/compiler/JspDocumentParser.java java/org/apache/jasper/runtime/HttpJspBase.java java/org/apache/juli/logging/LogConfigurationException.java java/org/apache/naming/EjbRef.java java/org/apache/naming/HandlerRef.java java/org/apache/naming/JndiPermission.java java/org/apache/naming/ResourceEnvRef.java java/org/apache/naming/ResourceLinkRef.java java/org/apache/naming/ServiceRef.java java/org/apache/naming/TransactionRef.java java/org/apache/tomcat/util/buf/CharChunk.java java/org/apache/tomcat/util/buf/MessageBytes.java java/org/apache/tomcat/util/modeler/BaseAttributeFilter.java java/org/apache/tomcat/util/modeler/FixedNotificationFilter.java java/org/apache/tomcat/util/modeler/ManagedBean.java java/org/apache/tomcat/util/net/URL.java test/org/apache/catalina/tribes/demos/MapDemo.java webapps/examples/WEB-INF/jsp/applet/Clock2.java');
INSERT INTO `tomcatdataset` VALUES (184, '48837', 'ddbbfc1', 'java/org/apache/catalina/loader/WebappClassLoader.java', '1267490000', '1290630000', 'java/org/apache/catalina/loader/WebappClassLoader.java');
INSERT INTO `tomcatdataset` VALUES (185, '50192', 'e075c4b', 'java/org/apache/jasper/el/ELContextImpl.java\njava/org/apache/jasper/el/ELResolverImpl.java', '1288640000', '1289590000', 'java/org/apache/jasper/el/ELContextImpl.java java/org/apache/jasper/el/ELResolverImpl.java');
INSERT INTO `tomcatdataset` VALUES (186, '50168', '6eae969', 'java/org/apache/catalina/Lifecycle.java\njava/org/apache/catalina/LifecycleState.java\njava/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/util/LifecycleBase.java', '1288230000', '1288910000', 'java/org/apache/catalina/Lifecycle.java java/org/apache/catalina/LifecycleState.java java/org/apache/catalina/core/AprLifecycleListener.java java/org/apache/catalina/core/ContainerBase.java java/org/apache/catalina/startup/ContextConfig.java java/org/apache/catalina/util/LifecycleBase.java');
INSERT INTO `tomcatdataset` VALUES (187, '49426', '7357867', 'java/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/tomcat/util/res/StringManager.java', '1276240000', '1287260000', 'java/org/apache/catalina/manager/HTMLManagerServlet.java java/org/apache/catalina/manager/ManagerServlet.java java/org/apache/tomcat/util/res/StringManager.java');
INSERT INTO `tomcatdataset` VALUES (188, '50066', '79cf689', 'java/org/apache/jasper/compiler/TagFileProcessor.java', '1286630000', '1286730000', 'java/org/apache/jasper/compiler/TagFileProcessor.java');
INSERT INTO `tomcatdataset` VALUES (189, '50027', '6ce21f4', 'java/org/apache/catalina/core/StandardContext.java', '1285780000', '1286570000', 'java/org/apache/catalina/core/StandardContext.java');
INSERT INTO `tomcatdataset` VALUES (190, '49986', '2570d6ff', 'java/org/apache/jasper/servlet/JspServletWrapper.java', '1285250000', '1286460000', 'java/org/apache/jasper/servlet/JspServletWrapper.java');
INSERT INTO `tomcatdataset` VALUES (191, '49972', '0ae33cb', 'java/org/apache/tomcat/util/http/FastHttpDateFormat.java', '1285150000', '1286460000', 'java/org/apache/tomcat/util/http/FastHttpDateFormat.java');
INSERT INTO `tomcatdataset` VALUES (192, '49985', 'b893eee', 'java/org/apache/el/parser/AstFloatingPoint.java\njava/org/apache/el/parser/AstInteger.java\njava/org/apache/el/parser/AstString.java', '1285250000', '1286050000', 'java/org/apache/el/parser/AstFloatingPoint.java java/org/apache/el/parser/AstInteger.java java/org/apache/el/parser/AstString.java');
INSERT INTO `tomcatdataset` VALUES (193, '49915', '5eb3851', 'java/org/apache/catalina/core/StandardServer.java', '1284160000', '1285950000', 'java/org/apache/catalina/core/StandardServer.java');
INSERT INTO `tomcatdataset` VALUES (194, '49667', 'dc754cc', 'java/org/apache/catalina/loader/JdbcLeakPrevention.java', '1280410000', '1285930000', 'java/org/apache/catalina/loader/JdbcLeakPrevention.java');
INSERT INTO `tomcatdataset` VALUES (195, '49730', '2bfc300', 'java/org/apache/tomcat/util/threads/TaskQueue.java\njava/org/apache/tomcat/util/threads/ThreadPoolExecutor.java', '1281380000', '1285870000', 'java/org/apache/tomcat/util/threads/TaskQueue.java java/org/apache/tomcat/util/threads/ThreadPoolExecutor.java');
INSERT INTO `tomcatdataset` VALUES (196, '49665', '7b24ed5', 'java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/compiler/Parser.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java', '1280390000', '1285690000', 'java/org/apache/jasper/compiler/Generator.java java/org/apache/jasper/compiler/JspDocumentParser.java java/org/apache/jasper/compiler/Parser.java java/org/apache/jasper/compiler/TagLibraryInfoImpl.java');
INSERT INTO `tomcatdataset` VALUES (197, '49209', 'd0d4c75', 'java/org/apache/catalina/loader/WebappClassLoader.java', '1272450000', '1285630000', 'java/org/apache/catalina/loader/WebappClassLoader.java');
INSERT INTO `tomcatdataset` VALUES (198, '49234', 'e0182ef', 'java/org/apache/catalina/Server.java\njava/org/apache/catalina/Service.java\njava/org/apache/catalina/core/StandardEngine.java\njava/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/core/StandardService.java\njava/org/apache/catalina/startup/Catalina.java', '1272600000', '1284250000', 'java/org/apache/catalina/Server.java java/org/apache/catalina/Service.java java/org/apache/catalina/core/StandardEngine.java java/org/apache/catalina/core/StandardServer.java java/org/apache/catalina/core/StandardService.java java/org/apache/catalina/mbeans/ContainerMBean.java java/org/apache/catalina/mbeans/ContextMBean.java java/org/apache/catalina/mbeans/ServiceMBean.java java/org/apache/catalina/startup/Catalina.java');
INSERT INTO `tomcatdataset` VALUES (199, '49749', 'e641f20', 'java/org/apache/catalina/authenticator/AuthenticatorBase.java', '1281740000', '1282740000', 'java/org/apache/catalina/authenticator/AuthenticatorBase.java');
INSERT INTO `tomcatdataset` VALUES (200, '48738', '526f4ac', 'java/org/apache/coyote/http11/AbstractOutputBuffer.java\njava/org/apache/coyote/http11/filters/GzipOutputFilter.java', '1266120000', '1282640000', 'java/org/apache/coyote/http11/AbstractOutputBuffer.java java/org/apache/coyote/http11/filters/FlushableGZIPOutputStream.java java/org/apache/coyote/http11/filters/GzipOutputFilter.java test/org/apache/coyote/http11/TestGzipOutputFilter.java');
INSERT INTO `tomcatdataset` VALUES (201, '49670', 'e2f0b9b', 'java/org/apache/catalina/authenticator/AuthenticatorBase.java', '1280410000', '1282590000', 'java/org/apache/catalina/authenticator/AuthenticatorBase.java');
INSERT INTO `tomcatdataset` VALUES (202, '49721', '187eed8', 'java/org/apache/catalina/startup/ContextConfig.java', '1281150000', '1282590000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (203, '49613', '5f1ad13', 'java/org/apache/catalina/connector/Request.java', '1279530000', '1279810000', 'java/org/apache/catalina/connector/Request.java');
INSERT INTO `tomcatdataset` VALUES (204, '49567', '2357fb5', 'java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/AsyncContextImpl.java\njava/org/apache/coyote/http11/Http11Processor.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java', '1278510000', '1279790000', 'java/org/apache/catalina/connector/CoyoteAdapter.java java/org/apache/catalina/connector/Request.java java/org/apache/catalina/core/AsyncContextImpl.java java/org/apache/coyote/http11/Http11Processor.java test/org/apache/catalina/core/TestAsyncContextImpl.java');
INSERT INTO `tomcatdataset` VALUES (205, '48998', '7963a16', NULL, '1269640000', '1279150000', 'java/org/apache/catalina/filters/ExpiresFilter.java test/org/apache/catalina/filters/TestExpiresFilter.java');
INSERT INTO `tomcatdataset` VALUES (206, '48960', 'a36b0c0', 'java/org/apache/catalina/ssi/SSIFilter.java\njava/org/apache/catalina/ssi/SSIProcessor.java\njava/org/apache/catalina/ssi/SSIServlet.java', '1269290000', '1279060000', 'java/org/apache/catalina/ssi/SSIFilter.java java/org/apache/catalina/ssi/SSIProcessor.java java/org/apache/catalina/ssi/SSIServlet.java');
INSERT INTO `tomcatdataset` VALUES (207, '49570', 'c191152', 'webapps/examples/WEB-INF/classes/compressionFilters/CompressionResponseStream.java', '1278570000', '1278780000', 'webapps/examples/WEB-INF/classes/compressionFilters/CompressionResponseStream.java');
INSERT INTO `tomcatdataset` VALUES (208, '49550', '7b9630b', 'java/org/apache/catalina/connector/Response.java', '1278330000', '1278360000', 'java/org/apache/catalina/connector/Response.java');
INSERT INTO `tomcatdataset` VALUES (209, '49525', '0b8a9a8', 'java/org/apache/catalina/core/ApplicationSessionCookieConfig.java', '1277860000', '1278010000', 'java/org/apache/catalina/core/ApplicationSessionCookieConfig.java');
INSERT INTO `tomcatdataset` VALUES (210, '49445', '4f990f1', 'java/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/SessionMessage.java\njava/org/apache/catalina/ha/session/SessionMessageImpl.java', '1276680000', '1276690000', 'java/org/apache/catalina/ha/session/DeltaManager.java java/org/apache/catalina/ha/session/SessionMessage.java java/org/apache/catalina/ha/session/SessionMessageImpl.java');
INSERT INTO `tomcatdataset` VALUES (211, '48971', 'ac8a5ba', 'java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java', '1269400000', '1275410000', 'java/org/apache/catalina/core/StandardContext.java java/org/apache/catalina/loader/WebappClassLoader.java java/org/apache/catalina/loader/WebappLoader.java');
INSERT INTO `tomcatdataset` VALUES (212, '49224', '4fff6c0', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java', '1272550000', '1273660000', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java');
INSERT INTO `tomcatdataset` VALUES (213, '48689', 'efd418b', 'java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/ImplicitTagLibraryInfo.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/compiler/Parser.java\njava/org/apache/jasper/compiler/ParserController.java\njava/org/apache/jasper/compiler/TagFileProcessor.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/jasper/servlet/JspServletWrapper.java', '1265390000', '1272200000', 'java/org/apache/jasper/JspCompilationContext.java java/org/apache/jasper/compiler/ImplicitTagLibraryInfo.java java/org/apache/jasper/compiler/JarResource.java java/org/apache/jasper/compiler/JarURLResource.java java/org/apache/jasper/compiler/JspDocumentParser.java java/org/apache/jasper/compiler/Parser.java java/org/apache/jasper/compiler/ParserController.java java/org/apache/jasper/compiler/TagFileProcessor.java java/org/apache/jasper/compiler/TagLibraryInfoImpl.java java/org/apache/jasper/compiler/TldLocation.java java/org/apache/jasper/compiler/TldLocationsCache.java java/org/apache/jasper/servlet/JspServletWrapper.java');
INSERT INTO `tomcatdataset` VALUES (214, '43642', 'e7fb8fa', 'java/org/apache/catalina/core/StandardThreadExecutor.java', '1192620000', '1271850000', 'java/org/apache/catalina/core/StandardThreadExecutor.java');
INSERT INTO `tomcatdataset` VALUES (215, '49045', '32046eb', 'java/org/apache/catalina/mbeans/MBeanFactory.java', '1270370000', '1271250000', 'java/org/apache/catalina/mbeans/MBeanFactory.java');
INSERT INTO `tomcatdataset` VALUES (216, '49086', '6fc4360', 'java/javax/servlet/annotation/HandlesTypes.java\njava/javax/servlet/annotation/HttpConstraint.java\njava/javax/servlet/annotation/HttpMethodConstraint.java\njava/javax/servlet/annotation/MultipartConfig.java\njava/javax/servlet/annotation/ServletSecurity.java\njava/javax/servlet/annotation/WebFilter.java\njava/javax/servlet/annotation/WebInitParam.java\njava/javax/servlet/annotation/WebListener.java\njava/javax/servlet/annotation/WebServlet.java', '1271020000', '1271070000', 'java/javax/servlet/annotation/HandlesTypes.java java/javax/servlet/annotation/HttpConstraint.java java/javax/servlet/annotation/HttpMethodConstraint.java java/javax/servlet/annotation/MultipartConfig.java java/javax/servlet/annotation/ServletSecurity.java java/javax/servlet/annotation/WebFilter.java java/javax/servlet/annotation/WebInitParam.java java/javax/servlet/annotation/WebListener.java java/javax/servlet/annotation/WebServlet.java');
INSERT INTO `tomcatdataset` VALUES (217, '48717', '39d3082', 'java/org/apache/catalina/ha/session/DeltaManager.java', '1265760000', '1269800000', 'java/org/apache/catalina/ha/session/DeltaManager.java');
INSERT INTO `tomcatdataset` VALUES (218, '48760', 'f1760d8', 'java/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/WARDirContext.java', '1266460000', '1268140000', 'java/org/apache/naming/resources/FileDirContext.java java/org/apache/naming/resources/WARDirContext.java');
INSERT INTO `tomcatdataset` VALUES (219, '48737', '6ac5036', 'java/org/apache/jasper/JspCompilationContext.java', '1266100000', '1268140000', 'java/org/apache/jasper/JspCompilationContext.java');
INSERT INTO `tomcatdataset` VALUES (220, '48582', '7301a10', 'java/org/apache/jasper/servlet/JspServletWrapper.java', '1264010000', '1266320000', 'java/org/apache/jasper/servlet/JspServletWrapper.java');
INSERT INTO `tomcatdataset` VALUES (221, '48580', '9e55819', 'java/org/apache/jasper/security/SecurityClassLoad.java', '1264010000', '1266310000', 'java/org/apache/jasper/security/SecurityClassLoad.java');
INSERT INTO `tomcatdataset` VALUES (222, '48498', '789ac1e', 'java/org/apache/jasper/compiler/JavacErrorDetail.java', '1262820000', '1266280000', 'java/org/apache/jasper/compiler/JavacErrorDetail.java');
INSERT INTO `tomcatdataset` VALUES (223, '48371', '563e315', 'java/org/apache/jasper/JspC.java', '1260490000', '1266090000', 'java/org/apache/jasper/JspC.java');
INSERT INTO `tomcatdataset` VALUES (224, '48170', 'c09753b', 'java/javax/servlet/jsp/JspFactory.java', '1257890000', '1265670000', 'java/javax/servlet/jsp/JspFactory.java');
INSERT INTO `tomcatdataset` VALUES (225, '48643', '6f48cde', 'java/org/apache/catalina/session/FileStore.java\njava/org/apache/catalina/session/StandardManager.java', '1264890000', '1265580000', 'java/org/apache/catalina/session/FileStore.java java/org/apache/catalina/session/StandardManager.java');
INSERT INTO `tomcatdataset` VALUES (226, '48516', '62d29b6', 'java/org/apache/catalina/realm/JNDIRealm.java', '1263210000', '1263340000', 'java/org/apache/catalina/realm/JNDIRealm.java');
INSERT INTO `tomcatdataset` VALUES (227, '48004', '13daf69', 'java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java', '1255620000', '1263330000', 'java/org/apache/coyote/http11/Http11AprProcessor.java java/org/apache/coyote/http11/Http11NioProcessor.java java/org/apache/coyote/http11/Http11Processor.java');
INSERT INTO `tomcatdataset` VALUES (228, '48006', '3d309a5', 'java/org/apache/catalina/connector/CoyoteAdapter.java', '1255620000', '1262260000', 'java/org/apache/catalina/connector/CoyoteAdapter.java');
INSERT INTO `tomcatdataset` VALUES (229, '43819', '9a2ae02', 'java/javax/el/ExpressionFactory.java\njava/org/apache/jasper/compiler/JspUtil.java\njava/org/apache/jasper/compiler/PageInfo.java\njava/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/runtime/JspApplicationContextImpl.java', '1194550000', '1262210000', 'java/javax/el/ExpressionFactory.java java/org/apache/jasper/compiler/JspUtil.java java/org/apache/jasper/compiler/PageInfo.java java/org/apache/jasper/compiler/Validator.java java/org/apache/jasper/runtime/JspApplicationContextImpl.java');
INSERT INTO `tomcatdataset` VALUES (230, '47744', '51d5511', 'java/org/apache/tomcat/util/net/jsse/JSSESupport.java', '1251300000', '1260800000', 'java/org/apache/tomcat/util/net/jsse/JSSESupport.java');
INSERT INTO `tomcatdataset` VALUES (231, '47502', '806200c', 'java/org/apache/catalina/ha/session/DeltaSession.java', '1247130000', '1259710000', 'java/org/apache/catalina/ha/session/DeltaSession.java');
INSERT INTO `tomcatdataset` VALUES (232, '47342', '9afe6ce', 'java/org/apache/catalina/ha/context/ReplicatedContext.java', '1244620000', '1259360000', 'java/org/apache/catalina/ha/context/ReplicatedContext.java');
INSERT INTO `tomcatdataset` VALUES (233, '48267', '632e68c', 'java/javax/annotation/Resource.java\njava/javax/ejb/EJB.java\njava/javax/el/BeanELResolver.java\njava/javax/el/ELContext.java\njava/javax/el/ListELResolver.java\njava/javax/el/MapELResolver.java\njava/javax/el/ResourceBundleELResolver.java\njava/javax/xml/ws/WebServiceRef.java', '1259000000', '1259340000', 'java/javax/annotation/Resource.java java/javax/ejb/EJB.java java/javax/el/BeanELResolver.java java/javax/el/ELContext.java java/javax/el/ListELResolver.java java/javax/el/MapELResolver.java java/javax/el/ResourceBundleELResolver.java java/javax/xml/ws/WebServiceRef.java');
INSERT INTO `tomcatdataset` VALUES (234, '47799', '94c643b', 'java/org/apache/catalina/tribes/group/interceptors/DomainFilterInterceptor.java\njava/org/apache/catalina/tribes/membership/McastService.java', '1252390000', '1258930000', 'java/org/apache/catalina/tribes/group/interceptors/DomainFilterInterceptor.java java/org/apache/catalina/tribes/membership/McastService.java');
INSERT INTO `tomcatdataset` VALUES (235, '47462', '04b0838', 'java/org/apache/catalina/startup/WebRuleSet.java', '1246430000', '1258920000', 'java/org/apache/catalina/startup/WebRuleSet.java');
INSERT INTO `tomcatdataset` VALUES (236, '47997', '58162ed', 'java/org/apache/catalina/core/NamingContextListener.java', '1255560000', '1258920000', 'java/org/apache/catalina/core/NamingContextListener.java');
INSERT INTO `tomcatdataset` VALUES (237, '47718', 'ae5c640', 'java/org/apache/catalina/session/ManagerBase.java', '1250790000', '1258920000', 'java/org/apache/catalina/session/ManagerBase.java');
INSERT INTO `tomcatdataset` VALUES (238, '48172', '242b6a3', 'java/org/apache/jasper/compiler/JspRuntimeContext.java', '1257930000', '1258590000', 'java/org/apache/jasper/compiler/JspRuntimeContext.java');
INSERT INTO `tomcatdataset` VALUES (239, '47881', '3ef0f21', 'java/org/apache/catalina/startup/Bootstrap.java', '1253490000', '1257160000', 'java/org/apache/catalina/startup/Bootstrap.java');
INSERT INTO `tomcatdataset` VALUES (240, '47451', '14084ac', 'java/org/apache/catalina/connector/Response.java', '1246300000', '1257120000', 'java/org/apache/catalina/connector/Response.java');
INSERT INTO `tomcatdataset` VALUES (241, '40001', '99f01fd', 'java/org/apache/catalina/manager/Constants.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java', '1152560000', '1255210000', 'java/org/apache/catalina/manager/Constants.java java/org/apache/catalina/manager/HTMLManagerServlet.java');
INSERT INTO `tomcatdataset` VALUES (242, '47499', '73bb9e4', 'java/org/apache/tomcat/util/net/JIoEndpoint.java', '1247110000', '1253650000', 'java/org/apache/tomcat/util/net/JIoEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (243, '47866', '189181a', 'test/org/apache/catalina/startup/TestTomcat.java', '1253250000', '1253530000', 'test/org/apache/catalina/startup/TestTomcat.java');
INSERT INTO `tomcatdataset` VALUES (244, '47161', 'aaf7b5d', 'java/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/threads/ResizableExecutor.java', '1241610000', '1253050000', 'java/org/apache/tomcat/util/net/AbstractEndpoint.java java/org/apache/tomcat/util/threads/ResizableExecutor.java');
INSERT INTO `tomcatdataset` VALUES (245, '46950', 'e9248d7', 'java/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/tomcat/jni/SSLSocket.java', '1238580000', '1253040000', 'java/org/apache/catalina/core/AprLifecycleListener.java java/org/apache/coyote/http11/Http11AprProcessor.java java/org/apache/tomcat/jni/SSLSocket.java');
INSERT INTO `tomcatdataset` VALUES (246, '47378', 'fe53ca9', 'java/org/apache/tomcat/util/http/mapper/Mapper.java', '1245170000', '1251730000', 'java/org/apache/tomcat/util/http/mapper/Mapper.java');
INSERT INTO `tomcatdataset` VALUES (247, '41824', '768af9f', 'java/org/apache/jasper/compiler/JspUtil.java', '1173710000', '1248460000', 'java/org/apache/jasper/compiler/JspUtil.java');
INSERT INTO `tomcatdataset` VALUES (248, '46907', '50d0e6e', 'java/org/apache/jasper/servlet/JspServlet.java', '1237920000', '1248370000', 'java/org/apache/jasper/servlet/JspServlet.java');
INSERT INTO `tomcatdataset` VALUES (249, '47518', '9dc93f5', 'java/org/apache/catalina/Valve.java', '1247480000', '1248160000', 'java/org/apache/catalina/Valve.java');
INSERT INTO `tomcatdataset` VALUES (250, '41059', 'a9f0239', 'java/org/apache/catalina/loader/WebappClassLoader.java', '1164730000', '1247850000', 'java/org/apache/catalina/loader/WebappClassLoader.java');
INSERT INTO `tomcatdataset` VALUES (251, '40551', 'f0d447d', 'java/org/apache/catalina/ha/session/JvmRouteBinderValve.java', '1158730000', '1247770000', 'java/org/apache/catalina/ha/session/JvmRouteBinderValve.java');
INSERT INTO `tomcatdataset` VALUES (252, '47515', '83e98da', 'java/org/apache/catalina/ha/session/DeltaManager.java', '1247450000', '1247750000', 'java/org/apache/catalina/ha/session/DeltaManager.java');
INSERT INTO `tomcatdataset` VALUES (253, '40380', '6f3e56e', 'java/org/apache/catalina/session/StandardSession.java', '1157070000', '1247590000', 'java/org/apache/catalina/session/StandardSession.java');
INSERT INTO `tomcatdataset` VALUES (254, '39231', '80f8ec6', 'java/org/apache/catalina/realm/GenericPrincipal.java\njava/org/apache/catalina/realm/JAASRealm.java\njava/org/apache/catalina/session/StandardSession.java', '1144370000', '1246980000', 'java/org/apache/catalina/realm/GenericPrincipal.java java/org/apache/catalina/realm/JAASRealm.java java/org/apache/catalina/session/StandardSession.java');
INSERT INTO `tomcatdataset` VALUES (255, '37984', 'c6818a0', 'java/org/apache/catalina/realm/JNDIRealm.java', '1135160000', '1246490000', 'java/org/apache/catalina/realm/JNDIRealm.java');
INSERT INTO `tomcatdataset` VALUES (256, '47440', 'd92da6e', 'modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/CheckOutThreadTest.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/DefaultProperties.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestSlowQueryReport.java', '1246090000', '1246290000', 'modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/CheckOutThreadTest.java modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/DefaultProperties.java modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestSlowQueryReport.java');
INSERT INTO `tomcatdataset` VALUES (257, '47439', 'ef96fa2', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java', '1246090000', '1246200000', 'modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java');
INSERT INTO `tomcatdataset` VALUES (258, '38352', '76a4eb3', 'java/org/apache/jasper/compiler/JspRuntimeContext.java', '1137980000', '1245420000', 'java/org/apache/jasper/compiler/JspRuntimeContext.java');
INSERT INTO `tomcatdataset` VALUES (259, '47046', '54b9da9', 'java/org/apache/catalina/connector/MapperListener.java\njava/org/apache/catalina/mbeans/MBeanUtils.java\njava/org/apache/catalina/mbeans/ServerLifecycleListener.java', '1239970000', '1241050000', 'java/org/apache/catalina/connector/MapperListener.java java/org/apache/catalina/mbeans/MBeanUtils.java java/org/apache/catalina/mbeans/ServerLifecycleListener.java');
INSERT INTO `tomcatdataset` VALUES (260, '37929', '04cacaf', 'java/org/apache/jasper/runtime/PageContextImpl.java', '1134720000', '1239900000', 'java/org/apache/jasper/runtime/PageContextImpl.java');
INSERT INTO `tomcatdataset` VALUES (261, '47013', 'c8cbc28', 'java/org/apache/catalina/core/Constants.java\njava/org/apache/catalina/core/StandardWrapper.java', '1239370000', '1239750000', 'java/org/apache/catalina/core/Constants.java java/org/apache/catalina/core/StandardWrapper.java');
INSERT INTO `tomcatdataset` VALUES (262, '42579', '90e8d0d', 'java/org/apache/catalina/realm/JNDIRealm.java', '1180980000', '1239290000', 'java/org/apache/catalina/realm/JNDIRealm.java');
INSERT INTO `tomcatdataset` VALUES (263, '46354', '78a994a', 'java/org/apache/jasper/runtime/BodyContentImpl.java', '1228490000', '1239290000', 'java/org/apache/jasper/runtime/BodyContentImpl.java');
INSERT INTO `tomcatdataset` VALUES (264, '46562', '6ecc35d', 'java/org/apache/catalina/ssi/SSIServlet.java', '1232370000', '1239280000', 'java/org/apache/catalina/ssi/SSIServlet.java');
INSERT INTO `tomcatdataset` VALUES (265, '46991', 'a228c06', 'java/org/apache/jk/server/JkCoyoteHandler.java', '1239170000', '1239210000', 'java/org/apache/jk/server/JkCoyoteHandler.java');
INSERT INTO `tomcatdataset` VALUES (266, '46967', '243aa86', 'java/org/apache/catalina/session/ManagerBase.java', '1238800000', '1239200000', 'java/org/apache/catalina/session/ManagerBase.java');
INSERT INTO `tomcatdataset` VALUES (267, '46933', '23c47da', 'java/org/apache/tomcat/util/res/StringManager.java', '1238180000', '1239190000', 'java/org/apache/tomcat/util/res/StringManager.java test/org/apache/tomcat/util/res/TestStringManager.java');
INSERT INTO `tomcatdataset` VALUES (268, '46982', '360f8eb', 'java/org/apache/catalina/valves/AccessLogValve.java', '1239100000', '1239190000', 'java/org/apache/catalina/valves/AccessLogValve.java');
INSERT INTO `tomcatdataset` VALUES (269, '41606', 'f36a2c4', 'java/org/apache/jasper/compiler/Compiler.java', '1171420000', '1238150000', 'java/org/apache/jasper/compiler/Compiler.java');
INSERT INTO `tomcatdataset` VALUES (270, '46875', '08f7a5f', 'java/org/apache/catalina/valves/CometConnectionManagerValve.java', '1237440000', '1238010000', 'java/org/apache/catalina/valves/CometConnectionManagerValve.java');
INSERT INTO `tomcatdataset` VALUES (271, '46666', 'ac6369a', 'java/org/apache/coyote/http11/Http11Processor.java', '1233750000', '1234540000', 'java/org/apache/coyote/http11/Http11Processor.java');
INSERT INTO `tomcatdataset` VALUES (272, '39396', '9752018', 'java/org/apache/catalina/connector/RequestFacade.java\njava/org/apache/catalina/servlets/DefaultServlet.java', '1145910000', '1234210000', 'java/org/apache/catalina/connector/RequestFacade.java java/org/apache/catalina/servlets/DefaultServlet.java');
INSERT INTO `tomcatdataset` VALUES (273, '38570', '8d2b8ff', 'java/org/apache/catalina/startup/ContextConfig.java', '1139430000', '1234210000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (274, '38553', '156f1ca', 'java/org/apache/catalina/authenticator/SSLAuthenticator.java', '1139350000', '1233740000', 'java/org/apache/catalina/authenticator/SSLAuthenticator.java');
INSERT INTO `tomcatdataset` VALUES (275, '38197', '2824a70', 'java/org/apache/jasper/compiler/Generator.java', '1136840000', '1233740000', 'java/org/apache/jasper/compiler/Generator.java');
INSERT INTO `tomcatdataset` VALUES (276, '46261', '85fc30c', 'java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java', '1227270000', '1230340000', 'java/org/apache/catalina/core/StandardContext.java java/org/apache/catalina/manager/HTMLManagerServlet.java');
INSERT INTO `tomcatdataset` VALUES (277, '46381', '24bcb47', 'java/org/apache/jasper/compiler/Generator.java', '1229000000', '1230330000', 'java/org/apache/jasper/compiler/Generator.java');
INSERT INTO `tomcatdataset` VALUES (278, '46397', '5277185', 'java/org/apache/jasper/compiler/Generator.java', '1229320000', '1230060000', 'java/org/apache/jasper/compiler/Generator.java');
INSERT INTO `tomcatdataset` VALUES (279, '46403', '99c5ca6', 'java/org/apache/tomcat/util/http/ServerCookie.java', '1229370000', '1230040000', 'java/org/apache/tomcat/util/http/ServerCookie.java');
INSERT INTO `tomcatdataset` VALUES (280, '46408', 'a1e4c86', 'java/org/apache/catalina/security/SecurityUtil.java', '1229460000', '1229700000', 'java/org/apache/catalina/security/SecurityUtil.java');
INSERT INTO `tomcatdataset` VALUES (281, '46247', '408175f', 'modules/bayeux/java/org/apache/cometd/bayeux/Bayeux.java\nmodules/bayeux/java/org/apache/cometd/bayeux/Channel.java\nmodules/bayeux/java/org/apache/cometd/bayeux/Client.java\nmodules/bayeux/java/org/apache/cometd/bayeux/DataFilter.java\nmodules/bayeux/java/org/apache/cometd/bayeux/Listener.java\nmodules/bayeux/java/org/apache/cometd/bayeux/Message.java\nmodules/bayeux/java/org/apache/cometd/bayeux/SecurityPolicy.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/BayeuxException.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/BayeuxRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/BayeuxServlet.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/ChannelImpl.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/ClientImpl.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/HttpError.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/MessageImpl.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/RequestBase.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/RequestFactory.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/TomcatBayeux.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaConnectRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaDisconnectRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaHandshakeRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaSubscribeRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaUnsubscribeRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/PublishRequest.java\nmodules/bayeux/test/org/apache/cometd/bayeux/samples/BayeuxStockTicker.java\nmodules/bayeux/test/org/apache/cometd/bayeux/samples/EchoChatClient.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/ConnectionState.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java', '1227140000', '1228490000', 'modules/bayeux/java/org/apache/cometd/bayeux/Bayeux.java modules/bayeux/java/org/apache/cometd/bayeux/Channel.java modules/bayeux/java/org/apache/cometd/bayeux/Client.java modules/bayeux/java/org/apache/cometd/bayeux/DataFilter.java modules/bayeux/java/org/apache/cometd/bayeux/Listener.java modules/bayeux/java/org/apache/cometd/bayeux/Message.java modules/bayeux/java/org/apache/cometd/bayeux/SecurityPolicy.java modules/bayeux/java/org/apache/tomcat/bayeux/BayeuxException.java modules/bayeux/java/org/apache/tomcat/bayeux/BayeuxRequest.java modules/bayeux/java/org/apache/tomcat/bayeux/BayeuxServlet.java modules/bayeux/java/org/apache/tomcat/bayeux/ChannelImpl.java modules/bayeux/java/org/apache/tomcat/bayeux/ClientImpl.java modules/bayeux/java/org/apache/tomcat/bayeux/HttpError.java modules/bayeux/java/org/apache/tomcat/bayeux/MessageImpl.java modules/bayeux/java/org/apache/tomcat/bayeux/RequestBase.java modules/bayeux/java/org/apache/tomcat/bayeux/RequestFactory.java modules/bayeux/java/org/apache/tomcat/bayeux/TomcatBayeux.java modules/bayeux/java/org/apache/tomcat/bayeux/request/MetaConnectRequest.java modules/bayeux/java/org/apache/tomcat/bayeux/request/MetaDisconnectRequest.java modules/bayeux/java/org/apache/tomcat/bayeux/request/MetaHandshakeRequest.java modules/bayeux/java/org/apache/tomcat/bayeux/request/MetaSubscribeRequest.java modules/bayeux/java/org/apache/tomcat/bayeux/request/MetaUnsubscribeRequest.java modules/bayeux/java/org/apache/tomcat/bayeux/request/PublishRequest.java modules/bayeux/test/org/apache/cometd/bayeux/samples/BayeuxStockTicker.java modules/bayeux/test/org/apache/cometd/bayeux/samples/EchoChatClient.java modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/ConnectionState.java modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java');
INSERT INTO `tomcatdataset` VALUES (282, '42693', 'b5a5094', 'java/org/apache/jasper/compiler/Compiler.java', '1182180000', '1227480000', 'java/org/apache/jasper/compiler/Compiler.java');
INSERT INTO `tomcatdataset` VALUES (283, '42707', '23a8ba0', 'java/org/apache/catalina/connector/MapperListener.java\njava/org/apache/tomcat/util/http/mapper/Mapper.java', '1182370000', '1226200000', 'java/org/apache/catalina/connector/MapperListener.java java/org/apache/tomcat/util/http/mapper/Mapper.java');
INSERT INTO `tomcatdataset` VALUES (284, '42409', 'e0489c8', 'java/org/apache/catalina/core/StandardHostValve.java', '1179150000', '1225720000', 'java/org/apache/catalina/core/StandardHostValve.java');
INSERT INTO `tomcatdataset` VALUES (285, '46051', 'f4bef20', 'java/org/apache/catalina/connector/CoyoteWriter.java', '1224600000', '1225590000', 'java/org/apache/catalina/connector/CoyoteWriter.java');
INSERT INTO `tomcatdataset` VALUES (286, '46096', '428c03b', 'java/org/apache/catalina/core/DefaultInstanceManager.java', '1225100000', '1225130000', 'java/org/apache/catalina/core/DefaultInstanceManager.java');
INSERT INTO `tomcatdataset` VALUES (287, '45933', 'f69637f', 'java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/startup/TldConfig.java', '1222920000', '1223030000', 'java/org/apache/catalina/core/StandardContext.java java/org/apache/catalina/startup/TldConfig.java');
INSERT INTO `tomcatdataset` VALUES (288, '45851', 'c340c69', 'java/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/ha/deploy/FileMessageFactory.java', '1221880000', '1222450000', 'java/org/apache/catalina/ha/deploy/FarmWarDeployer.java java/org/apache/catalina/ha/deploy/FileMessageFactory.java');
INSERT INTO `tomcatdataset` VALUES (289, '45026', '03097fa', 'java/org/apache/jk/common/JkInputStream.java', '1211100000', '1221850000', 'java/org/apache/jk/common/JkInputStream.java');
INSERT INTO `tomcatdataset` VALUES (290, '45419', '633545f', 'java/org/apache/catalina/servlets/DefaultServlet.java', '1216290000', '1221680000', 'java/org/apache/catalina/servlets/DefaultServlet.java');
INSERT INTO `tomcatdataset` VALUES (291, '45441', '2c0fffe', 'java/org/apache/catalina/core/ApplicationDispatcher.java', '1216570000', '1221650000', 'java/org/apache/catalina/core/ApplicationDispatcher.java');
INSERT INTO `tomcatdataset` VALUES (292, '45618', 'd69b378', 'java/org/apache/catalina/tribes/transport/nio/ParallelNioSender.java', '1218510000', '1220390000', 'java/org/apache/catalina/tribes/transport/nio/ParallelNioSender.java');
INSERT INTO `tomcatdataset` VALUES (293, '45666', 'ccc1014', 'java/org/apache/jasper/runtime/JspContextWrapper.java', '1219320000', '1220220000', 'java/org/apache/jasper/runtime/JspContextWrapper.java');
INSERT INTO `tomcatdataset` VALUES (294, '45648', '6d40691', 'java/org/apache/el/parser/ELParser.java', '1219100000', '1220210000', 'java/org/apache/el/parser/ELParser.java');
INSERT INTO `tomcatdataset` VALUES (295, '45691', '337d6a6', 'java/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/JspUtil.java\njava/org/apache/jasper/compiler/Node.java\njava/org/apache/jasper/compiler/TagPluginManager.java', '1219750000', '1220190000', 'java/org/apache/jasper/compiler/Compiler.java java/org/apache/jasper/compiler/JspUtil.java java/org/apache/jasper/compiler/Node.java java/org/apache/jasper/compiler/TagPluginManager.java');
INSERT INTO `tomcatdataset` VALUES (296, '43327', 'fea7658', 'java/org/apache/tomcat/util/net/AprEndpoint.java', '1189160000', '1219330000', 'java/org/apache/tomcat/util/net/AprEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (297, '45608', '816ecb8', 'java/org/apache/catalina/core/StandardWrapper.java', '1218420000', '1218550000', 'java/org/apache/catalina/core/StandardWrapper.java');
INSERT INTO `tomcatdataset` VALUES (298, '41407', '6d78232', 'java/org/apache/catalina/realm/JAASCallbackHandler.java\njava/org/apache/catalina/realm/JAASMemoryLoginModule.java\njava/org/apache/catalina/realm/JAASRealm.java', '1169160000', '1218290000', 'java/org/apache/catalina/realm/JAASCallbackHandler.java java/org/apache/catalina/realm/JAASMemoryLoginModule.java java/org/apache/catalina/realm/JAASRealm.java');
INSERT INTO `tomcatdataset` VALUES (299, '45591', '38a62a6', 'java/org/apache/jk/server/JkMain.java', '1218130000', '1218210000', 'java/org/apache/jk/server/JkMain.java');
INSERT INTO `tomcatdataset` VALUES (300, '45453', '9d3cad7', 'java/org/apache/catalina/realm/JDBCRealm.java', '1216710000', '1217340000', 'java/org/apache/catalina/realm/JDBCRealm.java');
INSERT INTO `tomcatdataset` VALUES (301, '42727', '92f847d', 'java/org/apache/catalina/connector/CoyoteReader.java', '1182590000', '1216330000', 'java/org/apache/catalina/connector/CoyoteReader.java');
INSERT INTO `tomcatdataset` VALUES (302, '42722', 'd41f610', 'java/org/apache/catalina/servlets/CGIServlet.java', '1182500000', '1215720000', 'java/org/apache/catalina/servlets/CGIServlet.java');
INSERT INTO `tomcatdataset` VALUES (303, '36155', 'f23907d', 'java/org/apache/coyote/ajp/AjpMessage.java', '1123840000', '1214620000', 'java/org/apache/coyote/ajp/AjpMessage.java');
INSERT INTO `tomcatdataset` VALUES (304, '42750', 'f93376d', 'java/org/apache/coyote/http11/InternalAprInputBuffer.java\njava/org/apache/coyote/http11/InternalInputBuffer.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java', '1182890000', '1211230000', 'java/org/apache/coyote/http11/InternalAprInputBuffer.java java/org/apache/coyote/http11/InternalInputBuffer.java java/org/apache/coyote/http11/InternalNioInputBuffer.java');
INSERT INTO `tomcatdataset` VALUES (305, '42934', 'a9cb6a6', 'java/org/apache/catalina/core/StandardContext.java', '1184780000', '1210360000', 'java/org/apache/catalina/core/StandardContext.java');
INSERT INTO `tomcatdataset` VALUES (306, '42943', '17b4436', 'java/org/apache/jasper/compiler/JspDocumentParser.java', '1184920000', '1210280000', 'java/org/apache/jasper/compiler/JspDocumentParser.java');
INSERT INTO `tomcatdataset` VALUES (307, '43080', '332d0f0', 'java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/deploy/SecurityCollection.java', '1186690000', '1209900000', 'java/org/apache/catalina/core/StandardContext.java java/org/apache/catalina/deploy/SecurityCollection.java');
INSERT INTO `tomcatdataset` VALUES (308, '43191', 'e2524a8', 'java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java', '1187810000', '1209810000', 'java/org/apache/coyote/http11/Http11AprProcessor.java java/org/apache/coyote/http11/Http11NioProcessor.java java/org/apache/coyote/http11/Http11Processor.java');
INSERT INTO `tomcatdataset` VALUES (309, '43366', 'f4a7632', 'java/org/apache/catalina/manager/ManagerServlet.java', '1189600000', '1209320000', 'java/org/apache/catalina/manager/ManagerServlet.java');
INSERT INTO `tomcatdataset` VALUES (310, '44877', 'dfa25f4', 'java/org/apache/jasper/compiler/Generator.java', '1209150000', '1209320000', 'java/org/apache/jasper/compiler/Generator.java');
INSERT INTO `tomcatdataset` VALUES (311, '31257', '0ea3e15', 'java/org/apache/jasper/compiler/AntCompiler.java', '1095330000', '1208730000', 'java/org/apache/jasper/compiler/AntCompiler.java');
INSERT INTO `tomcatdataset` VALUES (312, '29936', '06c23d8', 'java/org/apache/catalina/startup/ContextConfig.java', '1089140000', '1208720000', 'java/org/apache/catalina/startup/ContextConfig.java');
INSERT INTO `tomcatdataset` VALUES (313, '44562', '288b2ae', 'java/javax/servlet/http/HttpServlet.java', '1204910000', '1205080000', 'java/javax/servlet/http/HttpServlet.java');
INSERT INTO `tomcatdataset` VALUES (314, '43701', 'bf6ce6f', 'java/org/apache/tomcat/util/net/NioEndpoint.java', '1193380000', '1202070000', 'java/org/apache/tomcat/util/net/NioEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (315, '44268', 'cdff09f', 'java/org/apache/catalina/core/StandardContext.java', '1200660000', '1200950000', 'java/org/apache/catalina/core/StandardContext.java');
INSERT INTO `tomcatdataset` VALUES (316, '44223', 'f9e41b8', 'java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java', '1200300000', '1200690000', 'java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java');
INSERT INTO `tomcatdataset` VALUES (317, '11117', '1cc6641', 'java/org/apache/coyote/http11/filters/ChunkedInputFilter.java', '1027510000', '1199830000', 'java/org/apache/coyote/http11/filters/ChunkedInputFilter.java');
INSERT INTO `tomcatdataset` VALUES (318, '43285', 'c5bcc98', 'java/org/apache/el/parser/AstValue.java', '1188750000', '1198720000', 'java/org/apache/el/parser/AstValue.java');
INSERT INTO `tomcatdataset` VALUES (319, '42503', '2441155', 'java/org/apache/naming/resources/FileDirContext.java', '1179950000', '1198720000', 'java/org/apache/naming/resources/FileDirContext.java');
INSERT INTO `tomcatdataset` VALUES (320, '43914', 'e452200', 'java/org/apache/catalina/connector/CoyoteAdapter.java', '1195560000', '1198700000', 'java/org/apache/catalina/connector/CoyoteAdapter.java');
INSERT INTO `tomcatdataset` VALUES (321, '44084', '46721e4', 'java/org/apache/catalina/realm/JAASRealm.java', '1197750000', '1198450000', 'java/org/apache/catalina/realm/JAASRealm.java');
INSERT INTO `tomcatdataset` VALUES (322, '43236', '71bd193', 'java/org/apache/catalina/connector/Response.java', '1188370000', '1198020000', 'java/org/apache/catalina/connector/Response.java');
INSERT INTO `tomcatdataset` VALUES (323, '43241', '8f91433', 'java/org/apache/catalina/core/ApplicationContext.java', '1188410000', '1198020000', 'java/org/apache/catalina/core/ApplicationContext.java');
INSERT INTO `tomcatdataset` VALUES (324, '43622', 'd1d0619', 'java/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java', '1192430000', '1196450000', 'java/org/apache/coyote/http11/Http11AprProtocol.java java/org/apache/coyote/http11/Http11NioProtocol.java java/org/apache/coyote/http11/Http11Protocol.java');
INSERT INTO `tomcatdataset` VALUES (325, '43757', 'eb87635', 'java/org/apache/jasper/compiler/ErrorDispatcher.java', '1193850000', '1196380000', 'java/org/apache/jasper/compiler/ErrorDispatcher.java');
INSERT INTO `tomcatdataset` VALUES (326, '43893', '3c61f9b', 'java/org/apache/catalina/servlets/WebdavServlet.java', '1195360000', '1195840000', 'java/org/apache/catalina/servlets/WebdavServlet.java');
INSERT INTO `tomcatdataset` VALUES (327, '43356', '28da141', 'java/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/tomcat/util/net/NioEndpoint.java', '1189530000', '1189810000', 'java/org/apache/coyote/http11/Http11NioProtocol.java java/org/apache/tomcat/util/net/NioEndpoint.java');
INSERT INTO `tomcatdataset` VALUES (328, '30949', '4dd22a5', 'java/org/apache/catalina/core/ApplicationDispatcher.java', '1093920000', '1188960000', 'java/org/apache/catalina/core/ApplicationDispatcher.java');
INSERT INTO `tomcatdataset` VALUES (329, '42753', 'a6ea14d', 'java/org/apache/catalina/core/ApplicationFilterFactory.java', '1182940000', '1183120000', 'java/org/apache/catalina/core/ApplicationFilterFactory.java');
INSERT INTO `tomcatdataset` VALUES (330, '42314', '6c6ad83', 'java/org/apache/jasper/compiler/JavacErrorDetail.java', '1178080000', '1182690000', 'java/org/apache/jasper/compiler/JavacErrorDetail.java');
INSERT INTO `tomcatdataset` VALUES (331, '42547', '53add24', 'java/org/apache/catalina/deploy/NamingResources.java', '1180540000', '1182610000', 'java/org/apache/catalina/deploy/NamingResources.java');
INSERT INTO `tomcatdataset` VALUES (332, '42497', '0114b2d', 'java/org/apache/catalina/servlets/DefaultServlet.java', '1179930000', '1180740000', 'java/org/apache/catalina/servlets/DefaultServlet.java');
INSERT INTO `tomcatdataset` VALUES (333, '42438', '5e188bc', 'java/org/apache/jasper/compiler/Node.java', '1179350000', '1179890000', 'java/org/apache/jasper/compiler/Node.java');
INSERT INTO `tomcatdataset` VALUES (334, '42361', '637acc5', 'java/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/authenticator/SavedRequest.java', '1178650000', '1178670000', 'java/org/apache/catalina/authenticator/FormAuthenticator.java java/org/apache/catalina/authenticator/SavedRequest.java');
INSERT INTO `tomcatdataset` VALUES (335, '42202', 'f9ddaba', 'java/org/apache/catalina/startup/TldConfig.java', '1177350000', '1177420000', 'java/org/apache/catalina/startup/TldConfig.java');
INSERT INTO `tomcatdataset` VALUES (336, '42071', '508f513', 'java/org/apache/jasper/servlet/JspServletWrapper.java', '1176070000', '1176950000', 'java/org/apache/jasper/servlet/JspServletWrapper.java');
INSERT INTO `tomcatdataset` VALUES (337, '42085', 'fa2b746', 'java/org/apache/juli/ClassLoaderLogManager.java', '1176260000', '1176390000', 'java/org/apache/juli/ClassLoaderLogManager.java');
INSERT INTO `tomcatdataset` VALUES (338, '41289', 'd721522', 'java/org/apache/catalina/manager/ManagerServlet.java', '1167910000', '1175780000', 'java/org/apache/catalina/manager/ManagerServlet.java');
INSERT INTO `tomcatdataset` VALUES (339, '40150', '400d684', 'java/org/apache/catalina/realm/JAASRealm.java', '1154440000', '1174860000', 'java/org/apache/catalina/realm/JAASRealm.java');
INSERT INTO `tomcatdataset` VALUES (340, '40820', 'a1b1bed', 'java/org/apache/catalina/core/JasperListener.java', '1161860000', '1167780000', 'java/org/apache/catalina/core/JasperListener.java');
INSERT INTO `tomcatdataset` VALUES (341, '41057', 'de5c3b7', 'java/org/apache/tomcat/util/buf/StringCache.java', '1164730000', '1164760000', 'java/org/apache/tomcat/util/buf/StringCache.java');
INSERT INTO `tomcatdataset` VALUES (342, '40901', 'cb2c655', 'java/org/apache/catalina/servlets/DefaultServlet.java', '1162780000', '1163980000', 'java/org/apache/catalina/servlets/DefaultServlet.java');
INSERT INTO `tomcatdataset` VALUES (343, '37509', 'a6d6962', 'java/org/apache/juli/ClassLoaderLogManager.java', '1132100000', '1163980000', 'java/org/apache/juli/ClassLoaderLogManager.java');
INSERT INTO `tomcatdataset` VALUES (344, '34956', '22d1ad7', 'java/org/apache/catalina/core/ApplicationDispatcher.java\njava/org/apache/catalina/core/ApplicationFilterChain.java', '1116440000', '1162680000', 'java/org/apache/catalina/core/ApplicationDispatcher.java java/org/apache/catalina/core/ApplicationFilterChain.java');
INSERT INTO `tomcatdataset` VALUES (345, '40817', '6d274b4', 'java/org/apache/catalina/servlets/CGIServlet.java', '1161820000', '1162680000', 'java/org/apache/catalina/servlets/CGIServlet.java');
INSERT INTO `tomcatdataset` VALUES (346, '37458', '79631bb', 'java/org/apache/catalina/loader/WebappClassLoader.java', '1131680000', '1162680000', 'java/org/apache/catalina/loader/WebappClassLoader.java');
INSERT INTO `tomcatdataset` VALUES (347, '39724', 'b18c29e', 'java/org/apache/catalina/core/StandardPipeline.java', '1149530000', '1159840000', 'java/org/apache/catalina/core/StandardPipeline.java');
INSERT INTO `tomcatdataset` VALUES (348, '29727', '1a5e6e7', 'java/org/apache/catalina/deploy/NamingResources.java', '1087870000', '1159750000', 'java/org/apache/catalina/deploy/NamingResources.java');
INSERT INTO `tomcatdataset` VALUES (349, '34399', '9dd8a23', 'java/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/startup/HostConfig.java', '1113250000', '1158810000', 'java/org/apache/catalina/manager/HTMLManagerServlet.java java/org/apache/catalina/manager/ManagerServlet.java java/org/apache/catalina/startup/HostConfig.java');
INSERT INTO `tomcatdataset` VALUES (350, '34509', '823101d', 'java/org/apache/jasper/compiler/Generator.java', '1113890000', '1158370000', 'java/org/apache/jasper/compiler/Generator.java');
INSERT INTO `tomcatdataset` VALUES (351, '31804', '2d6d717', 'java/org/apache/jasper/compiler/Generator.java', '1098300000', '1157840000', 'java/org/apache/jasper/compiler/Generator.java');
INSERT INTO `tomcatdataset` VALUES (352, '38713', 'c7f0f60', 'java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/servlet/JspServletWrapper.java', '1140440000', '1157190000', 'java/org/apache/jasper/JspCompilationContext.java java/org/apache/jasper/compiler/Compiler.java java/org/apache/jasper/servlet/JspServletWrapper.java');
INSERT INTO `tomcatdataset` VALUES (353, '40306', 'a91b95e', 'java/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/jk/core/MsgContext.java', '1156380000', '1156740000', 'java/org/apache/coyote/ajp/AjpAprProcessor.java java/org/apache/jk/core/MsgContext.java');
INSERT INTO `tomcatdataset` VALUES (354, '34801', 'c30afec', 'java/org/apache/catalina/servlets/CGIServlet.java', '1115550000', '1153530000', 'java/org/apache/catalina/servlets/CGIServlet.java');
INSERT INTO `tomcatdataset` VALUES (355, '39699', '7b870a4', 'java/org/apache/catalina/core/StandardContext.java', '1149190000', '1149780000', 'java/org/apache/catalina/core/StandardContext.java');

-- ----------------------------
-- Table structure for tomcatpredefined
-- ----------------------------
DROP TABLE IF EXISTS `tomcatpredefined`;
CREATE TABLE `tomcatpredefined`  (
  `id` int(0) NOT NULL AUTO_INCREMENT,
  `bug_id` char(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `Summary` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  `Status` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `Alias` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '分配给bug的简短、唯一名称，以帮助在 Bugzilla 的其他地方查找和引用它。',
  `Product` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `Component` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `Version` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT 'bug被发现时的版本',
  `Hardware` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '观察到bug的硬件平台。',
  `Importance` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT 'bug的重要性被描述为它的优先级和严重性的组合',
  `TargetMilestone` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '用于定义分配bug的工程师希望修复它的时间。',
  `Assignee` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '负责解决bug的人。',
  `Assignee_link` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `QAContact` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '负责确认此bug（如果未确认）并在bug解决后验证修复的人员。',
  `QAContact_link` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `URL` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL COMMENT 'bug可以有一个与之关联的 URL - 例如，指向出现问题的网站的指针。',
  `Whiteboard` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '每个bug都有一个自由格式的单行文本输入框，用于添加标签和状态信息。',
  `Keywords` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '将定义列表中的关键字添加到bug中',
  `DependsOn` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '必须先解决此处列出的bug，然后才能解决此bug。',
  `Blocks` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '必须先解决此bug，然后才能解决此字段中列出的bug。',
  `ReportedTime` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `Reporter` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `Reporter_link` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `ModifiedTime` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  `CCList` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL COMMENT '\r\n\r\n\r\nemail-list 可能对这个bug没有直接作用但对其进展感兴趣的用户。',
  `SeeAlso` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL COMMENT '这允许您参考其他安装中的bug。',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1057 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of tomcatpredefined
-- ----------------------------
INSERT INTO `tomcatpredefined` VALUES (1, '56029', 'Bug 56029 Ternary operator doesn\'t work as expected inside attributes in jspx pages', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', 'unspecified', 'All Mac OS X 10.4', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2014-01-18 12:42 UTC', 'Michael Simons', NULL, '2014-02-10 10:18:44 UTC', 'fgiust,pansa05', NULL);
INSERT INTO `tomcatpredefined` VALUES (2, '55943', 'Bug 55943 Provide a way prevent  looking at the System classloader before the webapp classloaders', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'unspecified', 'PC Linux', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2014-01-01 10:02 UTC', 'chris.dow8', NULL, '2014-09-08 13:23:21 UTC', 'opldupuy', NULL);
INSERT INTO `tomcatpredefined` VALUES (3, '55995', 'Bug 55995 java.lang.NullPointerException at org.apache.jasper.servlet.JspCServletContext.getResource(JspCServletContext.java:344)', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Jasper', '8.0.0-RC10', 'Other Linux', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2014-01-13 05:55 UTC', 'Peter Lenahan', NULL, '2014-01-14 14:49:02 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (4, '55976', 'Bug 55976 Broken response from NIO connector in Tomcat 7.0.50', 'CLOSED FIXED', 'None', 'Tomcat 7', 'Connectors', 'trunk', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2014-01-08 09:52 UTC', 'Ognjen Blagojevic', NULL, '2014-01-10 19:51:38 UTC', 'pdewacht', NULL);
INSERT INTO `tomcatpredefined` VALUES (5, '55958', 'Bug 55958 Tomcat tries to deploy dir as zip archive even when it is a directory if the name ends with .war', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.47', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2014-01-06 09:28 UTC', 'Radim Hatlapatka', NULL, '2014-01-09 14:15:19 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (6, '55937', 'Bug 55937 Tomcat auto deployer not working for ROOT applications', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Manager', '7.0.47', 'All Linux', 'P2 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-12-27 15:41 UTC', 'Jesse Barnum', NULL, '2020-09-06 04:51:24 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (7, '55884', 'Bug 55884 JSPs no longer compile in Java 8', 'CLOSED FIXED', 'None', 'Tomcat 8', 'Jasper', '8.0.0-RC5', 'PC All', 'P2 major', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-12-14 17:03 UTC', 'Nick Williams', NULL, '2014-12-01 17:59:27 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (8, '55801', 'Bug 55801 Add ability to provide custom SSLContext for websocket client', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-11-20 09:57 UTC', 'Maciej Lypik', NULL, '2013-12-07 20:20:12 UTC', 'marek.jagielski', NULL);
INSERT INTO `tomcatpredefined` VALUES (9, '55842', 'Bug 55842 response.setBufferSize() does not seem to work properly', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.47', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-12-04 15:56 UTC', 'Martin Maier-Moessner', NULL, '2014-10-24 20:15:05 UTC', 'tobias.steffenhagen', NULL);
INSERT INTO `tomcatpredefined` VALUES (10, '55837', 'Bug 55837 ServletContext.getRealPath() returns null', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.0-RC5', 'Macintosh All', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-12-03 08:03 UTC', 'oschina.net', NULL, '2014-12-03 00:17:24 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (11, '55804', 'Bug 55804 SPNEGOAUTHENTICATOR - GSSCredential does not get renewed after RemainingLifeTime is less than zero', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.47', 'PC All', 'P2 critical', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-11-20 19:23 UTC', 'Sachin Kumar', NULL, '2013-11-29 19:31:17 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (12, '55798', 'Bug 55798 Enabling Manager App - process and description is inadequate', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Documentation', 'unspecified', 'PC Linux', 'P2 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, 'http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html#Configuring_Manager_Application_Access', NULL, ' ', ' ', ' ', '2013-11-19 23:03 UTC', 'BJ Chippindale', NULL, '2013-11-24 20:08:17 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (13, '55776', 'Bug 55776 if path include relative char, eg: ../, classloader will not find zhe file', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.0-RC5', 'PC Windows Server 2003', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-11-14 06:14 UTC', 'LabnizDirac', NULL, '2013-11-20 09:18:36 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (14, '55760', 'Bug 55760 Tomcat SPNEGO authenticator incompatible with IBM JDK in case of Keytab based initiate and accept authentication', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.35', 'PC AIX', 'P1 blocker', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-11-08 11:48 UTC', 'Arunav Sanyal', NULL, '2013-11-11 09:50:47 UTC', 'arunav.sanyal91', NULL);
INSERT INTO `tomcatpredefined` VALUES (15, '55735', 'Bug 55735 Additional quote entity in html element attribute evaluated in tagx if attribute contains EL expression', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', 'unspecified', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-11-02 06:14 UTC', 'azuo.lee', NULL, '2013-11-05 23:01:16 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (16, '55684', 'Bug 55684 WebappClassLoader.getThread want an access to root ThreadGroup', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.42', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-10-21 16:30 UTC', 'Gael Lalire', NULL, '2013-10-29 09:56:13 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (17, '55691', 'Bug 55691 javax.el.ArrayELResolver.setValue not supporting arrays of primitives', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Servlet &amp; JSP API', '6.0.37', 'All Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-10-22 23:05 UTC', 'taly', NULL, '2013-12-02 14:58:09 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (18, '55317', 'Bug 55317 Facilitate weaving by allowing ClassFileTransformer to be added to WebppClassLoader', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-07-28 07:17 UTC', 'Nick Williams', NULL, '2015-07-17 08:02:02 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (19, '55576', 'Bug 55576 Order of ServletRequest parameters is not preserved', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', '7.0.35', 'PC All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-09-20 21:14 UTC', 'corythearchitect', NULL, '2013-10-22 08:02:13 UTC', 'zhouyanming', NULL);
INSERT INTO `tomcatpredefined` VALUES (20, '54693', 'Bug 54693 Add a validationQueryTimeout property', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-03-13 20:04 UTC', 'Daniel Mikusa', NULL, '2013-09-09 10:21:48 UTC', 'donnchadh', NULL);
INSERT INTO `tomcatpredefined` VALUES (21, '55494', 'Bug 55494 JNDIRealm throws exception after timeout / Connection reset', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.41', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-08-28 12:54 UTC', 'Thomas Hoffmann', NULL, '2013-08-28 14:06:38 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (22, '55454', 'Bug 55454 NullPointerException caused by invalid contentType, e.g. trailing semicolon', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.42', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-08-20 09:30 UTC', 'Christian', NULL, '2013-08-20 16:40:58 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (23, '55404', 'Bug 55404 ContextConfig#validateSecurityRoles emits three info log messages which contain a warning', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.37', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-08-12 13:09 UTC', 'Michael Osipov', NULL, '2013-11-07 10:06:19 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (24, '55312', 'Bug 55312 No SCI scan in embedded Tomcat', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'PC Linux', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-07-26 15:37 UTC', 'Dave Syer', NULL, '2013-07-31 13:14:01 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (25, '55267', 'Bug 55267 NIO thread locked', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', '7.0.41', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-07-15 11:38 UTC', 'Pavel', NULL, '2013-07-24 15:02:59 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (26, '55259', 'Bug 55259 Unnecessary work in JspConfig', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Jasper', '8.0.x-trunk', 'All All', 'P2 trivial', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-07-13 04:34 UTC', 'Jeremy Boynes', NULL, '2013-07-17 01:45:57 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (27, '55245', 'Bug 55245 Add test cases for JspC', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Jasper', '8.0.x-trunk', 'PC Mac OS X 10.4', 'P2 enhancement', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-07-12 02:05 UTC', 'Jeremy Boynes', NULL, '2013-07-12 08:58:21 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (28, '55238', 'Bug 55238 [websocket] NPE in clearHandler(WsRemoteEndpointImplServer.java:156)', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'PC All', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-07-11 08:11 UTC', 'Niki Dokovski', NULL, '2013-07-11 16:15:23 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (29, '55228', 'Bug 55228 AbstractHttp11Processor overwrites Date header, even when set by application', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.37', 'All All', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-07-10 00:35 UTC', 'fern&#64;alum.mit.edu', NULL, '2013-09-11 20:36:04 UTC', 'fern', NULL);
INSERT INTO `tomcatpredefined` VALUES (30, '55231', 'Bug 55231 NPE and incorrect version detection in JspC', 'CLOSED FIXED', 'None', 'Tomcat 8', 'Jasper', '8.0.x-trunk', 'PC Mac OS X 10.4', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-07-10 04:10 UTC', 'Jeremy Boynes', NULL, '2013-07-11 16:07:35 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (31, '55166', 'Bug 55166 schemaLocation references between servlet and jsp XSDs are invalid', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'PC Mac OS X 10.4', 'P2 enhancement', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-06-30 20:03 UTC', 'Jeremy Boynes', NULL, '2014-02-17 13:46:55 UTC', 'david_syer', NULL);
INSERT INTO `tomcatpredefined` VALUES (32, '53777', 'Bug 53777 Ability to bundle JAAS Configuration in Webappp', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'unspecified', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-08-24 13:50 UTC', 'eolivelli', NULL, '2013-07-01 15:01:12 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (33, '55160', 'Bug 55160 NIO connectionUploadTimeout can\'t work', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', '7.0.30', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-06-29 21:35 UTC', 'Roger Wang', NULL, '2020-10-22 18:58:53 UTC', 'kubi0106', NULL);
INSERT INTO `tomcatpredefined` VALUES (34, '55017', 'Bug 55017 Ability to configure RMI bind address', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC Linux', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-05-24 14:50 UTC', 'Alexey Noskov', NULL, '2013-07-01 09:53:55 UTC', 'alexey.noskov', NULL);
INSERT INTO `tomcatpredefined` VALUES (35, '55102', 'Bug 55102 Add ability to report time taken to prepare response', 'CLOSED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'All All', 'P2 enhancement', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-06-15 17:09 UTC', 'Jeremy Boynes', NULL, '2013-07-08 16:12:18 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (36, '55046', 'Bug 55046 CORS Filter', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'All All', 'P2 enhancement', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-06-02 00:48 UTC', 'Mohit Soni', NULL, '2013-06-05 10:01:34 UTC', 'mohitsoni1989', NULL);
INSERT INTO `tomcatpredefined` VALUES (37, '54971', 'Bug 54971 javax.servlet.http.Part.write(String fileName) is not properly implemented', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-05-15 02:16 UTC', 'Daniel Koh', NULL, '2013-05-28 14:49:08 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (38, '54947', 'Bug 54947 Http11NioProtocol generates HTTP 505 responses on valid requests if request is split across multiple packets', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.36', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-05-09 20:27 UTC', 'Greg Harris', NULL, '2013-09-11 20:19:42 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (39, '54984', 'Bug 54984 multipart/form-data is not always read with correct encoding', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.40', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-05-16 11:15 UTC', 'Per Holmberg', NULL, '2013-05-26 20:05:28 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (40, '54928', 'Bug 54928 IllegalStateException: Calling [asyncError()] is not valid for a request with Async state [COMPLETING]', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'PC Linux', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-05-04 12:41 UTC', 'Rossen Stoyanchev', NULL, '2014-10-25 23:25:36 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (41, '54703', 'Bug 54703 Nullpointer exception in HttpParser.parseMediaType', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.37', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-03-15 14:09 UTC', 'Sandy Meier', NULL, '2014-09-16 23:36:34 UTC', 'g.dimitrov,jgawor,sandy.meier', NULL);
INSERT INTO `tomcatpredefined` VALUES (42, '54801', 'Bug 54801 EL-like expressions in jsp:scriptlet break compilation of JSP XML documents', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', '7.0.39', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-04-04 22:24 UTC', 'Konstantin Kolinko', NULL, '2013-04-25 13:21:14 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (43, '54178', 'Bug 54178 [CVE-2013-2071] runtime exception in onComplete of AsyncListener, will make org.apache.catalina.connector.Request not recycled (orginally reported MESSAGE POST to tomcat, but it called doGet)', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.23', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-11-21 08:22 UTC', 'wan_jm', NULL, '2014-02-17 13:39:24 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (44, '54781', 'Bug 54781 NPE in WsServerContainer if there is no matching path', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'PC Linux', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-04-01 19:32 UTC', 'Rossen Stoyanchev', NULL, '2013-04-23 19:58:51 UTC', 'jfarcand', NULL);
INSERT INTO `tomcatpredefined` VALUES (45, '54800', 'Bug 54800 Possible thread/memory leak with use of WebSocketContainer', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'PC Linux', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-04-04 21:47 UTC', 'Rossen Stoyanchev', NULL, '2013-04-23 16:25:03 UTC', 'ralph', NULL);
INSERT INTO `tomcatpredefined` VALUES (46, '54724', 'Bug 54724 WsSession does not throw IllegalStateException if closed when methods on it are called', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'All All', 'P2 major', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-03-19 13:22 UTC', 'Nick Williams', NULL, '2013-03-19 20:24:43 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (47, '54702', 'Bug 54702 File descriptor leak at web.xml loading', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.33', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-03-15 08:53 UTC', 'Jean-Marie LAMARE', NULL, '2013-03-15 15:11:52 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (48, '54690', 'Bug 54690 HTTPS BIO/NIO connector does not enable TLS 1.1 and TLS 1.2 by default', 'CLOSED FIXED', 'None', 'Tomcat 7', 'Connectors', '7.0.37', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-03-13 17:07 UTC', 'Ognjen Blagojevic', NULL, '2013-03-21 02:53:07 UTC', 'fink', NULL);
INSERT INTO `tomcatpredefined` VALUES (49, '54602', 'Bug 54602 B2CConverter character decode underflow leaves bytes in buffer', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.33', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-02-22 20:06 UTC', 'Nate Clark', NULL, '2013-03-05 14:05:47 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (50, '54552', 'Bug 54552 Completed Servlet 3.1 spec for changeSessionId, HttpSessionIdListener', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Catalina', '8.0.x-trunk', 'PC All', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-02-12 13:56 UTC', 'Nick Williams', NULL, '2013-02-13 16:38:59 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (51, '54536', 'Bug 54536 ErrorReportValve doesn\'t respect HttpServletResponse.sendError(int sc, String msg)', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.30', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-02-07 12:33 UTC', 'Yannis Thanasoulas', NULL, '2013-02-12 20:33:36 UTC', 'michaelo', NULL);
INSERT INTO `tomcatpredefined` VALUES (52, '54239', 'Bug 54239 Extensible EL Interpreter', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', 'trunk', 'PC All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', '54499', '2012-12-04 06:56 UTC', 'Sheldon Shao', NULL, '2013-02-12 14:57:01 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (53, '54456', 'Bug 54456 ChunkedInputFilter returning EOF when client closes connection without sending end chunk', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-01-21 16:45 UTC', 'Sudhan Moghe', NULL, '2013-04-27 13:40:06 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (54, '54513', 'Bug 54513 NullPointerException in AprEndpoint$Poller.run', 'RESOLVED FIXED', 'None', 'Tomcat 8', 'Connectors', '8.0.x-trunk', 'PC Windows XP', 'P2 normal', '----', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-01-31 23:15 UTC', 'Konstantin Kolinko', NULL, '2013-02-03 10:09:33 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (55, '53869', 'Bug 53869 Performance tuning solution to resolve too many cascaded JspContextWrapper issue', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', 'trunk', 'PC All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-09-13 13:56 UTC', 'Sheldon Shao', NULL, '2013-01-25 12:08:43 UTC', 'jgawor', NULL);
INSERT INTO `tomcatpredefined` VALUES (56, '54324', 'Bug 54324 Support is required to disable TLS compression to prevent against CRIME attacks', 'RESOLVED FIXED', 'None', 'Tomcat Native', 'Library', '1.1.24', 'PC Linux', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-12-18 21:51 UTC', 'Maik Hemani', NULL, '2014-02-17 13:48:00 UTC', 'michaelo', NULL);
INSERT INTO `tomcatpredefined` VALUES (57, '54379', 'Bug 54379 Implement support for post-construct and pre-destroy elements in web.xml', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.34', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-01-07 04:07 UTC', 'Konstantin Kolinko', NULL, '2013-01-10 11:48:06 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (58, '54377', 'Bug 54377 RemoteIpFilter does not correctly set request attributes for AccessLog', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.32', 'All All', 'P2 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2013-01-05 23:52 UTC', 'Greg Arakelian', NULL, '2013-01-08 20:30:57 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (59, '54284', 'Bug 54284 Util.objectNameValueNeedsQuote throws NPE for anonymous Filters', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.34', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-12-12 15:51 UTC', 'benjamin.gehrels_external', NULL, '2013-01-07 19:11:04 UTC', 'benjamin.gehrels_external', NULL);
INSERT INTO `tomcatpredefined` VALUES (60, '54262', 'Bug 54262 An empty <absolute-ordering /> should turn off all web-fragments', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.33', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-12-07 22:00 UTC', 'Rossen Stoyanchev', NULL, '2014-06-19 09:18:32 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (61, '54241', 'Bug 54241 NPE in BodyContentImpl', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', 'trunk', 'PC All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-12-04 07:53 UTC', 'Sheldon Shao', NULL, '2013-01-02 15:59:35 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (62, '54220', 'Bug 54220 ErrorReportValve invoked on non-error responses too', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.36', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-11-28 20:19 UTC', 'Michael Osipov', NULL, '2012-12-06 14:56:19 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (63, '54217', 'Bug 54217 JDBC connection pool runs out of connections when Context reload=“true” is enabled in Tomcat', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-11-28 10:35 UTC', 'Levan', NULL, '2015-01-23 14:01:42 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (64, '54144', 'Bug 54144 Processing of java.io.Reader in \'Out\' tagplugin', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', '7.0.32', 'PC Windows XP', 'P2 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-11-14 08:38 UTC', 'Konstantin Kolinko', NULL, '2012-11-17 00:01:53 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (65, '54087', 'Bug 54087 HTTP Connector incorrectly throws Exception on Invalid If-Modified-Since Header', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.35', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-11-01 16:10 UTC', 'George Sexton', NULL, '2012-12-06 14:26:36 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (66, '54076', 'Bug 54076 SPNEGO authenticator\'s stateless-ness incompatible with stateful clients', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'All All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-10-30 13:49 UTC', 'Michael Osipov', NULL, '2012-11-05 09:37:27 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (67, '53867', 'Bug 53867 Performance tuning solution for PageContextImpl.XmlEscape', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', 'trunk', 'PC All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-09-13 13:33 UTC', 'Sheldon Shao', NULL, '2012-10-28 21:59:43 UTC', 'jgawor', NULL);
INSERT INTO `tomcatpredefined` VALUES (68, '54012', 'Bug 54012 No \'pageContext\' in tag files\' generated java code when using code generation by JSTL tagplugin \'Set\'', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', 'trunk', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-10-16 09:01 UTC', 'Sheldon Shao', NULL, '2012-10-25 12:04:31 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (69, '53986', 'Bug 53986 Comment end tag preceded directly by a dash causes JSP fail compilation', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', '7.0.32', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-10-09 18:40 UTC', 'Steve Ratay', NULL, '2012-11-21 19:13:37 UTC', 'bill.tomcat,java', NULL);
INSERT INTO `tomcatpredefined` VALUES (70, '53854', 'Bug 53854 DefaultServlet directory listings for aliased directories do not seem to work', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.30', 'All All', 'P2 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-09-11 20:28 UTC', 'Daniel Mikusa', NULL, '2012-09-30 19:49:17 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (71, '53713', 'Bug 53713 Performance tuning solution for JspReader', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', 'trunk', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-08-14 06:28 UTC', 'Sheldon Shao', NULL, '2012-10-29 06:27:04 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (72, '53793', 'Bug 53793 Change webapp links in Manager to point to /appname/ instead of /appname', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Manager', '7.0.29', 'PC Windows XP', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-08-28 21:50 UTC', 'Konstantin Kolinko', NULL, '2012-10-04 16:31:25 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (73, '42181', 'Bug 42181 ArrayIndexOutOfBoundsException in parseChunkHeader', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:Coyote', '5.5.23', 'Other Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-04-21 22:48 UTC', 'Nana', NULL, '2012-10-01 09:44:37 UTC', 'thyag_020', NULL);
INSERT INTO `tomcatpredefined` VALUES (74, '53783', 'Bug 53783 Static resources and jsp files under WEB-INF/lib/*.jar!/META-INF/resources are not found', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.29', 'PC All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-08-27 13:32 UTC', 'Violeta Georgieva', NULL, '2012-08-27 18:58:35 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (75, '53725', 'Bug 53725 Some GZipped responses result in java.io.IOException: Corrupt GZIP trailer during gunzip.', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', 'unspecified', 'PC Linux', 'P2 critical', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-08-15 18:28 UTC', 'kevin.l.stern', NULL, '2012-10-04 16:09:14 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (76, '53697', 'Bug 53697 java.lang.NullPointerException at org.apache.coyote.http11.Http11AprProcessor.actionInternal(Http11AprProcessor.java:277)', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', '7.0.29', 'HP Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-08-11 08:33 UTC', 'lacycb', NULL, '2014-02-28 21:09:48 UTC', 'bennett.schneider', NULL);
INSERT INTO `tomcatpredefined` VALUES (77, '53654', 'Bug 53654 JSP file is always recompiled for using file based TLD URL', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', '7.0.29', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-08-05 14:47 UTC', 'Ivan', NULL, '2012-08-15 16:04:22 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (78, '53545', 'Bug 53545 jsp:forward action to static resources causes IllegalStateException when inside classic custom tag', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', '7.0.28', 'PC All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-07-13 07:53 UTC', 'Radu Gancea', NULL, '2012-08-11 09:53:41 UTC', 'radu.gancea', NULL);
INSERT INTO `tomcatpredefined` VALUES (79, '53481', 'Bug 53481 Support SSL_OP_CIPHER_SERVER_PREFERENCE / SSLHonorCipherOrder', 'RESOLVED FIXED', 'None', 'Tomcat Native', 'Library', '1.1.24', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-06-28 14:27 UTC', 'Mike Noordermeer', NULL, '2016-06-25 13:18:00 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (80, '53606', 'Bug 53606 NullPointerException in TcpPingInterceptor', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', 'unspecified', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-07-26 16:15 UTC', 'F.Arnoud', NULL, '2012-08-27 21:35:31 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (81, '53535', 'Bug 53535 Out of memory while performing ContextConfig.webConfig', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'unspecified', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', '53615', '2012-07-11 10:29 UTC', 'Cedomir Igaly', NULL, '2014-02-17 13:47:33 UTC', 's.a.grigoriev', NULL);
INSERT INTO `tomcatpredefined` VALUES (82, '53469', 'Bug 53469 possible bug in Response.normalize(CharChunk cc)', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', '7.0.28', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-06-26 12:45 UTC', 'Thyzz', NULL, '2014-02-17 13:47:21 UTC', 'emond.papegaaij,mgrigorov,tino.kissig', NULL);
INSERT INTO `tomcatpredefined` VALUES (83, '53513', 'Bug 53513 Race condition / out of order operation in session replication at node startup', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.35', 'PC Linux', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-07-05 21:56 UTC', 'David Johle', NULL, '2012-08-27 22:20:29 UTC', 'gbalogh', NULL);
INSERT INTO `tomcatpredefined` VALUES (84, '52135', 'Bug 52135 Global error page is not handled', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', '7.0.22', 'PC All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-11-04 14:15 UTC', 'balusc', NULL, '2013-03-17 14:35:39 UTC', 'jens.borgland,jks,ljelinek,sutanu_g', NULL);
INSERT INTO `tomcatpredefined` VALUES (85, '53416', 'Bug 53416 Two datasources with the same name in different web applications results in javax.management.InstanceAlreadyExistsException', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC Windows Vista', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-06-14 13:37 UTC', 'Anthony Gerrard', NULL, '2012-06-27 17:38:30 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (86, '53406', 'Bug 53406 Stack overflow in connector', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', '7.0.27', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-06-13 03:51 UTC', 'Filip Hanik', NULL, '2012-06-13 15:48:45 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (87, '53374', 'Bug 53374 DataSourceFactory does not support commitOnReturn property', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC Mac OS X 10.4', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-06-06 20:56 UTC', 'Suresh Avadhanula', NULL, '2012-06-08 13:17:22 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (88, '53367', 'Bug 53367 Database failure may cause pool to hang', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC All', 'P2 critical', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-06-06 01:01 UTC', 'Filip Hanik', NULL, '2015-06-04 17:12:21 UTC', 'alex-pub.apache-ant,asafonov,ferrisn,monteslu', NULL);
INSERT INTO `tomcatpredefined` VALUES (89, '53032', 'Bug 53032 Ant Jasper task fails to run when using XML namespaces; no output; no errors', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.35', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-04-03 21:41 UTC', 'Nick Williams', NULL, '2012-06-24 11:43:54 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (90, '53337', 'Bug 53337 IllegalStateException when trying to render a JSP after startAsync', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.27', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-05-31 17:06 UTC', 'Rossen Stoyanchev', NULL, '2012-06-04 19:58:49 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (91, '53301', 'Bug 53301 Servlet init method called twice with embedded Tomcat', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', '7.0.27', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-05-26 21:36 UTC', 'Jeff MAURY', NULL, '2012-11-21 08:15:51 UTC', 'wan_jm', NULL);
INSERT INTO `tomcatpredefined` VALUES (92, '53074', 'Bug 53074 [websocket] java.net.SocketTimeoutException: Read timed caused by server.xml\' connectTimeout', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'unspecified', 'PC Mac OS X 10.4', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-04-13 13:45 UTC', 'Jean-Francois Arcand', NULL, '2012-06-13 16:07:40 UTC', 'mike_mackey', NULL);
INSERT INTO `tomcatpredefined` VALUES (93, '50864', 'Bug 50864 Reconfigure pool on the fly using JMX', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-03-03 11:15 UTC', 'Filip Hanik', NULL, '2012-06-13 15:52:32 UTC', 'brooke_hedrick,rtraja', NULL);
INSERT INTO `tomcatpredefined` VALUES (94, '53001', 'Bug 53001 Behaviour of ResourceBundleELResolver', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.35', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-03-29 09:41 UTC', 'b.diedrichsen', NULL, '2012-05-28 18:50:20 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (95, '52833', 'Bug 52833 NPE with 7.0.26', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.26', 'All Mac OS X 10.4', 'P2 regression', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-03-05 23:28 UTC', 'olamy', NULL, '2012-03-27 18:41:46 UTC', 'olamy', NULL);
INSERT INTO `tomcatpredefined` VALUES (96, '52066', 'Bug 52066 ConnectionPool.borrowConnection swallows interrupt state.', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-10-20 19:28 UTC', 'Alexander Pogrebnyak', NULL, '2012-03-29 16:54:55 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (97, '52850', 'Bug 52850 Various miscellaneous fixes to Tomcat Memory Leak Detection code', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC Windows Server 2003', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-03-07 14:57 UTC', 'Rohit Kelapure', NULL, '2012-11-12 11:19:06 UTC', 'kelapure', NULL);
INSERT INTO `tomcatpredefined` VALUES (98, '52500', 'Bug 52500 Improve client certificate authentication', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.23', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-01-23 13:02 UTC', 'Michael', NULL, '2012-06-02 21:08:46 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (99, '52792', 'Bug 52792 Incomplete error message when lookup a resource that is not bound in the naming', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.26', 'All All', 'P2 trivial', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-02-28 20:30 UTC', 'Violeta Georgieva', NULL, '2012-03-08 06:34:46 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (100, '52669', 'Bug 52669 Annotation processing, in WEB-INF/classes, for Servlets/Listeners/Filters is skipped when the web app is not extracted, classes do not have packages and for some embedded scenarios', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.25', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-02-14 21:39 UTC', 'Violeta Georgieva', NULL, '2012-02-16 12:23:50 UTC', 'youngm', NULL);
INSERT INTO `tomcatpredefined` VALUES (101, '52444', 'Bug 52444 Classloading-based ServletContainerInitializer @HandlesTypes processing can result in long startup times', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'unspecified', 'PC Mac OS X 10.4', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-01-09 17:11 UTC', 'Chris Beams', NULL, '2014-02-17 13:48:37 UTC', 'costin.leau,guillaume.smet', NULL);
INSERT INTO `tomcatpredefined` VALUES (102, '52543', 'Bug 52543 Exception', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.25', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-01-27 11:18 UTC', 'Evgeny', NULL, '2016-09-26 13:28:39 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (103, '52511', 'Bug 52511 Exception logged in annotation scanning for web apps without /WEB-INF/classes', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.25', 'PC All', 'P2 regression', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-01-23 21:02 UTC', 'Jess Holle', NULL, '2012-01-27 22:10:39 UTC', 'drees76', NULL);
INSERT INTO `tomcatpredefined` VALUES (104, '52474', 'Bug 52474 Do not load listeners declared with blank spaces on tld file.', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.23', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-01-17 05:41 UTC', 'Helio Frota', NULL, '2012-01-21 02:30:58 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (105, '51408', 'Bug 51408 String.getBytes() and new String(byte[]) use default charset - may cause problems in some Locales', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC Windows XP', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-06-21 15:47 UTC', 'Sebb', NULL, '2012-01-19 15:05:26 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (106, '38216', 'Bug 38216 Extend Jmxproxy to allow call of MBean Operations', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Manager', 'unspecified', 'Other other', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-01-10 18:01 UTC', 'Christopher Hlubek', NULL, '2012-01-22 18:34:10 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (107, '52245', 'Bug 52245 Add detection of EL Jar to WebappClassLoader', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-11-25 15:13 UTC', 'Pid', NULL, '2012-01-12 19:49:45 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (108, '52440', 'Bug 52440 Wrong getValueReference behaviour with Facelets parameter expressions', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', '7.0.22', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2012-01-09 09:11 UTC', 'JustasR', NULL, '2012-01-12 19:38:26 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (109, '52328', 'Bug 52328 Massive garbage production observed when using the response writer', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.23', 'PC All', 'P2 regression', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-12-14 11:03 UTC', 'Nikolay Diakov', NULL, '2012-01-13 13:07:55 UTC', 'andreas.kohn,peter.wong', NULL);
INSERT INTO `tomcatpredefined` VALUES (110, '52293', 'Bug 52293 antiResourceLocking and unpackWARs', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.35', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-12-06 18:54 UTC', 'Justin Miller', NULL, '2012-01-06 16:10:34 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (111, '52225', 'Bug 52225 Adding Alias for existing host on running Tomcat causes ClassCastException', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.33', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-11-22 07:14 UTC', 'Konstantin Kolinko', NULL, '2011-12-20 20:20:02 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (112, '50570', 'Bug 50570 Allow explicit use of FIPS mode in APR lifecycle listener', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', 'unspecified', 'PC All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, 'PatchAvailable\n\n', ' ', ' ', '2011-01-11 12:27 UTC', 'Christopher Schultz', NULL, '2014-02-17 13:52:39 UTC', 'burlie000,cbeckey,jfclere', NULL);
INSERT INTO `tomcatpredefined` VALUES (113, '52009', 'Bug 52009 NPE exception in org.apache.catalina.connector.CoyoteAdapter.service', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', '7.0.22', 'PC Windows XP', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-10-11 08:06 UTC', 'viola.lu', NULL, '2017-07-31 19:59:47 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (114, '51972', 'Bug 51972 sendRedirect does not support protocol relative URLs', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.22', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-10-05 21:31 UTC', 'Heikki Vesalainen', NULL, '2011-10-10 12:22:43 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (115, '51952', 'Bug 51952 IllegalStateException using CompressionFilter with Tomcat 7.0.21/22', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', '7.0.21', 'Sun Solaris', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-10-04 15:36 UTC', 'Kari Scott', NULL, '2011-11-08 23:35:49 UTC', 'bplies,jessh', NULL);
INSERT INTO `tomcatpredefined` VALUES (116, '51630', 'Bug 51630 java.lang.IllegalStateException: Calling [asyncComplete()]', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Examples', '7.0.22', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-08-07 02:34 UTC', 'zhh', NULL, '2011-10-03 19:55:14 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (117, '51872', 'Bug 51872 request.getRemoteAddr() sometimes returning IP address from the previous request', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', '7.0.20', 'PC Linux', 'P2 blocker', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-09-22 17:52 UTC', 'charlie', NULL, '2015-09-17 14:52:22 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (118, '51580', 'Bug 51580 Severe error deploying WAR application (ExpandWar error)', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.19', 'PC All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-07-28 22:41 UTC', 'Cleon', NULL, '2014-12-02 04:36:25 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (119, '51687', 'Bug 51687 Improve JreMemoryLeakPreventionListener against leak caused by sun.java2d.Disposer', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'PC Linux', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-08-19 14:41 UTC', 'Michał Politowski', NULL, '2014-02-17 13:47:57 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (120, '51739', 'Bug 51739 If landingpage is a XHTML (JSF/CDI), nullpointer exception.', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.20', 'PC All', 'P2 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-08-29 13:47 UTC', 'Flávio Henrique', NULL, '2011-08-29 18:30:46 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (121, '51558', 'Bug 51558 Tomcat Embedded: using tomcat.addWebapp always overrides programmatic context-settings with default values for the context at start of tomcat server', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.16', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-07-26 10:11 UTC', 'bhuber', NULL, '2011-08-26 16:09:52 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (122, '49683', 'Bug 49683 Separate keep-alive and connection timeout with APR/native connector', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', 'trunk', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-08-01 15:40 UTC', 'Mark Thomas', NULL, '2011-09-07 09:07:20 UTC', 'fhanik', NULL);
INSERT INTO `tomcatpredefined` VALUES (123, '51588', 'Bug 51588 Change access modifiers in AccessLogValve to make it easier to extend', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.32', 'PC Linux', 'P2 minor', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-07-30 02:33 UTC', 'Rod', NULL, '2011-08-11 09:17:36 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (124, '51056', 'Bug 51056 Disable / drop support for SSLv2', 'RESOLVED FIXED', 'None', 'Tomcat Native', 'Library', '1.1.20', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-04-13 14:12 UTC', 'Damien Raude-Morvan', NULL, '2011-08-12 18:01:40 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (125, '49595', 'Bug 49595 Tomcat crashes in tcnative-1.dll frequently', 'RESOLVED FIXED', 'None', 'Tomcat Native', 'Library', '1.1.20', 'PC Windows Server 2003', 'P2 critical', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-07-15 06:34 UTC', 'Anil Saraswathy', NULL, '2011-08-12 07:15:32 UTC', 'h.shirosaki', NULL);
INSERT INTO `tomcatpredefined` VALUES (126, '51503', 'Bug 51503 Additional error checking required for connector port attribute (e.g. for port=\'\')', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', 'trunk', 'PC Windows Server 2003', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-07-13 12:40 UTC', 'Etienne Massip', NULL, '2016-01-07 06:17:33 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (127, '51477', 'Bug 51477 Support all protocol combinations in SSLProtocol of APR Connector', 'RESOLVED FIXED', 'None', 'Tomcat Native', 'Library', '1.1.20', 'PC Linux', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, 'PatchAvailable\n\n', ' ', ' ', '2011-07-05 16:53 UTC', 'Marvin Addison', NULL, '2012-06-01 12:18:09 UTC', 'michaelo', NULL);
INSERT INTO `tomcatpredefined` VALUES (128, '46252', 'Bug 46252 Tomcat access log doesn\'t support Unicode', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.17', 'PC Windows XP', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-11-20 11:18 UTC', 'Adam', NULL, '2011-07-21 10:26:33 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (129, '51475', 'Bug 51475 GzipInterceptor#decompress is not completly implemented', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.29', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-07-05 09:58 UTC', 'Christian Stöber', NULL, '2011-07-21 17:09:14 UTC', 'cstoeber', NULL);
INSERT INTO `tomcatpredefined` VALUES (130, '51473', 'Bug 51473 SecurityConfig，set \'package.definition\' security property to \'nullsun.,java.,...\'', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.33', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-07-05 05:37 UTC', 'zhh', NULL, '2011-08-12 08:22:17 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (131, '51467', 'Bug 51467 usage of method run instead of start to start a thread', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'All All', 'P2 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-07-03 10:19 UTC', 'Felix Schumacher', NULL, '2011-07-04 18:50:13 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (132, '51088', 'Bug 51088 ArrayIndexOutOfBoundsException from org.apache.el.parser.JJTELParserState', 'RESOLVED WONTFIX', 'None', 'Tomcat 6', 'Jasper', '6.0.32', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-04-20 05:42 UTC', 'Michael Heinen', NULL, '2011-07-02 12:13:08 UTC', 'mhn4dev', NULL);
INSERT INTO `tomcatpredefined` VALUES (133, '50353', 'Bug 50353 Calling asyncContext.getResponse() returns null after async timeout', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.5', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-11-27 17:45 UTC', 'Sylvain Laurent', NULL, '2011-08-15 18:53:33 UTC', 'zhh200910', NULL);
INSERT INTO `tomcatpredefined` VALUES (134, '51396', 'Bug 51396 Embedding class cannot launch a webapp with a jsp servlet', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.16', 'PC All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-06-20 17:02 UTC', 'bmargulies', NULL, '2011-06-20 22:51:14 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (135, '49165', 'Bug 49165 Enhancement - Allow %{TIME_FORMAT}t As Configuration for AccessLogValve', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'unspecified', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-04-21 14:20 UTC', 'Jacob Zwiers', NULL, '2011-06-19 11:28:35 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (136, '48956', 'Bug 48956 SSI regular expressions not working', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.26', 'PC Mac OS X 10.4', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-03-22 11:48 UTC', 'Albert Tumanov', NULL, '2012-06-08 12:16:47 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (137, '43538', 'Bug 43538 [patch] Show the hostname and IP address in the manager webapp', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Webapps:Manager', '5.5.25', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-10-02 14:42 UTC', 'Dennis Lundberg', NULL, '2011-06-15 21:58:01 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (138, '51306', 'Bug 51306 NPE in DeltaRequest.writeExternal(DeltaRequest.java:267) when handling remote session expiration', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.32', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-06-01 12:21 UTC', 'Dmitry Mikhaylov', NULL, '2011-06-28 09:16:36 UTC', 'ronald-lists', NULL);
INSERT INTO `tomcatpredefined` VALUES (139, '51340', 'Bug 51340 Intermittent java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.12', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, 'http://mail-archives.apache.org/mod_mbox/tomcat-users/200902.mbox/%3C36E4692623C5974BA6661C0B18EE8EDFE4138B@MAILSERV.hcrest.com%3E', NULL, ' ', ' ', ' ', '2011-06-08 13:37 UTC', 'Glyn Normington', NULL, '2011-06-08 15:52:45 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (140, '51276', 'Bug 51276 Startup time is too high if there are few JARs in \'lib/\' and a few webapps.', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.14', 'PC FreeBSD', 'P2 regression', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-05-27 11:09 UTC', 'Alex Dupre', NULL, '2011-06-06 07:04:32 UTC', 'lapo', NULL);
INSERT INTO `tomcatpredefined` VALUES (141, '51240', 'Bug 51240 maxConnections not honors config when acceptorThreadCount > 1', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', '7.0.14', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-05-22 19:22 UTC', 'Guillermo Grandes', NULL, '2011-05-28 19:25:54 UTC', 'guillermo.grandes', NULL);
INSERT INTO `tomcatpredefined` VALUES (142, '51226', 'Bug 51226 [Patch] to add FindLeaks ant task', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Manager', 'trunk', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-05-19 06:26 UTC', 'Eiji Takahashi', NULL, '2011-05-24 16:05:16 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (143, '27122', 'Bug 27122 IE plugins cannot access components through Tomcat 5 over SSL', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:HTTP', '5.0.18', 'Sun Solaris', 'P3 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2004-02-20 21:09 UTC', 'Daniel Potter', NULL, '2011-05-22 22:55:04 UTC', 'burn,ingo,reconway,tomcat,wolfgang.hoheisel,wtff', NULL);
INSERT INTO `tomcatpredefined` VALUES (144, '51185', 'Bug 51185 Performance : DataSourceProxy#createPool should use more fine grained synchronisation', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'All All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-05-11 10:21 UTC', 'Philippe Mouawad', NULL, '2011-05-20 22:03:36 UTC', 'p.mouawad', NULL);
INSERT INTO `tomcatpredefined` VALUES (145, '35054', 'Bug 35054 warn if appBase is not existing as a File or directory', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', 'Nightly Build', 'Other All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2005-05-25 10:03 UTC', 'Ralf Hauser', NULL, '2011-05-20 18:11:32 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (146, '50950', 'Bug 50950 NotSerializableException: org.apache.catalina.realm.GenericPrincipal', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.32', 'Other Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-03-20 13:28 UTC', 'Ronald Klop', NULL, '2011-05-10 08:36:25 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (147, '51119', 'Bug 51119 extras - JmxRemoteLifecycleListener does not support JAAS based authentication and authorisation', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.32', 'All All', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-04-26 05:29 UTC', 'Neil laurance', NULL, '2011-05-18 12:41:26 UTC', 'edward.quick', NULL);
INSERT INTO `tomcatpredefined` VALUES (148, '51124', 'Bug 51124 ArrayIndexOutOfBoundsException after setting org.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.32', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-04-27 06:31 UTC', 'Juergen', NULL, '2015-08-10 09:36:25 UTC', 'ramiro', NULL);
INSERT INTO `tomcatpredefined` VALUES (149, '51042', 'Bug 51042 HttpSessionListener.sessionCreated() is called a second time when user is authenticated with no matching sessionDestroyed() call.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.33', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-04-08 05:54 UTC', 'Joachim Sauer', NULL, '2011-08-22 12:10:26 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (150, '50887', 'Bug 50887 Enhancement to set security-provider within AjpAprProcessor', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.32', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-03-08 04:49 UTC', 'pknopp', NULL, '2011-06-03 08:16:53 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (151, '50895', 'Bug 50895 JSP compiler initializes classes during compile which can result in failures', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.32', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-03-08 15:27 UTC', 'Andy Wang', NULL, '2011-04-18 09:57:13 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (152, '25060', 'Bug 25060 Reloading context orphans currently open jndi datasource connections', 'RESOLVED FIXED', 'None', 'Tomcat 4', 'Unknown', '4.1.27', 'Other other', 'P3 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2003-11-27 21:15 UTC', 'Wayne Schroeder', NULL, '2011-03-08 17:20:28 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (153, '27988', 'Bug 27988 Unhelpful FileNotFoundException raised', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.33', 'All All', 'P3 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2004-03-26 17:01 UTC', 'richard.beton', NULL, '2011-04-10 06:46:35 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (154, '28852', 'Bug 28852 failonerror attribute on Ant tasks', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.33', 'All All', 'P3 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2004-05-08 20:23 UTC', 'Stephane Bailliez', NULL, '2011-03-14 07:57:28 UTC', 'devlists', NULL);
INSERT INTO `tomcatpredefined` VALUES (155, '31027', 'Bug 31027 major error from minor whitespace error in properties file', 'RESOLVED WONTFIX', 'None', 'Tomcat 5', 'Catalina', '5.5.33', 'HP Linux', 'P3 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2004-09-02 22:36 UTC', 'Jim Eng', NULL, '2011-02-27 09:08:34 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (156, '50836', 'Bug 50836 LifecycleState#isAvailable() to be more restrictive', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.8', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-02-26 14:05 UTC', 'Konstantin Kolinko', NULL, '2011-02-27 09:36:52 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (157, '19444', 'Bug 19444 JNDI Authentication roles must be anonymous accessible', 'RESOLVED FIXED', 'None', 'Tomcat 4', 'Catalina', '4.1.24', 'All All', 'P3 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2003-04-29 21:58 UTC', 'art_w', NULL, '2011-02-22 06:10:26 UTC', 'berni_huber', NULL);
INSERT INTO `tomcatpredefined` VALUES (158, '50189', 'Bug 50189 AJP connector sends GET BODY CHUNK when reading after response closed', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:AJP', '5.5.23', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-10-31 23:27 UTC', 'James Roper', NULL, '2011-03-14 07:43:44 UTC', 'clint.morgan', NULL);
INSERT INTO `tomcatpredefined` VALUES (159, '50780', 'Bug 50780 AjpConnectionHandler keeps many connections causing memory leak', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Connectors', '7.0.6', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-02-15 04:51 UTC', 'Sergiusz', NULL, '2011-02-17 11:08:23 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (160, '50713', 'Bug 50713 The \'roles\' command doesn\'t work', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Manager', 'trunk', 'All All', 'P2 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-02-03 02:38 UTC', 'Eiji Takahashi', NULL, '2011-02-16 08:46:28 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (161, '50700', 'Bug 50700 Context parameters are being overridden with parameters from the web application deployment descriptor', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.30', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-02-01 13:04 UTC', 'Sergey', NULL, '2014-02-17 13:42:51 UTC', 'chris,n.beekman,oliver,wg', NULL);
INSERT INTO `tomcatpredefined` VALUES (162, '50771', 'Bug 50771 HttpServletRequest#getAuthType() returns null though the request is authenticated.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina:Cluster', '5.5.33', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-02-14 03:30 UTC', 'Keiichi Fujino', NULL, '2011-08-16 12:37:46 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (163, '50726', 'Bug 50726 Jasper can generate uncompilable source code if genStringAsCharArray is turned on', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.28', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-02-07 08:14 UTC', 'Róbert István', NULL, '2011-06-03 07:31:01 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (164, '50673', 'Bug 50673 Error when stopping Tomcat using services.msc', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.30', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-01-27 10:09 UTC', 'apache', NULL, '2011-02-02 10:22:46 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (165, '50642', 'Bug 50642 keepAliveProtection doesn\'t work', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.30', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-01-24 10:45 UTC', 'james', NULL, '2011-04-21 14:10:05 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (166, '50646', 'Bug 50646 Tribes ByteMessage will get corrupted if message size exceeds the underlying buffer size', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.32', 'PC All', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, 'PatchAvailable\n\n', ' ', ' ', '2011-01-25 07:08 UTC', 'Olivier Costet', NULL, '2011-07-02 12:18:38 UTC', 'ronald-lists', NULL);
INSERT INTO `tomcatpredefined` VALUES (167, '50613', 'Bug 50613 ConnectionPool.size corruption when evictions enabled:', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-01-18 17:33 UTC', 'Jeremy Norris', NULL, '2011-01-19 19:11:26 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (168, '50582', 'Bug 50582 Small JSPs do not set Content-Length (and use chunked encoding) if AccessLogValve is configured', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.6', 'PC Windows XP', 'P2 regression', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-01-14 02:16 UTC', 'Konstantin Kolinko', NULL, '2011-01-16 07:55:00 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (169, '18462', 'Bug 18462 System.err gets overriden to output to System.out', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'Other other', 'P3 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2003-03-28 12:35 UTC', 'Nikolay Metchev', NULL, '2011-01-12 19:58:15 UTC', 'oliver.henning', NULL);
INSERT INTO `tomcatpredefined` VALUES (170, '15688', 'Bug 15688 full-qualified names instead of imports', 'RESOLVED FIXED', 'None', 'Tomcat 4', 'Jasper 2', '4.1.17', 'Other other', 'P3 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2002-12-27 22:30 UTC', 'Sven', NULL, '2011-01-12 08:05:20 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (171, '49953', 'Bug 49953 Missing @Override annotations', 'RESOLVED WONTFIX', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-09-17 14:00 UTC', 'Sebb', NULL, '2012-03-20 15:50:47 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (172, '21157', 'Bug 21157 CookieExample is setting cookie after writing data', 'RESOLVED FIXED', 'None', 'Tomcat 4', 'Webapps:Examples', '4.1.24', 'All other', 'P5 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2003-06-27 23:12 UTC', 'Vishy Kasar', NULL, '2011-01-08 17:27:54 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (173, '50552', 'Bug 50552 Ant Tasks give a null pointer exception when an error occurs, masking true error', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-01-06 12:39 UTC', 'chris.rimmer', NULL, '2011-01-08 17:23:10 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (174, '49543', 'Bug 49543 Request for a \'shared\' datasource configuration as in DBCP', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-07-02 15:07 UTC', 'Jason', NULL, '2011-01-20 16:03:35 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (175, '50547', 'Bug 50547 The CHANGE_SESSION_ID message that received during cluster session synchronization is dropped.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina:Cluster', '5.5.31', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2011-01-06 03:48 UTC', 'Keiichi Fujino', NULL, '2011-01-20 14:24:04 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (176, '50453', 'Bug 50453 Multiple X-Forwarded-For headers not handled by RemoteIP valve', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.29', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-12-10 09:29 UTC', 'brett.dellegrazie', NULL, '2011-01-07 13:28:50 UTC', 'brett.dellegrazie,johnwastle', NULL);
INSERT INTO `tomcatpredefined` VALUES (177, '50467', 'Bug 50467 Occasional NIO connector lockups on high load', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.29', 'Other Linux', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-12-13 14:02 UTC', 'Steven Hugg', NULL, '2011-01-07 13:40:10 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (178, '50500', 'Bug 50500 EL evaluation of floating-point String value vs BigInteger loses precision', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.29', 'All All', 'P2 minor', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-12-19 19:00 UTC', 'Konstantin Kolinko', NULL, '2011-01-07 13:43:55 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (179, '50025', 'Bug 50025 getConnection method in class DataSourceProxy is ignoring credentials', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC Windows XP', 'P2 critical', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-09-29 09:48 UTC', 'Tim', NULL, '2019-07-10 10:15:00 UTC', 'wilkinsona', NULL);
INSERT INTO `tomcatpredefined` VALUES (180, '49125', 'Bug 49125 toString on byte[] array probably is not correct', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC Windows XP', 'P5 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-04-14 18:54 UTC', 'Sebb', NULL, '2010-12-14 15:57:03 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (181, '50460', 'Bug 50460 First access to a jspx page causes classloader leak in JspDocumentParser', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.29', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-12-11 21:33 UTC', 'Konstantin Kolinko', NULL, '2011-01-20 12:21:53 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (182, '48692', 'Bug 48692 Provide option to parse application/x-www-form-urlencoded PUT requests', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC Windows Server 2003', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-02-07 02:41 UTC', 'Mark Thomas', NULL, '2012-10-04 14:56:44 UTC', 'chris,stasgr', NULL);
INSERT INTO `tomcatpredefined` VALUES (183, '49142', 'Bug 49142 Missing serialVersionUIDs', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC Windows XP', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-04-16 21:25 UTC', 'Sebb', NULL, '2010-11-24 17:05:26 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (184, '48837', 'Bug 48837 Memory leaks protection does not detect leaks triggered by JSP pages code', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'PC Windows XP', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-03-01 18:51 UTC', 'Konstantin Kolinko', NULL, '2010-12-01 21:30:01 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (185, '50192', 'Bug 50192 performance issue after revision 746425 ', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', 'trunk', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-11-01 15:17 UTC', 'Robert Goff', NULL, '2010-11-12 13:30:36 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (186, '50168', 'Bug 50168 destory method is called twice while the child is destoryed directly', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.4', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-10-27 22:47 UTC', 'Ivan', NULL, '2010-11-04 19:04:31 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (187, '49426', 'Bug 49426 Manager app wrongly localized', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Manager', 'trunk', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-06-11 03:26 UTC', 'Marc Guillemot', NULL, '2010-10-16 15:32:32 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (188, '50066', 'Bug 50066 Cannot compile recursive tag with ant if it uses a class from the webapp', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.29', 'All All', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-10-09 09:49 UTC', 'Sylvain Laurent', NULL, '2010-10-14 10:48:16 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (189, '50027', 'Bug 50027 NullPointerException if context.xml is present with <Resource>', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.2', 'PC Windows Vista', 'P3 regression', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-09-29 13:02 UTC', 'Flávio Henrique', NULL, '2010-10-08 17:46:33 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (190, '49986', 'Bug 49986 Double-check locking. Possible data-race in JspServletWrapper', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.29', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-09-23 09:31 UTC', 'Sergey Vorobyev', NULL, '2010-10-13 10:59:02 UTC', 'konstantin.s.serebryany,sergeyvorobyev', NULL);
INSERT INTO `tomcatpredefined` VALUES (191, '49972', 'Bug 49972 Double-check idiom. Possible data-race.', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Manager application', '6.0.29', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-09-22 04:44 UTC', 'Sergey Vorobyev', NULL, '2010-10-13 11:07:03 UTC', 'konstantin.s.serebryany,sergeyvorobyev', NULL);
INSERT INTO `tomcatpredefined` VALUES (192, '49985', 'Bug 49985 Lazy initialization without any synchronization - data race in AstInteger, AstFloatingPoint, AstString', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.29', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-09-23 08:55 UTC', 'Sergey Vorobyev', NULL, '2010-10-04 17:16:33 UTC', 'konstantin.s.serebryany,sergeyvorobyev', NULL);
INSERT INTO `tomcatpredefined` VALUES (193, '49915', 'Bug 49915 [Patch] o.a.c.c.StandardServer swallows error on storeConfig.', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-09-10 19:35 UTC', 'Wesley', NULL, '2010-10-04 17:13:36 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (194, '49667', 'Bug 49667 JdbcLeakPrevention class can register unregistered JCBC Driver', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.29', 'Sun Solaris', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-07-29 09:31 UTC', 'Arjen Knibbe', NULL, '2010-10-03 13:36:57 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (195, '49730', 'Bug 49730 Race condition in StandardThreadExecutor : requests are sometimes enqueued instead of creating new threads', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.29', 'Macintosh All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-08-09 16:16 UTC', 'Sylvain Laurent', NULL, '2010-11-04 10:28:20 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (196, '49665', 'Bug 49665 When file not found error occurs it does not tell you which file caused the error.', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.29', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-07-29 05:08 UTC', 'Ted Leung', NULL, '2010-10-28 20:39:15 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (197, '49209', 'Bug 49209 AccessControlException when undeploying application', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.29', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-04-28 07:30 UTC', 'Stephan Bublava', NULL, '2010-10-12 09:03:12 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (198, '49234', 'Bug 49234 JMX Descriptor Modifications', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-04-30 00:17 UTC', 'chamith buddhika', NULL, '2010-09-16 03:04:51 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (199, '49749', 'Bug 49749 SSO cookie should be added as HttpOnly', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.29', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-08-13 19:18 UTC', 'dheinecke', NULL, '2010-09-07 12:05:39 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (200, '48738', 'Bug 48738 [PATCH]Allow GzipOutputFilter to send partial result when flushBuffer() is called', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.20', 'All Mac OS X 10.4', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, 'PatchAvailable\n\n', ' ', ' ', '2010-02-13 23:28 UTC', 'Jiong Wang', NULL, '2010-09-07 12:02:03 UTC', 'james', NULL);
INSERT INTO `tomcatpredefined` VALUES (201, '49670', 'Bug 49670 org.apache.catalina.authenticator.SingleSignOn valve does not function', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.0', 'PC All', 'P2 regression', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-07-29 10:43 UTC', 'chornsey', NULL, '2010-08-23 16:16:42 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (202, '49721', 'Bug 49721 Fail to access the resources such as jsp files from a jar file which is supported by servlet 3.0', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', 'trunk', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-08-06 21:52 UTC', 'Wang Guangzhe', NULL, '2010-08-23 15:40:12 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (203, '49613', 'Bug 49613 Request.getAttributeNames() slows down some applications', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.28', 'All All', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-07-19 06:23 UTC', 'Sampo Savolainen', NULL, '2010-09-07 11:56:25 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (204, '49567', 'Bug 49567 when starting a new thread from a startAsync Runnable, an infinite amount of doPosts is generated', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', 'trunk', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-07-07 09:22 UTC', 'Pieter Libin', NULL, '2010-10-10 17:11:27 UTC', 'den04304,janko,kevin,pieter', NULL);
INSERT INTO `tomcatpredefined` VALUES (205, '48998', 'Bug 48998 Proposal : port mod_expires in java as ExpiresFilter Servlet Filter', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC Mac OS X 10.4', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-03-26 16:38 UTC', 'Cyrille Le Clerc', NULL, '2010-07-14 18:16:23 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (206, '48960', 'Bug 48960 SSI Servlet should support safe configuration', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'All All', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-03-22 16:37 UTC', 'Yair Lenga', NULL, '2010-07-16 06:23:49 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (207, '49570', 'Bug 49570 The CompressionFilter example should support HTTP proxies to cache gzipped content better by sending Vary: Accept-Encoding header', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Examples', 'trunk', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-07-08 02:11 UTC', 'Thai Ha', NULL, '2010-07-23 08:01:54 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (208, '49550', 'Bug 49550 [PATCH] Response class fix isSpace (deprecated) => isWhiteSpace', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.0', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-07-05 07:23 UTC', 'Sebb', NULL, '2010-07-05 16:59:14 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (209, '49525', 'Bug 49525 IE8: Unabled to store data in HttpSession (root context)', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', '7.0.6', 'PC Linux', 'P2 blocker', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-06-29 22:22 UTC', 'oschina.net', NULL, '2014-02-17 13:48:27 UTC', 'brian', NULL);
INSERT INTO `tomcatpredefined` VALUES (210, '49445', 'Bug 49445 After session ID is changed on authentication, the session replication does not work.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina:Cluster', '5.5.29', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-06-16 05:08 UTC', 'Keiichi Fujino', NULL, '2010-06-28 03:44:57 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (211, '48971', 'Bug 48971 memory leak protection : stopping TimeThreads should be optional and disabled by default', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.24', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-03-23 22:56 UTC', 'Sylvain Laurent', NULL, '2014-02-17 13:51:23 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (212, '49224', 'Bug 49224 NullPointerException in PooledConnection when username or password are null', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-04-29 11:15 UTC', 'Matt Passell', NULL, '2010-08-04 12:40:13 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (213, '48689', 'Bug 48689 Jar abstraction for Jasper', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', 'trunk', 'PC Linux', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-02-05 12:30 UTC', 'Jarek Gawor', NULL, '2010-04-25 08:57:13 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (214, '43642', 'Bug 43642 Add prestartminSpareThreads attribute for Executor', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.14', 'All All', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-10-17 08:00 UTC', 'Ruediger Pluem', NULL, '2010-10-08 04:52:56 UTC', 'jfclere', NULL);
INSERT INTO `tomcatpredefined` VALUES (215, '49045', 'Bug 49045 JMX Enhancement- Provision of MBeanFactory createStandardService', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-04-04 05:40 UTC', 'chamith buddhika', NULL, '2010-04-14 08:07:06 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (216, '49086', 'Bug 49086 Addition of Javadoc for Servlet 3.0 annotations', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Documentation', 'trunk', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-04-11 16:43 UTC', 'Pid', NULL, '2010-04-12 06:33:45 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (217, '48717', 'Bug 48717 Session listeners not called on cluster node start', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina:Cluster', '5.5.32', 'PC Linux', 'P2 regression', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-02-09 17:43 UTC', 'David Rees', NULL, '2011-08-16 12:44:45 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (218, '48760', 'Bug 48760 Tomcat breaks in serving large files (>=1.8MB) under high load and high threading.', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.16', 'Sun Solaris', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-02-17 20:44 UTC', 'Stefan Kendall', NULL, '2014-02-17 13:56:36 UTC', 'arcanefang', NULL);
INSERT INTO `tomcatpredefined` VALUES (219, '48737', 'Bug 48737 JspCompilationContext assumes that tagfile with a path starting with META-INF are in jars without checking', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.24', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-02-13 18:19 UTC', 'Fabrizio Giustina', NULL, '2010-05-14 15:53:09 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (220, '48582', 'Bug 48582 JspServletWrapper.getServletContext() throws NullPointerException', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.24', 'PC Linux', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-01-20 13:25 UTC', 'Tim McCune', NULL, '2010-03-05 12:59:59 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (221, '48580', 'Bug 48580 6.0.24: AccessControlException in ProtectedFunctionMapper on first access to certain JSP', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', 'Nightly Build', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-01-20 11:54 UTC', 'Konstantin Kolinko', NULL, '2010-04-11 08:30:30 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (222, '48498', 'Bug 48498 6.0.22RC: ArrayIndexOutOfBoundsException from Jasper when compilation error inside a CDATA block', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.20', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-01-06 19:40 UTC', 'Konstantin Kolinko', NULL, '2015-05-07 19:04:13 UTC', 'rawatsaurav', NULL);
INSERT INTO `tomcatpredefined` VALUES (223, '48371', 'Bug 48371 addWebXmlMappings does not place servlet tags correctly', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.20', 'PC Windows XP', 'P2 minor', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-12-10 18:16 UTC', 'Lee Clemens', NULL, '2010-03-03 17:40:52 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (224, '48170', 'Bug 48170 Unnecessary synchronization by JspFactory.getDefaultFactory contributes to stability problems', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.16', 'Sun Solaris', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-11-10 18:04 UTC', 'Earl Nolan', NULL, '2010-02-18 12:13:33 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (225, '48643', 'Bug 48643 catalina.session.FileStore.save() and load() - close() bugs', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Catalina', 'trunk', 'PC Windows XP', 'P2 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-01-30 16:53 UTC', 'Sebb', NULL, '2010-02-07 14:16:50 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (226, '48516', 'Bug 48516 NullPointerException in JNDIRealm', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.28', 'PC All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2010-01-11 05:42 UTC', 'Kevin Conaway', NULL, '2010-03-03 16:51:54 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (227, '48004', 'Bug 48004 setHeader() does not replace the previous value for a \'Server\'', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Unknown', '5.5.28', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-10-15 11:16 UTC', 'olivier dupuy', NULL, '2010-03-03 23:31:49 UTC', 'michael.radlingmaier', NULL);
INSERT INTO `tomcatpredefined` VALUES (228, '48006', 'Bug 48006 Implement the header X-Powered-By suggested by the servlet specification', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.20', 'All All', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-10-15 11:34 UTC', 'olivier dupuy', NULL, '2010-03-06 17:35:29 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (229, '43819', 'Bug 43819 Support latest JSR245 proposal to make EL \'self-contained\'', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', 'trunk', 'Other other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-11-08 14:48 UTC', 'Christoph Beck', NULL, '2009-12-31 09:55:14 UTC', 'mraible', NULL);
INSERT INTO `tomcatpredefined` VALUES (230, '47744', 'Bug 47744 Memory leak when using SSL + Java security manager', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:Coyote', '5.5.28', 'PC Linux', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-08-26 11:01 UTC', 'Greg Vanore', NULL, '2010-01-27 01:20:44 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (231, '47502', 'Bug 47502 clustering fails on serializing javax.security.auth.subject', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.20', 'Other Linux', 'P2 critical', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-07-09 05:57 UTC', 'Ronald Klop', NULL, '2009-12-15 11:09:16 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (232, '47342', 'Bug 47342 ReplicatedContext#start throws NullPointerException.', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.20', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-06-10 02:48 UTC', 'Keiichi Fujino', NULL, '2009-12-15 11:05:46 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (233, '48267', 'Bug 48267 Patch to fix generics in javax packages', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', 'trunk', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-11-23 13:22 UTC', 'Sebb', NULL, '2009-11-30 15:27:27 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (234, '47799', 'Bug 47799 Domain does not work in Membership and DomainFilterInterceptor.', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.20', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-09-08 02:39 UTC', 'Keiichi Fujino', NULL, '2009-12-21 08:26:33 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (235, '47462', 'Bug 47462 The annotation doesn\'t become effective.(metadata-complete=\'false\' is not effective.)', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.20', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-07-01 02:51 UTC', 'Keiichi Fujino', NULL, '2010-01-06 18:06:55 UTC', 'charly41434', NULL);
INSERT INTO `tomcatpredefined` VALUES (236, '47997', 'Bug 47997 NamingContextListener fails to add itself as a PropertyChangeListener to all namingResources', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.28', 'Macintosh Mac OS X 10.4', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-10-14 17:45 UTC', 'Michael Allman', NULL, '2010-03-09 22:37:31 UTC', 'msa', NULL);
INSERT INTO `tomcatpredefined` VALUES (237, '47718', 'Bug 47718 ManagerBase leaks fd to /dev/urandom when context stopped', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.27', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-08-20 14:48 UTC', 'George Sexton', NULL, '2010-01-25 21:22:59 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (238, '48172', 'Bug 48172 JspRuntimeContext synch. problems.', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Jasper', 'trunk', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-11-11 03:23 UTC', 'Sebb', NULL, '2009-11-18 15:35:24 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (239, '47881', 'Bug 47881 org.apache.catalina.startup.Bootstrap\'s main method handles \'startd\' or \'stopd\' wrongly', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.20', 'PC Linux', 'P2 minor', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-09-20 19:14 UTC', 'qingyang.xu', NULL, '2009-11-02 16:47:52 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (240, '47451', 'Bug 47451 NPE if response contains null content-encoding header', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.20', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-06-29 14:53 UTC', 'Dan Rabe', NULL, '2009-12-21 11:19:31 UTC', 'stefan', NULL);
INSERT INTO `tomcatpredefined` VALUES (241, '40001', 'Bug 40001 HTML pages should not use GET to restart web-apps.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Webapps:Manager', '5.5.17', 'Other other', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-07-10 14:32 UTC', 'Michiel Meeuwissen', NULL, '2010-11-08 13:55:14 UTC', 'erharold,julian.reschke,ramon', NULL);
INSERT INTO `tomcatpredefined` VALUES (242, '47499', 'Bug 47499 provide better insight on BindException: Cannot assign requested address', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', 'unspecified', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-07-08 22:05 UTC', 'Ralf Hauser', NULL, '2009-10-03 11:06:07 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (243, '47866', 'Bug 47866 NullPointerException in embedded tomcat', 'RESOLVED WONTFIX', 'None', 'Tomcat 7', 'Catalina', 'unspecified', 'PC Linux', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-09-18 00:23 UTC', 'Dave Syer', NULL, '2009-09-22 03:00:32 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (244, '47161', 'Bug 47161 Manager ignores executors on status pages', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Manager application', '6.0.18', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-05-06 07:20 UTC', 'Mark Thomas', NULL, '2009-12-21 11:16:51 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (245, '46950', 'Bug 46950 SSL renegotiation does not occur when resource with CLIENT-CERT auth is requested', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Native:Integration', '5.5.28', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-04-01 06:33 UTC', 'Andre Cruz', NULL, '2009-11-30 16:33:37 UTC', 'liosa', NULL);
INSERT INTO `tomcatpredefined` VALUES (246, '47378', 'Bug 47378 welcome-file ignores servlet mapping', 'RESOLVED FIXED', 'None', 'Tomcat 7', 'Servlet &amp; JSP API', 'trunk', 'All All', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-06-16 12:52 UTC', 'Bobby Lawrence', NULL, '2010-06-14 14:50:54 UTC', 'thomas', NULL);
INSERT INTO `tomcatpredefined` VALUES (247, '41824', 'Bug 41824 Unable to use nested type in TLD', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.20', 'Other other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-03-12 10:40 UTC', 'Renaud Waldura', NULL, '2009-08-15 11:37:59 UTC', 'brian', NULL);
INSERT INTO `tomcatpredefined` VALUES (248, '46907', 'Bug 46907 Jasper with log4j in web-app classpath and debug level enabled prevents reading HTTP POST stream from JSP', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.26', 'PC Windows XP', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-03-24 15:20 UTC', 'Olivier Lau', NULL, '2009-08-12 04:51:38 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (249, '47518', 'Bug 47518 Valve Interface Javadocs for invoke method references non-existent method', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Documentation', 'unspecified', 'PC Windows Vista', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, 'http://tomcat.apache.org/tomcat-6.0-doc/api/org/apache/catalina/Valve.html#invoke%28org.apache.catalina.connector.Request,%20org.apache.catalina.connector.Response%29', NULL, ' ', ' ', ' ', '2009-07-13 06:40 UTC', 'Christopher Schultz', NULL, '2009-07-20 23:38:16 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (250, '41059', 'Bug 41059 WebAppClassLoader clearReferences code break running threads', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.20', 'All All', 'P3 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-11-28 11:53 UTC', 'James Birmingham', NULL, '2011-02-14 08:47:13 UTC', 'carnold,cowwoc,hugh,mauromol', NULL);
INSERT INTO `tomcatpredefined` VALUES (251, '40551', 'Bug 40551 Sticky sessions using PersistentManager enter indeterminate state on node failover', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', 'Nightly Build', 'All All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-09-20 01:33 UTC', 'Chris Chandler', NULL, '2009-07-17 04:38:35 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (252, '47515', 'Bug 47515 Tomcat can\'t replicate session when it is started.', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.18', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-07-12 23:08 UTC', 'Ryuichi Yoshihara', NULL, '2009-07-16 07:12:50 UTC', 'yoshihara.ryuiti', NULL);
INSERT INTO `tomcatpredefined` VALUES (253, '40380', 'Bug 40380 Potential syncro problem in StandardSession.expire(boolean)', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Servlet &amp; JSP API', '5.5.5', 'All other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-08-31 18:57 UTC', 'Claude Qu', NULL, '2009-07-17 04:16:21 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (254, '39231', 'Bug 39231 The JAAS contract for LoginModule is broken', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.16', 'All All', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-04-06 21:19 UTC', 'Seva Popov', NULL, '2009-12-20 09:49:05 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (255, '37984', 'Bug 37984 JNDIRealm.java not able to handle MD5 password', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.12', 'Other other', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, 'PatchAvailable\n\n', ' ', ' ', '2005-12-21 05:51 UTC', 'Eric Lenio', NULL, '2009-07-07 06:59:55 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (256, '47440', 'Bug 47440 Remove DB-specific SQL statements from test cases (SELECT 1)', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC Windows XP', 'P2 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-06-27 05:17 UTC', 'Sebb', NULL, '2010-08-04 12:34:40 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (257, '47439', 'Bug 47439 PooledConnection.connect() fails to check for null connection', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'jdbc-pool', 'unspecified', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-06-27 05:01 UTC', 'Sebb', NULL, '2010-08-04 12:34:42 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (258, '38352', 'Bug 38352 Additional Entries for Default catalina.policy file.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.14', 'Other other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-01-22 20:27 UTC', 'George Sexton', NULL, '2009-07-05 16:09:11 UTC', 'william.barker', NULL);
INSERT INTO `tomcatpredefined` VALUES (259, '47046', 'Bug 47046 Shutdown does not unregister all MBeans', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.18', 'PC Mac OS X 10.4', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-04-17 07:59 UTC', 'Rob Harrop', NULL, '2009-09-07 07:16:47 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (260, '37929', 'Bug 37929 invalidated session causes pageContext methods to fail', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.18', 'Other other', 'P3 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2005-12-16 01:58 UTC', 'Pierre Delisle', NULL, '2009-04-28 07:29:44 UTC', 'nex_sandro', NULL);
INSERT INTO `tomcatpredefined` VALUES (261, '47013', 'Bug 47013 JSP not compiled at startup when used as a servlet', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.18', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-04-10 09:26 UTC', 'Robert Flaherty', NULL, '2009-05-02 18:33:18 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (262, '42579', 'Bug 42579 [Patch] JNDIRealm fails to parse absolute names', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.23', 'All Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, 'PatchAvailable\n\n', ' ', ' ', '2007-06-04 14:13 UTC', 'Brandon DuRette', NULL, '2009-10-22 07:54:48 UTC', 'albrecht', NULL);
INSERT INTO `tomcatpredefined` VALUES (263, '46354', 'Bug 46354 LIMIT_BUFFER setting causes arraycopy errors', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.27', 'All Linux', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-12-05 09:01 UTC', 'Ed Hill', NULL, '2009-05-25 02:38:56 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (264, '46562', 'Bug 46562 Reader not closed', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Servlets:SSI', '5.5.27', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-01-19 08:17 UTC', 'Michael Rauner', NULL, '2009-06-04 07:44:07 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (265, '46991', 'Bug 46991 \'Bytes received \'  problem', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Manager application', 'unspecified', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-04-08 01:37 UTC', 'huangfeng', NULL, '2009-04-28 06:23:35 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (266, '46967', 'Bug 46967 ManagerBase.setRandomFile error handling fix', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.27', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-04-03 18:57 UTC', 'Kirk Wolf', NULL, '2009-08-12 18:23:28 UTC', 'tfull,Tim.Whittington', NULL);
INSERT INTO `tomcatpredefined` VALUES (267, '46933', 'Bug 46933 Using Java 1.5 in StringManager', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-03-27 15:34 UTC', 'Jens Kapitza', NULL, '2009-04-28 09:04:34 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (268, '46982', 'Bug 46982 AccessLogValve reports correct time but incorrect offset following Spring DST transition.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.27', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-04-07 07:32 UTC', 'Philip Pickett', NULL, '2009-06-04 07:34:00 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (269, '41606', 'Bug 41606 The jspInit method is called twice.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.20', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-02-13 20:46 UTC', 'Suzuki Yuichiro', NULL, '2009-06-04 07:19:08 UTC', 'Brian,robert.flaherty', NULL);
INSERT INTO `tomcatpredefined` VALUES (270, '46875', 'Bug 46875 CometConnectionManagerValve: concurrent access on session object when calling HttpSession.invalidate()', 'RESOLVED WONTFIX', 'None', 'Tomcat 6', 'Catalina', '6.0.18', 'PC All', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-03-19 02:15 UTC', 'holger.schott', NULL, '2014-02-17 13:48:34 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (271, '46666', 'Bug 46666 Why is disableUploadTimeout and KeepAliveTimeout correlated in Http11 Connector?', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.18', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2009-02-04 08:28 UTC', 'Doug Drechsel', NULL, '2009-03-06 07:21:53 UTC', 'dougd', NULL);
INSERT INTO `tomcatpredefined` VALUES (272, '39396', 'Bug 39396 OPTIONS request on directory with no default file reports an incorrect list of allowed HTTP verbs', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:Coyote', '5.5.9', 'All Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-04-24 15:15 UTC', 'Sean Molloy', NULL, '2009-07-05 07:28:52 UTC', 'aleksander.adamowski.apache,julian.reschke', NULL);
INSERT INTO `tomcatpredefined` VALUES (273, '38570', 'Bug 38570 if docBase path contains \'webapps\', a backslash is inserted', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.17', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-02-08 15:46 UTC', 'Edith', NULL, '2009-06-04 05:48:26 UTC', 'kirk', NULL);
INSERT INTO `tomcatpredefined` VALUES (274, '38553', 'Bug 38553 Wrong HTTP code for failed CLIENT-CERT authentication', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:Coyote', '5.0.28', 'Other other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-02-07 16:54 UTC', 'Markus', NULL, '2009-06-04 05:45:51 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (275, '38197', 'Bug 38197 taglib pool bug when tag is used with jsp:attribute', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.12', 'PC Windows Vista', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-01-09 15:53 UTC', 'Diego Belfer', NULL, '2009-06-03 15:12:33 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (276, '46261', 'Bug 46261 Context with %2F in name causes tomcat crash on shutdown', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.18', 'PC Linux', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-11-21 08:34 UTC', 'Joe Kislo', NULL, '2009-01-31 00:42:50 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (277, '46381', 'Bug 46381 Coerce EL expression to java.lang.Object breaks expression concatenation', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Servlet &amp; JSP API', 'unspecified', 'PC Windows XP', 'P2 critical', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-12-11 07:13 UTC', 'Fabian Necci', NULL, '2009-07-07 03:56:21 UTC', 'alfred.staflinger,markt', NULL);
INSERT INTO `tomcatpredefined` VALUES (278, '46397', 'Bug 46397 Potential memory leak with TagHandlers and JspIdConsumer', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', 'unspecified', 'Macintosh Mac OS X 10.4', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-12-15 00:43 UTC', 'Jochen Wuttke', NULL, '2008-12-27 13:05:00 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (279, '46403', 'Bug 46403 Persistent cookies written by 6.0.18 do not work in Internet Explorer or Safari', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.18', 'PC Linux', 'P2 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, 'http://cephas.net/blog/2008/11/18/tomcat-6018-version-1-cookies-acegi-remember-me-and-ie/', NULL, ' ', ' ', ' ', '2008-12-15 13:46 UTC', 'Matt Wiseley', NULL, '2010-05-26 10:59:30 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (280, '46408', 'Bug 46408 Invalid cast in SecurityUtil', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.27', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-12-16 15:22 UTC', 'Kazimierz Pogoda', NULL, '2009-06-03 14:19:31 UTC', 'hshsce', NULL);
INSERT INTO `tomcatpredefined` VALUES (281, '46247', 'Bug 46247 SVN property patches', 'RESOLVED FIXED', 'None', 'Tomcat Modules', 'Bayeux', 'unspecified', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-11-19 18:16 UTC', 'Sebb', NULL, '2010-08-04 12:33:03 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (282, '42693', 'Bug 42693 JSP-Generation error with recursive tagfile structure', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', 'unspecified', 'PC Linux', 'P1 critical', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-06-18 10:10 UTC', 'Frank Hofmann', NULL, '2009-01-14 15:27:06 UTC', 'dyk,jens.askengren', NULL);
INSERT INTO `tomcatpredefined` VALUES (283, '42707', 'Bug 42707 add host alias using jmx doesn\'t take affect until restart', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.27', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', '44856', '2007-06-20 14:46 UTC', 'Ted Leung', NULL, '2009-06-04 08:06:52 UTC', 'andrew', NULL);
INSERT INTO `tomcatpredefined` VALUES (284, '42409', 'Bug 42409 Extra response headers not sent when using custom error page', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'All All', 'P3 major', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-05-14 09:03 UTC', 'Hayden James', NULL, '2008-11-30 14:58:37 UTC', 'brian.curnow,knst.kolinko', NULL);
INSERT INTO `tomcatpredefined` VALUES (285, '46051', 'Bug 46051 Servlet response writer does not respect line.separator system property', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-10-21 10:54 UTC', 'Chris Hubick', NULL, '2008-11-01 19:31:46 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (286, '46096', 'Bug 46096 DefaultAnnotationProcessor.processAnnotations should use doPrivileged to call getDeclaredFields', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.18', 'PC Windows Vista', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-10-27 05:44 UTC', 'Richard Evans', NULL, '2008-11-04 19:26:46 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (287, '45933', 'Bug 45933 Error processing TLD file in webapp with XML parser', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.27', 'PC All', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-10-01 23:51 UTC', 'Eddy Chan', NULL, '2009-06-03 13:56:05 UTC', 'ecapachedev,mauromol', NULL);
INSERT INTO `tomcatpredefined` VALUES (288, '45851', 'Bug 45851 FarmWarDeployer fails to properly unpack copied war on target node', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Cluster', '6.0.18', 'PC Windows Server 2003', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-09-19 22:17 UTC', 'Paul McGurn', NULL, '2009-01-14 16:33:28 UTC', 'finger', NULL);
INSERT INTO `tomcatpredefined` VALUES (289, '45026', 'Bug 45026 Custom HTTP-Error codes get remapped to 500er codes', 'RESOLVED FIXED', 'None', 'Tomcat Connectors', 'Common', 'unspecified', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-05-18 04:16 UTC', 'Jan Schulte', NULL, '2009-04-06 15:14:57 UTC', 'jens.scheffler', NULL);
INSERT INTO `tomcatpredefined` VALUES (290, '45419', 'Bug 45419 Return Accept-Ranges from DefaultServlet', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-07-17 07:38 UTC', 'Mike Bremford', NULL, '2014-02-17 13:42:31 UTC', 'ftoth', NULL);
INSERT INTO `tomcatpredefined` VALUES (291, '45441', 'Bug 45441 Matching of relevant servlet filters fails when request is forwarded...', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.18', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-07-20 10:54 UTC', 'Andrzej Taramina', NULL, '2014-02-17 13:53:56 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (292, '45618', 'Bug 45618 Selector is not closed.', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'PC Windows 2000', 'P2 trivial', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-08-11 22:45 UTC', 'Hao Zhong', NULL, '2008-10-09 05:37:12 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (293, '45666', 'Bug 45666 JspContextWrapper contains infinite loop in include(String relativeUrlPath, boolean flush)', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.26', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-08-21 06:47 UTC', 'Tom Wadzinski', NULL, '2009-03-22 10:08:57 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (294, '45648', 'Bug 45648 Function \'f:length\' not found', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.18', 'PC Windows XP', 'P3 regression', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-08-18 19:54 UTC', 'Carlos Costa e Silva', NULL, '2008-09-25 03:42:09 UTC', 'c.costa.silva', NULL);
INSERT INTO `tomcatpredefined` VALUES (295, '45691', 'Bug 45691 Jasper creates duplicate variable names', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.0', 'PC All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-08-26 07:23 UTC', 'Stefan Birkner', NULL, '2014-02-17 13:56:25 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (296, '43327', 'Bug 43327 Socket bind fails on tomcat startup when using apr', 'RESOLVED FIXED', 'None', 'Tomcat Native', 'Library', 'unspecified', 'HP Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-09-07 07:22 UTC', 'Erik Moller', NULL, '2014-04-15 20:12:01 UTC', 'david,jfclere,siegmund.gorr', NULL);
INSERT INTO `tomcatpredefined` VALUES (297, '45608', 'Bug 45608 Race conditions on field countAllocated of class org.apache.catalina.core.StandardWrapper', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.13', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-08-10 21:27 UTC', 'Yao Qi', NULL, '2014-02-17 13:56:21 UTC', 'mgainty', NULL);
INSERT INTO `tomcatpredefined` VALUES (298, '41407', 'Bug 41407 CLIENT-CERT Authentication with JAASRealm not working', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.20', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-01-18 18:33 UTC', 'Butler', NULL, '2009-03-22 10:03:44 UTC', 'rm', NULL);
INSERT INTO `tomcatpredefined` VALUES (299, '45591', 'Bug 45591 NullPointerException during shutdown in JKMain.pause()', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:AJP', '5.5.20', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-08-07 12:35 UTC', 'Matt Passell', NULL, '2008-08-27 13:58:02 UTC', 'mpassell', NULL);
INSERT INTO `tomcatpredefined` VALUES (300, '45453', 'Bug 45453 JDBCRealm.getRoles bad synchronization causes hangs w/ DIGEST authentication', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.26', 'PC Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, 'PatchAvailable\n\n', ' ', ' ', '2008-07-22 02:25 UTC', 'Santtu Hyrkkö', NULL, '2008-08-14 02:37:32 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (301, '42727', 'Bug 42727 CoyoteReader readLine returns null for some post request bodies that are a multiple of MAX_LINE_LENGTH in size', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:Coyote', '5.5.20', 'All All', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', '42727,44060', '2007-06-23 06:29 UTC', 'mike', NULL, '2008-08-14 02:32:38 UTC', 'zibuk', NULL);
INSERT INTO `tomcatpredefined` VALUES (302, '42722', 'Bug 42722 Potential NullPointerException in org.apache.catalina.servlets.CGIServlet', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.11', 'Other All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-06-22 05:21 UTC', 'Nils Hammar', NULL, '2008-10-08 06:57:38 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (303, '36155', 'Bug 36155 tomcat chooses wrong host if using mod_jk', 'RESOLVED FIXED', 'None', 'Tomcat Connectors', 'Common', 'unspecified', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2005-08-12 05:08 UTC', 'Sven', NULL, '2011-04-11 16:23:08 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (304, '42750', 'Bug 42750 Http Post requests not handled correctly if there is more than one space between the \'POST\' and the URL', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:Coyote', '5.5.20', 'PC Windows XP', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-06-26 16:57 UTC', 'Dick Salisbury', NULL, '2008-07-30 14:01:40 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (305, '42934', 'Bug 42934 sessionDidActivate() called before contextInitialized()', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.11', 'PC Windows Vista', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-07-18 14:40 UTC', 'Mike Youngstrom', NULL, '2008-06-08 05:51:14 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (306, '42943', 'Bug 42943 jsp:text gets confused with other *:text elements in a JSP tag file', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.0.30', 'Other other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-07-20 03:46 UTC', 'Vojtech Toman', NULL, '2008-07-30 13:46:36 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (307, '43080', 'Bug 43080 Suspicious url pattern warning logged to wrong webapp', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.17', 'Other other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-08-09 15:18 UTC', 'Marius Scurtescu', NULL, '2008-07-30 13:38:49 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (308, '43191', 'Bug 43191 compressableMimeType attribute ignored', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:HTTP', '5.5.20', 'All Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-08-22 15:02 UTC', 'Dave Wood', NULL, '2008-07-30 13:24:26 UTC', 'fern,jleech,richard.mundell', NULL);
INSERT INTO `tomcatpredefined` VALUES (309, '43366', 'Bug 43366 Session Statistics command in manager fails with \'Unknown command /sessions\'', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Manager application', '6.0.14', 'Other All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, 'http://tomcat.apache.org/tomcat-6.0-doc/manager-howto.html#Session%20Statistics', NULL, ' ', ' ', ' ', '2007-09-12 08:15 UTC', 'Greg Johnson', NULL, '2008-05-01 13:50:09 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (310, '44877', 'Bug 44877 ClassCastException due to bad TagHandlerPool name generation of two different tags', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.26', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-04-25 13:43 UTC', 'illod', NULL, '2008-07-30 13:16:40 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (311, '31257', 'Bug 31257 java.endorsed.dirs is not used when JSP compilation is forked', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.0.27', 'All Windows XP', 'P3 critical', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2004-09-16 05:10 UTC', 'James DeFelice', NULL, '2008-07-30 11:14:40 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (312, '29936', 'Bug 29936 XML parser loading problems by container', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.23', 'PC All', 'P3 blocker', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2004-07-06 15:18 UTC', 'peter neville', NULL, '2008-07-30 11:06:36 UTC', 'daniel.spilker,ecapachedev', NULL);
INSERT INTO `tomcatpredefined` VALUES (313, '44562', 'Bug 44562 HEAD requests cannot go through request dispatch include.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Servlet &amp; JSP API', '5.5.26', 'PC Mac OS X 10.4', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-03-07 13:19 UTC', 'david jencks', NULL, '2008-07-30 10:26:00 UTC', 'lnelson', NULL);
INSERT INTO `tomcatpredefined` VALUES (314, '43701', 'Bug 43701 Error while starting tomcat', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.14', 'Other Windows XP', 'P1 critical', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-10-26 03:01 UTC', 'prabhat', NULL, '2008-04-13 15:21:02 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (315, '44268', 'Bug 44268 Multiple registrations of same ServletContextListener class not possible', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.14', 'Other Linux', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-01-18 08:42 UTC', 'Stefan Fleiter', NULL, '2014-02-17 13:56:39 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (316, '44223', 'Bug 44223 Tomcat ignores the \'javax.net.ssl.trustStoreType\' system property', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.14', 'Other other', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2008-01-14 04:24 UTC', 'Ivan Todoroski', NULL, '2008-01-28 13:34:43 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (317, '11117', 'Bug 11117 Coyote connector does not correctly deal with large PUT when using chunked transfer encoding', 'RESOLVED FIXED', 'None', 'Tomcat 4', 'Connector:Coyote HTTP/1.1', '4.1.7', 'PC Linux', 'P3 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2002-07-24 07:44 UTC', 'Michael Smith', NULL, '2004-11-16 19:05:39 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (318, '43285', 'Bug 43285 Missing EL Coercion causes argument type mismatch', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Servlet &amp; JSP API', '6.0.14', 'Other Windows XP', 'P2 enhancement', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-09-02 13:14 UTC', 'Bernhard Huemer', NULL, '2014-02-17 13:53:37 UTC', 'bernhard.huemer,bryan,jasonzhang2002,mail', NULL);
INSERT INTO `tomcatpredefined` VALUES (319, '42503', 'Bug 42503 ServletContext.getResourceAsStream returns stale data', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'Other other', 'P3 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-05-23 16:52 UTC', 'Arvind Srinivasan', NULL, '2007-12-30 14:06:06 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (320, '43914', 'Bug 43914 HTTP spec violation when generating HTTP redirects for folders without trailing slash', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:Coyote', '5.5.25', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-11-20 05:53 UTC', 'Ivan Todoroski', NULL, '2008-01-06 15:16:55 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (321, '44084', 'Bug 44084 JAASRealm useContextClassLoader has problems', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.25', 'Other other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-12-15 14:27 UTC', 'Noah Levitt', NULL, '2008-01-06 15:19:28 UTC', 'ate,computabloke', NULL);
INSERT INTO `tomcatpredefined` VALUES (322, '43236', 'Bug 43236 Response.setCharacterEncoding() fails after Response.getWriter() and Response.reset()', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.0.23', 'All All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-08-29 03:56 UTC', 'Olaf Meske', NULL, '2008-01-06 15:15:53 UTC', 'Udo.Walker', NULL);
INSERT INTO `tomcatpredefined` VALUES (323, '43241', 'Bug 43241 ServletContext.getResourceAsStream()  does not follow API specs for Path', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Servlet &amp; JSP API', '5.5.23', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-08-29 12:54 UTC', 'George Sexton', NULL, '2008-01-06 15:16:18 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (324, '43622', 'Bug 43622 compression / minCompressionSize attribute not properly implemented', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Connector:HTTP', '5.5.12', 'All All', 'P3 minor', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-10-15 03:51 UTC', 'redeemer', NULL, '2008-01-06 15:13:58 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (325, '43757', 'Bug 43757 Improper parsing of response.sendRedirect() in JSP source', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', 'Nightly Build', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-10-31 11:55 UTC', 'Charles Stahl', NULL, '2008-01-06 15:14:12 UTC', 'beefnog', NULL);
INSERT INTO `tomcatpredefined` VALUES (326, '43893', 'Bug 43893 WebdavServlet returns incorrect values for the \'href\' property when it is mapped with / url prefix, instead of /*', 'RESOLVED WONTFIX', 'None', 'Tomcat 6', 'Catalina', '6.0.14', 'All All', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-11-18 00:04 UTC', 'Ivan Todoroski', NULL, '2007-11-23 11:07:14 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (327, '43356', 'Bug 43356 keystoreFile parameter, when specified as relative, is not treated relative to $CATALINA_BASE or catalina.base property for NioEndPoint', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Connectors', '6.0.9', 'Other other', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-09-11 11:42 UTC', 'Peter Lynch', NULL, '2014-02-17 13:57:12 UTC', 'hauser', NULL);
INSERT INTO `tomcatpredefined` VALUES (328, '30949', 'Bug 30949 After Failed Include, Request and Response not Unwrapped', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.0.27', 'All All', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2004-08-30 23:54 UTC', 'Scott Goldstein', NULL, '2007-09-04 19:02:45 UTC', 'mcalmus', NULL);
INSERT INTO `tomcatpredefined` VALUES (329, '42753', 'Bug 42753 Race condition when using available() or reading in CometProcessor.event()', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', 'unspecified', 'All other', 'P1 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-06-27 05:21 UTC', 'Sebastiaan van Erk', NULL, '2007-06-29 06:31:39 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (330, '42314', 'Bug 42314 Jasper output no details with compilation error in specific case.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.23', 'Other Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-05-02 01:13 UTC', 'Suzuki Yuichiro', NULL, '2007-06-24 04:49:16 UTC', 'jochen', NULL);
INSERT INTO `tomcatpredefined` VALUES (331, '42547', 'Bug 42547 Same env-entry (web.xml) and ResourceLink (context) names causes NPE', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.23', 'All All', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-05-30 11:29 UTC', 'John Hutchnson', NULL, '2007-06-23 08:03:11 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (332, '42497', 'Bug 42497 304 response should consistently include ETag header', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.23', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-05-23 09:00 UTC', 'Len Popp', NULL, '2007-06-15 15:50:45 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (333, '42438', 'Bug 42438 Duplicate JSP temp variable declaration when jsp:attribute used in conjunction with custom tags', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.0.20', 'All All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-05-16 17:43 UTC', 'Brian Lenz', NULL, '2007-05-21 19:31:53 UTC', 'seeger', NULL);
INSERT INTO `tomcatpredefined` VALUES (334, '42361', 'Bug 42361 POST content type incorrect for multipart forms after login', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.10', 'PC Windows XP', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-05-08 16:06 UTC', 'Peter Runge', NULL, '2007-05-08 17:05:25 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (335, '42202', 'Bug 42202 if you install tomcat in a directory with spaces it ignores TLD files inside jar files', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.24', 'PC Windows XP', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-04-23 14:07 UTC', 'Rodrigo Urubatan', NULL, '2007-04-25 09:36:32 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (336, '42071', 'Bug 42071 If a JSP throws an UnavailableException twice, an IllegalStateException occurs.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.23', 'All All', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-04-08 17:49 UTC', 'kawasima', NULL, '2007-04-18 19:29:09 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (337, '42085', 'Bug 42085 java.util.Logging duplicated since 5.5.23.  5.5.20 is OK', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina:Modules', '5.5.23', 'All All', 'P3 regression', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2007-04-10 23:13 UTC', 'Klaus Halfmann', NULL, '2007-04-14 12:14:39 UTC', 'richardfearn', NULL);
INSERT INTO `tomcatpredefined` VALUES (338, '41289', 'Bug 41289 Error when deploying XML Configuration file URL', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Catalina', '6.0.2', 'Macintosh Mac OS X 10.4', 'P2 normal', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, 'http://localhost:8080/manager/html', NULL, ' ', ' ', ' ', '2007-01-04 07:42 UTC', 'Zemian Deng', NULL, '2007-04-05 07:00:54 UTC', 'lizongbo', NULL);
INSERT INTO `tomcatpredefined` VALUES (339, '40150', 'Bug 40150 Incorrect User/Role classnames are silently ignored.', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.17', 'All other', 'P2 blocker', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-08-01 08:52 UTC', 'Tom', NULL, '2008-01-21 13:01:59 UTC', 'ate', NULL);
INSERT INTO `tomcatpredefined` VALUES (340, '40820', 'Bug 40820 Default JSP factory not initialized early enough', 'RESOLVED FIXED', 'None', 'Tomcat 6', 'Jasper', '6.0.0', 'Other other', 'P2 minor', 'default', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-10-26 07:52 UTC', 'Scott Johnson', NULL, '2014-02-17 13:55:10 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (341, '41057', 'Bug 41057 Tomcat leaks memory on every request', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.20', 'All Linux', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-11-28 10:07 UTC', 'vilks56', NULL, '2006-12-02 12:12:26 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (342, '40901', 'Bug 40901 listings page does not escape XML characters', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Unknown', '5.5.17', 'Other Solaris', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-11-05 20:38 UTC', 'Dies Koper', NULL, '2006-11-10 13:17:32 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (343, '37509', 'Bug 37509 ClassLoaderLogManager remove \' n\' at the end of logging.properties values', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Unknown', '5.5.12', 'Other other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2005-11-15 18:22 UTC', 'Franck Hamelin', NULL, '2006-11-08 19:05:58 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (344, '34956', 'Bug 34956 Tomcat should enforce the requirements from servlet 2.4 specification SRV.8.2', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Servlet &amp; JSP API', '5.5.9', 'All other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2005-05-18 14:47 UTC', 'christian.buchegger', NULL, '2006-10-01 15:50:56 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (345, '40817', 'Bug 40817 servlet-cgi throws index out of bounds exception on certain cgi', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Servlets:CGI', '5.5.20', 'PC Linux', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-10-25 20:02 UTC', 'Gene Hardesty', NULL, '2006-10-27 17:52:44 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (346, '37458', 'Bug 37458 Datarace on org.apache.catalina.loader.WebappClassLoader', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.9', 'PC Windows XP', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2005-11-10 21:34 UTC', 'Feng Chen', NULL, '2009-06-03 14:37:34 UTC', 'david.mcintyre', NULL);
INSERT INTO `tomcatpredefined` VALUES (347, '39724', 'Bug 39724 Bug on StandardPipeline.removeValve(Valve valve) for T5.5.16+', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.16', 'Other other', 'P2 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-06-05 14:01 UTC', 'David Gagnon', NULL, '2006-10-02 18:06:07 UTC', 'paul.kemler', NULL);
INSERT INTO `tomcatpredefined` VALUES (348, '29727', 'Bug 29727 JNDI env-entry not reload when context reloaded', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', 'Nightly Build', 'All All', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2004-06-21 22:56 UTC', 'robert engels', NULL, '2006-09-21 16:58:00 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (349, '34399', 'Bug 34399 Undeploying fails when context defined in server.xml & server fails to stop', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Webapps:Manager', '5.5.7', 'Other other', 'P4 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2005-04-11 16:32 UTC', 'sherold', NULL, '2006-09-14 18:58:13 UTC', 'brycealcock,petr.jiricka,zikmund', NULL);
INSERT INTO `tomcatpredefined` VALUES (350, '34509', 'Bug 34509 tag names that are xml:Name but not java identifier are not accepted', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.8', 'PC Windows XP', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2005-04-19 00:45 UTC', 'elaine chien', NULL, '2007-06-01 18:43:55 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (351, '31804', 'Bug 31804 setParent() is not called on nested tags in a tag file (.tagx)', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.0.31', 'PC Windows XP', 'P3 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2004-10-20 16:26 UTC', 'Firepica', NULL, '2006-09-07 21:19:26 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (352, '38713', 'Bug 38713 java.io.IOException: tmpFile.renameTo(classFile) failed when compiling new JSP (upon redeploy)', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Jasper', '5.5.23', 'Sun SunOS', 'P3 normal', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-02-20 08:08 UTC', 'Eric', NULL, '2009-07-02 11:57:03 UTC', 'dstusynski,phil', NULL);
INSERT INTO `tomcatpredefined` VALUES (353, '40306', 'Bug 40306 mod_jk, POST request bodies are not restored on successful login when using mod_jk', 'RESOLVED FIXED', 'None', 'Tomcat Connectors', 'Common', 'unspecified', 'All All', 'P2 major', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-08-23 19:48 UTC', 'Aaron Loucks', NULL, '2008-10-05 03:13:36 UTC', 'gael.legargeant', NULL);
INSERT INTO `tomcatpredefined` VALUES (354, '34801', 'Bug 34801 PATCH: CGIServlet does not terminate child after a timeout', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Servlets:CGI', '5.5.17', 'Other Windows XP', 'P3 enhancement', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2005-05-08 06:47 UTC', 'chris_j_davey', NULL, '2011-04-08 17:51:10 UTC', ' ', NULL);
INSERT INTO `tomcatpredefined` VALUES (355, '39699', 'Bug 39699 simple deploy failed in cluster (distributable flag)', 'RESOLVED FIXED', 'None', 'Tomcat 5', 'Catalina', '5.5.17', 'Other Linux', 'P2 critical', '---', 'Tomcat Developers Mailing List', NULL, NULL, NULL, ' ', NULL, ' ', ' ', ' ', '2006-06-01 16:28 UTC', 'Christophe Yayon', NULL, '2006-06-09 02:06:40 UTC', 'corporate_gadfly', NULL);

SET FOREIGN_KEY_CHECKS = 1;
